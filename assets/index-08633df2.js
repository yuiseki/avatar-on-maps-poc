(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))f(_);new MutationObserver(_=>{for(const w of _)if(w.type==="childList")for(const I of w.addedNodes)I.tagName==="LINK"&&I.rel==="modulepreload"&&f(I)}).observe(document,{childList:!0,subtree:!0});function l(_){const w={};return _.integrity&&(w.integrity=_.integrity),_.referrerPolicy&&(w.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?w.credentials="include":_.crossOrigin==="anonymous"?w.credentials="omit":w.credentials="same-origin",w}function f(_){if(_.ep)return;_.ep=!0;const w=l(_);fetch(_.href,w)}})();var Iw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zw(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Xu={},Aw={get exports(){return Xu},set exports(n){Xu=n}},Md={},Qe={},Mw={get exports(){return Qe},set exports(n){Qe=n}},Dt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mc=Symbol.for("react.element"),Pw=Symbol.for("react.portal"),Dw=Symbol.for("react.fragment"),Lw=Symbol.for("react.strict_mode"),Rw=Symbol.for("react.profiler"),Bw=Symbol.for("react.provider"),Fw=Symbol.for("react.context"),Ow=Symbol.for("react.forward_ref"),Nw=Symbol.for("react.suspense"),Uw=Symbol.for("react.memo"),Vw=Symbol.for("react.lazy"),Qy=Symbol.iterator;function $w(n){return n===null||typeof n!="object"?null:(n=Qy&&n[Qy]||n["@@iterator"],typeof n=="function"?n:null)}var _v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},vv=Object.assign,xv={};function Tl(n,o,l){this.props=n,this.context=o,this.refs=xv,this.updater=l||_v}Tl.prototype.isReactComponent={};Tl.prototype.setState=function(n,o){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,o,"setState")};Tl.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function wv(){}wv.prototype=Tl.prototype;function Dm(n,o,l){this.props=n,this.context=o,this.refs=xv,this.updater=l||_v}var Lm=Dm.prototype=new wv;Lm.constructor=Dm;vv(Lm,Tl.prototype);Lm.isPureReactComponent=!0;var e_=Array.isArray,bv=Object.prototype.hasOwnProperty,Rm={current:null},Ev={key:!0,ref:!0,__self:!0,__source:!0};function Sv(n,o,l){var f,_={},w=null,I=null;if(o!=null)for(f in o.ref!==void 0&&(I=o.ref),o.key!==void 0&&(w=""+o.key),o)bv.call(o,f)&&!Ev.hasOwnProperty(f)&&(_[f]=o[f]);var u=arguments.length-2;if(u===1)_.children=l;else if(1<u){for(var N=Array(u),q=0;q<u;q++)N[q]=arguments[q+2];_.children=N}if(n&&n.defaultProps)for(f in u=n.defaultProps,u)_[f]===void 0&&(_[f]=u[f]);return{$$typeof:mc,type:n,key:w,ref:I,props:_,_owner:Rm.current}}function jw(n,o){return{$$typeof:mc,type:n.type,key:o,ref:n.ref,props:n.props,_owner:n._owner}}function Bm(n){return typeof n=="object"&&n!==null&&n.$$typeof===mc}function Gw(n){var o={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(l){return o[l]})}var t_=/\/+/g;function Jp(n,o){return typeof n=="object"&&n!==null&&n.key!=null?Gw(""+n.key):o.toString(36)}function Hh(n,o,l,f,_){var w=typeof n;(w==="undefined"||w==="boolean")&&(n=null);var I=!1;if(n===null)I=!0;else switch(w){case"string":case"number":I=!0;break;case"object":switch(n.$$typeof){case mc:case Pw:I=!0}}if(I)return I=n,_=_(I),n=f===""?"."+Jp(I,0):f,e_(_)?(l="",n!=null&&(l=n.replace(t_,"$&/")+"/"),Hh(_,o,l,"",function(q){return q})):_!=null&&(Bm(_)&&(_=jw(_,l+(!_.key||I&&I.key===_.key?"":(""+_.key).replace(t_,"$&/")+"/")+n)),o.push(_)),1;if(I=0,f=f===""?".":f+":",e_(n))for(var u=0;u<n.length;u++){w=n[u];var N=f+Jp(w,u);I+=Hh(w,o,l,N,_)}else if(N=$w(n),typeof N=="function")for(n=N.call(n),u=0;!(w=n.next()).done;)w=w.value,N=f+Jp(w,u++),I+=Hh(w,o,l,N,_);else if(w==="object")throw o=String(n),Error("Objects are not valid as a React child (found: "+(o==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.");return I}function zh(n,o,l){if(n==null)return n;var f=[],_=0;return Hh(n,f,"","",function(w){return o.call(l,w,_++)}),f}function Zw(n){if(n._status===-1){var o=n._result;o=o(),o.then(function(l){(n._status===0||n._status===-1)&&(n._status=1,n._result=l)},function(l){(n._status===0||n._status===-1)&&(n._status=2,n._result=l)}),n._status===-1&&(n._status=0,n._result=o)}if(n._status===1)return n._result.default;throw n._result}var $r={current:null},Kh={transition:null},qw={ReactCurrentDispatcher:$r,ReactCurrentBatchConfig:Kh,ReactCurrentOwner:Rm};Dt.Children={map:zh,forEach:function(n,o,l){zh(n,function(){o.apply(this,arguments)},l)},count:function(n){var o=0;return zh(n,function(){o++}),o},toArray:function(n){return zh(n,function(o){return o})||[]},only:function(n){if(!Bm(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Dt.Component=Tl;Dt.Fragment=Dw;Dt.Profiler=Rw;Dt.PureComponent=Dm;Dt.StrictMode=Lw;Dt.Suspense=Nw;Dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qw;Dt.cloneElement=function(n,o,l){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var f=vv({},n.props),_=n.key,w=n.ref,I=n._owner;if(o!=null){if(o.ref!==void 0&&(w=o.ref,I=Rm.current),o.key!==void 0&&(_=""+o.key),n.type&&n.type.defaultProps)var u=n.type.defaultProps;for(N in o)bv.call(o,N)&&!Ev.hasOwnProperty(N)&&(f[N]=o[N]===void 0&&u!==void 0?u[N]:o[N])}var N=arguments.length-2;if(N===1)f.children=l;else if(1<N){u=Array(N);for(var q=0;q<N;q++)u[q]=arguments[q+2];f.children=u}return{$$typeof:mc,type:n.type,key:_,ref:w,props:f,_owner:I}};Dt.createContext=function(n){return n={$$typeof:Fw,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:Bw,_context:n},n.Consumer=n};Dt.createElement=Sv;Dt.createFactory=function(n){var o=Sv.bind(null,n);return o.type=n,o};Dt.createRef=function(){return{current:null}};Dt.forwardRef=function(n){return{$$typeof:Ow,render:n}};Dt.isValidElement=Bm;Dt.lazy=function(n){return{$$typeof:Vw,_payload:{_status:-1,_result:n},_init:Zw}};Dt.memo=function(n,o){return{$$typeof:Uw,type:n,compare:o===void 0?null:o}};Dt.startTransition=function(n){var o=Kh.transition;Kh.transition={};try{n()}finally{Kh.transition=o}};Dt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Dt.useCallback=function(n,o){return $r.current.useCallback(n,o)};Dt.useContext=function(n){return $r.current.useContext(n)};Dt.useDebugValue=function(){};Dt.useDeferredValue=function(n){return $r.current.useDeferredValue(n)};Dt.useEffect=function(n,o){return $r.current.useEffect(n,o)};Dt.useId=function(){return $r.current.useId()};Dt.useImperativeHandle=function(n,o,l){return $r.current.useImperativeHandle(n,o,l)};Dt.useInsertionEffect=function(n,o){return $r.current.useInsertionEffect(n,o)};Dt.useLayoutEffect=function(n,o){return $r.current.useLayoutEffect(n,o)};Dt.useMemo=function(n,o){return $r.current.useMemo(n,o)};Dt.useReducer=function(n,o,l){return $r.current.useReducer(n,o,l)};Dt.useRef=function(n){return $r.current.useRef(n)};Dt.useState=function(n){return $r.current.useState(n)};Dt.useSyncExternalStore=function(n,o,l){return $r.current.useSyncExternalStore(n,o,l)};Dt.useTransition=function(){return $r.current.useTransition()};Dt.version="18.2.0";(function(n){n.exports=Dt})(Mw);const Fm=zw(Qe);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ww=Qe,Xw=Symbol.for("react.element"),Hw=Symbol.for("react.fragment"),Kw=Object.prototype.hasOwnProperty,Yw=Ww.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Jw={key:!0,ref:!0,__self:!0,__source:!0};function Tv(n,o,l){var f,_={},w=null,I=null;l!==void 0&&(w=""+l),o.key!==void 0&&(w=""+o.key),o.ref!==void 0&&(I=o.ref);for(f in o)Kw.call(o,f)&&!Jw.hasOwnProperty(f)&&(_[f]=o[f]);if(n&&n.defaultProps)for(f in o=n.defaultProps,o)_[f]===void 0&&(_[f]=o[f]);return{$$typeof:Xw,type:n,key:w,ref:I,props:_,_owner:Yw.current}}Md.Fragment=Hw;Md.jsx=Tv;Md.jsxs=Tv;(function(n){n.exports=Md})(Aw);const Qw=Xu.Fragment,Gn=Xu.jsx,Lu=Xu.jsxs;var Pf={},Hu={},eb={get exports(){return Hu},set exports(n){Hu=n}},fi={},Df={},tb={get exports(){return Df},set exports(n){Df=n}},kv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function o(Ze,ct){var at=Ze.length;Ze.push(ct);e:for(;0<at;){var Tt=at-1>>>1,Ut=Ze[Tt];if(0<_(Ut,ct))Ze[Tt]=ct,Ze[at]=Ut,at=Tt;else break e}}function l(Ze){return Ze.length===0?null:Ze[0]}function f(Ze){if(Ze.length===0)return null;var ct=Ze[0],at=Ze.pop();if(at!==ct){Ze[0]=at;e:for(var Tt=0,Ut=Ze.length,yr=Ut>>>1;Tt<yr;){var Rn=2*(Tt+1)-1,Wn=Ze[Rn],zn=Rn+1,lr=Ze[zn];if(0>_(Wn,at))zn<Ut&&0>_(lr,Wn)?(Ze[Tt]=lr,Ze[zn]=at,Tt=zn):(Ze[Tt]=Wn,Ze[Rn]=at,Tt=Rn);else if(zn<Ut&&0>_(lr,at))Ze[Tt]=lr,Ze[zn]=at,Tt=zn;else break e}}return ct}function _(Ze,ct){var at=Ze.sortIndex-ct.sortIndex;return at!==0?at:Ze.id-ct.id}if(typeof performance=="object"&&typeof performance.now=="function"){var w=performance;n.unstable_now=function(){return w.now()}}else{var I=Date,u=I.now();n.unstable_now=function(){return I.now()-u}}var N=[],q=[],ue=1,oe=null,Z=3,ze=!1,Ie=!1,ke=!1,Xe=typeof setTimeout=="function"?setTimeout:null,se=typeof clearTimeout=="function"?clearTimeout:null,Q=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ae(Ze){for(var ct=l(q);ct!==null;){if(ct.callback===null)f(q);else if(ct.startTime<=Ze)f(q),ct.sortIndex=ct.expirationTime,o(N,ct);else break;ct=l(q)}}function Se(Ze){if(ke=!1,ae(Ze),!Ie)if(l(N)!==null)Ie=!0,st(Ae);else{var ct=l(q);ct!==null&&wn(Se,ct.startTime-Ze)}}function Ae(Ze,ct){Ie=!1,ke&&(ke=!1,se(Ke),Ke=-1),ze=!0;var at=Z;try{for(ae(ct),oe=l(N);oe!==null&&(!(oe.expirationTime>ct)||Ze&&!cn());){var Tt=oe.callback;if(typeof Tt=="function"){oe.callback=null,Z=oe.priorityLevel;var Ut=Tt(oe.expirationTime<=ct);ct=n.unstable_now(),typeof Ut=="function"?oe.callback=Ut:oe===l(N)&&f(N),ae(ct)}else f(N);oe=l(N)}if(oe!==null)var yr=!0;else{var Rn=l(q);Rn!==null&&wn(Se,Rn.startTime-ct),yr=!1}return yr}finally{oe=null,Z=at,ze=!1}}var Le=!1,Me=null,Ke=-1,Ct=5,dt=-1;function cn(){return!(n.unstable_now()-dt<Ct)}function xn(){if(Me!==null){var Ze=n.unstable_now();dt=Ze;var ct=!0;try{ct=Me(!0,Ze)}finally{ct?an():(Le=!1,Me=null)}}else Le=!1}var an;if(typeof Q=="function")an=function(){Q(xn)};else if(typeof MessageChannel<"u"){var ar=new MessageChannel,qn=ar.port2;ar.port1.onmessage=xn,an=function(){qn.postMessage(null)}}else an=function(){Xe(xn,0)};function st(Ze){Me=Ze,Le||(Le=!0,an())}function wn(Ze,ct){Ke=Xe(function(){Ze(n.unstable_now())},ct)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Ze){Ze.callback=null},n.unstable_continueExecution=function(){Ie||ze||(Ie=!0,st(Ae))},n.unstable_forceFrameRate=function(Ze){0>Ze||125<Ze?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ct=0<Ze?Math.floor(1e3/Ze):5},n.unstable_getCurrentPriorityLevel=function(){return Z},n.unstable_getFirstCallbackNode=function(){return l(N)},n.unstable_next=function(Ze){switch(Z){case 1:case 2:case 3:var ct=3;break;default:ct=Z}var at=Z;Z=ct;try{return Ze()}finally{Z=at}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Ze,ct){switch(Ze){case 1:case 2:case 3:case 4:case 5:break;default:Ze=3}var at=Z;Z=Ze;try{return ct()}finally{Z=at}},n.unstable_scheduleCallback=function(Ze,ct,at){var Tt=n.unstable_now();switch(typeof at=="object"&&at!==null?(at=at.delay,at=typeof at=="number"&&0<at?Tt+at:Tt):at=Tt,Ze){case 1:var Ut=-1;break;case 2:Ut=250;break;case 5:Ut=1073741823;break;case 4:Ut=1e4;break;default:Ut=5e3}return Ut=at+Ut,Ze={id:ue++,callback:ct,priorityLevel:Ze,startTime:at,expirationTime:Ut,sortIndex:-1},at>Tt?(Ze.sortIndex=at,o(q,Ze),l(N)===null&&Ze===l(q)&&(ke?(se(Ke),Ke=-1):ke=!0,wn(Se,at-Tt))):(Ze.sortIndex=Ut,o(N,Ze),Ie||ze||(Ie=!0,st(Ae))),Ze},n.unstable_shouldYield=cn,n.unstable_wrapCallback=function(Ze){var ct=Z;return function(){var at=Z;Z=ct;try{return Ze.apply(this,arguments)}finally{Z=at}}}})(kv);(function(n){n.exports=kv})(tb);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cv=Qe,pi=Df;function Pe(n){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+n,l=1;l<arguments.length;l++)o+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+n+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Iv=new Set,Ku={};function _a(n,o){gl(n,o),gl(n+"Capture",o)}function gl(n,o){for(Ku[n]=o,n=0;n<o.length;n++)Iv.add(o[n])}var Bo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Lf=Object.prototype.hasOwnProperty,nb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,n_={},r_={};function rb(n){return Lf.call(r_,n)?!0:Lf.call(n_,n)?!1:nb.test(n)?r_[n]=!0:(n_[n]=!0,!1)}function ib(n,o,l,f){if(l!==null&&l.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return f?!1:l!==null?!l.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function ob(n,o,l,f){if(o===null||typeof o>"u"||ib(n,o,l,f))return!0;if(f)return!1;if(l!==null)switch(l.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function jr(n,o,l,f,_,w,I){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=f,this.attributeNamespace=_,this.mustUseProperty=l,this.propertyName=n,this.type=o,this.sanitizeURL=w,this.removeEmptyString=I}var gr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){gr[n]=new jr(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var o=n[0];gr[o]=new jr(o,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){gr[n]=new jr(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){gr[n]=new jr(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){gr[n]=new jr(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){gr[n]=new jr(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){gr[n]=new jr(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){gr[n]=new jr(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){gr[n]=new jr(n,5,!1,n.toLowerCase(),null,!1,!1)});var Om=/[\-:]([a-z])/g;function Nm(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var o=n.replace(Om,Nm);gr[o]=new jr(o,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var o=n.replace(Om,Nm);gr[o]=new jr(o,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var o=n.replace(Om,Nm);gr[o]=new jr(o,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){gr[n]=new jr(n,1,!1,n.toLowerCase(),null,!1,!1)});gr.xlinkHref=new jr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){gr[n]=new jr(n,1,!1,n.toLowerCase(),null,!0,!0)});function Um(n,o,l,f){var _=gr.hasOwnProperty(o)?gr[o]:null;(_!==null?_.type!==0:f||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(ob(o,l,_,f)&&(l=null),f||_===null?rb(o)&&(l===null?n.removeAttribute(o):n.setAttribute(o,""+l)):_.mustUseProperty?n[_.propertyName]=l===null?_.type===3?!1:"":l:(o=_.attributeName,f=_.attributeNamespace,l===null?n.removeAttribute(o):(_=_.type,l=_===3||_===4&&l===!0?"":""+l,f?n.setAttributeNS(f,o,l):n.setAttribute(o,l))))}var Uo=Cv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ah=Symbol.for("react.element"),Ja=Symbol.for("react.portal"),Qa=Symbol.for("react.fragment"),Vm=Symbol.for("react.strict_mode"),Rf=Symbol.for("react.profiler"),zv=Symbol.for("react.provider"),Av=Symbol.for("react.context"),$m=Symbol.for("react.forward_ref"),Bf=Symbol.for("react.suspense"),Ff=Symbol.for("react.suspense_list"),jm=Symbol.for("react.memo"),us=Symbol.for("react.lazy"),Mv=Symbol.for("react.offscreen"),i_=Symbol.iterator;function Tu(n){return n===null||typeof n!="object"?null:(n=i_&&n[i_]||n["@@iterator"],typeof n=="function"?n:null)}var vn=Object.assign,Qp;function Ru(n){if(Qp===void 0)try{throw Error()}catch(l){var o=l.stack.trim().match(/\n( *(at )?)/);Qp=o&&o[1]||""}return`
`+Qp+n}var ef=!1;function tf(n,o){if(!n||ef)return"";ef=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(q){var f=q}Reflect.construct(n,[],o)}else{try{o.call()}catch(q){f=q}n.call(o.prototype)}else{try{throw Error()}catch(q){f=q}n()}}catch(q){if(q&&f&&typeof q.stack=="string"){for(var _=q.stack.split(`
`),w=f.stack.split(`
`),I=_.length-1,u=w.length-1;1<=I&&0<=u&&_[I]!==w[u];)u--;for(;1<=I&&0<=u;I--,u--)if(_[I]!==w[u]){if(I!==1||u!==1)do if(I--,u--,0>u||_[I]!==w[u]){var N=`
`+_[I].replace(" at new "," at ");return n.displayName&&N.includes("<anonymous>")&&(N=N.replace("<anonymous>",n.displayName)),N}while(1<=I&&0<=u);break}}}finally{ef=!1,Error.prepareStackTrace=l}return(n=n?n.displayName||n.name:"")?Ru(n):""}function sb(n){switch(n.tag){case 5:return Ru(n.type);case 16:return Ru("Lazy");case 13:return Ru("Suspense");case 19:return Ru("SuspenseList");case 0:case 2:case 15:return n=tf(n.type,!1),n;case 11:return n=tf(n.type.render,!1),n;case 1:return n=tf(n.type,!0),n;default:return""}}function Of(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Qa:return"Fragment";case Ja:return"Portal";case Rf:return"Profiler";case Vm:return"StrictMode";case Bf:return"Suspense";case Ff:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Av:return(n.displayName||"Context")+".Consumer";case zv:return(n._context.displayName||"Context")+".Provider";case $m:var o=n.render;return n=n.displayName,n||(n=o.displayName||o.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case jm:return o=n.displayName||null,o!==null?o:Of(n.type)||"Memo";case us:o=n._payload,n=n._init;try{return Of(n(o))}catch{}}return null}function ab(n){var o=n.type;switch(n.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=o.render,n=n.displayName||n.name||"",o.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Of(o);case 8:return o===Vm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Ts(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Pv(n){var o=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function lb(n){var o=Pv(n)?"checked":"value",l=Object.getOwnPropertyDescriptor(n.constructor.prototype,o),f=""+n[o];if(!n.hasOwnProperty(o)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var _=l.get,w=l.set;return Object.defineProperty(n,o,{configurable:!0,get:function(){return _.call(this)},set:function(I){f=""+I,w.call(this,I)}}),Object.defineProperty(n,o,{enumerable:l.enumerable}),{getValue:function(){return f},setValue:function(I){f=""+I},stopTracking:function(){n._valueTracker=null,delete n[o]}}}}function Mh(n){n._valueTracker||(n._valueTracker=lb(n))}function Dv(n){if(!n)return!1;var o=n._valueTracker;if(!o)return!0;var l=o.getValue(),f="";return n&&(f=Pv(n)?n.checked?"true":"false":n.value),n=f,n!==l?(o.setValue(n),!0):!1}function ad(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Nf(n,o){var l=o.checked;return vn({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??n._wrapperState.initialChecked})}function o_(n,o){var l=o.defaultValue==null?"":o.defaultValue,f=o.checked!=null?o.checked:o.defaultChecked;l=Ts(o.value!=null?o.value:l),n._wrapperState={initialChecked:f,initialValue:l,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function Lv(n,o){o=o.checked,o!=null&&Um(n,"checked",o,!1)}function Uf(n,o){Lv(n,o);var l=Ts(o.value),f=o.type;if(l!=null)f==="number"?(l===0&&n.value===""||n.value!=l)&&(n.value=""+l):n.value!==""+l&&(n.value=""+l);else if(f==="submit"||f==="reset"){n.removeAttribute("value");return}o.hasOwnProperty("value")?Vf(n,o.type,l):o.hasOwnProperty("defaultValue")&&Vf(n,o.type,Ts(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(n.defaultChecked=!!o.defaultChecked)}function s_(n,o,l){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var f=o.type;if(!(f!=="submit"&&f!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+n._wrapperState.initialValue,l||o===n.value||(n.value=o),n.defaultValue=o}l=n.name,l!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,l!==""&&(n.name=l)}function Vf(n,o,l){(o!=="number"||ad(n.ownerDocument)!==n)&&(l==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+l&&(n.defaultValue=""+l))}var Bu=Array.isArray;function cl(n,o,l,f){if(n=n.options,o){o={};for(var _=0;_<l.length;_++)o["$"+l[_]]=!0;for(l=0;l<n.length;l++)_=o.hasOwnProperty("$"+n[l].value),n[l].selected!==_&&(n[l].selected=_),_&&f&&(n[l].defaultSelected=!0)}else{for(l=""+Ts(l),o=null,_=0;_<n.length;_++){if(n[_].value===l){n[_].selected=!0,f&&(n[_].defaultSelected=!0);return}o!==null||n[_].disabled||(o=n[_])}o!==null&&(o.selected=!0)}}function $f(n,o){if(o.dangerouslySetInnerHTML!=null)throw Error(Pe(91));return vn({},o,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function a_(n,o){var l=o.value;if(l==null){if(l=o.children,o=o.defaultValue,l!=null){if(o!=null)throw Error(Pe(92));if(Bu(l)){if(1<l.length)throw Error(Pe(93));l=l[0]}o=l}o==null&&(o=""),l=o}n._wrapperState={initialValue:Ts(l)}}function Rv(n,o){var l=Ts(o.value),f=Ts(o.defaultValue);l!=null&&(l=""+l,l!==n.value&&(n.value=l),o.defaultValue==null&&n.defaultValue!==l&&(n.defaultValue=l)),f!=null&&(n.defaultValue=""+f)}function l_(n){var o=n.textContent;o===n._wrapperState.initialValue&&o!==""&&o!==null&&(n.value=o)}function Bv(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jf(n,o){return n==null||n==="http://www.w3.org/1999/xhtml"?Bv(o):n==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Ph,Fv=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,l,f,_){MSApp.execUnsafeLocalFunction(function(){return n(o,l,f,_)})}:n}(function(n,o){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=o;else{for(Ph=Ph||document.createElement("div"),Ph.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=Ph.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;o.firstChild;)n.appendChild(o.firstChild)}});function Yu(n,o){if(o){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=o;return}}n.textContent=o}var Nu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ub=["Webkit","ms","Moz","O"];Object.keys(Nu).forEach(function(n){ub.forEach(function(o){o=o+n.charAt(0).toUpperCase()+n.substring(1),Nu[o]=Nu[n]})});function Ov(n,o,l){return o==null||typeof o=="boolean"||o===""?"":l||typeof o!="number"||o===0||Nu.hasOwnProperty(n)&&Nu[n]?(""+o).trim():o+"px"}function Nv(n,o){n=n.style;for(var l in o)if(o.hasOwnProperty(l)){var f=l.indexOf("--")===0,_=Ov(l,o[l],f);l==="float"&&(l="cssFloat"),f?n.setProperty(l,_):n[l]=_}}var cb=vn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gf(n,o){if(o){if(cb[n]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(Pe(137,n));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(Pe(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(Pe(61))}if(o.style!=null&&typeof o.style!="object")throw Error(Pe(62))}}function Zf(n,o){if(n.indexOf("-")===-1)return typeof o.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qf=null;function Gm(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Wf=null,hl=null,dl=null;function u_(n){if(n=_c(n)){if(typeof Wf!="function")throw Error(Pe(280));var o=n.stateNode;o&&(o=Bd(o),Wf(n.stateNode,n.type,o))}}function Uv(n){hl?dl?dl.push(n):dl=[n]:hl=n}function Vv(){if(hl){var n=hl,o=dl;if(dl=hl=null,u_(n),o)for(n=0;n<o.length;n++)u_(o[n])}}function $v(n,o){return n(o)}function jv(){}var nf=!1;function Gv(n,o,l){if(nf)return n(o,l);nf=!0;try{return $v(n,o,l)}finally{nf=!1,(hl!==null||dl!==null)&&(jv(),Vv())}}function Ju(n,o){var l=n.stateNode;if(l===null)return null;var f=Bd(l);if(f===null)return null;l=f[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(n=n.type,f=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!f;break e;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(Pe(231,o,typeof l));return l}var Xf=!1;if(Bo)try{var ku={};Object.defineProperty(ku,"passive",{get:function(){Xf=!0}}),window.addEventListener("test",ku,ku),window.removeEventListener("test",ku,ku)}catch{Xf=!1}function hb(n,o,l,f,_,w,I,u,N){var q=Array.prototype.slice.call(arguments,3);try{o.apply(l,q)}catch(ue){this.onError(ue)}}var Uu=!1,ld=null,ud=!1,Hf=null,db={onError:function(n){Uu=!0,ld=n}};function pb(n,o,l,f,_,w,I,u,N){Uu=!1,ld=null,hb.apply(db,arguments)}function fb(n,o,l,f,_,w,I,u,N){if(pb.apply(this,arguments),Uu){if(Uu){var q=ld;Uu=!1,ld=null}else throw Error(Pe(198));ud||(ud=!0,Hf=q)}}function va(n){var o=n,l=n;if(n.alternate)for(;o.return;)o=o.return;else{n=o;do o=n,o.flags&4098&&(l=o.return),n=o.return;while(n)}return o.tag===3?l:null}function Zv(n){if(n.tag===13){var o=n.memoizedState;if(o===null&&(n=n.alternate,n!==null&&(o=n.memoizedState)),o!==null)return o.dehydrated}return null}function c_(n){if(va(n)!==n)throw Error(Pe(188))}function mb(n){var o=n.alternate;if(!o){if(o=va(n),o===null)throw Error(Pe(188));return o!==n?null:n}for(var l=n,f=o;;){var _=l.return;if(_===null)break;var w=_.alternate;if(w===null){if(f=_.return,f!==null){l=f;continue}break}if(_.child===w.child){for(w=_.child;w;){if(w===l)return c_(_),n;if(w===f)return c_(_),o;w=w.sibling}throw Error(Pe(188))}if(l.return!==f.return)l=_,f=w;else{for(var I=!1,u=_.child;u;){if(u===l){I=!0,l=_,f=w;break}if(u===f){I=!0,f=_,l=w;break}u=u.sibling}if(!I){for(u=w.child;u;){if(u===l){I=!0,l=w,f=_;break}if(u===f){I=!0,f=w,l=_;break}u=u.sibling}if(!I)throw Error(Pe(189))}}if(l.alternate!==f)throw Error(Pe(190))}if(l.tag!==3)throw Error(Pe(188));return l.stateNode.current===l?n:o}function qv(n){return n=mb(n),n!==null?Wv(n):null}function Wv(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var o=Wv(n);if(o!==null)return o;n=n.sibling}return null}var Xv=pi.unstable_scheduleCallback,h_=pi.unstable_cancelCallback,gb=pi.unstable_shouldYield,yb=pi.unstable_requestPaint,Ln=pi.unstable_now,_b=pi.unstable_getCurrentPriorityLevel,Zm=pi.unstable_ImmediatePriority,Hv=pi.unstable_UserBlockingPriority,cd=pi.unstable_NormalPriority,vb=pi.unstable_LowPriority,Kv=pi.unstable_IdlePriority,Pd=null,lo=null;function xb(n){if(lo&&typeof lo.onCommitFiberRoot=="function")try{lo.onCommitFiberRoot(Pd,n,void 0,(n.current.flags&128)===128)}catch{}}var ji=Math.clz32?Math.clz32:Eb,wb=Math.log,bb=Math.LN2;function Eb(n){return n>>>=0,n===0?32:31-(wb(n)/bb|0)|0}var Dh=64,Lh=4194304;function Fu(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function hd(n,o){var l=n.pendingLanes;if(l===0)return 0;var f=0,_=n.suspendedLanes,w=n.pingedLanes,I=l&268435455;if(I!==0){var u=I&~_;u!==0?f=Fu(u):(w&=I,w!==0&&(f=Fu(w)))}else I=l&~_,I!==0?f=Fu(I):w!==0&&(f=Fu(w));if(f===0)return 0;if(o!==0&&o!==f&&!(o&_)&&(_=f&-f,w=o&-o,_>=w||_===16&&(w&4194240)!==0))return o;if(f&4&&(f|=l&16),o=n.entangledLanes,o!==0)for(n=n.entanglements,o&=f;0<o;)l=31-ji(o),_=1<<l,f|=n[l],o&=~_;return f}function Sb(n,o){switch(n){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tb(n,o){for(var l=n.suspendedLanes,f=n.pingedLanes,_=n.expirationTimes,w=n.pendingLanes;0<w;){var I=31-ji(w),u=1<<I,N=_[I];N===-1?(!(u&l)||u&f)&&(_[I]=Sb(u,o)):N<=o&&(n.expiredLanes|=u),w&=~u}}function Kf(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Yv(){var n=Dh;return Dh<<=1,!(Dh&4194240)&&(Dh=64),n}function rf(n){for(var o=[],l=0;31>l;l++)o.push(n);return o}function gc(n,o,l){n.pendingLanes|=o,o!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,o=31-ji(o),n[o]=l}function kb(n,o){var l=n.pendingLanes&~o;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=o,n.mutableReadLanes&=o,n.entangledLanes&=o,o=n.entanglements;var f=n.eventTimes;for(n=n.expirationTimes;0<l;){var _=31-ji(l),w=1<<_;o[_]=0,f[_]=-1,n[_]=-1,l&=~w}}function qm(n,o){var l=n.entangledLanes|=o;for(n=n.entanglements;l;){var f=31-ji(l),_=1<<f;_&o|n[f]&o&&(n[f]|=o),l&=~_}}var Kt=0;function Jv(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var Qv,Wm,ex,tx,nx,Yf=!1,Rh=[],ys=null,_s=null,vs=null,Qu=new Map,ec=new Map,hs=[],Cb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function d_(n,o){switch(n){case"focusin":case"focusout":ys=null;break;case"dragenter":case"dragleave":_s=null;break;case"mouseover":case"mouseout":vs=null;break;case"pointerover":case"pointerout":Qu.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":ec.delete(o.pointerId)}}function Cu(n,o,l,f,_,w){return n===null||n.nativeEvent!==w?(n={blockedOn:o,domEventName:l,eventSystemFlags:f,nativeEvent:w,targetContainers:[_]},o!==null&&(o=_c(o),o!==null&&Wm(o)),n):(n.eventSystemFlags|=f,o=n.targetContainers,_!==null&&o.indexOf(_)===-1&&o.push(_),n)}function Ib(n,o,l,f,_){switch(o){case"focusin":return ys=Cu(ys,n,o,l,f,_),!0;case"dragenter":return _s=Cu(_s,n,o,l,f,_),!0;case"mouseover":return vs=Cu(vs,n,o,l,f,_),!0;case"pointerover":var w=_.pointerId;return Qu.set(w,Cu(Qu.get(w)||null,n,o,l,f,_)),!0;case"gotpointercapture":return w=_.pointerId,ec.set(w,Cu(ec.get(w)||null,n,o,l,f,_)),!0}return!1}function rx(n){var o=la(n.target);if(o!==null){var l=va(o);if(l!==null){if(o=l.tag,o===13){if(o=Zv(l),o!==null){n.blockedOn=o,nx(n.priority,function(){ex(l)});return}}else if(o===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Yh(n){if(n.blockedOn!==null)return!1;for(var o=n.targetContainers;0<o.length;){var l=Jf(n.domEventName,n.eventSystemFlags,o[0],n.nativeEvent);if(l===null){l=n.nativeEvent;var f=new l.constructor(l.type,l);qf=f,l.target.dispatchEvent(f),qf=null}else return o=_c(l),o!==null&&Wm(o),n.blockedOn=l,!1;o.shift()}return!0}function p_(n,o,l){Yh(n)&&l.delete(o)}function zb(){Yf=!1,ys!==null&&Yh(ys)&&(ys=null),_s!==null&&Yh(_s)&&(_s=null),vs!==null&&Yh(vs)&&(vs=null),Qu.forEach(p_),ec.forEach(p_)}function Iu(n,o){n.blockedOn===o&&(n.blockedOn=null,Yf||(Yf=!0,pi.unstable_scheduleCallback(pi.unstable_NormalPriority,zb)))}function tc(n){function o(_){return Iu(_,n)}if(0<Rh.length){Iu(Rh[0],n);for(var l=1;l<Rh.length;l++){var f=Rh[l];f.blockedOn===n&&(f.blockedOn=null)}}for(ys!==null&&Iu(ys,n),_s!==null&&Iu(_s,n),vs!==null&&Iu(vs,n),Qu.forEach(o),ec.forEach(o),l=0;l<hs.length;l++)f=hs[l],f.blockedOn===n&&(f.blockedOn=null);for(;0<hs.length&&(l=hs[0],l.blockedOn===null);)rx(l),l.blockedOn===null&&hs.shift()}var pl=Uo.ReactCurrentBatchConfig,dd=!0;function Ab(n,o,l,f){var _=Kt,w=pl.transition;pl.transition=null;try{Kt=1,Xm(n,o,l,f)}finally{Kt=_,pl.transition=w}}function Mb(n,o,l,f){var _=Kt,w=pl.transition;pl.transition=null;try{Kt=4,Xm(n,o,l,f)}finally{Kt=_,pl.transition=w}}function Xm(n,o,l,f){if(dd){var _=Jf(n,o,l,f);if(_===null)ff(n,o,f,pd,l),d_(n,f);else if(Ib(_,n,o,l,f))f.stopPropagation();else if(d_(n,f),o&4&&-1<Cb.indexOf(n)){for(;_!==null;){var w=_c(_);if(w!==null&&Qv(w),w=Jf(n,o,l,f),w===null&&ff(n,o,f,pd,l),w===_)break;_=w}_!==null&&f.stopPropagation()}else ff(n,o,f,null,l)}}var pd=null;function Jf(n,o,l,f){if(pd=null,n=Gm(f),n=la(n),n!==null)if(o=va(n),o===null)n=null;else if(l=o.tag,l===13){if(n=Zv(o),n!==null)return n;n=null}else if(l===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;n=null}else o!==n&&(n=null);return pd=n,null}function ix(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_b()){case Zm:return 1;case Hv:return 4;case cd:case vb:return 16;case Kv:return 536870912;default:return 16}default:return 16}}var fs=null,Hm=null,Jh=null;function ox(){if(Jh)return Jh;var n,o=Hm,l=o.length,f,_="value"in fs?fs.value:fs.textContent,w=_.length;for(n=0;n<l&&o[n]===_[n];n++);var I=l-n;for(f=1;f<=I&&o[l-f]===_[w-f];f++);return Jh=_.slice(n,1<f?1-f:void 0)}function Qh(n){var o=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&o===13&&(n=13)):n=o,n===10&&(n=13),32<=n||n===13?n:0}function Bh(){return!0}function f_(){return!1}function mi(n){function o(l,f,_,w,I){this._reactName=l,this._targetInst=_,this.type=f,this.nativeEvent=w,this.target=I,this.currentTarget=null;for(var u in n)n.hasOwnProperty(u)&&(l=n[u],this[u]=l?l(w):w[u]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Bh:f_,this.isPropagationStopped=f_,this}return vn(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Bh)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Bh)},persist:function(){},isPersistent:Bh}),o}var kl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Km=mi(kl),yc=vn({},kl,{view:0,detail:0}),Pb=mi(yc),of,sf,zu,Dd=vn({},yc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ym,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==zu&&(zu&&n.type==="mousemove"?(of=n.screenX-zu.screenX,sf=n.screenY-zu.screenY):sf=of=0,zu=n),of)},movementY:function(n){return"movementY"in n?n.movementY:sf}}),m_=mi(Dd),Db=vn({},Dd,{dataTransfer:0}),Lb=mi(Db),Rb=vn({},yc,{relatedTarget:0}),af=mi(Rb),Bb=vn({},kl,{animationName:0,elapsedTime:0,pseudoElement:0}),Fb=mi(Bb),Ob=vn({},kl,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Nb=mi(Ob),Ub=vn({},kl,{data:0}),g_=mi(Ub),Vb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$b={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gb(n){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(n):(n=jb[n])?!!o[n]:!1}function Ym(){return Gb}var Zb=vn({},yc,{key:function(n){if(n.key){var o=Vb[n.key]||n.key;if(o!=="Unidentified")return o}return n.type==="keypress"?(n=Qh(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?$b[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ym,charCode:function(n){return n.type==="keypress"?Qh(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Qh(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),qb=mi(Zb),Wb=vn({},Dd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),y_=mi(Wb),Xb=vn({},yc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ym}),Hb=mi(Xb),Kb=vn({},kl,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yb=mi(Kb),Jb=vn({},Dd,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Qb=mi(Jb),e2=[9,13,27,32],Jm=Bo&&"CompositionEvent"in window,Vu=null;Bo&&"documentMode"in document&&(Vu=document.documentMode);var t2=Bo&&"TextEvent"in window&&!Vu,sx=Bo&&(!Jm||Vu&&8<Vu&&11>=Vu),__=String.fromCharCode(32),v_=!1;function ax(n,o){switch(n){case"keyup":return e2.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lx(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var el=!1;function n2(n,o){switch(n){case"compositionend":return lx(o);case"keypress":return o.which!==32?null:(v_=!0,__);case"textInput":return n=o.data,n===__&&v_?null:n;default:return null}}function r2(n,o){if(el)return n==="compositionend"||!Jm&&ax(n,o)?(n=ox(),Jh=Hm=fs=null,el=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return sx&&o.locale!=="ko"?null:o.data;default:return null}}var i2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function x_(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o==="input"?!!i2[n.type]:o==="textarea"}function ux(n,o,l,f){Uv(f),o=fd(o,"onChange"),0<o.length&&(l=new Km("onChange","change",null,l,f),n.push({event:l,listeners:o}))}var $u=null,nc=null;function o2(n){xx(n,0)}function Ld(n){var o=rl(n);if(Dv(o))return n}function s2(n,o){if(n==="change")return o}var cx=!1;if(Bo){var lf;if(Bo){var uf="oninput"in document;if(!uf){var w_=document.createElement("div");w_.setAttribute("oninput","return;"),uf=typeof w_.oninput=="function"}lf=uf}else lf=!1;cx=lf&&(!document.documentMode||9<document.documentMode)}function b_(){$u&&($u.detachEvent("onpropertychange",hx),nc=$u=null)}function hx(n){if(n.propertyName==="value"&&Ld(nc)){var o=[];ux(o,nc,n,Gm(n)),Gv(o2,o)}}function a2(n,o,l){n==="focusin"?(b_(),$u=o,nc=l,$u.attachEvent("onpropertychange",hx)):n==="focusout"&&b_()}function l2(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Ld(nc)}function u2(n,o){if(n==="click")return Ld(o)}function c2(n,o){if(n==="input"||n==="change")return Ld(o)}function h2(n,o){return n===o&&(n!==0||1/n===1/o)||n!==n&&o!==o}var Zi=typeof Object.is=="function"?Object.is:h2;function rc(n,o){if(Zi(n,o))return!0;if(typeof n!="object"||n===null||typeof o!="object"||o===null)return!1;var l=Object.keys(n),f=Object.keys(o);if(l.length!==f.length)return!1;for(f=0;f<l.length;f++){var _=l[f];if(!Lf.call(o,_)||!Zi(n[_],o[_]))return!1}return!0}function E_(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function S_(n,o){var l=E_(n);n=0;for(var f;l;){if(l.nodeType===3){if(f=n+l.textContent.length,n<=o&&f>=o)return{node:l,offset:o-n};n=f}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=E_(l)}}function dx(n,o){return n&&o?n===o?!0:n&&n.nodeType===3?!1:o&&o.nodeType===3?dx(n,o.parentNode):"contains"in n?n.contains(o):n.compareDocumentPosition?!!(n.compareDocumentPosition(o)&16):!1:!1}function px(){for(var n=window,o=ad();o instanceof n.HTMLIFrameElement;){try{var l=typeof o.contentWindow.location.href=="string"}catch{l=!1}if(l)n=o.contentWindow;else break;o=ad(n.document)}return o}function Qm(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o&&(o==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||o==="textarea"||n.contentEditable==="true")}function d2(n){var o=px(),l=n.focusedElem,f=n.selectionRange;if(o!==l&&l&&l.ownerDocument&&dx(l.ownerDocument.documentElement,l)){if(f!==null&&Qm(l)){if(o=f.start,n=f.end,n===void 0&&(n=o),"selectionStart"in l)l.selectionStart=o,l.selectionEnd=Math.min(n,l.value.length);else if(n=(o=l.ownerDocument||document)&&o.defaultView||window,n.getSelection){n=n.getSelection();var _=l.textContent.length,w=Math.min(f.start,_);f=f.end===void 0?w:Math.min(f.end,_),!n.extend&&w>f&&(_=f,f=w,w=_),_=S_(l,w);var I=S_(l,f);_&&I&&(n.rangeCount!==1||n.anchorNode!==_.node||n.anchorOffset!==_.offset||n.focusNode!==I.node||n.focusOffset!==I.offset)&&(o=o.createRange(),o.setStart(_.node,_.offset),n.removeAllRanges(),w>f?(n.addRange(o),n.extend(I.node,I.offset)):(o.setEnd(I.node,I.offset),n.addRange(o)))}}for(o=[],n=l;n=n.parentNode;)n.nodeType===1&&o.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<o.length;l++)n=o[l],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var p2=Bo&&"documentMode"in document&&11>=document.documentMode,tl=null,Qf=null,ju=null,em=!1;function T_(n,o,l){var f=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;em||tl==null||tl!==ad(f)||(f=tl,"selectionStart"in f&&Qm(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),ju&&rc(ju,f)||(ju=f,f=fd(Qf,"onSelect"),0<f.length&&(o=new Km("onSelect","select",null,o,l),n.push({event:o,listeners:f}),o.target=tl)))}function Fh(n,o){var l={};return l[n.toLowerCase()]=o.toLowerCase(),l["Webkit"+n]="webkit"+o,l["Moz"+n]="moz"+o,l}var nl={animationend:Fh("Animation","AnimationEnd"),animationiteration:Fh("Animation","AnimationIteration"),animationstart:Fh("Animation","AnimationStart"),transitionend:Fh("Transition","TransitionEnd")},cf={},fx={};Bo&&(fx=document.createElement("div").style,"AnimationEvent"in window||(delete nl.animationend.animation,delete nl.animationiteration.animation,delete nl.animationstart.animation),"TransitionEvent"in window||delete nl.transitionend.transition);function Rd(n){if(cf[n])return cf[n];if(!nl[n])return n;var o=nl[n],l;for(l in o)if(o.hasOwnProperty(l)&&l in fx)return cf[n]=o[l];return n}var mx=Rd("animationend"),gx=Rd("animationiteration"),yx=Rd("animationstart"),_x=Rd("transitionend"),vx=new Map,k_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Is(n,o){vx.set(n,o),_a(o,[n])}for(var hf=0;hf<k_.length;hf++){var df=k_[hf],f2=df.toLowerCase(),m2=df[0].toUpperCase()+df.slice(1);Is(f2,"on"+m2)}Is(mx,"onAnimationEnd");Is(gx,"onAnimationIteration");Is(yx,"onAnimationStart");Is("dblclick","onDoubleClick");Is("focusin","onFocus");Is("focusout","onBlur");Is(_x,"onTransitionEnd");gl("onMouseEnter",["mouseout","mouseover"]);gl("onMouseLeave",["mouseout","mouseover"]);gl("onPointerEnter",["pointerout","pointerover"]);gl("onPointerLeave",["pointerout","pointerover"]);_a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));_a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));_a("onBeforeInput",["compositionend","keypress","textInput","paste"]);_a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));_a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));_a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ou="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),g2=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ou));function C_(n,o,l){var f=n.type||"unknown-event";n.currentTarget=l,fb(f,o,void 0,n),n.currentTarget=null}function xx(n,o){o=(o&4)!==0;for(var l=0;l<n.length;l++){var f=n[l],_=f.event;f=f.listeners;e:{var w=void 0;if(o)for(var I=f.length-1;0<=I;I--){var u=f[I],N=u.instance,q=u.currentTarget;if(u=u.listener,N!==w&&_.isPropagationStopped())break e;C_(_,u,q),w=N}else for(I=0;I<f.length;I++){if(u=f[I],N=u.instance,q=u.currentTarget,u=u.listener,N!==w&&_.isPropagationStopped())break e;C_(_,u,q),w=N}}}if(ud)throw n=Hf,ud=!1,Hf=null,n}function hn(n,o){var l=o[om];l===void 0&&(l=o[om]=new Set);var f=n+"__bubble";l.has(f)||(wx(o,n,2,!1),l.add(f))}function pf(n,o,l){var f=0;o&&(f|=4),wx(l,n,f,o)}var Oh="_reactListening"+Math.random().toString(36).slice(2);function ic(n){if(!n[Oh]){n[Oh]=!0,Iv.forEach(function(l){l!=="selectionchange"&&(g2.has(l)||pf(l,!1,n),pf(l,!0,n))});var o=n.nodeType===9?n:n.ownerDocument;o===null||o[Oh]||(o[Oh]=!0,pf("selectionchange",!1,o))}}function wx(n,o,l,f){switch(ix(o)){case 1:var _=Ab;break;case 4:_=Mb;break;default:_=Xm}l=_.bind(null,o,l,n),_=void 0,!Xf||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(_=!0),f?_!==void 0?n.addEventListener(o,l,{capture:!0,passive:_}):n.addEventListener(o,l,!0):_!==void 0?n.addEventListener(o,l,{passive:_}):n.addEventListener(o,l,!1)}function ff(n,o,l,f,_){var w=f;if(!(o&1)&&!(o&2)&&f!==null)e:for(;;){if(f===null)return;var I=f.tag;if(I===3||I===4){var u=f.stateNode.containerInfo;if(u===_||u.nodeType===8&&u.parentNode===_)break;if(I===4)for(I=f.return;I!==null;){var N=I.tag;if((N===3||N===4)&&(N=I.stateNode.containerInfo,N===_||N.nodeType===8&&N.parentNode===_))return;I=I.return}for(;u!==null;){if(I=la(u),I===null)return;if(N=I.tag,N===5||N===6){f=w=I;continue e}u=u.parentNode}}f=f.return}Gv(function(){var q=w,ue=Gm(l),oe=[];e:{var Z=vx.get(n);if(Z!==void 0){var ze=Km,Ie=n;switch(n){case"keypress":if(Qh(l)===0)break e;case"keydown":case"keyup":ze=qb;break;case"focusin":Ie="focus",ze=af;break;case"focusout":Ie="blur",ze=af;break;case"beforeblur":case"afterblur":ze=af;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ze=m_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ze=Lb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ze=Hb;break;case mx:case gx:case yx:ze=Fb;break;case _x:ze=Yb;break;case"scroll":ze=Pb;break;case"wheel":ze=Qb;break;case"copy":case"cut":case"paste":ze=Nb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ze=y_}var ke=(o&4)!==0,Xe=!ke&&n==="scroll",se=ke?Z!==null?Z+"Capture":null:Z;ke=[];for(var Q=q,ae;Q!==null;){ae=Q;var Se=ae.stateNode;if(ae.tag===5&&Se!==null&&(ae=Se,se!==null&&(Se=Ju(Q,se),Se!=null&&ke.push(oc(Q,Se,ae)))),Xe)break;Q=Q.return}0<ke.length&&(Z=new ze(Z,Ie,null,l,ue),oe.push({event:Z,listeners:ke}))}}if(!(o&7)){e:{if(Z=n==="mouseover"||n==="pointerover",ze=n==="mouseout"||n==="pointerout",Z&&l!==qf&&(Ie=l.relatedTarget||l.fromElement)&&(la(Ie)||Ie[Fo]))break e;if((ze||Z)&&(Z=ue.window===ue?ue:(Z=ue.ownerDocument)?Z.defaultView||Z.parentWindow:window,ze?(Ie=l.relatedTarget||l.toElement,ze=q,Ie=Ie?la(Ie):null,Ie!==null&&(Xe=va(Ie),Ie!==Xe||Ie.tag!==5&&Ie.tag!==6)&&(Ie=null)):(ze=null,Ie=q),ze!==Ie)){if(ke=m_,Se="onMouseLeave",se="onMouseEnter",Q="mouse",(n==="pointerout"||n==="pointerover")&&(ke=y_,Se="onPointerLeave",se="onPointerEnter",Q="pointer"),Xe=ze==null?Z:rl(ze),ae=Ie==null?Z:rl(Ie),Z=new ke(Se,Q+"leave",ze,l,ue),Z.target=Xe,Z.relatedTarget=ae,Se=null,la(ue)===q&&(ke=new ke(se,Q+"enter",Ie,l,ue),ke.target=ae,ke.relatedTarget=Xe,Se=ke),Xe=Se,ze&&Ie)t:{for(ke=ze,se=Ie,Q=0,ae=ke;ae;ae=Ya(ae))Q++;for(ae=0,Se=se;Se;Se=Ya(Se))ae++;for(;0<Q-ae;)ke=Ya(ke),Q--;for(;0<ae-Q;)se=Ya(se),ae--;for(;Q--;){if(ke===se||se!==null&&ke===se.alternate)break t;ke=Ya(ke),se=Ya(se)}ke=null}else ke=null;ze!==null&&I_(oe,Z,ze,ke,!1),Ie!==null&&Xe!==null&&I_(oe,Xe,Ie,ke,!0)}}e:{if(Z=q?rl(q):window,ze=Z.nodeName&&Z.nodeName.toLowerCase(),ze==="select"||ze==="input"&&Z.type==="file")var Ae=s2;else if(x_(Z))if(cx)Ae=c2;else{Ae=l2;var Le=a2}else(ze=Z.nodeName)&&ze.toLowerCase()==="input"&&(Z.type==="checkbox"||Z.type==="radio")&&(Ae=u2);if(Ae&&(Ae=Ae(n,q))){ux(oe,Ae,l,ue);break e}Le&&Le(n,Z,q),n==="focusout"&&(Le=Z._wrapperState)&&Le.controlled&&Z.type==="number"&&Vf(Z,"number",Z.value)}switch(Le=q?rl(q):window,n){case"focusin":(x_(Le)||Le.contentEditable==="true")&&(tl=Le,Qf=q,ju=null);break;case"focusout":ju=Qf=tl=null;break;case"mousedown":em=!0;break;case"contextmenu":case"mouseup":case"dragend":em=!1,T_(oe,l,ue);break;case"selectionchange":if(p2)break;case"keydown":case"keyup":T_(oe,l,ue)}var Me;if(Jm)e:{switch(n){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else el?ax(n,l)&&(Ke="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(Ke="onCompositionStart");Ke&&(sx&&l.locale!=="ko"&&(el||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&el&&(Me=ox()):(fs=ue,Hm="value"in fs?fs.value:fs.textContent,el=!0)),Le=fd(q,Ke),0<Le.length&&(Ke=new g_(Ke,n,null,l,ue),oe.push({event:Ke,listeners:Le}),Me?Ke.data=Me:(Me=lx(l),Me!==null&&(Ke.data=Me)))),(Me=t2?n2(n,l):r2(n,l))&&(q=fd(q,"onBeforeInput"),0<q.length&&(ue=new g_("onBeforeInput","beforeinput",null,l,ue),oe.push({event:ue,listeners:q}),ue.data=Me))}xx(oe,o)})}function oc(n,o,l){return{instance:n,listener:o,currentTarget:l}}function fd(n,o){for(var l=o+"Capture",f=[];n!==null;){var _=n,w=_.stateNode;_.tag===5&&w!==null&&(_=w,w=Ju(n,l),w!=null&&f.unshift(oc(n,w,_)),w=Ju(n,o),w!=null&&f.push(oc(n,w,_))),n=n.return}return f}function Ya(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function I_(n,o,l,f,_){for(var w=o._reactName,I=[];l!==null&&l!==f;){var u=l,N=u.alternate,q=u.stateNode;if(N!==null&&N===f)break;u.tag===5&&q!==null&&(u=q,_?(N=Ju(l,w),N!=null&&I.unshift(oc(l,N,u))):_||(N=Ju(l,w),N!=null&&I.push(oc(l,N,u)))),l=l.return}I.length!==0&&n.push({event:o,listeners:I})}var y2=/\r\n?/g,_2=/\u0000|\uFFFD/g;function z_(n){return(typeof n=="string"?n:""+n).replace(y2,`
`).replace(_2,"")}function Nh(n,o,l){if(o=z_(o),z_(n)!==o&&l)throw Error(Pe(425))}function md(){}var tm=null,nm=null;function rm(n,o){return n==="textarea"||n==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var im=typeof setTimeout=="function"?setTimeout:void 0,v2=typeof clearTimeout=="function"?clearTimeout:void 0,A_=typeof Promise=="function"?Promise:void 0,x2=typeof queueMicrotask=="function"?queueMicrotask:typeof A_<"u"?function(n){return A_.resolve(null).then(n).catch(w2)}:im;function w2(n){setTimeout(function(){throw n})}function mf(n,o){var l=o,f=0;do{var _=l.nextSibling;if(n.removeChild(l),_&&_.nodeType===8)if(l=_.data,l==="/$"){if(f===0){n.removeChild(_),tc(o);return}f--}else l!=="$"&&l!=="$?"&&l!=="$!"||f++;l=_}while(l);tc(o)}function xs(n){for(;n!=null;n=n.nextSibling){var o=n.nodeType;if(o===1||o===3)break;if(o===8){if(o=n.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return n}function M_(n){n=n.previousSibling;for(var o=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"){if(o===0)return n;o--}else l==="/$"&&o++}n=n.previousSibling}return null}var Cl=Math.random().toString(36).slice(2),ao="__reactFiber$"+Cl,sc="__reactProps$"+Cl,Fo="__reactContainer$"+Cl,om="__reactEvents$"+Cl,b2="__reactListeners$"+Cl,E2="__reactHandles$"+Cl;function la(n){var o=n[ao];if(o)return o;for(var l=n.parentNode;l;){if(o=l[Fo]||l[ao]){if(l=o.alternate,o.child!==null||l!==null&&l.child!==null)for(n=M_(n);n!==null;){if(l=n[ao])return l;n=M_(n)}return o}n=l,l=n.parentNode}return null}function _c(n){return n=n[ao]||n[Fo],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function rl(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(Pe(33))}function Bd(n){return n[sc]||null}var sm=[],il=-1;function zs(n){return{current:n}}function dn(n){0>il||(n.current=sm[il],sm[il]=null,il--)}function un(n,o){il++,sm[il]=n.current,n.current=o}var ks={},kr=zs(ks),Yr=zs(!1),pa=ks;function yl(n,o){var l=n.type.contextTypes;if(!l)return ks;var f=n.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===o)return f.__reactInternalMemoizedMaskedChildContext;var _={},w;for(w in l)_[w]=o[w];return f&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=o,n.__reactInternalMemoizedMaskedChildContext=_),_}function Jr(n){return n=n.childContextTypes,n!=null}function gd(){dn(Yr),dn(kr)}function P_(n,o,l){if(kr.current!==ks)throw Error(Pe(168));un(kr,o),un(Yr,l)}function bx(n,o,l){var f=n.stateNode;if(o=o.childContextTypes,typeof f.getChildContext!="function")return l;f=f.getChildContext();for(var _ in f)if(!(_ in o))throw Error(Pe(108,ab(n)||"Unknown",_));return vn({},l,f)}function yd(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||ks,pa=kr.current,un(kr,n),un(Yr,Yr.current),!0}function D_(n,o,l){var f=n.stateNode;if(!f)throw Error(Pe(169));l?(n=bx(n,o,pa),f.__reactInternalMemoizedMergedChildContext=n,dn(Yr),dn(kr),un(kr,n)):dn(Yr),un(Yr,l)}var Ao=null,Fd=!1,gf=!1;function Ex(n){Ao===null?Ao=[n]:Ao.push(n)}function S2(n){Fd=!0,Ex(n)}function As(){if(!gf&&Ao!==null){gf=!0;var n=0,o=Kt;try{var l=Ao;for(Kt=1;n<l.length;n++){var f=l[n];do f=f(!0);while(f!==null)}Ao=null,Fd=!1}catch(_){throw Ao!==null&&(Ao=Ao.slice(n+1)),Xv(Zm,As),_}finally{Kt=o,gf=!1}}return null}var ol=[],sl=0,_d=null,vd=0,Si=[],Ti=0,fa=null,Do=1,Lo="";function sa(n,o){ol[sl++]=vd,ol[sl++]=_d,_d=n,vd=o}function Sx(n,o,l){Si[Ti++]=Do,Si[Ti++]=Lo,Si[Ti++]=fa,fa=n;var f=Do;n=Lo;var _=32-ji(f)-1;f&=~(1<<_),l+=1;var w=32-ji(o)+_;if(30<w){var I=_-_%5;w=(f&(1<<I)-1).toString(32),f>>=I,_-=I,Do=1<<32-ji(o)+_|l<<_|f,Lo=w+n}else Do=1<<w|l<<_|f,Lo=n}function eg(n){n.return!==null&&(sa(n,1),Sx(n,1,0))}function tg(n){for(;n===_d;)_d=ol[--sl],ol[sl]=null,vd=ol[--sl],ol[sl]=null;for(;n===fa;)fa=Si[--Ti],Si[Ti]=null,Lo=Si[--Ti],Si[Ti]=null,Do=Si[--Ti],Si[Ti]=null}var di=null,hi=null,mn=!1,Vi=null;function Tx(n,o){var l=ki(5,null,null,0);l.elementType="DELETED",l.stateNode=o,l.return=n,o=n.deletions,o===null?(n.deletions=[l],n.flags|=16):o.push(l)}function L_(n,o){switch(n.tag){case 5:var l=n.type;return o=o.nodeType!==1||l.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(n.stateNode=o,di=n,hi=xs(o.firstChild),!0):!1;case 6:return o=n.pendingProps===""||o.nodeType!==3?null:o,o!==null?(n.stateNode=o,di=n,hi=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(l=fa!==null?{id:Do,overflow:Lo}:null,n.memoizedState={dehydrated:o,treeContext:l,retryLane:1073741824},l=ki(18,null,null,0),l.stateNode=o,l.return=n,n.child=l,di=n,hi=null,!0):!1;default:return!1}}function am(n){return(n.mode&1)!==0&&(n.flags&128)===0}function lm(n){if(mn){var o=hi;if(o){var l=o;if(!L_(n,o)){if(am(n))throw Error(Pe(418));o=xs(l.nextSibling);var f=di;o&&L_(n,o)?Tx(f,l):(n.flags=n.flags&-4097|2,mn=!1,di=n)}}else{if(am(n))throw Error(Pe(418));n.flags=n.flags&-4097|2,mn=!1,di=n}}}function R_(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;di=n}function Uh(n){if(n!==di)return!1;if(!mn)return R_(n),mn=!0,!1;var o;if((o=n.tag!==3)&&!(o=n.tag!==5)&&(o=n.type,o=o!=="head"&&o!=="body"&&!rm(n.type,n.memoizedProps)),o&&(o=hi)){if(am(n))throw kx(),Error(Pe(418));for(;o;)Tx(n,o),o=xs(o.nextSibling)}if(R_(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Pe(317));e:{for(n=n.nextSibling,o=0;n;){if(n.nodeType===8){var l=n.data;if(l==="/$"){if(o===0){hi=xs(n.nextSibling);break e}o--}else l!=="$"&&l!=="$!"&&l!=="$?"||o++}n=n.nextSibling}hi=null}}else hi=di?xs(n.stateNode.nextSibling):null;return!0}function kx(){for(var n=hi;n;)n=xs(n.nextSibling)}function _l(){hi=di=null,mn=!1}function ng(n){Vi===null?Vi=[n]:Vi.push(n)}var T2=Uo.ReactCurrentBatchConfig;function Ni(n,o){if(n&&n.defaultProps){o=vn({},o),n=n.defaultProps;for(var l in n)o[l]===void 0&&(o[l]=n[l]);return o}return o}var xd=zs(null),wd=null,al=null,rg=null;function ig(){rg=al=wd=null}function og(n){var o=xd.current;dn(xd),n._currentValue=o}function um(n,o,l){for(;n!==null;){var f=n.alternate;if((n.childLanes&o)!==o?(n.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),n===l)break;n=n.return}}function fl(n,o){wd=n,rg=al=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&o&&(Kr=!0),n.firstContext=null)}function Ii(n){var o=n._currentValue;if(rg!==n)if(n={context:n,memoizedValue:o,next:null},al===null){if(wd===null)throw Error(Pe(308));al=n,wd.dependencies={lanes:0,firstContext:n}}else al=al.next=n;return o}var ua=null;function sg(n){ua===null?ua=[n]:ua.push(n)}function Cx(n,o,l,f){var _=o.interleaved;return _===null?(l.next=l,sg(o)):(l.next=_.next,_.next=l),o.interleaved=l,Oo(n,f)}function Oo(n,o){n.lanes|=o;var l=n.alternate;for(l!==null&&(l.lanes|=o),l=n,n=n.return;n!==null;)n.childLanes|=o,l=n.alternate,l!==null&&(l.childLanes|=o),l=n,n=n.return;return l.tag===3?l.stateNode:null}var cs=!1;function ag(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ix(n,o){n=n.updateQueue,o.updateQueue===n&&(o.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Ro(n,o){return{eventTime:n,lane:o,tag:0,payload:null,callback:null,next:null}}function ws(n,o,l){var f=n.updateQueue;if(f===null)return null;if(f=f.shared,Nt&2){var _=f.pending;return _===null?o.next=o:(o.next=_.next,_.next=o),f.pending=o,Oo(n,l)}return _=f.interleaved,_===null?(o.next=o,sg(f)):(o.next=_.next,_.next=o),f.interleaved=o,Oo(n,l)}function ed(n,o,l){if(o=o.updateQueue,o!==null&&(o=o.shared,(l&4194240)!==0)){var f=o.lanes;f&=n.pendingLanes,l|=f,o.lanes=l,qm(n,l)}}function B_(n,o){var l=n.updateQueue,f=n.alternate;if(f!==null&&(f=f.updateQueue,l===f)){var _=null,w=null;if(l=l.firstBaseUpdate,l!==null){do{var I={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};w===null?_=w=I:w=w.next=I,l=l.next}while(l!==null);w===null?_=w=o:w=w.next=o}else _=w=o;l={baseState:f.baseState,firstBaseUpdate:_,lastBaseUpdate:w,shared:f.shared,effects:f.effects},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=o:n.next=o,l.lastBaseUpdate=o}function bd(n,o,l,f){var _=n.updateQueue;cs=!1;var w=_.firstBaseUpdate,I=_.lastBaseUpdate,u=_.shared.pending;if(u!==null){_.shared.pending=null;var N=u,q=N.next;N.next=null,I===null?w=q:I.next=q,I=N;var ue=n.alternate;ue!==null&&(ue=ue.updateQueue,u=ue.lastBaseUpdate,u!==I&&(u===null?ue.firstBaseUpdate=q:u.next=q,ue.lastBaseUpdate=N))}if(w!==null){var oe=_.baseState;I=0,ue=q=N=null,u=w;do{var Z=u.lane,ze=u.eventTime;if((f&Z)===Z){ue!==null&&(ue=ue.next={eventTime:ze,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var Ie=n,ke=u;switch(Z=o,ze=l,ke.tag){case 1:if(Ie=ke.payload,typeof Ie=="function"){oe=Ie.call(ze,oe,Z);break e}oe=Ie;break e;case 3:Ie.flags=Ie.flags&-65537|128;case 0:if(Ie=ke.payload,Z=typeof Ie=="function"?Ie.call(ze,oe,Z):Ie,Z==null)break e;oe=vn({},oe,Z);break e;case 2:cs=!0}}u.callback!==null&&u.lane!==0&&(n.flags|=64,Z=_.effects,Z===null?_.effects=[u]:Z.push(u))}else ze={eventTime:ze,lane:Z,tag:u.tag,payload:u.payload,callback:u.callback,next:null},ue===null?(q=ue=ze,N=oe):ue=ue.next=ze,I|=Z;if(u=u.next,u===null){if(u=_.shared.pending,u===null)break;Z=u,u=Z.next,Z.next=null,_.lastBaseUpdate=Z,_.shared.pending=null}}while(1);if(ue===null&&(N=oe),_.baseState=N,_.firstBaseUpdate=q,_.lastBaseUpdate=ue,o=_.shared.interleaved,o!==null){_=o;do I|=_.lane,_=_.next;while(_!==o)}else w===null&&(_.shared.lanes=0);ga|=I,n.lanes=I,n.memoizedState=oe}}function F_(n,o,l){if(n=o.effects,o.effects=null,n!==null)for(o=0;o<n.length;o++){var f=n[o],_=f.callback;if(_!==null){if(f.callback=null,f=l,typeof _!="function")throw Error(Pe(191,_));_.call(f)}}}var zx=new Cv.Component().refs;function cm(n,o,l,f){o=n.memoizedState,l=l(f,o),l=l==null?o:vn({},o,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var Od={isMounted:function(n){return(n=n._reactInternals)?va(n)===n:!1},enqueueSetState:function(n,o,l){n=n._reactInternals;var f=Vr(),_=Es(n),w=Ro(f,_);w.payload=o,l!=null&&(w.callback=l),o=ws(n,w,_),o!==null&&(Gi(o,n,_,f),ed(o,n,_))},enqueueReplaceState:function(n,o,l){n=n._reactInternals;var f=Vr(),_=Es(n),w=Ro(f,_);w.tag=1,w.payload=o,l!=null&&(w.callback=l),o=ws(n,w,_),o!==null&&(Gi(o,n,_,f),ed(o,n,_))},enqueueForceUpdate:function(n,o){n=n._reactInternals;var l=Vr(),f=Es(n),_=Ro(l,f);_.tag=2,o!=null&&(_.callback=o),o=ws(n,_,f),o!==null&&(Gi(o,n,f,l),ed(o,n,f))}};function O_(n,o,l,f,_,w,I){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(f,w,I):o.prototype&&o.prototype.isPureReactComponent?!rc(l,f)||!rc(_,w):!0}function Ax(n,o,l){var f=!1,_=ks,w=o.contextType;return typeof w=="object"&&w!==null?w=Ii(w):(_=Jr(o)?pa:kr.current,f=o.contextTypes,w=(f=f!=null)?yl(n,_):ks),o=new o(l,w),n.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Od,n.stateNode=o,o._reactInternals=n,f&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=_,n.__reactInternalMemoizedMaskedChildContext=w),o}function N_(n,o,l,f){n=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(l,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(l,f),o.state!==n&&Od.enqueueReplaceState(o,o.state,null)}function hm(n,o,l,f){var _=n.stateNode;_.props=l,_.state=n.memoizedState,_.refs=zx,ag(n);var w=o.contextType;typeof w=="object"&&w!==null?_.context=Ii(w):(w=Jr(o)?pa:kr.current,_.context=yl(n,w)),_.state=n.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(cm(n,o,w,l),_.state=n.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(o=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),o!==_.state&&Od.enqueueReplaceState(_,_.state,null),bd(n,l,_,f),_.state=n.memoizedState),typeof _.componentDidMount=="function"&&(n.flags|=4194308)}function Au(n,o,l){if(n=l.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(Pe(309));var f=l.stateNode}if(!f)throw Error(Pe(147,n));var _=f,w=""+n;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===w?o.ref:(o=function(I){var u=_.refs;u===zx&&(u=_.refs={}),I===null?delete u[w]:u[w]=I},o._stringRef=w,o)}if(typeof n!="string")throw Error(Pe(284));if(!l._owner)throw Error(Pe(290,n))}return n}function Vh(n,o){throw n=Object.prototype.toString.call(o),Error(Pe(31,n==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":n))}function U_(n){var o=n._init;return o(n._payload)}function Mx(n){function o(se,Q){if(n){var ae=se.deletions;ae===null?(se.deletions=[Q],se.flags|=16):ae.push(Q)}}function l(se,Q){if(!n)return null;for(;Q!==null;)o(se,Q),Q=Q.sibling;return null}function f(se,Q){for(se=new Map;Q!==null;)Q.key!==null?se.set(Q.key,Q):se.set(Q.index,Q),Q=Q.sibling;return se}function _(se,Q){return se=Ss(se,Q),se.index=0,se.sibling=null,se}function w(se,Q,ae){return se.index=ae,n?(ae=se.alternate,ae!==null?(ae=ae.index,ae<Q?(se.flags|=2,Q):ae):(se.flags|=2,Q)):(se.flags|=1048576,Q)}function I(se){return n&&se.alternate===null&&(se.flags|=2),se}function u(se,Q,ae,Se){return Q===null||Q.tag!==6?(Q=Ef(ae,se.mode,Se),Q.return=se,Q):(Q=_(Q,ae),Q.return=se,Q)}function N(se,Q,ae,Se){var Ae=ae.type;return Ae===Qa?ue(se,Q,ae.props.children,Se,ae.key):Q!==null&&(Q.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===us&&U_(Ae)===Q.type)?(Se=_(Q,ae.props),Se.ref=Au(se,Q,ae),Se.return=se,Se):(Se=sd(ae.type,ae.key,ae.props,null,se.mode,Se),Se.ref=Au(se,Q,ae),Se.return=se,Se)}function q(se,Q,ae,Se){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==ae.containerInfo||Q.stateNode.implementation!==ae.implementation?(Q=Sf(ae,se.mode,Se),Q.return=se,Q):(Q=_(Q,ae.children||[]),Q.return=se,Q)}function ue(se,Q,ae,Se,Ae){return Q===null||Q.tag!==7?(Q=da(ae,se.mode,Se,Ae),Q.return=se,Q):(Q=_(Q,ae),Q.return=se,Q)}function oe(se,Q,ae){if(typeof Q=="string"&&Q!==""||typeof Q=="number")return Q=Ef(""+Q,se.mode,ae),Q.return=se,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case Ah:return ae=sd(Q.type,Q.key,Q.props,null,se.mode,ae),ae.ref=Au(se,null,Q),ae.return=se,ae;case Ja:return Q=Sf(Q,se.mode,ae),Q.return=se,Q;case us:var Se=Q._init;return oe(se,Se(Q._payload),ae)}if(Bu(Q)||Tu(Q))return Q=da(Q,se.mode,ae,null),Q.return=se,Q;Vh(se,Q)}return null}function Z(se,Q,ae,Se){var Ae=Q!==null?Q.key:null;if(typeof ae=="string"&&ae!==""||typeof ae=="number")return Ae!==null?null:u(se,Q,""+ae,Se);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case Ah:return ae.key===Ae?N(se,Q,ae,Se):null;case Ja:return ae.key===Ae?q(se,Q,ae,Se):null;case us:return Ae=ae._init,Z(se,Q,Ae(ae._payload),Se)}if(Bu(ae)||Tu(ae))return Ae!==null?null:ue(se,Q,ae,Se,null);Vh(se,ae)}return null}function ze(se,Q,ae,Se,Ae){if(typeof Se=="string"&&Se!==""||typeof Se=="number")return se=se.get(ae)||null,u(Q,se,""+Se,Ae);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case Ah:return se=se.get(Se.key===null?ae:Se.key)||null,N(Q,se,Se,Ae);case Ja:return se=se.get(Se.key===null?ae:Se.key)||null,q(Q,se,Se,Ae);case us:var Le=Se._init;return ze(se,Q,ae,Le(Se._payload),Ae)}if(Bu(Se)||Tu(Se))return se=se.get(ae)||null,ue(Q,se,Se,Ae,null);Vh(Q,Se)}return null}function Ie(se,Q,ae,Se){for(var Ae=null,Le=null,Me=Q,Ke=Q=0,Ct=null;Me!==null&&Ke<ae.length;Ke++){Me.index>Ke?(Ct=Me,Me=null):Ct=Me.sibling;var dt=Z(se,Me,ae[Ke],Se);if(dt===null){Me===null&&(Me=Ct);break}n&&Me&&dt.alternate===null&&o(se,Me),Q=w(dt,Q,Ke),Le===null?Ae=dt:Le.sibling=dt,Le=dt,Me=Ct}if(Ke===ae.length)return l(se,Me),mn&&sa(se,Ke),Ae;if(Me===null){for(;Ke<ae.length;Ke++)Me=oe(se,ae[Ke],Se),Me!==null&&(Q=w(Me,Q,Ke),Le===null?Ae=Me:Le.sibling=Me,Le=Me);return mn&&sa(se,Ke),Ae}for(Me=f(se,Me);Ke<ae.length;Ke++)Ct=ze(Me,se,Ke,ae[Ke],Se),Ct!==null&&(n&&Ct.alternate!==null&&Me.delete(Ct.key===null?Ke:Ct.key),Q=w(Ct,Q,Ke),Le===null?Ae=Ct:Le.sibling=Ct,Le=Ct);return n&&Me.forEach(function(cn){return o(se,cn)}),mn&&sa(se,Ke),Ae}function ke(se,Q,ae,Se){var Ae=Tu(ae);if(typeof Ae!="function")throw Error(Pe(150));if(ae=Ae.call(ae),ae==null)throw Error(Pe(151));for(var Le=Ae=null,Me=Q,Ke=Q=0,Ct=null,dt=ae.next();Me!==null&&!dt.done;Ke++,dt=ae.next()){Me.index>Ke?(Ct=Me,Me=null):Ct=Me.sibling;var cn=Z(se,Me,dt.value,Se);if(cn===null){Me===null&&(Me=Ct);break}n&&Me&&cn.alternate===null&&o(se,Me),Q=w(cn,Q,Ke),Le===null?Ae=cn:Le.sibling=cn,Le=cn,Me=Ct}if(dt.done)return l(se,Me),mn&&sa(se,Ke),Ae;if(Me===null){for(;!dt.done;Ke++,dt=ae.next())dt=oe(se,dt.value,Se),dt!==null&&(Q=w(dt,Q,Ke),Le===null?Ae=dt:Le.sibling=dt,Le=dt);return mn&&sa(se,Ke),Ae}for(Me=f(se,Me);!dt.done;Ke++,dt=ae.next())dt=ze(Me,se,Ke,dt.value,Se),dt!==null&&(n&&dt.alternate!==null&&Me.delete(dt.key===null?Ke:dt.key),Q=w(dt,Q,Ke),Le===null?Ae=dt:Le.sibling=dt,Le=dt);return n&&Me.forEach(function(xn){return o(se,xn)}),mn&&sa(se,Ke),Ae}function Xe(se,Q,ae,Se){if(typeof ae=="object"&&ae!==null&&ae.type===Qa&&ae.key===null&&(ae=ae.props.children),typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case Ah:e:{for(var Ae=ae.key,Le=Q;Le!==null;){if(Le.key===Ae){if(Ae=ae.type,Ae===Qa){if(Le.tag===7){l(se,Le.sibling),Q=_(Le,ae.props.children),Q.return=se,se=Q;break e}}else if(Le.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===us&&U_(Ae)===Le.type){l(se,Le.sibling),Q=_(Le,ae.props),Q.ref=Au(se,Le,ae),Q.return=se,se=Q;break e}l(se,Le);break}else o(se,Le);Le=Le.sibling}ae.type===Qa?(Q=da(ae.props.children,se.mode,Se,ae.key),Q.return=se,se=Q):(Se=sd(ae.type,ae.key,ae.props,null,se.mode,Se),Se.ref=Au(se,Q,ae),Se.return=se,se=Se)}return I(se);case Ja:e:{for(Le=ae.key;Q!==null;){if(Q.key===Le)if(Q.tag===4&&Q.stateNode.containerInfo===ae.containerInfo&&Q.stateNode.implementation===ae.implementation){l(se,Q.sibling),Q=_(Q,ae.children||[]),Q.return=se,se=Q;break e}else{l(se,Q);break}else o(se,Q);Q=Q.sibling}Q=Sf(ae,se.mode,Se),Q.return=se,se=Q}return I(se);case us:return Le=ae._init,Xe(se,Q,Le(ae._payload),Se)}if(Bu(ae))return Ie(se,Q,ae,Se);if(Tu(ae))return ke(se,Q,ae,Se);Vh(se,ae)}return typeof ae=="string"&&ae!==""||typeof ae=="number"?(ae=""+ae,Q!==null&&Q.tag===6?(l(se,Q.sibling),Q=_(Q,ae),Q.return=se,se=Q):(l(se,Q),Q=Ef(ae,se.mode,Se),Q.return=se,se=Q),I(se)):l(se,Q)}return Xe}var vl=Mx(!0),Px=Mx(!1),vc={},uo=zs(vc),ac=zs(vc),lc=zs(vc);function ca(n){if(n===vc)throw Error(Pe(174));return n}function lg(n,o){switch(un(lc,o),un(ac,n),un(uo,vc),n=o.nodeType,n){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:jf(null,"");break;default:n=n===8?o.parentNode:o,o=n.namespaceURI||null,n=n.tagName,o=jf(o,n)}dn(uo),un(uo,o)}function xl(){dn(uo),dn(ac),dn(lc)}function Dx(n){ca(lc.current);var o=ca(uo.current),l=jf(o,n.type);o!==l&&(un(ac,n),un(uo,l))}function ug(n){ac.current===n&&(dn(uo),dn(ac))}var yn=zs(0);function Ed(n){for(var o=n;o!==null;){if(o.tag===13){var l=o.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var yf=[];function cg(){for(var n=0;n<yf.length;n++)yf[n]._workInProgressVersionPrimary=null;yf.length=0}var td=Uo.ReactCurrentDispatcher,_f=Uo.ReactCurrentBatchConfig,ma=0,_n=null,Yn=null,or=null,Sd=!1,Gu=!1,uc=0,k2=0;function Er(){throw Error(Pe(321))}function hg(n,o){if(o===null)return!1;for(var l=0;l<o.length&&l<n.length;l++)if(!Zi(n[l],o[l]))return!1;return!0}function dg(n,o,l,f,_,w){if(ma=w,_n=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,td.current=n===null||n.memoizedState===null?A2:M2,n=l(f,_),Gu){w=0;do{if(Gu=!1,uc=0,25<=w)throw Error(Pe(301));w+=1,or=Yn=null,o.updateQueue=null,td.current=P2,n=l(f,_)}while(Gu)}if(td.current=Td,o=Yn!==null&&Yn.next!==null,ma=0,or=Yn=_n=null,Sd=!1,o)throw Error(Pe(300));return n}function pg(){var n=uc!==0;return uc=0,n}function so(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return or===null?_n.memoizedState=or=n:or=or.next=n,or}function zi(){if(Yn===null){var n=_n.alternate;n=n!==null?n.memoizedState:null}else n=Yn.next;var o=or===null?_n.memoizedState:or.next;if(o!==null)or=o,Yn=n;else{if(n===null)throw Error(Pe(310));Yn=n,n={memoizedState:Yn.memoizedState,baseState:Yn.baseState,baseQueue:Yn.baseQueue,queue:Yn.queue,next:null},or===null?_n.memoizedState=or=n:or=or.next=n}return or}function cc(n,o){return typeof o=="function"?o(n):o}function vf(n){var o=zi(),l=o.queue;if(l===null)throw Error(Pe(311));l.lastRenderedReducer=n;var f=Yn,_=f.baseQueue,w=l.pending;if(w!==null){if(_!==null){var I=_.next;_.next=w.next,w.next=I}f.baseQueue=_=w,l.pending=null}if(_!==null){w=_.next,f=f.baseState;var u=I=null,N=null,q=w;do{var ue=q.lane;if((ma&ue)===ue)N!==null&&(N=N.next={lane:0,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null}),f=q.hasEagerState?q.eagerState:n(f,q.action);else{var oe={lane:ue,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null};N===null?(u=N=oe,I=f):N=N.next=oe,_n.lanes|=ue,ga|=ue}q=q.next}while(q!==null&&q!==w);N===null?I=f:N.next=u,Zi(f,o.memoizedState)||(Kr=!0),o.memoizedState=f,o.baseState=I,o.baseQueue=N,l.lastRenderedState=f}if(n=l.interleaved,n!==null){_=n;do w=_.lane,_n.lanes|=w,ga|=w,_=_.next;while(_!==n)}else _===null&&(l.lanes=0);return[o.memoizedState,l.dispatch]}function xf(n){var o=zi(),l=o.queue;if(l===null)throw Error(Pe(311));l.lastRenderedReducer=n;var f=l.dispatch,_=l.pending,w=o.memoizedState;if(_!==null){l.pending=null;var I=_=_.next;do w=n(w,I.action),I=I.next;while(I!==_);Zi(w,o.memoizedState)||(Kr=!0),o.memoizedState=w,o.baseQueue===null&&(o.baseState=w),l.lastRenderedState=w}return[w,f]}function Lx(){}function Rx(n,o){var l=_n,f=zi(),_=o(),w=!Zi(f.memoizedState,_);if(w&&(f.memoizedState=_,Kr=!0),f=f.queue,fg(Ox.bind(null,l,f,n),[n]),f.getSnapshot!==o||w||or!==null&&or.memoizedState.tag&1){if(l.flags|=2048,hc(9,Fx.bind(null,l,f,_,o),void 0,null),sr===null)throw Error(Pe(349));ma&30||Bx(l,o,_)}return _}function Bx(n,o,l){n.flags|=16384,n={getSnapshot:o,value:l},o=_n.updateQueue,o===null?(o={lastEffect:null,stores:null},_n.updateQueue=o,o.stores=[n]):(l=o.stores,l===null?o.stores=[n]:l.push(n))}function Fx(n,o,l,f){o.value=l,o.getSnapshot=f,Nx(o)&&Ux(n)}function Ox(n,o,l){return l(function(){Nx(o)&&Ux(n)})}function Nx(n){var o=n.getSnapshot;n=n.value;try{var l=o();return!Zi(n,l)}catch{return!0}}function Ux(n){var o=Oo(n,1);o!==null&&Gi(o,n,1,-1)}function V_(n){var o=so();return typeof n=="function"&&(n=n()),o.memoizedState=o.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:cc,lastRenderedState:n},o.queue=n,n=n.dispatch=z2.bind(null,_n,n),[o.memoizedState,n]}function hc(n,o,l,f){return n={tag:n,create:o,destroy:l,deps:f,next:null},o=_n.updateQueue,o===null?(o={lastEffect:null,stores:null},_n.updateQueue=o,o.lastEffect=n.next=n):(l=o.lastEffect,l===null?o.lastEffect=n.next=n:(f=l.next,l.next=n,n.next=f,o.lastEffect=n)),n}function Vx(){return zi().memoizedState}function nd(n,o,l,f){var _=so();_n.flags|=n,_.memoizedState=hc(1|o,l,void 0,f===void 0?null:f)}function Nd(n,o,l,f){var _=zi();f=f===void 0?null:f;var w=void 0;if(Yn!==null){var I=Yn.memoizedState;if(w=I.destroy,f!==null&&hg(f,I.deps)){_.memoizedState=hc(o,l,w,f);return}}_n.flags|=n,_.memoizedState=hc(1|o,l,w,f)}function $_(n,o){return nd(8390656,8,n,o)}function fg(n,o){return Nd(2048,8,n,o)}function $x(n,o){return Nd(4,2,n,o)}function jx(n,o){return Nd(4,4,n,o)}function Gx(n,o){if(typeof o=="function")return n=n(),o(n),function(){o(null)};if(o!=null)return n=n(),o.current=n,function(){o.current=null}}function Zx(n,o,l){return l=l!=null?l.concat([n]):null,Nd(4,4,Gx.bind(null,o,n),l)}function mg(){}function qx(n,o){var l=zi();o=o===void 0?null:o;var f=l.memoizedState;return f!==null&&o!==null&&hg(o,f[1])?f[0]:(l.memoizedState=[n,o],n)}function Wx(n,o){var l=zi();o=o===void 0?null:o;var f=l.memoizedState;return f!==null&&o!==null&&hg(o,f[1])?f[0]:(n=n(),l.memoizedState=[n,o],n)}function Xx(n,o,l){return ma&21?(Zi(l,o)||(l=Yv(),_n.lanes|=l,ga|=l,n.baseState=!0),o):(n.baseState&&(n.baseState=!1,Kr=!0),n.memoizedState=l)}function C2(n,o){var l=Kt;Kt=l!==0&&4>l?l:4,n(!0);var f=_f.transition;_f.transition={};try{n(!1),o()}finally{Kt=l,_f.transition=f}}function Hx(){return zi().memoizedState}function I2(n,o,l){var f=Es(n);if(l={lane:f,action:l,hasEagerState:!1,eagerState:null,next:null},Kx(n))Yx(o,l);else if(l=Cx(n,o,l,f),l!==null){var _=Vr();Gi(l,n,f,_),Jx(l,o,f)}}function z2(n,o,l){var f=Es(n),_={lane:f,action:l,hasEagerState:!1,eagerState:null,next:null};if(Kx(n))Yx(o,_);else{var w=n.alternate;if(n.lanes===0&&(w===null||w.lanes===0)&&(w=o.lastRenderedReducer,w!==null))try{var I=o.lastRenderedState,u=w(I,l);if(_.hasEagerState=!0,_.eagerState=u,Zi(u,I)){var N=o.interleaved;N===null?(_.next=_,sg(o)):(_.next=N.next,N.next=_),o.interleaved=_;return}}catch{}finally{}l=Cx(n,o,_,f),l!==null&&(_=Vr(),Gi(l,n,f,_),Jx(l,o,f))}}function Kx(n){var o=n.alternate;return n===_n||o!==null&&o===_n}function Yx(n,o){Gu=Sd=!0;var l=n.pending;l===null?o.next=o:(o.next=l.next,l.next=o),n.pending=o}function Jx(n,o,l){if(l&4194240){var f=o.lanes;f&=n.pendingLanes,l|=f,o.lanes=l,qm(n,l)}}var Td={readContext:Ii,useCallback:Er,useContext:Er,useEffect:Er,useImperativeHandle:Er,useInsertionEffect:Er,useLayoutEffect:Er,useMemo:Er,useReducer:Er,useRef:Er,useState:Er,useDebugValue:Er,useDeferredValue:Er,useTransition:Er,useMutableSource:Er,useSyncExternalStore:Er,useId:Er,unstable_isNewReconciler:!1},A2={readContext:Ii,useCallback:function(n,o){return so().memoizedState=[n,o===void 0?null:o],n},useContext:Ii,useEffect:$_,useImperativeHandle:function(n,o,l){return l=l!=null?l.concat([n]):null,nd(4194308,4,Gx.bind(null,o,n),l)},useLayoutEffect:function(n,o){return nd(4194308,4,n,o)},useInsertionEffect:function(n,o){return nd(4,2,n,o)},useMemo:function(n,o){var l=so();return o=o===void 0?null:o,n=n(),l.memoizedState=[n,o],n},useReducer:function(n,o,l){var f=so();return o=l!==void 0?l(o):o,f.memoizedState=f.baseState=o,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:o},f.queue=n,n=n.dispatch=I2.bind(null,_n,n),[f.memoizedState,n]},useRef:function(n){var o=so();return n={current:n},o.memoizedState=n},useState:V_,useDebugValue:mg,useDeferredValue:function(n){return so().memoizedState=n},useTransition:function(){var n=V_(!1),o=n[0];return n=C2.bind(null,n[1]),so().memoizedState=n,[o,n]},useMutableSource:function(){},useSyncExternalStore:function(n,o,l){var f=_n,_=so();if(mn){if(l===void 0)throw Error(Pe(407));l=l()}else{if(l=o(),sr===null)throw Error(Pe(349));ma&30||Bx(f,o,l)}_.memoizedState=l;var w={value:l,getSnapshot:o};return _.queue=w,$_(Ox.bind(null,f,w,n),[n]),f.flags|=2048,hc(9,Fx.bind(null,f,w,l,o),void 0,null),l},useId:function(){var n=so(),o=sr.identifierPrefix;if(mn){var l=Lo,f=Do;l=(f&~(1<<32-ji(f)-1)).toString(32)+l,o=":"+o+"R"+l,l=uc++,0<l&&(o+="H"+l.toString(32)),o+=":"}else l=k2++,o=":"+o+"r"+l.toString(32)+":";return n.memoizedState=o},unstable_isNewReconciler:!1},M2={readContext:Ii,useCallback:qx,useContext:Ii,useEffect:fg,useImperativeHandle:Zx,useInsertionEffect:$x,useLayoutEffect:jx,useMemo:Wx,useReducer:vf,useRef:Vx,useState:function(){return vf(cc)},useDebugValue:mg,useDeferredValue:function(n){var o=zi();return Xx(o,Yn.memoizedState,n)},useTransition:function(){var n=vf(cc)[0],o=zi().memoizedState;return[n,o]},useMutableSource:Lx,useSyncExternalStore:Rx,useId:Hx,unstable_isNewReconciler:!1},P2={readContext:Ii,useCallback:qx,useContext:Ii,useEffect:fg,useImperativeHandle:Zx,useInsertionEffect:$x,useLayoutEffect:jx,useMemo:Wx,useReducer:xf,useRef:Vx,useState:function(){return xf(cc)},useDebugValue:mg,useDeferredValue:function(n){var o=zi();return Yn===null?o.memoizedState=n:Xx(o,Yn.memoizedState,n)},useTransition:function(){var n=xf(cc)[0],o=zi().memoizedState;return[n,o]},useMutableSource:Lx,useSyncExternalStore:Rx,useId:Hx,unstable_isNewReconciler:!1};function wl(n,o){try{var l="",f=o;do l+=sb(f),f=f.return;while(f);var _=l}catch(w){_=`
Error generating stack: `+w.message+`
`+w.stack}return{value:n,source:o,stack:_,digest:null}}function wf(n,o,l){return{value:n,source:null,stack:l??null,digest:o??null}}function dm(n,o){try{console.error(o.value)}catch(l){setTimeout(function(){throw l})}}var D2=typeof WeakMap=="function"?WeakMap:Map;function Qx(n,o,l){l=Ro(-1,l),l.tag=3,l.payload={element:null};var f=o.value;return l.callback=function(){Cd||(Cd=!0,bm=f),dm(n,o)},l}function e0(n,o,l){l=Ro(-1,l),l.tag=3;var f=n.type.getDerivedStateFromError;if(typeof f=="function"){var _=o.value;l.payload=function(){return f(_)},l.callback=function(){dm(n,o)}}var w=n.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(l.callback=function(){dm(n,o),typeof f!="function"&&(bs===null?bs=new Set([this]):bs.add(this));var I=o.stack;this.componentDidCatch(o.value,{componentStack:I!==null?I:""})}),l}function j_(n,o,l){var f=n.pingCache;if(f===null){f=n.pingCache=new D2;var _=new Set;f.set(o,_)}else _=f.get(o),_===void 0&&(_=new Set,f.set(o,_));_.has(l)||(_.add(l),n=W2.bind(null,n,o,l),o.then(n,n))}function G_(n){do{var o;if((o=n.tag===13)&&(o=n.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return n;n=n.return}while(n!==null);return null}function Z_(n,o,l,f,_){return n.mode&1?(n.flags|=65536,n.lanes=_,n):(n===o?n.flags|=65536:(n.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(o=Ro(-1,1),o.tag=2,ws(l,o,1))),l.lanes|=1),n)}var L2=Uo.ReactCurrentOwner,Kr=!1;function Ur(n,o,l,f){o.child=n===null?Px(o,null,l,f):vl(o,n.child,l,f)}function q_(n,o,l,f,_){l=l.render;var w=o.ref;return fl(o,_),f=dg(n,o,l,f,w,_),l=pg(),n!==null&&!Kr?(o.updateQueue=n.updateQueue,o.flags&=-2053,n.lanes&=~_,No(n,o,_)):(mn&&l&&eg(o),o.flags|=1,Ur(n,o,f,_),o.child)}function W_(n,o,l,f,_){if(n===null){var w=l.type;return typeof w=="function"&&!Eg(w)&&w.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(o.tag=15,o.type=w,t0(n,o,w,f,_)):(n=sd(l.type,null,f,o,o.mode,_),n.ref=o.ref,n.return=o,o.child=n)}if(w=n.child,!(n.lanes&_)){var I=w.memoizedProps;if(l=l.compare,l=l!==null?l:rc,l(I,f)&&n.ref===o.ref)return No(n,o,_)}return o.flags|=1,n=Ss(w,f),n.ref=o.ref,n.return=o,o.child=n}function t0(n,o,l,f,_){if(n!==null){var w=n.memoizedProps;if(rc(w,f)&&n.ref===o.ref)if(Kr=!1,o.pendingProps=f=w,(n.lanes&_)!==0)n.flags&131072&&(Kr=!0);else return o.lanes=n.lanes,No(n,o,_)}return pm(n,o,l,f,_)}function n0(n,o,l){var f=o.pendingProps,_=f.children,w=n!==null?n.memoizedState:null;if(f.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},un(ul,ci),ci|=l;else{if(!(l&1073741824))return n=w!==null?w.baseLanes|l:l,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:n,cachePool:null,transitions:null},o.updateQueue=null,un(ul,ci),ci|=n,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=w!==null?w.baseLanes:l,un(ul,ci),ci|=f}else w!==null?(f=w.baseLanes|l,o.memoizedState=null):f=l,un(ul,ci),ci|=f;return Ur(n,o,_,l),o.child}function r0(n,o){var l=o.ref;(n===null&&l!==null||n!==null&&n.ref!==l)&&(o.flags|=512,o.flags|=2097152)}function pm(n,o,l,f,_){var w=Jr(l)?pa:kr.current;return w=yl(o,w),fl(o,_),l=dg(n,o,l,f,w,_),f=pg(),n!==null&&!Kr?(o.updateQueue=n.updateQueue,o.flags&=-2053,n.lanes&=~_,No(n,o,_)):(mn&&f&&eg(o),o.flags|=1,Ur(n,o,l,_),o.child)}function X_(n,o,l,f,_){if(Jr(l)){var w=!0;yd(o)}else w=!1;if(fl(o,_),o.stateNode===null)rd(n,o),Ax(o,l,f),hm(o,l,f,_),f=!0;else if(n===null){var I=o.stateNode,u=o.memoizedProps;I.props=u;var N=I.context,q=l.contextType;typeof q=="object"&&q!==null?q=Ii(q):(q=Jr(l)?pa:kr.current,q=yl(o,q));var ue=l.getDerivedStateFromProps,oe=typeof ue=="function"||typeof I.getSnapshotBeforeUpdate=="function";oe||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(u!==f||N!==q)&&N_(o,I,f,q),cs=!1;var Z=o.memoizedState;I.state=Z,bd(o,f,I,_),N=o.memoizedState,u!==f||Z!==N||Yr.current||cs?(typeof ue=="function"&&(cm(o,l,ue,f),N=o.memoizedState),(u=cs||O_(o,l,u,f,Z,N,q))?(oe||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(o.flags|=4194308)):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=N),I.props=f,I.state=N,I.context=q,f=u):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{I=o.stateNode,Ix(n,o),u=o.memoizedProps,q=o.type===o.elementType?u:Ni(o.type,u),I.props=q,oe=o.pendingProps,Z=I.context,N=l.contextType,typeof N=="object"&&N!==null?N=Ii(N):(N=Jr(l)?pa:kr.current,N=yl(o,N));var ze=l.getDerivedStateFromProps;(ue=typeof ze=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(u!==oe||Z!==N)&&N_(o,I,f,N),cs=!1,Z=o.memoizedState,I.state=Z,bd(o,f,I,_);var Ie=o.memoizedState;u!==oe||Z!==Ie||Yr.current||cs?(typeof ze=="function"&&(cm(o,l,ze,f),Ie=o.memoizedState),(q=cs||O_(o,l,q,f,Z,Ie,N)||!1)?(ue||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(f,Ie,N),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(f,Ie,N)),typeof I.componentDidUpdate=="function"&&(o.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof I.componentDidUpdate!="function"||u===n.memoizedProps&&Z===n.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||u===n.memoizedProps&&Z===n.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=Ie),I.props=f,I.state=Ie,I.context=N,f=q):(typeof I.componentDidUpdate!="function"||u===n.memoizedProps&&Z===n.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||u===n.memoizedProps&&Z===n.memoizedState||(o.flags|=1024),f=!1)}return fm(n,o,l,f,w,_)}function fm(n,o,l,f,_,w){r0(n,o);var I=(o.flags&128)!==0;if(!f&&!I)return _&&D_(o,l,!1),No(n,o,w);f=o.stateNode,L2.current=o;var u=I&&typeof l.getDerivedStateFromError!="function"?null:f.render();return o.flags|=1,n!==null&&I?(o.child=vl(o,n.child,null,w),o.child=vl(o,null,u,w)):Ur(n,o,u,w),o.memoizedState=f.state,_&&D_(o,l,!0),o.child}function i0(n){var o=n.stateNode;o.pendingContext?P_(n,o.pendingContext,o.pendingContext!==o.context):o.context&&P_(n,o.context,!1),lg(n,o.containerInfo)}function H_(n,o,l,f,_){return _l(),ng(_),o.flags|=256,Ur(n,o,l,f),o.child}var mm={dehydrated:null,treeContext:null,retryLane:0};function gm(n){return{baseLanes:n,cachePool:null,transitions:null}}function o0(n,o,l){var f=o.pendingProps,_=yn.current,w=!1,I=(o.flags&128)!==0,u;if((u=I)||(u=n!==null&&n.memoizedState===null?!1:(_&2)!==0),u?(w=!0,o.flags&=-129):(n===null||n.memoizedState!==null)&&(_|=1),un(yn,_&1),n===null)return lm(o),n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(o.mode&1?n.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(I=f.children,n=f.fallback,w?(f=o.mode,w=o.child,I={mode:"hidden",children:I},!(f&1)&&w!==null?(w.childLanes=0,w.pendingProps=I):w=$d(I,f,0,null),n=da(n,f,l,null),w.return=o,n.return=o,w.sibling=n,o.child=w,o.child.memoizedState=gm(l),o.memoizedState=mm,n):gg(o,I));if(_=n.memoizedState,_!==null&&(u=_.dehydrated,u!==null))return R2(n,o,I,f,u,_,l);if(w){w=f.fallback,I=o.mode,_=n.child,u=_.sibling;var N={mode:"hidden",children:f.children};return!(I&1)&&o.child!==_?(f=o.child,f.childLanes=0,f.pendingProps=N,o.deletions=null):(f=Ss(_,N),f.subtreeFlags=_.subtreeFlags&14680064),u!==null?w=Ss(u,w):(w=da(w,I,l,null),w.flags|=2),w.return=o,f.return=o,f.sibling=w,o.child=f,f=w,w=o.child,I=n.child.memoizedState,I=I===null?gm(l):{baseLanes:I.baseLanes|l,cachePool:null,transitions:I.transitions},w.memoizedState=I,w.childLanes=n.childLanes&~l,o.memoizedState=mm,f}return w=n.child,n=w.sibling,f=Ss(w,{mode:"visible",children:f.children}),!(o.mode&1)&&(f.lanes=l),f.return=o,f.sibling=null,n!==null&&(l=o.deletions,l===null?(o.deletions=[n],o.flags|=16):l.push(n)),o.child=f,o.memoizedState=null,f}function gg(n,o){return o=$d({mode:"visible",children:o},n.mode,0,null),o.return=n,n.child=o}function $h(n,o,l,f){return f!==null&&ng(f),vl(o,n.child,null,l),n=gg(o,o.pendingProps.children),n.flags|=2,o.memoizedState=null,n}function R2(n,o,l,f,_,w,I){if(l)return o.flags&256?(o.flags&=-257,f=wf(Error(Pe(422))),$h(n,o,I,f)):o.memoizedState!==null?(o.child=n.child,o.flags|=128,null):(w=f.fallback,_=o.mode,f=$d({mode:"visible",children:f.children},_,0,null),w=da(w,_,I,null),w.flags|=2,f.return=o,w.return=o,f.sibling=w,o.child=f,o.mode&1&&vl(o,n.child,null,I),o.child.memoizedState=gm(I),o.memoizedState=mm,w);if(!(o.mode&1))return $h(n,o,I,null);if(_.data==="$!"){if(f=_.nextSibling&&_.nextSibling.dataset,f)var u=f.dgst;return f=u,w=Error(Pe(419)),f=wf(w,f,void 0),$h(n,o,I,f)}if(u=(I&n.childLanes)!==0,Kr||u){if(f=sr,f!==null){switch(I&-I){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=_&(f.suspendedLanes|I)?0:_,_!==0&&_!==w.retryLane&&(w.retryLane=_,Oo(n,_),Gi(f,n,_,-1))}return bg(),f=wf(Error(Pe(421))),$h(n,o,I,f)}return _.data==="$?"?(o.flags|=128,o.child=n.child,o=X2.bind(null,n),_._reactRetry=o,null):(n=w.treeContext,hi=xs(_.nextSibling),di=o,mn=!0,Vi=null,n!==null&&(Si[Ti++]=Do,Si[Ti++]=Lo,Si[Ti++]=fa,Do=n.id,Lo=n.overflow,fa=o),o=gg(o,f.children),o.flags|=4096,o)}function K_(n,o,l){n.lanes|=o;var f=n.alternate;f!==null&&(f.lanes|=o),um(n.return,o,l)}function bf(n,o,l,f,_){var w=n.memoizedState;w===null?n.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:l,tailMode:_}:(w.isBackwards=o,w.rendering=null,w.renderingStartTime=0,w.last=f,w.tail=l,w.tailMode=_)}function s0(n,o,l){var f=o.pendingProps,_=f.revealOrder,w=f.tail;if(Ur(n,o,f.children,l),f=yn.current,f&2)f=f&1|2,o.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=o.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&K_(n,l,o);else if(n.tag===19)K_(n,l,o);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===o)break e;for(;n.sibling===null;){if(n.return===null||n.return===o)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}f&=1}if(un(yn,f),!(o.mode&1))o.memoizedState=null;else switch(_){case"forwards":for(l=o.child,_=null;l!==null;)n=l.alternate,n!==null&&Ed(n)===null&&(_=l),l=l.sibling;l=_,l===null?(_=o.child,o.child=null):(_=l.sibling,l.sibling=null),bf(o,!1,_,l,w);break;case"backwards":for(l=null,_=o.child,o.child=null;_!==null;){if(n=_.alternate,n!==null&&Ed(n)===null){o.child=_;break}n=_.sibling,_.sibling=l,l=_,_=n}bf(o,!0,l,null,w);break;case"together":bf(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function rd(n,o){!(o.mode&1)&&n!==null&&(n.alternate=null,o.alternate=null,o.flags|=2)}function No(n,o,l){if(n!==null&&(o.dependencies=n.dependencies),ga|=o.lanes,!(l&o.childLanes))return null;if(n!==null&&o.child!==n.child)throw Error(Pe(153));if(o.child!==null){for(n=o.child,l=Ss(n,n.pendingProps),o.child=l,l.return=o;n.sibling!==null;)n=n.sibling,l=l.sibling=Ss(n,n.pendingProps),l.return=o;l.sibling=null}return o.child}function B2(n,o,l){switch(o.tag){case 3:i0(o),_l();break;case 5:Dx(o);break;case 1:Jr(o.type)&&yd(o);break;case 4:lg(o,o.stateNode.containerInfo);break;case 10:var f=o.type._context,_=o.memoizedProps.value;un(xd,f._currentValue),f._currentValue=_;break;case 13:if(f=o.memoizedState,f!==null)return f.dehydrated!==null?(un(yn,yn.current&1),o.flags|=128,null):l&o.child.childLanes?o0(n,o,l):(un(yn,yn.current&1),n=No(n,o,l),n!==null?n.sibling:null);un(yn,yn.current&1);break;case 19:if(f=(l&o.childLanes)!==0,n.flags&128){if(f)return s0(n,o,l);o.flags|=128}if(_=o.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),un(yn,yn.current),f)break;return null;case 22:case 23:return o.lanes=0,n0(n,o,l)}return No(n,o,l)}var a0,ym,l0,u0;a0=function(n,o){for(var l=o.child;l!==null;){if(l.tag===5||l.tag===6)n.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return;l=l.return}l.sibling.return=l.return,l=l.sibling}};ym=function(){};l0=function(n,o,l,f){var _=n.memoizedProps;if(_!==f){n=o.stateNode,ca(uo.current);var w=null;switch(l){case"input":_=Nf(n,_),f=Nf(n,f),w=[];break;case"select":_=vn({},_,{value:void 0}),f=vn({},f,{value:void 0}),w=[];break;case"textarea":_=$f(n,_),f=$f(n,f),w=[];break;default:typeof _.onClick!="function"&&typeof f.onClick=="function"&&(n.onclick=md)}Gf(l,f);var I;l=null;for(q in _)if(!f.hasOwnProperty(q)&&_.hasOwnProperty(q)&&_[q]!=null)if(q==="style"){var u=_[q];for(I in u)u.hasOwnProperty(I)&&(l||(l={}),l[I]="")}else q!=="dangerouslySetInnerHTML"&&q!=="children"&&q!=="suppressContentEditableWarning"&&q!=="suppressHydrationWarning"&&q!=="autoFocus"&&(Ku.hasOwnProperty(q)?w||(w=[]):(w=w||[]).push(q,null));for(q in f){var N=f[q];if(u=_!=null?_[q]:void 0,f.hasOwnProperty(q)&&N!==u&&(N!=null||u!=null))if(q==="style")if(u){for(I in u)!u.hasOwnProperty(I)||N&&N.hasOwnProperty(I)||(l||(l={}),l[I]="");for(I in N)N.hasOwnProperty(I)&&u[I]!==N[I]&&(l||(l={}),l[I]=N[I])}else l||(w||(w=[]),w.push(q,l)),l=N;else q==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,u=u?u.__html:void 0,N!=null&&u!==N&&(w=w||[]).push(q,N)):q==="children"?typeof N!="string"&&typeof N!="number"||(w=w||[]).push(q,""+N):q!=="suppressContentEditableWarning"&&q!=="suppressHydrationWarning"&&(Ku.hasOwnProperty(q)?(N!=null&&q==="onScroll"&&hn("scroll",n),w||u===N||(w=[])):(w=w||[]).push(q,N))}l&&(w=w||[]).push("style",l);var q=w;(o.updateQueue=q)&&(o.flags|=4)}};u0=function(n,o,l,f){l!==f&&(o.flags|=4)};function Mu(n,o){if(!mn)switch(n.tailMode){case"hidden":o=n.tail;for(var l=null;o!==null;)o.alternate!==null&&(l=o),o=o.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?o||n.tail===null?n.tail=null:n.tail.sibling=null:f.sibling=null}}function Sr(n){var o=n.alternate!==null&&n.alternate.child===n.child,l=0,f=0;if(o)for(var _=n.child;_!==null;)l|=_.lanes|_.childLanes,f|=_.subtreeFlags&14680064,f|=_.flags&14680064,_.return=n,_=_.sibling;else for(_=n.child;_!==null;)l|=_.lanes|_.childLanes,f|=_.subtreeFlags,f|=_.flags,_.return=n,_=_.sibling;return n.subtreeFlags|=f,n.childLanes=l,o}function F2(n,o,l){var f=o.pendingProps;switch(tg(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Sr(o),null;case 1:return Jr(o.type)&&gd(),Sr(o),null;case 3:return f=o.stateNode,xl(),dn(Yr),dn(kr),cg(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(n===null||n.child===null)&&(Uh(o)?o.flags|=4:n===null||n.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,Vi!==null&&(Tm(Vi),Vi=null))),ym(n,o),Sr(o),null;case 5:ug(o);var _=ca(lc.current);if(l=o.type,n!==null&&o.stateNode!=null)l0(n,o,l,f,_),n.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!f){if(o.stateNode===null)throw Error(Pe(166));return Sr(o),null}if(n=ca(uo.current),Uh(o)){f=o.stateNode,l=o.type;var w=o.memoizedProps;switch(f[ao]=o,f[sc]=w,n=(o.mode&1)!==0,l){case"dialog":hn("cancel",f),hn("close",f);break;case"iframe":case"object":case"embed":hn("load",f);break;case"video":case"audio":for(_=0;_<Ou.length;_++)hn(Ou[_],f);break;case"source":hn("error",f);break;case"img":case"image":case"link":hn("error",f),hn("load",f);break;case"details":hn("toggle",f);break;case"input":o_(f,w),hn("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!w.multiple},hn("invalid",f);break;case"textarea":a_(f,w),hn("invalid",f)}Gf(l,w),_=null;for(var I in w)if(w.hasOwnProperty(I)){var u=w[I];I==="children"?typeof u=="string"?f.textContent!==u&&(w.suppressHydrationWarning!==!0&&Nh(f.textContent,u,n),_=["children",u]):typeof u=="number"&&f.textContent!==""+u&&(w.suppressHydrationWarning!==!0&&Nh(f.textContent,u,n),_=["children",""+u]):Ku.hasOwnProperty(I)&&u!=null&&I==="onScroll"&&hn("scroll",f)}switch(l){case"input":Mh(f),s_(f,w,!0);break;case"textarea":Mh(f),l_(f);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(f.onclick=md)}f=_,o.updateQueue=f,f!==null&&(o.flags|=4)}else{I=_.nodeType===9?_:_.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Bv(l)),n==="http://www.w3.org/1999/xhtml"?l==="script"?(n=I.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof f.is=="string"?n=I.createElement(l,{is:f.is}):(n=I.createElement(l),l==="select"&&(I=n,f.multiple?I.multiple=!0:f.size&&(I.size=f.size))):n=I.createElementNS(n,l),n[ao]=o,n[sc]=f,a0(n,o,!1,!1),o.stateNode=n;e:{switch(I=Zf(l,f),l){case"dialog":hn("cancel",n),hn("close",n),_=f;break;case"iframe":case"object":case"embed":hn("load",n),_=f;break;case"video":case"audio":for(_=0;_<Ou.length;_++)hn(Ou[_],n);_=f;break;case"source":hn("error",n),_=f;break;case"img":case"image":case"link":hn("error",n),hn("load",n),_=f;break;case"details":hn("toggle",n),_=f;break;case"input":o_(n,f),_=Nf(n,f),hn("invalid",n);break;case"option":_=f;break;case"select":n._wrapperState={wasMultiple:!!f.multiple},_=vn({},f,{value:void 0}),hn("invalid",n);break;case"textarea":a_(n,f),_=$f(n,f),hn("invalid",n);break;default:_=f}Gf(l,_),u=_;for(w in u)if(u.hasOwnProperty(w)){var N=u[w];w==="style"?Nv(n,N):w==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,N!=null&&Fv(n,N)):w==="children"?typeof N=="string"?(l!=="textarea"||N!=="")&&Yu(n,N):typeof N=="number"&&Yu(n,""+N):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(Ku.hasOwnProperty(w)?N!=null&&w==="onScroll"&&hn("scroll",n):N!=null&&Um(n,w,N,I))}switch(l){case"input":Mh(n),s_(n,f,!1);break;case"textarea":Mh(n),l_(n);break;case"option":f.value!=null&&n.setAttribute("value",""+Ts(f.value));break;case"select":n.multiple=!!f.multiple,w=f.value,w!=null?cl(n,!!f.multiple,w,!1):f.defaultValue!=null&&cl(n,!!f.multiple,f.defaultValue,!0);break;default:typeof _.onClick=="function"&&(n.onclick=md)}switch(l){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return Sr(o),null;case 6:if(n&&o.stateNode!=null)u0(n,o,n.memoizedProps,f);else{if(typeof f!="string"&&o.stateNode===null)throw Error(Pe(166));if(l=ca(lc.current),ca(uo.current),Uh(o)){if(f=o.stateNode,l=o.memoizedProps,f[ao]=o,(w=f.nodeValue!==l)&&(n=di,n!==null))switch(n.tag){case 3:Nh(f.nodeValue,l,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Nh(f.nodeValue,l,(n.mode&1)!==0)}w&&(o.flags|=4)}else f=(l.nodeType===9?l:l.ownerDocument).createTextNode(f),f[ao]=o,o.stateNode=f}return Sr(o),null;case 13:if(dn(yn),f=o.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(mn&&hi!==null&&o.mode&1&&!(o.flags&128))kx(),_l(),o.flags|=98560,w=!1;else if(w=Uh(o),f!==null&&f.dehydrated!==null){if(n===null){if(!w)throw Error(Pe(318));if(w=o.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(Pe(317));w[ao]=o}else _l(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;Sr(o),w=!1}else Vi!==null&&(Tm(Vi),Vi=null),w=!0;if(!w)return o.flags&65536?o:null}return o.flags&128?(o.lanes=l,o):(f=f!==null,f!==(n!==null&&n.memoizedState!==null)&&f&&(o.child.flags|=8192,o.mode&1&&(n===null||yn.current&1?Jn===0&&(Jn=3):bg())),o.updateQueue!==null&&(o.flags|=4),Sr(o),null);case 4:return xl(),ym(n,o),n===null&&ic(o.stateNode.containerInfo),Sr(o),null;case 10:return og(o.type._context),Sr(o),null;case 17:return Jr(o.type)&&gd(),Sr(o),null;case 19:if(dn(yn),w=o.memoizedState,w===null)return Sr(o),null;if(f=(o.flags&128)!==0,I=w.rendering,I===null)if(f)Mu(w,!1);else{if(Jn!==0||n!==null&&n.flags&128)for(n=o.child;n!==null;){if(I=Ed(n),I!==null){for(o.flags|=128,Mu(w,!1),f=I.updateQueue,f!==null&&(o.updateQueue=f,o.flags|=4),o.subtreeFlags=0,f=l,l=o.child;l!==null;)w=l,n=f,w.flags&=14680066,I=w.alternate,I===null?(w.childLanes=0,w.lanes=n,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=I.childLanes,w.lanes=I.lanes,w.child=I.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=I.memoizedProps,w.memoizedState=I.memoizedState,w.updateQueue=I.updateQueue,w.type=I.type,n=I.dependencies,w.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),l=l.sibling;return un(yn,yn.current&1|2),o.child}n=n.sibling}w.tail!==null&&Ln()>bl&&(o.flags|=128,f=!0,Mu(w,!1),o.lanes=4194304)}else{if(!f)if(n=Ed(I),n!==null){if(o.flags|=128,f=!0,l=n.updateQueue,l!==null&&(o.updateQueue=l,o.flags|=4),Mu(w,!0),w.tail===null&&w.tailMode==="hidden"&&!I.alternate&&!mn)return Sr(o),null}else 2*Ln()-w.renderingStartTime>bl&&l!==1073741824&&(o.flags|=128,f=!0,Mu(w,!1),o.lanes=4194304);w.isBackwards?(I.sibling=o.child,o.child=I):(l=w.last,l!==null?l.sibling=I:o.child=I,w.last=I)}return w.tail!==null?(o=w.tail,w.rendering=o,w.tail=o.sibling,w.renderingStartTime=Ln(),o.sibling=null,l=yn.current,un(yn,f?l&1|2:l&1),o):(Sr(o),null);case 22:case 23:return wg(),f=o.memoizedState!==null,n!==null&&n.memoizedState!==null!==f&&(o.flags|=8192),f&&o.mode&1?ci&1073741824&&(Sr(o),o.subtreeFlags&6&&(o.flags|=8192)):Sr(o),null;case 24:return null;case 25:return null}throw Error(Pe(156,o.tag))}function O2(n,o){switch(tg(o),o.tag){case 1:return Jr(o.type)&&gd(),n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 3:return xl(),dn(Yr),dn(kr),cg(),n=o.flags,n&65536&&!(n&128)?(o.flags=n&-65537|128,o):null;case 5:return ug(o),null;case 13:if(dn(yn),n=o.memoizedState,n!==null&&n.dehydrated!==null){if(o.alternate===null)throw Error(Pe(340));_l()}return n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 19:return dn(yn),null;case 4:return xl(),null;case 10:return og(o.type._context),null;case 22:case 23:return wg(),null;case 24:return null;default:return null}}var jh=!1,Tr=!1,N2=typeof WeakSet=="function"?WeakSet:Set,rt=null;function ll(n,o){var l=n.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(f){In(n,o,f)}else l.current=null}function _m(n,o,l){try{l()}catch(f){In(n,o,f)}}var Y_=!1;function U2(n,o){if(tm=dd,n=px(),Qm(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else e:{l=(l=n.ownerDocument)&&l.defaultView||window;var f=l.getSelection&&l.getSelection();if(f&&f.rangeCount!==0){l=f.anchorNode;var _=f.anchorOffset,w=f.focusNode;f=f.focusOffset;try{l.nodeType,w.nodeType}catch{l=null;break e}var I=0,u=-1,N=-1,q=0,ue=0,oe=n,Z=null;t:for(;;){for(var ze;oe!==l||_!==0&&oe.nodeType!==3||(u=I+_),oe!==w||f!==0&&oe.nodeType!==3||(N=I+f),oe.nodeType===3&&(I+=oe.nodeValue.length),(ze=oe.firstChild)!==null;)Z=oe,oe=ze;for(;;){if(oe===n)break t;if(Z===l&&++q===_&&(u=I),Z===w&&++ue===f&&(N=I),(ze=oe.nextSibling)!==null)break;oe=Z,Z=oe.parentNode}oe=ze}l=u===-1||N===-1?null:{start:u,end:N}}else l=null}l=l||{start:0,end:0}}else l=null;for(nm={focusedElem:n,selectionRange:l},dd=!1,rt=o;rt!==null;)if(o=rt,n=o.child,(o.subtreeFlags&1028)!==0&&n!==null)n.return=o,rt=n;else for(;rt!==null;){o=rt;try{var Ie=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(Ie!==null){var ke=Ie.memoizedProps,Xe=Ie.memoizedState,se=o.stateNode,Q=se.getSnapshotBeforeUpdate(o.elementType===o.type?ke:Ni(o.type,ke),Xe);se.__reactInternalSnapshotBeforeUpdate=Q}break;case 3:var ae=o.stateNode.containerInfo;ae.nodeType===1?ae.textContent="":ae.nodeType===9&&ae.documentElement&&ae.removeChild(ae.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Pe(163))}}catch(Se){In(o,o.return,Se)}if(n=o.sibling,n!==null){n.return=o.return,rt=n;break}rt=o.return}return Ie=Y_,Y_=!1,Ie}function Zu(n,o,l){var f=o.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var _=f=f.next;do{if((_.tag&n)===n){var w=_.destroy;_.destroy=void 0,w!==void 0&&_m(o,l,w)}_=_.next}while(_!==f)}}function Ud(n,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var l=o=o.next;do{if((l.tag&n)===n){var f=l.create;l.destroy=f()}l=l.next}while(l!==o)}}function vm(n){var o=n.ref;if(o!==null){var l=n.stateNode;switch(n.tag){case 5:n=l;break;default:n=l}typeof o=="function"?o(n):o.current=n}}function c0(n){var o=n.alternate;o!==null&&(n.alternate=null,c0(o)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(o=n.stateNode,o!==null&&(delete o[ao],delete o[sc],delete o[om],delete o[b2],delete o[E2])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function h0(n){return n.tag===5||n.tag===3||n.tag===4}function J_(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||h0(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function xm(n,o,l){var f=n.tag;if(f===5||f===6)n=n.stateNode,o?l.nodeType===8?l.parentNode.insertBefore(n,o):l.insertBefore(n,o):(l.nodeType===8?(o=l.parentNode,o.insertBefore(n,l)):(o=l,o.appendChild(n)),l=l._reactRootContainer,l!=null||o.onclick!==null||(o.onclick=md));else if(f!==4&&(n=n.child,n!==null))for(xm(n,o,l),n=n.sibling;n!==null;)xm(n,o,l),n=n.sibling}function wm(n,o,l){var f=n.tag;if(f===5||f===6)n=n.stateNode,o?l.insertBefore(n,o):l.appendChild(n);else if(f!==4&&(n=n.child,n!==null))for(wm(n,o,l),n=n.sibling;n!==null;)wm(n,o,l),n=n.sibling}var fr=null,Ui=!1;function ls(n,o,l){for(l=l.child;l!==null;)d0(n,o,l),l=l.sibling}function d0(n,o,l){if(lo&&typeof lo.onCommitFiberUnmount=="function")try{lo.onCommitFiberUnmount(Pd,l)}catch{}switch(l.tag){case 5:Tr||ll(l,o);case 6:var f=fr,_=Ui;fr=null,ls(n,o,l),fr=f,Ui=_,fr!==null&&(Ui?(n=fr,l=l.stateNode,n.nodeType===8?n.parentNode.removeChild(l):n.removeChild(l)):fr.removeChild(l.stateNode));break;case 18:fr!==null&&(Ui?(n=fr,l=l.stateNode,n.nodeType===8?mf(n.parentNode,l):n.nodeType===1&&mf(n,l),tc(n)):mf(fr,l.stateNode));break;case 4:f=fr,_=Ui,fr=l.stateNode.containerInfo,Ui=!0,ls(n,o,l),fr=f,Ui=_;break;case 0:case 11:case 14:case 15:if(!Tr&&(f=l.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){_=f=f.next;do{var w=_,I=w.destroy;w=w.tag,I!==void 0&&(w&2||w&4)&&_m(l,o,I),_=_.next}while(_!==f)}ls(n,o,l);break;case 1:if(!Tr&&(ll(l,o),f=l.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=l.memoizedProps,f.state=l.memoizedState,f.componentWillUnmount()}catch(u){In(l,o,u)}ls(n,o,l);break;case 21:ls(n,o,l);break;case 22:l.mode&1?(Tr=(f=Tr)||l.memoizedState!==null,ls(n,o,l),Tr=f):ls(n,o,l);break;default:ls(n,o,l)}}function Q_(n){var o=n.updateQueue;if(o!==null){n.updateQueue=null;var l=n.stateNode;l===null&&(l=n.stateNode=new N2),o.forEach(function(f){var _=H2.bind(null,n,f);l.has(f)||(l.add(f),f.then(_,_))})}}function Oi(n,o){var l=o.deletions;if(l!==null)for(var f=0;f<l.length;f++){var _=l[f];try{var w=n,I=o,u=I;e:for(;u!==null;){switch(u.tag){case 5:fr=u.stateNode,Ui=!1;break e;case 3:fr=u.stateNode.containerInfo,Ui=!0;break e;case 4:fr=u.stateNode.containerInfo,Ui=!0;break e}u=u.return}if(fr===null)throw Error(Pe(160));d0(w,I,_),fr=null,Ui=!1;var N=_.alternate;N!==null&&(N.return=null),_.return=null}catch(q){In(_,o,q)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)p0(o,n),o=o.sibling}function p0(n,o){var l=n.alternate,f=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Oi(o,n),oo(n),f&4){try{Zu(3,n,n.return),Ud(3,n)}catch(ke){In(n,n.return,ke)}try{Zu(5,n,n.return)}catch(ke){In(n,n.return,ke)}}break;case 1:Oi(o,n),oo(n),f&512&&l!==null&&ll(l,l.return);break;case 5:if(Oi(o,n),oo(n),f&512&&l!==null&&ll(l,l.return),n.flags&32){var _=n.stateNode;try{Yu(_,"")}catch(ke){In(n,n.return,ke)}}if(f&4&&(_=n.stateNode,_!=null)){var w=n.memoizedProps,I=l!==null?l.memoizedProps:w,u=n.type,N=n.updateQueue;if(n.updateQueue=null,N!==null)try{u==="input"&&w.type==="radio"&&w.name!=null&&Lv(_,w),Zf(u,I);var q=Zf(u,w);for(I=0;I<N.length;I+=2){var ue=N[I],oe=N[I+1];ue==="style"?Nv(_,oe):ue==="dangerouslySetInnerHTML"?Fv(_,oe):ue==="children"?Yu(_,oe):Um(_,ue,oe,q)}switch(u){case"input":Uf(_,w);break;case"textarea":Rv(_,w);break;case"select":var Z=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!w.multiple;var ze=w.value;ze!=null?cl(_,!!w.multiple,ze,!1):Z!==!!w.multiple&&(w.defaultValue!=null?cl(_,!!w.multiple,w.defaultValue,!0):cl(_,!!w.multiple,w.multiple?[]:"",!1))}_[sc]=w}catch(ke){In(n,n.return,ke)}}break;case 6:if(Oi(o,n),oo(n),f&4){if(n.stateNode===null)throw Error(Pe(162));_=n.stateNode,w=n.memoizedProps;try{_.nodeValue=w}catch(ke){In(n,n.return,ke)}}break;case 3:if(Oi(o,n),oo(n),f&4&&l!==null&&l.memoizedState.isDehydrated)try{tc(o.containerInfo)}catch(ke){In(n,n.return,ke)}break;case 4:Oi(o,n),oo(n);break;case 13:Oi(o,n),oo(n),_=n.child,_.flags&8192&&(w=_.memoizedState!==null,_.stateNode.isHidden=w,!w||_.alternate!==null&&_.alternate.memoizedState!==null||(vg=Ln())),f&4&&Q_(n);break;case 22:if(ue=l!==null&&l.memoizedState!==null,n.mode&1?(Tr=(q=Tr)||ue,Oi(o,n),Tr=q):Oi(o,n),oo(n),f&8192){if(q=n.memoizedState!==null,(n.stateNode.isHidden=q)&&!ue&&n.mode&1)for(rt=n,ue=n.child;ue!==null;){for(oe=rt=ue;rt!==null;){switch(Z=rt,ze=Z.child,Z.tag){case 0:case 11:case 14:case 15:Zu(4,Z,Z.return);break;case 1:ll(Z,Z.return);var Ie=Z.stateNode;if(typeof Ie.componentWillUnmount=="function"){f=Z,l=Z.return;try{o=f,Ie.props=o.memoizedProps,Ie.state=o.memoizedState,Ie.componentWillUnmount()}catch(ke){In(f,l,ke)}}break;case 5:ll(Z,Z.return);break;case 22:if(Z.memoizedState!==null){tv(oe);continue}}ze!==null?(ze.return=Z,rt=ze):tv(oe)}ue=ue.sibling}e:for(ue=null,oe=n;;){if(oe.tag===5){if(ue===null){ue=oe;try{_=oe.stateNode,q?(w=_.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(u=oe.stateNode,N=oe.memoizedProps.style,I=N!=null&&N.hasOwnProperty("display")?N.display:null,u.style.display=Ov("display",I))}catch(ke){In(n,n.return,ke)}}}else if(oe.tag===6){if(ue===null)try{oe.stateNode.nodeValue=q?"":oe.memoizedProps}catch(ke){In(n,n.return,ke)}}else if((oe.tag!==22&&oe.tag!==23||oe.memoizedState===null||oe===n)&&oe.child!==null){oe.child.return=oe,oe=oe.child;continue}if(oe===n)break e;for(;oe.sibling===null;){if(oe.return===null||oe.return===n)break e;ue===oe&&(ue=null),oe=oe.return}ue===oe&&(ue=null),oe.sibling.return=oe.return,oe=oe.sibling}}break;case 19:Oi(o,n),oo(n),f&4&&Q_(n);break;case 21:break;default:Oi(o,n),oo(n)}}function oo(n){var o=n.flags;if(o&2){try{e:{for(var l=n.return;l!==null;){if(h0(l)){var f=l;break e}l=l.return}throw Error(Pe(160))}switch(f.tag){case 5:var _=f.stateNode;f.flags&32&&(Yu(_,""),f.flags&=-33);var w=J_(n);wm(n,w,_);break;case 3:case 4:var I=f.stateNode.containerInfo,u=J_(n);xm(n,u,I);break;default:throw Error(Pe(161))}}catch(N){In(n,n.return,N)}n.flags&=-3}o&4096&&(n.flags&=-4097)}function V2(n,o,l){rt=n,f0(n)}function f0(n,o,l){for(var f=(n.mode&1)!==0;rt!==null;){var _=rt,w=_.child;if(_.tag===22&&f){var I=_.memoizedState!==null||jh;if(!I){var u=_.alternate,N=u!==null&&u.memoizedState!==null||Tr;u=jh;var q=Tr;if(jh=I,(Tr=N)&&!q)for(rt=_;rt!==null;)I=rt,N=I.child,I.tag===22&&I.memoizedState!==null?nv(_):N!==null?(N.return=I,rt=N):nv(_);for(;w!==null;)rt=w,f0(w),w=w.sibling;rt=_,jh=u,Tr=q}ev(n)}else _.subtreeFlags&8772&&w!==null?(w.return=_,rt=w):ev(n)}}function ev(n){for(;rt!==null;){var o=rt;if(o.flags&8772){var l=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:Tr||Ud(5,o);break;case 1:var f=o.stateNode;if(o.flags&4&&!Tr)if(l===null)f.componentDidMount();else{var _=o.elementType===o.type?l.memoizedProps:Ni(o.type,l.memoizedProps);f.componentDidUpdate(_,l.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var w=o.updateQueue;w!==null&&F_(o,w,f);break;case 3:var I=o.updateQueue;if(I!==null){if(l=null,o.child!==null)switch(o.child.tag){case 5:l=o.child.stateNode;break;case 1:l=o.child.stateNode}F_(o,I,l)}break;case 5:var u=o.stateNode;if(l===null&&o.flags&4){l=u;var N=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":N.autoFocus&&l.focus();break;case"img":N.src&&(l.src=N.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var q=o.alternate;if(q!==null){var ue=q.memoizedState;if(ue!==null){var oe=ue.dehydrated;oe!==null&&tc(oe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Pe(163))}Tr||o.flags&512&&vm(o)}catch(Z){In(o,o.return,Z)}}if(o===n){rt=null;break}if(l=o.sibling,l!==null){l.return=o.return,rt=l;break}rt=o.return}}function tv(n){for(;rt!==null;){var o=rt;if(o===n){rt=null;break}var l=o.sibling;if(l!==null){l.return=o.return,rt=l;break}rt=o.return}}function nv(n){for(;rt!==null;){var o=rt;try{switch(o.tag){case 0:case 11:case 15:var l=o.return;try{Ud(4,o)}catch(N){In(o,l,N)}break;case 1:var f=o.stateNode;if(typeof f.componentDidMount=="function"){var _=o.return;try{f.componentDidMount()}catch(N){In(o,_,N)}}var w=o.return;try{vm(o)}catch(N){In(o,w,N)}break;case 5:var I=o.return;try{vm(o)}catch(N){In(o,I,N)}}}catch(N){In(o,o.return,N)}if(o===n){rt=null;break}var u=o.sibling;if(u!==null){u.return=o.return,rt=u;break}rt=o.return}}var $2=Math.ceil,kd=Uo.ReactCurrentDispatcher,yg=Uo.ReactCurrentOwner,Ci=Uo.ReactCurrentBatchConfig,Nt=0,sr=null,Zn=null,mr=0,ci=0,ul=zs(0),Jn=0,dc=null,ga=0,Vd=0,_g=0,qu=null,Hr=null,vg=0,bl=1/0,zo=null,Cd=!1,bm=null,bs=null,Gh=!1,ms=null,Id=0,Wu=0,Em=null,id=-1,od=0;function Vr(){return Nt&6?Ln():id!==-1?id:id=Ln()}function Es(n){return n.mode&1?Nt&2&&mr!==0?mr&-mr:T2.transition!==null?(od===0&&(od=Yv()),od):(n=Kt,n!==0||(n=window.event,n=n===void 0?16:ix(n.type)),n):1}function Gi(n,o,l,f){if(50<Wu)throw Wu=0,Em=null,Error(Pe(185));gc(n,l,f),(!(Nt&2)||n!==sr)&&(n===sr&&(!(Nt&2)&&(Vd|=l),Jn===4&&ds(n,mr)),Qr(n,f),l===1&&Nt===0&&!(o.mode&1)&&(bl=Ln()+500,Fd&&As()))}function Qr(n,o){var l=n.callbackNode;Tb(n,o);var f=hd(n,n===sr?mr:0);if(f===0)l!==null&&h_(l),n.callbackNode=null,n.callbackPriority=0;else if(o=f&-f,n.callbackPriority!==o){if(l!=null&&h_(l),o===1)n.tag===0?S2(rv.bind(null,n)):Ex(rv.bind(null,n)),x2(function(){!(Nt&6)&&As()}),l=null;else{switch(Jv(f)){case 1:l=Zm;break;case 4:l=Hv;break;case 16:l=cd;break;case 536870912:l=Kv;break;default:l=cd}l=b0(l,m0.bind(null,n))}n.callbackPriority=o,n.callbackNode=l}}function m0(n,o){if(id=-1,od=0,Nt&6)throw Error(Pe(327));var l=n.callbackNode;if(ml()&&n.callbackNode!==l)return null;var f=hd(n,n===sr?mr:0);if(f===0)return null;if(f&30||f&n.expiredLanes||o)o=zd(n,f);else{o=f;var _=Nt;Nt|=2;var w=y0();(sr!==n||mr!==o)&&(zo=null,bl=Ln()+500,ha(n,o));do try{Z2();break}catch(u){g0(n,u)}while(1);ig(),kd.current=w,Nt=_,Zn!==null?o=0:(sr=null,mr=0,o=Jn)}if(o!==0){if(o===2&&(_=Kf(n),_!==0&&(f=_,o=Sm(n,_))),o===1)throw l=dc,ha(n,0),ds(n,f),Qr(n,Ln()),l;if(o===6)ds(n,f);else{if(_=n.current.alternate,!(f&30)&&!j2(_)&&(o=zd(n,f),o===2&&(w=Kf(n),w!==0&&(f=w,o=Sm(n,w))),o===1))throw l=dc,ha(n,0),ds(n,f),Qr(n,Ln()),l;switch(n.finishedWork=_,n.finishedLanes=f,o){case 0:case 1:throw Error(Pe(345));case 2:aa(n,Hr,zo);break;case 3:if(ds(n,f),(f&130023424)===f&&(o=vg+500-Ln(),10<o)){if(hd(n,0)!==0)break;if(_=n.suspendedLanes,(_&f)!==f){Vr(),n.pingedLanes|=n.suspendedLanes&_;break}n.timeoutHandle=im(aa.bind(null,n,Hr,zo),o);break}aa(n,Hr,zo);break;case 4:if(ds(n,f),(f&4194240)===f)break;for(o=n.eventTimes,_=-1;0<f;){var I=31-ji(f);w=1<<I,I=o[I],I>_&&(_=I),f&=~w}if(f=_,f=Ln()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*$2(f/1960))-f,10<f){n.timeoutHandle=im(aa.bind(null,n,Hr,zo),f);break}aa(n,Hr,zo);break;case 5:aa(n,Hr,zo);break;default:throw Error(Pe(329))}}}return Qr(n,Ln()),n.callbackNode===l?m0.bind(null,n):null}function Sm(n,o){var l=qu;return n.current.memoizedState.isDehydrated&&(ha(n,o).flags|=256),n=zd(n,o),n!==2&&(o=Hr,Hr=l,o!==null&&Tm(o)),n}function Tm(n){Hr===null?Hr=n:Hr.push.apply(Hr,n)}function j2(n){for(var o=n;;){if(o.flags&16384){var l=o.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var f=0;f<l.length;f++){var _=l[f],w=_.getSnapshot;_=_.value;try{if(!Zi(w(),_))return!1}catch{return!1}}}if(l=o.child,o.subtreeFlags&16384&&l!==null)l.return=o,o=l;else{if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ds(n,o){for(o&=~_g,o&=~Vd,n.suspendedLanes|=o,n.pingedLanes&=~o,n=n.expirationTimes;0<o;){var l=31-ji(o),f=1<<l;n[l]=-1,o&=~f}}function rv(n){if(Nt&6)throw Error(Pe(327));ml();var o=hd(n,0);if(!(o&1))return Qr(n,Ln()),null;var l=zd(n,o);if(n.tag!==0&&l===2){var f=Kf(n);f!==0&&(o=f,l=Sm(n,f))}if(l===1)throw l=dc,ha(n,0),ds(n,o),Qr(n,Ln()),l;if(l===6)throw Error(Pe(345));return n.finishedWork=n.current.alternate,n.finishedLanes=o,aa(n,Hr,zo),Qr(n,Ln()),null}function xg(n,o){var l=Nt;Nt|=1;try{return n(o)}finally{Nt=l,Nt===0&&(bl=Ln()+500,Fd&&As())}}function ya(n){ms!==null&&ms.tag===0&&!(Nt&6)&&ml();var o=Nt;Nt|=1;var l=Ci.transition,f=Kt;try{if(Ci.transition=null,Kt=1,n)return n()}finally{Kt=f,Ci.transition=l,Nt=o,!(Nt&6)&&As()}}function wg(){ci=ul.current,dn(ul)}function ha(n,o){n.finishedWork=null,n.finishedLanes=0;var l=n.timeoutHandle;if(l!==-1&&(n.timeoutHandle=-1,v2(l)),Zn!==null)for(l=Zn.return;l!==null;){var f=l;switch(tg(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&gd();break;case 3:xl(),dn(Yr),dn(kr),cg();break;case 5:ug(f);break;case 4:xl();break;case 13:dn(yn);break;case 19:dn(yn);break;case 10:og(f.type._context);break;case 22:case 23:wg()}l=l.return}if(sr=n,Zn=n=Ss(n.current,null),mr=ci=o,Jn=0,dc=null,_g=Vd=ga=0,Hr=qu=null,ua!==null){for(o=0;o<ua.length;o++)if(l=ua[o],f=l.interleaved,f!==null){l.interleaved=null;var _=f.next,w=l.pending;if(w!==null){var I=w.next;w.next=_,f.next=I}l.pending=f}ua=null}return n}function g0(n,o){do{var l=Zn;try{if(ig(),td.current=Td,Sd){for(var f=_n.memoizedState;f!==null;){var _=f.queue;_!==null&&(_.pending=null),f=f.next}Sd=!1}if(ma=0,or=Yn=_n=null,Gu=!1,uc=0,yg.current=null,l===null||l.return===null){Jn=1,dc=o,Zn=null;break}e:{var w=n,I=l.return,u=l,N=o;if(o=mr,u.flags|=32768,N!==null&&typeof N=="object"&&typeof N.then=="function"){var q=N,ue=u,oe=ue.tag;if(!(ue.mode&1)&&(oe===0||oe===11||oe===15)){var Z=ue.alternate;Z?(ue.updateQueue=Z.updateQueue,ue.memoizedState=Z.memoizedState,ue.lanes=Z.lanes):(ue.updateQueue=null,ue.memoizedState=null)}var ze=G_(I);if(ze!==null){ze.flags&=-257,Z_(ze,I,u,w,o),ze.mode&1&&j_(w,q,o),o=ze,N=q;var Ie=o.updateQueue;if(Ie===null){var ke=new Set;ke.add(N),o.updateQueue=ke}else Ie.add(N);break e}else{if(!(o&1)){j_(w,q,o),bg();break e}N=Error(Pe(426))}}else if(mn&&u.mode&1){var Xe=G_(I);if(Xe!==null){!(Xe.flags&65536)&&(Xe.flags|=256),Z_(Xe,I,u,w,o),ng(wl(N,u));break e}}w=N=wl(N,u),Jn!==4&&(Jn=2),qu===null?qu=[w]:qu.push(w),w=I;do{switch(w.tag){case 3:w.flags|=65536,o&=-o,w.lanes|=o;var se=Qx(w,N,o);B_(w,se);break e;case 1:u=N;var Q=w.type,ae=w.stateNode;if(!(w.flags&128)&&(typeof Q.getDerivedStateFromError=="function"||ae!==null&&typeof ae.componentDidCatch=="function"&&(bs===null||!bs.has(ae)))){w.flags|=65536,o&=-o,w.lanes|=o;var Se=e0(w,u,o);B_(w,Se);break e}}w=w.return}while(w!==null)}v0(l)}catch(Ae){o=Ae,Zn===l&&l!==null&&(Zn=l=l.return);continue}break}while(1)}function y0(){var n=kd.current;return kd.current=Td,n===null?Td:n}function bg(){(Jn===0||Jn===3||Jn===2)&&(Jn=4),sr===null||!(ga&268435455)&&!(Vd&268435455)||ds(sr,mr)}function zd(n,o){var l=Nt;Nt|=2;var f=y0();(sr!==n||mr!==o)&&(zo=null,ha(n,o));do try{G2();break}catch(_){g0(n,_)}while(1);if(ig(),Nt=l,kd.current=f,Zn!==null)throw Error(Pe(261));return sr=null,mr=0,Jn}function G2(){for(;Zn!==null;)_0(Zn)}function Z2(){for(;Zn!==null&&!gb();)_0(Zn)}function _0(n){var o=w0(n.alternate,n,ci);n.memoizedProps=n.pendingProps,o===null?v0(n):Zn=o,yg.current=null}function v0(n){var o=n;do{var l=o.alternate;if(n=o.return,o.flags&32768){if(l=O2(l,o),l!==null){l.flags&=32767,Zn=l;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Jn=6,Zn=null;return}}else if(l=F2(l,o,ci),l!==null){Zn=l;return}if(o=o.sibling,o!==null){Zn=o;return}Zn=o=n}while(o!==null);Jn===0&&(Jn=5)}function aa(n,o,l){var f=Kt,_=Ci.transition;try{Ci.transition=null,Kt=1,q2(n,o,l,f)}finally{Ci.transition=_,Kt=f}return null}function q2(n,o,l,f){do ml();while(ms!==null);if(Nt&6)throw Error(Pe(327));l=n.finishedWork;var _=n.finishedLanes;if(l===null)return null;if(n.finishedWork=null,n.finishedLanes=0,l===n.current)throw Error(Pe(177));n.callbackNode=null,n.callbackPriority=0;var w=l.lanes|l.childLanes;if(kb(n,w),n===sr&&(Zn=sr=null,mr=0),!(l.subtreeFlags&2064)&&!(l.flags&2064)||Gh||(Gh=!0,b0(cd,function(){return ml(),null})),w=(l.flags&15990)!==0,l.subtreeFlags&15990||w){w=Ci.transition,Ci.transition=null;var I=Kt;Kt=1;var u=Nt;Nt|=4,yg.current=null,U2(n,l),p0(l,n),d2(nm),dd=!!tm,nm=tm=null,n.current=l,V2(l),yb(),Nt=u,Kt=I,Ci.transition=w}else n.current=l;if(Gh&&(Gh=!1,ms=n,Id=_),w=n.pendingLanes,w===0&&(bs=null),xb(l.stateNode),Qr(n,Ln()),o!==null)for(f=n.onRecoverableError,l=0;l<o.length;l++)_=o[l],f(_.value,{componentStack:_.stack,digest:_.digest});if(Cd)throw Cd=!1,n=bm,bm=null,n;return Id&1&&n.tag!==0&&ml(),w=n.pendingLanes,w&1?n===Em?Wu++:(Wu=0,Em=n):Wu=0,As(),null}function ml(){if(ms!==null){var n=Jv(Id),o=Ci.transition,l=Kt;try{if(Ci.transition=null,Kt=16>n?16:n,ms===null)var f=!1;else{if(n=ms,ms=null,Id=0,Nt&6)throw Error(Pe(331));var _=Nt;for(Nt|=4,rt=n.current;rt!==null;){var w=rt,I=w.child;if(rt.flags&16){var u=w.deletions;if(u!==null){for(var N=0;N<u.length;N++){var q=u[N];for(rt=q;rt!==null;){var ue=rt;switch(ue.tag){case 0:case 11:case 15:Zu(8,ue,w)}var oe=ue.child;if(oe!==null)oe.return=ue,rt=oe;else for(;rt!==null;){ue=rt;var Z=ue.sibling,ze=ue.return;if(c0(ue),ue===q){rt=null;break}if(Z!==null){Z.return=ze,rt=Z;break}rt=ze}}}var Ie=w.alternate;if(Ie!==null){var ke=Ie.child;if(ke!==null){Ie.child=null;do{var Xe=ke.sibling;ke.sibling=null,ke=Xe}while(ke!==null)}}rt=w}}if(w.subtreeFlags&2064&&I!==null)I.return=w,rt=I;else e:for(;rt!==null;){if(w=rt,w.flags&2048)switch(w.tag){case 0:case 11:case 15:Zu(9,w,w.return)}var se=w.sibling;if(se!==null){se.return=w.return,rt=se;break e}rt=w.return}}var Q=n.current;for(rt=Q;rt!==null;){I=rt;var ae=I.child;if(I.subtreeFlags&2064&&ae!==null)ae.return=I,rt=ae;else e:for(I=Q;rt!==null;){if(u=rt,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Ud(9,u)}}catch(Ae){In(u,u.return,Ae)}if(u===I){rt=null;break e}var Se=u.sibling;if(Se!==null){Se.return=u.return,rt=Se;break e}rt=u.return}}if(Nt=_,As(),lo&&typeof lo.onPostCommitFiberRoot=="function")try{lo.onPostCommitFiberRoot(Pd,n)}catch{}f=!0}return f}finally{Kt=l,Ci.transition=o}}return!1}function iv(n,o,l){o=wl(l,o),o=Qx(n,o,1),n=ws(n,o,1),o=Vr(),n!==null&&(gc(n,1,o),Qr(n,o))}function In(n,o,l){if(n.tag===3)iv(n,n,l);else for(;o!==null;){if(o.tag===3){iv(o,n,l);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(bs===null||!bs.has(f))){n=wl(l,n),n=e0(o,n,1),o=ws(o,n,1),n=Vr(),o!==null&&(gc(o,1,n),Qr(o,n));break}}o=o.return}}function W2(n,o,l){var f=n.pingCache;f!==null&&f.delete(o),o=Vr(),n.pingedLanes|=n.suspendedLanes&l,sr===n&&(mr&l)===l&&(Jn===4||Jn===3&&(mr&130023424)===mr&&500>Ln()-vg?ha(n,0):_g|=l),Qr(n,o)}function x0(n,o){o===0&&(n.mode&1?(o=Lh,Lh<<=1,!(Lh&130023424)&&(Lh=4194304)):o=1);var l=Vr();n=Oo(n,o),n!==null&&(gc(n,o,l),Qr(n,l))}function X2(n){var o=n.memoizedState,l=0;o!==null&&(l=o.retryLane),x0(n,l)}function H2(n,o){var l=0;switch(n.tag){case 13:var f=n.stateNode,_=n.memoizedState;_!==null&&(l=_.retryLane);break;case 19:f=n.stateNode;break;default:throw Error(Pe(314))}f!==null&&f.delete(o),x0(n,l)}var w0;w0=function(n,o,l){if(n!==null)if(n.memoizedProps!==o.pendingProps||Yr.current)Kr=!0;else{if(!(n.lanes&l)&&!(o.flags&128))return Kr=!1,B2(n,o,l);Kr=!!(n.flags&131072)}else Kr=!1,mn&&o.flags&1048576&&Sx(o,vd,o.index);switch(o.lanes=0,o.tag){case 2:var f=o.type;rd(n,o),n=o.pendingProps;var _=yl(o,kr.current);fl(o,l),_=dg(null,o,f,n,_,l);var w=pg();return o.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Jr(f)?(w=!0,yd(o)):w=!1,o.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,ag(o),_.updater=Od,o.stateNode=_,_._reactInternals=o,hm(o,f,n,l),o=fm(null,o,f,!0,w,l)):(o.tag=0,mn&&w&&eg(o),Ur(null,o,_,l),o=o.child),o;case 16:f=o.elementType;e:{switch(rd(n,o),n=o.pendingProps,_=f._init,f=_(f._payload),o.type=f,_=o.tag=Y2(f),n=Ni(f,n),_){case 0:o=pm(null,o,f,n,l);break e;case 1:o=X_(null,o,f,n,l);break e;case 11:o=q_(null,o,f,n,l);break e;case 14:o=W_(null,o,f,Ni(f.type,n),l);break e}throw Error(Pe(306,f,""))}return o;case 0:return f=o.type,_=o.pendingProps,_=o.elementType===f?_:Ni(f,_),pm(n,o,f,_,l);case 1:return f=o.type,_=o.pendingProps,_=o.elementType===f?_:Ni(f,_),X_(n,o,f,_,l);case 3:e:{if(i0(o),n===null)throw Error(Pe(387));f=o.pendingProps,w=o.memoizedState,_=w.element,Ix(n,o),bd(o,f,null,l);var I=o.memoizedState;if(f=I.element,w.isDehydrated)if(w={element:f,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},o.updateQueue.baseState=w,o.memoizedState=w,o.flags&256){_=wl(Error(Pe(423)),o),o=H_(n,o,f,l,_);break e}else if(f!==_){_=wl(Error(Pe(424)),o),o=H_(n,o,f,l,_);break e}else for(hi=xs(o.stateNode.containerInfo.firstChild),di=o,mn=!0,Vi=null,l=Px(o,null,f,l),o.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(_l(),f===_){o=No(n,o,l);break e}Ur(n,o,f,l)}o=o.child}return o;case 5:return Dx(o),n===null&&lm(o),f=o.type,_=o.pendingProps,w=n!==null?n.memoizedProps:null,I=_.children,rm(f,_)?I=null:w!==null&&rm(f,w)&&(o.flags|=32),r0(n,o),Ur(n,o,I,l),o.child;case 6:return n===null&&lm(o),null;case 13:return o0(n,o,l);case 4:return lg(o,o.stateNode.containerInfo),f=o.pendingProps,n===null?o.child=vl(o,null,f,l):Ur(n,o,f,l),o.child;case 11:return f=o.type,_=o.pendingProps,_=o.elementType===f?_:Ni(f,_),q_(n,o,f,_,l);case 7:return Ur(n,o,o.pendingProps,l),o.child;case 8:return Ur(n,o,o.pendingProps.children,l),o.child;case 12:return Ur(n,o,o.pendingProps.children,l),o.child;case 10:e:{if(f=o.type._context,_=o.pendingProps,w=o.memoizedProps,I=_.value,un(xd,f._currentValue),f._currentValue=I,w!==null)if(Zi(w.value,I)){if(w.children===_.children&&!Yr.current){o=No(n,o,l);break e}}else for(w=o.child,w!==null&&(w.return=o);w!==null;){var u=w.dependencies;if(u!==null){I=w.child;for(var N=u.firstContext;N!==null;){if(N.context===f){if(w.tag===1){N=Ro(-1,l&-l),N.tag=2;var q=w.updateQueue;if(q!==null){q=q.shared;var ue=q.pending;ue===null?N.next=N:(N.next=ue.next,ue.next=N),q.pending=N}}w.lanes|=l,N=w.alternate,N!==null&&(N.lanes|=l),um(w.return,l,o),u.lanes|=l;break}N=N.next}}else if(w.tag===10)I=w.type===o.type?null:w.child;else if(w.tag===18){if(I=w.return,I===null)throw Error(Pe(341));I.lanes|=l,u=I.alternate,u!==null&&(u.lanes|=l),um(I,l,o),I=w.sibling}else I=w.child;if(I!==null)I.return=w;else for(I=w;I!==null;){if(I===o){I=null;break}if(w=I.sibling,w!==null){w.return=I.return,I=w;break}I=I.return}w=I}Ur(n,o,_.children,l),o=o.child}return o;case 9:return _=o.type,f=o.pendingProps.children,fl(o,l),_=Ii(_),f=f(_),o.flags|=1,Ur(n,o,f,l),o.child;case 14:return f=o.type,_=Ni(f,o.pendingProps),_=Ni(f.type,_),W_(n,o,f,_,l);case 15:return t0(n,o,o.type,o.pendingProps,l);case 17:return f=o.type,_=o.pendingProps,_=o.elementType===f?_:Ni(f,_),rd(n,o),o.tag=1,Jr(f)?(n=!0,yd(o)):n=!1,fl(o,l),Ax(o,f,_),hm(o,f,_,l),fm(null,o,f,!0,n,l);case 19:return s0(n,o,l);case 22:return n0(n,o,l)}throw Error(Pe(156,o.tag))};function b0(n,o){return Xv(n,o)}function K2(n,o,l,f){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ki(n,o,l,f){return new K2(n,o,l,f)}function Eg(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Y2(n){if(typeof n=="function")return Eg(n)?1:0;if(n!=null){if(n=n.$$typeof,n===$m)return 11;if(n===jm)return 14}return 2}function Ss(n,o){var l=n.alternate;return l===null?(l=ki(n.tag,o,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=o,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&14680064,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,o=n.dependencies,l.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l}function sd(n,o,l,f,_,w){var I=2;if(f=n,typeof n=="function")Eg(n)&&(I=1);else if(typeof n=="string")I=5;else e:switch(n){case Qa:return da(l.children,_,w,o);case Vm:I=8,_|=8;break;case Rf:return n=ki(12,l,o,_|2),n.elementType=Rf,n.lanes=w,n;case Bf:return n=ki(13,l,o,_),n.elementType=Bf,n.lanes=w,n;case Ff:return n=ki(19,l,o,_),n.elementType=Ff,n.lanes=w,n;case Mv:return $d(l,_,w,o);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case zv:I=10;break e;case Av:I=9;break e;case $m:I=11;break e;case jm:I=14;break e;case us:I=16,f=null;break e}throw Error(Pe(130,n==null?n:typeof n,""))}return o=ki(I,l,o,_),o.elementType=n,o.type=f,o.lanes=w,o}function da(n,o,l,f){return n=ki(7,n,f,o),n.lanes=l,n}function $d(n,o,l,f){return n=ki(22,n,f,o),n.elementType=Mv,n.lanes=l,n.stateNode={isHidden:!1},n}function Ef(n,o,l){return n=ki(6,n,null,o),n.lanes=l,n}function Sf(n,o,l){return o=ki(4,n.children!==null?n.children:[],n.key,o),o.lanes=l,o.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},o}function J2(n,o,l,f,_){this.tag=o,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rf(0),this.expirationTimes=rf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rf(0),this.identifierPrefix=f,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function Sg(n,o,l,f,_,w,I,u,N){return n=new J2(n,o,l,u,N),o===1?(o=1,w===!0&&(o|=8)):o=0,w=ki(3,null,null,o),n.current=w,w.stateNode=n,w.memoizedState={element:f,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},ag(w),n}function Q2(n,o,l){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ja,key:f==null?null:""+f,children:n,containerInfo:o,implementation:l}}function E0(n){if(!n)return ks;n=n._reactInternals;e:{if(va(n)!==n||n.tag!==1)throw Error(Pe(170));var o=n;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Jr(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(Pe(171))}if(n.tag===1){var l=n.type;if(Jr(l))return bx(n,l,o)}return o}function S0(n,o,l,f,_,w,I,u,N){return n=Sg(l,f,!0,n,_,w,I,u,N),n.context=E0(null),l=n.current,f=Vr(),_=Es(l),w=Ro(f,_),w.callback=o??null,ws(l,w,_),n.current.lanes=_,gc(n,_,f),Qr(n,f),n}function jd(n,o,l,f){var _=o.current,w=Vr(),I=Es(_);return l=E0(l),o.context===null?o.context=l:o.pendingContext=l,o=Ro(w,I),o.payload={element:n},f=f===void 0?null:f,f!==null&&(o.callback=f),n=ws(_,o,I),n!==null&&(Gi(n,_,I,w),ed(n,_,I)),I}function Ad(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function ov(n,o){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<o?l:o}}function Tg(n,o){ov(n,o),(n=n.alternate)&&ov(n,o)}function eE(){return null}var T0=typeof reportError=="function"?reportError:function(n){console.error(n)};function kg(n){this._internalRoot=n}Gd.prototype.render=kg.prototype.render=function(n){var o=this._internalRoot;if(o===null)throw Error(Pe(409));jd(n,o,null,null)};Gd.prototype.unmount=kg.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var o=n.containerInfo;ya(function(){jd(null,n,null,null)}),o[Fo]=null}};function Gd(n){this._internalRoot=n}Gd.prototype.unstable_scheduleHydration=function(n){if(n){var o=tx();n={blockedOn:null,target:n,priority:o};for(var l=0;l<hs.length&&o!==0&&o<hs[l].priority;l++);hs.splice(l,0,n),l===0&&rx(n)}};function Cg(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Zd(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function sv(){}function tE(n,o,l,f,_){if(_){if(typeof f=="function"){var w=f;f=function(){var q=Ad(I);w.call(q)}}var I=S0(o,f,n,0,null,!1,!1,"",sv);return n._reactRootContainer=I,n[Fo]=I.current,ic(n.nodeType===8?n.parentNode:n),ya(),I}for(;_=n.lastChild;)n.removeChild(_);if(typeof f=="function"){var u=f;f=function(){var q=Ad(N);u.call(q)}}var N=Sg(n,0,!1,null,null,!1,!1,"",sv);return n._reactRootContainer=N,n[Fo]=N.current,ic(n.nodeType===8?n.parentNode:n),ya(function(){jd(o,N,l,f)}),N}function qd(n,o,l,f,_){var w=l._reactRootContainer;if(w){var I=w;if(typeof _=="function"){var u=_;_=function(){var N=Ad(I);u.call(N)}}jd(o,I,n,_)}else I=tE(l,o,n,_,f);return Ad(I)}Qv=function(n){switch(n.tag){case 3:var o=n.stateNode;if(o.current.memoizedState.isDehydrated){var l=Fu(o.pendingLanes);l!==0&&(qm(o,l|1),Qr(o,Ln()),!(Nt&6)&&(bl=Ln()+500,As()))}break;case 13:ya(function(){var f=Oo(n,1);if(f!==null){var _=Vr();Gi(f,n,1,_)}}),Tg(n,1)}};Wm=function(n){if(n.tag===13){var o=Oo(n,134217728);if(o!==null){var l=Vr();Gi(o,n,134217728,l)}Tg(n,134217728)}};ex=function(n){if(n.tag===13){var o=Es(n),l=Oo(n,o);if(l!==null){var f=Vr();Gi(l,n,o,f)}Tg(n,o)}};tx=function(){return Kt};nx=function(n,o){var l=Kt;try{return Kt=n,o()}finally{Kt=l}};Wf=function(n,o,l){switch(o){case"input":if(Uf(n,l),o=l.name,l.type==="radio"&&o!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<l.length;o++){var f=l[o];if(f!==n&&f.form===n.form){var _=Bd(f);if(!_)throw Error(Pe(90));Dv(f),Uf(f,_)}}}break;case"textarea":Rv(n,l);break;case"select":o=l.value,o!=null&&cl(n,!!l.multiple,o,!1)}};$v=xg;jv=ya;var nE={usingClientEntryPoint:!1,Events:[_c,rl,Bd,Uv,Vv,xg]},Pu={findFiberByHostInstance:la,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rE={bundleType:Pu.bundleType,version:Pu.version,rendererPackageName:Pu.rendererPackageName,rendererConfig:Pu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Uo.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=qv(n),n===null?null:n.stateNode},findFiberByHostInstance:Pu.findFiberByHostInstance||eE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zh.isDisabled&&Zh.supportsFiber)try{Pd=Zh.inject(rE),lo=Zh}catch{}}fi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nE;fi.createPortal=function(n,o){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cg(o))throw Error(Pe(200));return Q2(n,o,null,l)};fi.createRoot=function(n,o){if(!Cg(n))throw Error(Pe(299));var l=!1,f="",_=T0;return o!=null&&(o.unstable_strictMode===!0&&(l=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onRecoverableError!==void 0&&(_=o.onRecoverableError)),o=Sg(n,1,!1,null,null,l,!1,f,_),n[Fo]=o.current,ic(n.nodeType===8?n.parentNode:n),new kg(o)};fi.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var o=n._reactInternals;if(o===void 0)throw typeof n.render=="function"?Error(Pe(188)):(n=Object.keys(n).join(","),Error(Pe(268,n)));return n=qv(o),n=n===null?null:n.stateNode,n};fi.flushSync=function(n){return ya(n)};fi.hydrate=function(n,o,l){if(!Zd(o))throw Error(Pe(200));return qd(null,n,o,!0,l)};fi.hydrateRoot=function(n,o,l){if(!Cg(n))throw Error(Pe(405));var f=l!=null&&l.hydratedSources||null,_=!1,w="",I=T0;if(l!=null&&(l.unstable_strictMode===!0&&(_=!0),l.identifierPrefix!==void 0&&(w=l.identifierPrefix),l.onRecoverableError!==void 0&&(I=l.onRecoverableError)),o=S0(o,null,n,1,l??null,_,!1,w,I),n[Fo]=o.current,ic(n),f)for(n=0;n<f.length;n++)l=f[n],_=l._getVersion,_=_(l._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[l,_]:o.mutableSourceEagerHydrationData.push(l,_);return new Gd(o)};fi.render=function(n,o,l){if(!Zd(o))throw Error(Pe(200));return qd(null,n,o,!1,l)};fi.unmountComponentAtNode=function(n){if(!Zd(n))throw Error(Pe(40));return n._reactRootContainer?(ya(function(){qd(null,null,n,!1,function(){n._reactRootContainer=null,n[Fo]=null})}),!0):!1};fi.unstable_batchedUpdates=xg;fi.unstable_renderSubtreeIntoContainer=function(n,o,l,f){if(!Zd(l))throw Error(Pe(200));if(n==null||n._reactInternals===void 0)throw Error(Pe(38));return qd(n,o,l,!1,f)};fi.version="18.2.0-next-9e3b772b8-20220608";(function(n){function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(l){console.error(l)}}o(),n.exports=fi})(eb);var av=Hu;Pf.createRoot=av.createRoot,Pf.hydrateRoot=av.hydrateRoot;const iE="modulepreload",oE=function(n){return"/avatar-on-maps-poc/"+n},lv={},sE=function(o,l,f){if(!l||l.length===0)return o();const _=document.getElementsByTagName("link");return Promise.all(l.map(w=>{if(w=oE(w),w in lv)return;lv[w]=!0;const I=w.endsWith(".css"),u=I?'[rel="stylesheet"]':"";if(!!f)for(let ue=_.length-1;ue>=0;ue--){const oe=_[ue];if(oe.href===w&&(!I||oe.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${w}"]${u}`))return;const q=document.createElement("link");if(q.rel=I?"stylesheet":iE,I||(q.as="script",q.crossOrigin=""),q.href=w,document.head.appendChild(q),I)return new Promise((ue,oe)=>{q.addEventListener("load",ue),q.addEventListener("error",()=>oe(new Error(`Unable to preload CSS for ${w}`)))})})).then(()=>o())},k0=Qe.createContext(null);function aE(){var n;const o=(n=Qe.useContext(k0))===null||n===void 0?void 0:n.maps,l=Qe.useContext(xc);return Qe.useMemo(()=>({...o,current:l==null?void 0:l.map}),[o,l])}function lE(n){const o=n.clone();return o.pixelsToGLUnits=n.pixelsToGLUnits,o}function uv(n){return{longitude:n.center.lng,latitude:n.center.lat,zoom:n.zoom,pitch:n.pitch,bearing:n.bearing,padding:n.padding}}function cv(n,o){const l=o.viewState||o;let f=!1;if("longitude"in l&&"latitude"in l){const _=n.center;n.center=new _.constructor(l.longitude,l.latitude),f=f||_!==n.center}if("zoom"in l){const _=n.zoom;n.zoom=l.zoom,f=f||_!==n.zoom}if("bearing"in l){const _=n.bearing;n.bearing=l.bearing,f=f||_!==n.bearing}if("pitch"in l){const _=n.pitch;n.pitch=l.pitch,f=f||_!==n.pitch}return l.padding&&!n.isPaddingEqual(l.padding)&&(f=!0,n.padding=l.padding),f}const uE=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function hv(n){if(!n)return null;if(typeof n=="string"||("toJS"in n&&(n=n.toJS()),!n.layers))return n;const o={};for(const f of n.layers)o[f.id]=f;const l=n.layers.map(f=>{const _=o[f.ref];let w=null;if("interactive"in f&&(w={...f},delete w.interactive),_){w=w||{...f},delete w.ref;for(const I of uE)I in _&&(w[I]=_[I])}return w||f});return{...n,layers:l}}function cE(n,o){const l=Array.isArray(n)?n[0]:n?n.x:0,f=Array.isArray(n)?n[1]:n?n.y:0,_=Array.isArray(o)?o[0]:o?o.x:0,w=Array.isArray(o)?o[1]:o?o.y:0;return l===_&&f===w}function ps(n,o){if(n===o)return!0;if(!n||!o)return!1;if(Array.isArray(n)){if(!Array.isArray(o)||n.length!==o.length)return!1;for(let l=0;l<n.length;l++)if(!ps(n[l],o[l]))return!1;return!0}else if(Array.isArray(o))return!1;if(typeof n=="object"&&typeof o=="object"){const l=Object.keys(n),f=Object.keys(o);if(l.length!==f.length)return!1;for(const _ of l)if(!o.hasOwnProperty(_)||!ps(n[_],o[_]))return!1;return!0}return!1}const dv={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Tf={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},pv={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},hE=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],dE=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class El{constructor(o,l,f){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=_=>{const w=this.props[pv[_.type]];w&&w(_)},this._onPointerEvent=_=>{(_.type==="mousemove"||_.type==="mouseout")&&this._updateHover(_);const w=this.props[dv[_.type]];if(w){if(this.props.interactiveLayerIds&&_.type!=="mouseover"&&_.type!=="mouseout"){const I=this._hoveredFeatures||this._map.queryRenderedFeatures(_.point,{layers:this.props.interactiveLayerIds});_.features=I}w(_),delete _.features}},this._onCameraEvent=_=>{if(!this._internalUpdate){const w=this.props[Tf[_.type]];w&&w(_)}_.type in this._deferredEvents&&(this._deferredEvents[_.type]=!1)},this._MapClass=o,this.props=l,this._initialize(f)}get map(){return this._map}get transform(){return this._renderTransform}setProps(o){const l=this.props;this.props=o;const f=this._updateSettings(o,l);f&&this._createShadowTransform(this._map);const _=this._updateSize(o),w=this._updateViewState(o,!0);this._updateStyle(o,l),this._updateStyleComponents(o,l),this._updateHandlers(o,l),(f||_||w&&!this._map.isMoving())&&this.redraw()}static reuse(o,l){const f=El.savedMaps.pop();if(!f)return null;const _=f.map,w=_.getContainer();for(l.className=w.className;w.childNodes.length>0;)l.appendChild(w.childNodes[0]);_._container=l,f.setProps({...o,styleDiffing:!1}),_.resize();const{initialViewState:I}=o;return I&&(I.bounds?_.fitBounds(I.bounds,{...I.fitBoundsOptions,duration:0}):f._updateViewState(I,!1)),_.isStyleLoaded()?_.fire("load"):_.once("styledata",()=>_.fire("load")),f}_initialize(o){const{props:l}=this,f={...l,...l.initialViewState,accessToken:l.mapboxAccessToken||pE()||null,container:o,style:hv(l.mapStyle)},_=f.initialViewState||f.viewState||f;if(Object.assign(f,{center:[_.longitude||0,_.latitude||0],zoom:_.zoom||0,pitch:_.pitch||0,bearing:_.bearing||0}),l.gl){const q=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=q,l.gl)}const w=new this._MapClass(f);_.padding&&w.setPadding(_.padding),l.cursor&&(w.getCanvas().style.cursor=l.cursor),this._createShadowTransform(w);const I=w._render;w._render=q=>{this._inRender=!0,I.call(w,q),this._inRender=!1};const u=w._renderTaskQueue.run;w._renderTaskQueue.run=q=>{u.call(w._renderTaskQueue,q),this._onBeforeRepaint()},w.on("render",()=>this._onAfterRepaint());const N=w.fire;w.fire=this._fireEvent.bind(this,N),w.on("resize",()=>{this._renderTransform.resize(w.transform.width,w.transform.height)}),w.on("styledata",()=>this._updateStyleComponents(this.props,{})),w.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const q in dv)w.on(q,this._onPointerEvent);for(const q in Tf)w.on(q,this._onCameraEvent);for(const q in pv)w.on(q,this._onEvent);this._map=w}recycle(){const l=this.map.getContainer().querySelector("[mapboxgl-children]");l==null||l.remove(),El.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const o=this._map;!this._inRender&&o.style&&(o._frame&&(o._frame.cancel(),o._frame=null),o._render())}_createShadowTransform(o){const l=lE(o.transform);o.painter.transform=l,this._renderTransform=l}_updateSize(o){const{viewState:l}=o;if(l){const f=this._map;if(l.width!==f.transform.width||l.height!==f.transform.height)return f.resize(),!0}return!1}_updateViewState(o,l){if(this._internalUpdate)return!1;const f=this._map,_=this._renderTransform,{zoom:w,pitch:I,bearing:u}=_,N=f.isMoving();N&&(_.cameraElevationReference="sea");const q=cv(_,{...uv(f.transform),...o});if(N&&(_.cameraElevationReference="ground"),q&&l){const ue=this._deferredEvents;ue.move=!0,ue.zoom||(ue.zoom=w!==_.zoom),ue.rotate||(ue.rotate=u!==_.bearing),ue.pitch||(ue.pitch=I!==_.pitch)}return N||cv(f.transform,o),q}_updateSettings(o,l){const f=this._map;let _=!1;for(const w of hE)w in o&&!ps(o[w],l[w])&&(_=!0,f[`set${w[0].toUpperCase()}${w.slice(1)}`](o[w]));return _}_updateStyle(o,l){if(o.cursor!==l.cursor&&(this._map.getCanvas().style.cursor=o.cursor),o.mapStyle!==l.mapStyle){const f={diff:o.styleDiffing};return"localIdeographFontFamily"in o&&(f.localIdeographFontFamily=o.localIdeographFontFamily),this._map.setStyle(hv(o.mapStyle),f),!0}return!1}_updateStyleComponents(o,l){const f=this._map;let _=!1;return f.style.loaded()&&("light"in o&&!ps(o.light,l.light)&&(_=!0,f.setLight(o.light)),"fog"in o&&!ps(o.fog,l.fog)&&(_=!0,f.setFog(o.fog)),"terrain"in o&&!ps(o.terrain,l.terrain)&&(!o.terrain||f.getSource(o.terrain.source))&&(_=!0,f.setTerrain(o.terrain))),_}_updateHandlers(o,l){const f=this._map;let _=!1;for(const w of dE){const I=o[w];ps(I,l[w])||(_=!0,I?f[w].enable(I):f[w].disable())}return _}_updateHover(o){var l;const{props:f}=this;if(f.interactiveLayerIds&&(f.onMouseMove||f.onMouseEnter||f.onMouseLeave)){const w=o.type,I=((l=this._hoveredFeatures)===null||l===void 0?void 0:l.length)>0;let u;if(w==="mousemove")try{u=this._map.queryRenderedFeatures(o.point,{layers:f.interactiveLayerIds})}catch{u=[]}else u=[];const N=u.length>0;!N&&I&&(o.type="mouseleave",this._onPointerEvent(o)),this._hoveredFeatures=u,N&&!I&&(o.type="mouseenter",this._onPointerEvent(o)),o.type=w}else this._hoveredFeatures=null}_fireEvent(o,l,f){const _=this._map,w=_.transform,I=typeof l=="string"?l:l.type;return I==="move"&&this._updateViewState(this.props,!1),I in Tf&&(typeof l=="object"&&(l.viewState=uv(w)),this._map.isMoving())?(_.transform=this._renderTransform,o.call(_,l,f),_.transform=w,_):(o.call(_,l,f),_)}_onBeforeRepaint(){const o=this._map;this._internalUpdate=!0;for(const f in this._deferredEvents)this._deferredEvents[f]&&o.fire(f);this._internalUpdate=!1;const l=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=()=>{this._map.transform=l}}}El.savedMaps=[];function pE(){let n=null;if(typeof location<"u"){const o=/access_token=([^&\/]*)/.exec(location.search);n=o&&o[1]}try{n=n||{}.MapboxAccessToken}catch{}try{n=n||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return n}const fE=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function mE(n,o){if(!n)return null;const l=n.map,f={getMap:()=>l,getCenter:()=>n.transform.center,getZoom:()=>n.transform.zoom,getBearing:()=>n.transform.bearing,getPitch:()=>n.transform.pitch,getPadding:()=>n.transform.padding,getBounds:()=>n.transform.getBounds(),project:_=>n.transform.locationPoint(o.LngLat.convert(_)),unproject:_=>n.transform.pointLocation(o.Point.convert(_)),queryTerrainElevation:(_,w)=>{const I=l.transform;l.transform=n.transform;const u=l.queryTerrainElevation(_,w);return l.transform=I,u}};for(const _ of gE(l))!(_ in f)&&!fE.includes(_)&&(f[_]=l[_].bind(l));return f}function gE(n){const o=new Set;let l=n;for(;l;){for(const f of Object.getOwnPropertyNames(l))f[0]!=="_"&&typeof n[f]=="function"&&f!=="fire"&&f!=="setEventedParent"&&o.add(f);l=Object.getPrototypeOf(l)}return Array.from(o)}const yE=typeof document<"u"?Qe.useLayoutEffect:Qe.useEffect,_E=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function vE(n,o){for(const l of _E)l in o&&(n[l]=o[l]);o.RTLTextPlugin&&n.getRTLTextPluginStatus&&n.getRTLTextPluginStatus()==="unavailable"&&n.setRTLTextPlugin(o.RTLTextPlugin,l=>{l&&console.error(l)},!1)}const xc=Qe.createContext(null),xE={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:n=>console.error(n.error),RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},Ig=Qe.forwardRef((n,o)=>{const l=Qe.useContext(k0),[f,_]=Qe.useState(null),w=Qe.useRef(),{current:I}=Qe.useRef({mapLib:null,map:null});Qe.useEffect(()=>{const N=n.mapLib;let q=!0,ue;return Promise.resolve(N||sE(()=>import("./index-fc2e9253.js").then(oe=>oe.i),[])).then(oe=>{if(q){if(oe.Map||(oe=oe.default),!oe||!oe.Map)throw new Error("Invalid mapLib");if(oe.supported(n))vE(oe,n),n.reuseMaps&&(ue=El.reuse(n,w.current)),ue||(ue=new El(oe.Map,n,w.current)),I.map=mE(ue,oe),I.mapLib=oe,_(ue),l==null||l.onMapMount(I.map,n.id);else throw new Error("Map is not supported by this browser")}}).catch(oe=>{n.onError({type:"error",target:null,originalEvent:null,error:oe})}),()=>{q=!1,ue&&(l==null||l.onMapUnmount(n.id),n.reuseMaps?ue.recycle():ue.destroy())}},[]),yE(()=>{f&&f.setProps(n)}),Qe.useImperativeHandle(o,()=>I.map,[f]);const u=Qe.useMemo(()=>({position:"relative",width:"100%",height:"100%",...n.style}),[n.style]);return Qe.createElement("div",{id:n.id,ref:w,style:u},f&&Qe.createElement(xc.Provider,{value:I},Qe.createElement("div",{"mapboxgl-children":""},n.children)))});Ig.displayName="Map";Ig.defaultProps=xE;const wE=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function xa(n,o){if(!n||!o)return;const l=n.style;for(const f in o){const _=o[f];Number.isFinite(_)&&!wE.test(f)?l[f]=`${_}px`:l[f]=_}}const bE={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"};function C0(n){const{map:o,mapLib:l}=Qe.useContext(xc),f=Qe.useRef({props:n});f.current.props=n;const _=Qe.useMemo(()=>{let w=!1;Qe.Children.forEach(n.children,N=>{N&&(w=!0)});const I={...n,element:w?document.createElement("div"):null},u=new l.Marker(I).setLngLat([n.longitude,n.latitude]);return u.getElement().addEventListener("click",N=>{var q,ue;(ue=(q=f.current.props).onClick)===null||ue===void 0||ue.call(q,{type:"click",target:u,originalEvent:N})}),u.on("dragstart",N=>{var q,ue;const oe=N;oe.lngLat=_.getLngLat(),(ue=(q=f.current.props).onDragStart)===null||ue===void 0||ue.call(q,oe)}),u.on("drag",N=>{var q,ue;const oe=N;oe.lngLat=_.getLngLat(),(ue=(q=f.current.props).onDrag)===null||ue===void 0||ue.call(q,oe)}),u.on("dragend",N=>{var q,ue;const oe=N;oe.lngLat=_.getLngLat(),(ue=(q=f.current.props).onDragEnd)===null||ue===void 0||ue.call(q,oe)}),u},[]);return Qe.useEffect(()=>(_.addTo(o.getMap()),()=>{_.remove()}),[]),Qe.useEffect(()=>{xa(_.getElement(),n.style)},[n.style]),(_.getLngLat().lng!==n.longitude||_.getLngLat().lat!==n.latitude)&&_.setLngLat([n.longitude,n.latitude]),n.offset&&!cE(_.getOffset(),n.offset)&&_.setOffset(n.offset),_.isDraggable()!==n.draggable&&_.setDraggable(n.draggable),_.getRotation()!==n.rotation&&_.setRotation(n.rotation),_.getRotationAlignment()!==n.rotationAlignment&&_.setRotationAlignment(n.rotationAlignment),_.getPitchAlignment()!==n.pitchAlignment&&_.setPitchAlignment(n.pitchAlignment),_.getPopup()!==n.popup&&_.setPopup(n.popup),Hu.createPortal(n.children,_.getElement())}C0.defaultProps=bE;const EE=Qe.memo(C0);function fv(n){return new Set(n?n.trim().split(/\s+/):[])}function SE(n){const{map:o,mapLib:l}=Qe.useContext(xc),f=Qe.useMemo(()=>document.createElement("div"),[]),_=Qe.useRef({props:n});_.current.props=n;const w=Qe.useMemo(()=>{const I={...n},u=new l.Popup(I).setLngLat([n.longitude,n.latitude]);return u.once("open",N=>{var q,ue;(ue=(q=_.current.props).onOpen)===null||ue===void 0||ue.call(q,N)}),u},[]);if(Qe.useEffect(()=>{const I=u=>{var N,q;(q=(N=_.current.props).onClose)===null||q===void 0||q.call(N,u)};return w.on("close",I),w.setDOMContent(f).addTo(o.getMap()),()=>{w.off("close",I),w.isOpen()&&w.remove()}},[]),Qe.useEffect(()=>{xa(w.getElement(),n.style)},[n.style]),w.isOpen()&&((w.getLngLat().lng!==n.longitude||w.getLngLat().lat!==n.latitude)&&w.setLngLat([n.longitude,n.latitude]),n.offset&&!ps(w.options.offset,n.offset)&&w.setOffset(n.offset),(w.options.anchor!==n.anchor||w.options.maxWidth!==n.maxWidth)&&(w.options.anchor=n.anchor,w.setMaxWidth(n.maxWidth)),w.options.className!==n.className)){const I=fv(w.options.className),u=fv(n.className);for(const N of I)u.has(N)||w.removeClassName(N);for(const N of u)I.has(N)||w.addClassName(N);w.options.className=n.className}return Hu.createPortal(n.children,f)}Qe.memo(SE);function wc(n,o,l,f){const _=Qe.useContext(xc),w=Qe.useMemo(()=>n(_),[]);return Qe.useEffect(()=>{const I=f||l||o,u=typeof o=="function"&&typeof l=="function"?o:null,N=typeof l=="function"?l:typeof o=="function"?o:null,{map:q}=_;return q.hasControl(w)||(q.addControl(w,I==null?void 0:I.position),u&&u(_)),()=>{N&&N(_),q.hasControl(w)&&q.removeControl(w)}},[]),w}function TE(n){const o=wc(({mapLib:l})=>new l.AttributionControl(n),{position:n.position});return Qe.useEffect(()=>{xa(o._container,n.style)},[n.style]),null}Qe.memo(TE);function kE(n){const o=wc(({mapLib:l})=>new l.FullscreenControl({container:n.containerId&&document.getElementById(n.containerId)}),{position:n.position});return Qe.useEffect(()=>{xa(o._controlContainer,n.style)},[n.style]),null}Qe.memo(kE);const I0=Qe.forwardRef((n,o)=>{const l=Qe.useRef({props:n}),f=wc(({mapLib:_})=>{const w=new _.GeolocateControl(n),I=w._setupUI;return w._setupUI=u=>{w._container.hasChildNodes()||I(u)},w.on("geolocate",u=>{var N,q;(q=(N=l.current.props).onGeolocate)===null||q===void 0||q.call(N,u)}),w.on("error",u=>{var N,q;(q=(N=l.current.props).onError)===null||q===void 0||q.call(N,u)}),w.on("outofmaxbounds",u=>{var N,q;(q=(N=l.current.props).onOutOfMaxBounds)===null||q===void 0||q.call(N,u)}),w.on("trackuserlocationstart",u=>{var N,q;(q=(N=l.current.props).onTrackUserLocationStart)===null||q===void 0||q.call(N,u)}),w.on("trackuserlocationend",u=>{var N,q;(q=(N=l.current.props).onTrackUserLocationEnd)===null||q===void 0||q.call(N,u)}),w},{position:n.position});return l.current.props=n,Qe.useImperativeHandle(o,()=>({trigger:()=>f.trigger()}),[]),Qe.useEffect(()=>{xa(f._container,n.style)},[n.style]),null});I0.displayName="GeolocateControl";Qe.memo(I0);function CE(n){const o=wc(({mapLib:l})=>new l.NavigationControl(n),{position:n.position});return Qe.useEffect(()=>{xa(o._container,n.style)},[n.style]),null}const IE=Qe.memo(CE),zE={unit:"metric",maxWidth:100};function z0(n){const o=wc(({mapLib:l})=>new l.ScaleControl(n),{position:n.position});return(o.options.unit!==n.unit||o.options.maxWidth!==n.maxWidth)&&(o.options.maxWidth=n.maxWidth,o.setUnit(n.unit)),Qe.useEffect(()=>{xa(o._container,n.style)},[n.style]),null}z0.defaultProps=zE;Qe.memo(z0);var km={},AE={get exports(){return km},set exports(n){km=n}};(function(n,o){(function(l,f){n.exports=f()})(Iw,function(){var l,f,_;function w(u,N){if(!l)l=N;else if(!f)f=N;else{var q="var sharedChunk = {}; ("+l+")(sharedChunk); ("+f+")(sharedChunk);",ue={};l(ue),_=N(ue),typeof window<"u"&&(_.workerUrl=window.URL.createObjectURL(new Blob([q],{type:"text/javascript"})))}}w(["exports"],function(u){var N=q;function q(r,e,i,a){this.cx=3*r,this.bx=3*(i-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(a-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=e,this.p2x=i,this.p2y=a}function ue(r,e,i,a){const d=new N(r,e,i,a);return function(m){return d.solve(m)}}q.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,e){if(e===void 0&&(e=1e-6),r<0)return 0;if(r>1)return 1;for(var i=r,a=0;a<8;a++){var d=this.sampleCurveX(i)-r;if(Math.abs(d)<e)return i;var m=this.sampleCurveDerivativeX(i);if(Math.abs(m)<1e-6)break;i-=d/m}var y=0,x=1;for(i=r,a=0;a<20&&(d=this.sampleCurveX(i),!(Math.abs(d-r)<e));a++)r>d?y=i:x=i,i=.5*(x-y)+y;return i},solve:function(r,e){return this.sampleCurveY(this.solveCurveX(r,e))}};const oe=ue(.25,.1,.25,1);function Z(r,e,i){return Math.min(i,Math.max(e,r))}function ze(r,e,i){const a=i-e,d=((r-e)%a+a)%a+e;return d===e?i:d}function Ie(r,...e){for(const i of e)for(const a in i)r[a]=i[a];return r}let ke=1;function Xe(r,e){r.forEach(i=>{e[i]&&(e[i]=e[i].bind(e))})}function se(r,e,i){const a={};for(const d in r)a[d]=e.call(i||this,r[d],d,r);return a}function Q(r,e,i){const a={};for(const d in r)e.call(i||this,r[d],d,r)&&(a[d]=r[d]);return a}function ae(r){return Array.isArray(r)?r.map(ae):typeof r=="object"&&r?se(r,ae):r}const Se={};function Ae(r){Se[r]||(typeof console<"u"&&console.warn(r),Se[r]=!0)}function Le(r,e,i){return(i.y-r.y)*(e.x-r.x)>(e.y-r.y)*(i.x-r.x)}function Me(r){let e=0;for(let i,a,d=0,m=r.length,y=m-1;d<m;y=d++)i=r[d],a=r[y],e+=(a.x-i.x)*(i.y+a.y);return e}function Ke(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ct(r){const e={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,a,d,m)=>{const y=d||m;return e[a]=!y||y.toLowerCase(),""}),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}let dt,cn,xn=null;function an(r){if(xn==null){const e=r.navigator?r.navigator.userAgent:null;xn=!!r.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return xn}function ar(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const qn={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(r){const e=requestAnimationFrame(r);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(r,e=0){const i=window.document.createElement("canvas"),a=i.getContext("2d");if(!a)throw new Error("failed to create canvas 2d context");return i.width=r.width,i.height=r.height,a.drawImage(r,0,0,r.width,r.height),a.getImageData(-e,-e,r.width+2*e,r.height+2*e)},resolveURL:r=>(dt||(dt=document.createElement("a")),dt.href=r,dt.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(cn==null&&(cn=matchMedia("(prefers-reduced-motion: reduce)")),cn.matches)}};var st=wn;function wn(r,e){this.x=r,this.y=e}wn.prototype={clone:function(){return new wn(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,e){return this.clone()._rotateAround(r,e)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var e=r.x-this.x,i=r.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,e){return Math.atan2(this.x*e-this.y*r,this.x*r+this.y*e)},_matMult:function(r){var e=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=e,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var e=Math.cos(r),i=Math.sin(r),a=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=a,this},_rotateAround:function(r,e){var i=Math.cos(r),a=Math.sin(r),d=e.y+a*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-a*(this.y-e.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},wn.convert=function(r){return r instanceof wn?r:Array.isArray(r)?new wn(r[0],r[1]):r};const Ze={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},ct="mapbox-tiles";let at,Tt,Ut=500,yr=50;function Rn(){typeof caches>"u"||at||(at=caches.open(ct))}let Wn=1/0;const zn={supported:!1,testSupport:function(r){!bn&&gi&&(qi?Xt(r):lr=r)}};let lr,gi,bn=!1,qi=!1;function Xt(r){const e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,gi),r.isContextLost())return;zn.supported=!0}catch{}r.deleteTexture(e),bn=!0}typeof document<"u"&&(gi=document.createElement("img"),gi.onload=function(){lr&&Xt(lr),lr=null,qi=!0},gi.onerror=function(){bn=!0,lr=null},gi.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const jt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(jt);class Pt extends Error{constructor(e,i,a,d){super(`AJAXError: ${i} (${e}): ${a}`),this.status=e,this.statusText=i,this.url=a,this.body=d}}const En=Ke()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function Gt(r,e){const i=new AbortController,a=new Request(r.url,{method:r.method||"GET",body:r.body,credentials:r.credentials,headers:r.headers,referrer:En(),signal:i.signal});let d=!1,m=!1;return r.type==="json"&&a.headers.set("Accept","application/json"),((y,x,b)=>{if(m)return;const T=Date.now();fetch(a).then(z=>z.ok?((M,L,B)=>{(r.type==="arrayBuffer"?M.arrayBuffer():r.type==="json"?M.json():M.text()).then(F=>{m||(L&&B&&function(H,X,le){if(Rn(),!at)return;const fe={status:X.status,statusText:X.statusText,headers:new Headers};X.headers.forEach((de,be)=>fe.headers.set(be,de));const ie=Ct(X.headers.get("Cache-Control")||"");ie["no-store"]||(ie["max-age"]&&fe.headers.set("Expires",new Date(le+1e3*ie["max-age"]).toUTCString()),new Date(fe.headers.get("Expires")).getTime()-le<42e4||function(de,be){if(Tt===void 0)try{new Response(new ReadableStream),Tt=!0}catch{Tt=!1}Tt?be(de.body):de.blob().then(be)}(X,de=>{const be=new Response(de,fe);Rn(),at&&at.then(we=>we.put(function(We){const Je=We.indexOf("?");return Je<0?We:We.slice(0,Je)}(H.url),be)).catch(we=>Ae(we.message))}))}(a,L,B),d=!0,e(null,F,M.headers.get("Cache-Control"),M.headers.get("Expires")))}).catch(F=>{m||e(new Error(F.message))})})(z,null,T):z.blob().then(M=>e(new Pt(z.status,z.statusText,r.url,M)))).catch(z=>{z.code!==20&&e(new Error(z.message))})})(),{cancel:()=>{m=!0,d||i.abort()}}}const ur=function(r,e){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){if(Ke()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,e);if(!Ke()){const a=r.url.substring(0,r.url.indexOf("://"));return(Ze.REGISTERED_PROTOCOLS[a]||Gt)(r,e)}}if(!(/^file:/.test(i=r.url)||/^file:/.test(En())&&!/^\w+:/.test(i))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Gt(r,e);if(Ke()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,e,void 0,!0)}var i;return function(a,d){const m=new XMLHttpRequest;m.open(a.method||"GET",a.url,!0),a.type==="arrayBuffer"&&(m.responseType="arraybuffer");for(const y in a.headers)m.setRequestHeader(y,a.headers[y]);return a.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=a.credentials==="include",m.onerror=()=>{d(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let y=m.response;if(a.type==="json")try{y=JSON.parse(m.response)}catch(x){return d(x)}d(null,y,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else{const y=new Blob([m.response],{type:m.getResponseHeader("Content-Type")});d(new Pt(m.status,m.statusText,a.url,y))}},m.send(a.body),{cancel:()=>m.abort()}}(r,e)},Qn=function(r,e){return ur(Ie(r,{type:"arrayBuffer"}),e)};function ei(r){const e=window.document.createElement("a");return e.href=r,e.protocol===window.document.location.protocol&&e.host===window.document.location.host}const wt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Cr,ti;Cr=[],ti=0;const ni=function(r,e){if(zn.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),ti>=Ze.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:r,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Cr.push(m),m}ti++;let i=!1;const a=()=>{if(!i)for(i=!0,ti--;Cr.length&&ti<Ze.MAX_PARALLEL_IMAGE_REQUESTS;){const m=Cr.shift(),{requestParameters:y,callback:x,cancelled:b}=m;b||(m.cancel=ni(y,x).cancel)}},d=Qn(r,(m,y,x,b)=>{a(),m?e(m):y&&function(T,z){typeof createImageBitmap=="function"?function(M,L){const B=new Blob([new Uint8Array(M)],{type:"image/png"});createImageBitmap(B).then(F=>{L(null,F)}).catch(F=>{L(new Error(`Could not load image because of ${F.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(T,z):function(M,L){const B=new Image;B.onload=()=>{L(null,B),URL.revokeObjectURL(B.src),B.onload=null,window.requestAnimationFrame(()=>{B.src=wt})},B.onerror=()=>L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const F=new Blob([new Uint8Array(M)],{type:"image/png"});B.src=M.byteLength?URL.createObjectURL(F):wt}(T,z)}(y,(T,z)=>{T!=null?e(T):z!=null&&e(null,z,{cacheControl:x,expires:b})})});return{cancel:()=>{d.cancel(),a()}}};function Bn(r,e,i){i[r]&&i[r].indexOf(e)!==-1||(i[r]=i[r]||[],i[r].push(e))}function An(r,e,i){if(i&&i[r]){const a=i[r].indexOf(e);a!==-1&&i[r].splice(a,1)}}class Ir{constructor(e,i={}){Ie(this,i),this.type=e}}class Wi extends Ir{constructor(e,i={}){super("error",Ie({error:e},i))}}class zr{on(e,i){return this._listeners=this._listeners||{},Bn(e,i,this._listeners),this}off(e,i){return An(e,i,this._listeners),An(e,i,this._oneTimeListeners),this}once(e,i){return this._oneTimeListeners=this._oneTimeListeners||{},Bn(e,i,this._oneTimeListeners),this}fire(e,i){typeof e=="string"&&(e=new Ir(e,i||{}));const a=e.type;if(this.listens(a)){e.target=this;const d=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const x of d)x.call(this,e);const m=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const x of m)An(a,x,this._oneTimeListeners),x.call(this,e);const y=this._eventedParent;y&&(Ie(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(e))}else e instanceof Wi&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var xe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class Oe{constructor(e,i,a,d){this.message=(e?`${e}: `:"")+a,d&&(this.identifier=d),i!=null&&i.__line__&&(this.line=i.__line__)}}function co(r){const e=r.value;return e?[new Oe(r.key,e,"constants have been deprecated as of v8")]:[]}function ri(r,...e){for(const i of e)for(const a in i)r[a]=i[a];return r}function It(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function Gr(r){if(Array.isArray(r))return r.map(Gr);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const e={};for(const i in r)e[i]=Gr(r[i]);return e}return It(r)}class Ar extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}class Mr{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[a,d]of i)this.bindings[a]=d}concat(e){return new Mr(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Xi={kind:"null"},Re={kind:"number"},yt={kind:"string"},mt={kind:"boolean"},Xn={kind:"color"},Hi={kind:"object"},ft={kind:"value"},Ai={kind:"collator"},Fn={kind:"formatted"},Vo={kind:"padding"},Sn={kind:"resolvedImage"};function cr(r,e){return{kind:"array",itemType:r,N:e}}function Vt(r){if(r.kind==="array"){const e=Vt(r.itemType);return typeof r.N=="number"?`array<${e}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${e}>`}return r.kind}const $o=[Xi,Re,yt,mt,Xn,Fn,Hi,cr(ft),Vo,Sn];function yi(r,e){if(e.kind==="error")return null;if(r.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!yi(r.itemType,e.itemType))&&(typeof r.N!="number"||r.N===e.N))return null}else{if(r.kind===e.kind)return null;if(r.kind==="value"){for(const i of $o)if(!yi(i,e))return null}}return`Expected ${Vt(r)} but found ${Vt(e)} instead.`}function ho(r,e){return e.some(i=>i.kind===r.kind)}function po(r,e){return e.some(i=>i==="null"?r===null:i==="array"?Array.isArray(r):i==="object"?r&&!Array.isArray(r)&&typeof r=="object":i===typeof r)}var jo,fo={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function V(r){return(r=Math.round(r))<0?0:r>255?255:r}function C(r){return V(r[r.length-1]==="%"?parseFloat(r)/100*255:parseInt(r))}function P(r){return(e=r[r.length-1]==="%"?parseFloat(r)/100:parseFloat(r))<0?0:e>1?1:e;var e}function O(r,e,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?r+(e-r)*i*6:2*i<1?e:3*i<2?r+(e-r)*(2/3-i)*6:r}try{jo={}.parseCSSColor=function(r){var e,i=r.replace(/ /g,"").toLowerCase();if(i in fo)return fo[i].slice();if(i[0]==="#")return i.length===4?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:i.length===7&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var a=i.indexOf("("),d=i.indexOf(")");if(a!==-1&&d+1===i.length){var m=i.substr(0,a),y=i.substr(a+1,d-(a+1)).split(","),x=1;switch(m){case"rgba":if(y.length!==4)return null;x=P(y.pop());case"rgb":return y.length!==3?null:[C(y[0]),C(y[1]),C(y[2]),x];case"hsla":if(y.length!==4)return null;x=P(y.pop());case"hsl":if(y.length!==3)return null;var b=(parseFloat(y[0])%360+360)%360/360,T=P(y[1]),z=P(y[2]),M=z<=.5?z*(T+1):z+T-z*T,L=2*z-M;return[V(255*O(L,M,b+1/3)),V(255*O(L,M,b)),V(255*O(L,M,b-1/3)),x];default:return null}}return null}}catch{}class U{constructor(e,i,a,d=1){this.r=e,this.g=i,this.b=a,this.a=d}static parse(e){if(!e)return;if(e instanceof U)return e;if(typeof e!="string")return;const i=jo(e);return i?new U(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[e,i,a,d]=this.toArray();return`rgba(${Math.round(e)},${Math.round(i)},${Math.round(a)},${d})`}toArray(){const{r:e,g:i,b:a,a:d}=this;return d===0?[0,0,0,0]:[255*e/d,255*i/d,255*a/d,d]}}U.black=new U(0,0,0,1),U.white=new U(1,1,1,1),U.transparent=new U(0,0,0,0),U.red=new U(1,0,0,1);class K{constructor(e,i,a){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class te{constructor(e,i,a,d,m){this.text=e,this.image=i,this.scale=a,this.fontStack=d,this.textColor=m}}class J{constructor(e){this.sections=e}static fromString(e){return new J([new te(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof J?e:J.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class Y{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Y)return e;if(typeof e=="number")return new Y([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const i of e)if(typeof i!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new Y(e)}}toString(){return JSON.stringify(this.values)}}class ne{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new ne({name:e,available:!1}):null}}function ge(r,e,i,a){return typeof r=="number"&&r>=0&&r<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof i=="number"&&i>=0&&i<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[r,e,i,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[r,e,i,a]:[r,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ee(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof U||r instanceof K||r instanceof J||r instanceof Y||r instanceof ne)return!0;if(Array.isArray(r)){for(const e of r)if(!Ee(e))return!1;return!0}if(typeof r=="object"){for(const e in r)if(!Ee(r[e]))return!1;return!0}return!1}function me(r){if(r===null)return Xi;if(typeof r=="string")return yt;if(typeof r=="boolean")return mt;if(typeof r=="number")return Re;if(r instanceof U)return Xn;if(r instanceof K)return Ai;if(r instanceof J)return Fn;if(r instanceof Y)return Vo;if(r instanceof ne)return Sn;if(Array.isArray(r)){const e=r.length;let i;for(const a of r){const d=me(a);if(i){if(i===d)continue;i=ft;break}i=d}return cr(i||ft,e)}return Hi}function Ye(r){const e=typeof r;return r===null?"":e==="string"||e==="number"||e==="boolean"?String(r):r instanceof U||r instanceof J||r instanceof Y||r instanceof ne?r.toString():JSON.stringify(r)}class et{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(e.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Ee(e[1]))return i.error("invalid value");const a=e[1];let d=me(a);const m=i.expectedType;return d.kind!=="array"||d.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(d=m),new et(d,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class je{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const lt={string:yt,number:Re,boolean:mt,object:Hi};class ht{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let a,d=1;const m=e[0];if(m==="array"){let x,b;if(e.length>2){const T=e[1];if(typeof T!="string"||!(T in lt)||T==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);x=lt[T],d++}else x=ft;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);b=e[2],d++}a=cr(x,b)}else{if(!lt[m])throw new Error(`Types doesn't contain name = ${m}`);a=lt[m]}const y=[];for(;d<e.length;d++){const x=i.parse(e[d],d,ft);if(!x)return null;y.push(x)}return new ht(a,y)}evaluate(e){for(let i=0;i<this.args.length;i++){const a=this.args[i].evaluate(e);if(!yi(this.type,me(a)))return a;if(i===this.args.length-1)throw new je(`Expected value to be of type ${Vt(this.type)}, but found ${Vt(me(a))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const zt={"to-boolean":mt,"to-color":Xn,"to-number":Re,"to-string":yt};class pt{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const a=e[0];if(!zt[a])throw new Error(`Can't parse ${a} as it is not part of the known types`);if((a==="to-boolean"||a==="to-string")&&e.length!==2)return i.error("Expected one argument.");const d=zt[a],m=[];for(let y=1;y<e.length;y++){const x=i.parse(e[y],y,ft);if(!x)return null;m.push(x)}return new pt(d,m)}evaluate(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){let i,a;for(const d of this.args){if(i=d.evaluate(e),a=null,i instanceof U)return i;if(typeof i=="string"){const m=e.parseColor(i);if(m)return m}else if(Array.isArray(i)&&(a=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:ge(i[0],i[1],i[2],i[3]),!a))return new U(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new je(a||`Could not parse color from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}if(this.type.kind==="padding"){let i;for(const a of this.args){i=a.evaluate(e);const d=Y.parse(i);if(d)return d}throw new je(`Could not parse padding from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}if(this.type.kind==="number"){let i=null;for(const a of this.args){if(i=a.evaluate(e),i===null)return 0;const d=Number(i);if(!isNaN(d))return d}throw new je(`Could not convert ${JSON.stringify(i)} to number.`)}return this.type.kind==="formatted"?J.fromString(Ye(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?ne.fromString(Ye(this.args[0].evaluate(e))):Ye(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const _t=["Unknown","Point","LineString","Polygon"];class At{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?_t[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let i=this._parseColorCache[e];return i||(i=this._parseColorCache[e]=U.parse(e)),i}}class Zt{constructor(e,i,a,d){this.name=e,this.type=i,this._evaluate=a,this.args=d}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,i){const a=e[0],d=Zt.definitions[a];if(!d)return i.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(d)?d[0]:d.type,y=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,x=y.filter(([T])=>!Array.isArray(T)||T.length===e.length-1);let b=null;for(const[T,z]of x){b=new qo(i.registry,i.path,null,i.scope);const M=[];let L=!1;for(let B=1;B<e.length;B++){const F=e[B],H=Array.isArray(T)?T[B-1]:T.type,X=b.parse(F,1+M.length,H);if(!X){L=!0;break}M.push(X)}if(!L)if(Array.isArray(T)&&T.length!==M.length)b.error(`Expected ${T.length} arguments, but found ${M.length} instead.`);else{for(let B=0;B<M.length;B++){const F=Array.isArray(T)?T[B]:T.type,H=M[B];b.concat(B+1).checkSubtype(F,H.type)}if(b.errors.length===0)return new Zt(a,m,z,M)}}if(x.length===1)i.errors.push(...b.errors);else{const T=(x.length?x:y).map(([M])=>{return L=M,Array.isArray(L)?`(${L.map(Vt).join(", ")})`:`(${Vt(L.type)}...)`;var L}).join(" | "),z=[];for(let M=1;M<e.length;M++){const L=i.parse(e[M],1+z.length);if(!L)return null;z.push(Vt(L.type))}i.error(`Expected arguments of type ${T}, but found (${z.join(", ")}) instead.`)}return null}static register(e,i){Zt.definitions=i;for(const a in i)e[a]=Zt}}class On{constructor(e,i,a){this.type=Ai,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(e.length!==2)return i.error("Expected one argument.");const a=e[1];if(typeof a!="object"||Array.isArray(a))return i.error("Collator options argument must be an object.");const d=i.parse(a["case-sensitive"]!==void 0&&a["case-sensitive"],1,mt);if(!d)return null;const m=i.parse(a["diacritic-sensitive"]!==void 0&&a["diacritic-sensitive"],1,mt);if(!m)return null;let y=null;return a.locale&&(y=i.parse(a.locale,1,yt),!y)?null:new On(d,m,y)}evaluate(e){return new K(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}const Qt=8192;function er(r,e){r[0]=Math.min(r[0],e[0]),r[1]=Math.min(r[1],e[1]),r[2]=Math.max(r[2],e[0]),r[3]=Math.max(r[3],e[1])}function Go(r,e){return!(r[0]<=e[0]||r[2]>=e[2]||r[1]<=e[1]||r[3]>=e[3])}function Ms(r,e){const i=(180+r[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,d=Math.pow(2,e.z);return[Math.round(i*d*Qt),Math.round(a*d*Qt)]}function qt(r,e,i){const a=r[0]-e[0],d=r[1]-e[1],m=r[0]-i[0],y=r[1]-i[1];return a*y-m*d==0&&a*m<=0&&d*y<=0}function Il(r,e){let i=!1;for(let y=0,x=e.length;y<x;y++){const b=e[y];for(let T=0,z=b.length;T<z-1;T++){if(qt(r,b[T],b[T+1]))return!1;(d=b[T])[1]>(a=r)[1]!=(m=b[T+1])[1]>a[1]&&a[0]<(m[0]-d[0])*(a[1]-d[1])/(m[1]-d[1])+d[0]&&(i=!i)}}var a,d,m;return i}function zl(r,e){for(let i=0;i<e.length;i++)if(Il(r,e[i]))return!0;return!1}function bc(r,e,i,a){const d=a[0]-i[0],m=a[1]-i[1],y=(r[0]-i[0])*m-d*(r[1]-i[1]),x=(e[0]-i[0])*m-d*(e[1]-i[1]);return y>0&&x<0||y<0&&x>0}function Ec(r,e,i){for(const T of i)for(let z=0;z<T.length-1;++z)if((x=[(y=T[z+1])[0]-(m=T[z])[0],y[1]-m[1]])[0]*(b=[(d=e)[0]-(a=r)[0],d[1]-a[1]])[1]-x[1]*b[0]!=0&&bc(a,d,m,y)&&bc(m,y,a,d))return!0;var a,d,m,y,x,b;return!1}function Al(r,e){for(let i=0;i<r.length;++i)if(!Il(r[i],e))return!1;for(let i=0;i<r.length-1;++i)if(Ec(r[i],r[i+1],e))return!1;return!0}function Xd(r,e){for(let i=0;i<e.length;i++)if(Al(r,e[i]))return!0;return!1}function wa(r,e,i){const a=[];for(let d=0;d<r.length;d++){const m=[];for(let y=0;y<r[d].length;y++){const x=Ms(r[d][y],i);er(e,x),m.push(x)}a.push(m)}return a}function Ml(r,e,i){const a=[];for(let d=0;d<r.length;d++){const m=wa(r[d],e,i);a.push(m)}return a}function Sc(r,e,i,a){if(r[0]<i[0]||r[0]>i[2]){const d=.5*a;let m=r[0]-i[0]>d?-a:i[0]-r[0]>d?a:0;m===0&&(m=r[0]-i[2]>d?-a:i[2]-r[0]>d?a:0),r[0]+=m}er(e,r)}function Tc(r,e,i,a){const d=Math.pow(2,a.z)*Qt,m=[a.x*Qt,a.y*Qt],y=[];for(const x of r)for(const b of x){const T=[b.x+m[0],b.y+m[1]];Sc(T,e,i,d),y.push(T)}return y}function kc(r,e,i,a){const d=Math.pow(2,a.z)*Qt,m=[a.x*Qt,a.y*Qt],y=[];for(const b of r){const T=[];for(const z of b){const M=[z.x+m[0],z.y+m[1]];er(e,M),T.push(M)}y.push(T)}if(e[2]-e[0]<=d/2){(x=e)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const b of y)for(const T of b)Sc(T,e,i,d)}var x;return y}class mo{constructor(e,i){this.type=mt,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ee(e[1])){const a=e[1];if(a.type==="FeatureCollection")for(let d=0;d<a.features.length;++d){const m=a.features[d].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new mo(a,a.features[d].geometry)}else if(a.type==="Feature"){const d=a.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new mo(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new mo(a,a)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(i,a){const d=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=i.canonicalID();if(a.type==="Polygon"){const x=wa(a.coordinates,m,y),b=Tc(i.geometry(),d,m,y);if(!Go(d,m))return!1;for(const T of b)if(!Il(T,x))return!1}if(a.type==="MultiPolygon"){const x=Ml(a.coordinates,m,y),b=Tc(i.geometry(),d,m,y);if(!Go(d,m))return!1;for(const T of b)if(!zl(T,x))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(i,a){const d=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=i.canonicalID();if(a.type==="Polygon"){const x=wa(a.coordinates,m,y),b=kc(i.geometry(),d,m,y);if(!Go(d,m))return!1;for(const T of b)if(!Al(T,x))return!1}if(a.type==="MultiPolygon"){const x=Ml(a.coordinates,m,y),b=kc(i.geometry(),d,m,y);if(!Go(d,m))return!1;for(const T of b)if(!Xd(T,x))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function Ps(r){if(r instanceof Zt&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof mo)return!1;let e=!0;return r.eachChild(i=>{e&&!Ps(i)&&(e=!1)}),e}function Zo(r){if(r instanceof Zt&&r.name==="feature-state")return!1;let e=!0;return r.eachChild(i=>{e&&!Zo(i)&&(e=!1)}),e}function ba(r,e){if(r instanceof Zt&&e.indexOf(r.name)>=0)return!1;let i=!0;return r.eachChild(a=>{i&&!ba(a,e)&&(i=!1)}),i}class Ea{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(e.length!==2||typeof e[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const a=e[1];return i.scope.has(a)?new Ea(a,i.scope.get(a)):i.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class qo{constructor(e,i=[],a,d=new Mr,m=[]){this.registry=e,this.path=i,this.key=i.map(y=>`[${y}]`).join(""),this.scope=d,this.errors=m,this.expectedType=a}parse(e,i,a,d,m={}){return i?this.concat(i,a,d)._parse(e,m):this._parse(e,m)}_parse(e,i){function a(d,m,y){return y==="assert"?new ht(m,[d]):y==="coerce"?new pt(m,[d]):d}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=e[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[d];if(m){let y=m.parse(e,this);if(!y)return null;if(this.expectedType){const x=this.expectedType,b=y.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||b.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string")if(x.kind!=="padding"||b.kind!=="value"&&b.kind!=="number"&&b.kind!=="array"){if(this.checkSubtype(x,b))return null}else y=a(y,x,i.typeAnnotation||"coerce");else y=a(y,x,i.typeAnnotation||"coerce");else y=a(y,x,i.typeAnnotation||"assert")}if(!(y instanceof et)&&y.type.kind!=="resolvedImage"&&Pl(y)){const x=new At;try{y=new et(y.type,y.evaluate(x))}catch(b){return this.error(b.message),null}}return y}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,a){const d=typeof e=="number"?this.path.concat(e):this.path,m=a?this.scope.concat(a):this.scope;return new qo(this.registry,d,i||null,m,this.errors)}error(e,...i){const a=`${this.key}${i.map(d=>`[${d}]`).join("")}`;this.errors.push(new Ar(a,e))}checkSubtype(e,i){const a=yi(e,i);return a&&this.error(a),a}}function Pl(r){if(r instanceof Ea)return Pl(r.boundExpression);if(r instanceof Zt&&r.name==="error"||r instanceof On||r instanceof mo)return!1;const e=r instanceof pt||r instanceof ht;let i=!0;return r.eachChild(a=>{i=e?i&&Pl(a):i&&a instanceof et}),!!i&&Ps(r)&&ba(r,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Sa(r,e){const i=r.length-1;let a,d,m=0,y=i,x=0;for(;m<=y;)if(x=Math.floor((m+y)/2),a=r[x],d=r[x+1],a<=e){if(x===i||e<d)return x;m=x+1}else{if(!(a>e))throw new je("Input is not a number.");y=x-1}return 0}class Ds{constructor(e,i,a){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[d,m]of a)this.labels.push(d),this.outputs.push(m)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const a=i.parse(e[1],1,Re);if(!a)return null;const d=[];let m=null;i.expectedType&&i.expectedType.kind!=="value"&&(m=i.expectedType);for(let y=1;y<e.length;y+=2){const x=y===1?-1/0:e[y],b=e[y+1],T=y,z=y+1;if(typeof x!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(d.length&&d[d.length-1][0]>=x)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);const M=i.parse(b,z,m);if(!M)return null;m=m||M.type,d.push([x,M])}return new Ds(m,a,d)}evaluate(e){const i=this.labels,a=this.outputs;if(i.length===1)return a[0].evaluate(e);const d=this.input.evaluate(e);if(d<=i[0])return a[0].evaluate(e);const m=i.length;return d>=i[m-1]?a[m-1].evaluate(e):a[Sa(i,d)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function en(r,e,i){return r*(1-i)+e*i}var Ls=Object.freeze({__proto__:null,number:en,color:function(r,e,i){return new U(en(r.r,e.r,i),en(r.g,e.g,i),en(r.b,e.b,i),en(r.a,e.a,i))},array:function(r,e,i){return r.map((a,d)=>en(a,e[d],i))},padding:function(r,e,i){const a=r.values,d=e.values;return new Y([en(a[0],d[0],i),en(a[1],d[1],i),en(a[2],d[2],i),en(a[3],d[3],i)])}});const Cc=.95047,Ic=1.08883,Dl=4/29,Ta=6/29,zc=3*Ta*Ta,Hd=Math.PI/180,Kd=180/Math.PI;function Ll(r){return r>.008856451679035631?Math.pow(r,1/3):r/zc+Dl}function Rl(r){return r>Ta?r*r*r:zc*(r-Dl)}function Bl(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function Fl(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Lt(r){const e=Fl(r.r),i=Fl(r.g),a=Fl(r.b),d=Ll((.4124564*e+.3575761*i+.1804375*a)/Cc),m=Ll((.2126729*e+.7151522*i+.072175*a)/1);return{l:116*m-16,a:500*(d-m),b:200*(m-Ll((.0193339*e+.119192*i+.9503041*a)/Ic)),alpha:r.a}}function Ac(r){let e=(r.l+16)/116,i=isNaN(r.a)?e:e+r.a/500,a=isNaN(r.b)?e:e-r.b/200;return e=1*Rl(e),i=Cc*Rl(i),a=Ic*Rl(a),new U(Bl(3.2404542*i-1.5371385*e-.4985314*a),Bl(-.969266*i+1.8760108*e+.041556*a),Bl(.0556434*i-.2040259*e+1.0572252*a),r.alpha)}function Yd(r,e,i){const a=e-r;return r+i*(a>180||a<-180?a-360*Math.round(a/360):a)}const Rs={forward:Lt,reverse:Ac,interpolate:function(r,e,i){return{l:en(r.l,e.l,i),a:en(r.a,e.a,i),b:en(r.b,e.b,i),alpha:en(r.alpha,e.alpha,i)}}},Bs={forward:function(r){const{l:e,a:i,b:a}=Lt(r),d=Math.atan2(a,i)*Kd;return{h:d<0?d+360:d,c:Math.sqrt(i*i+a*a),l:e,alpha:r.a}},reverse:function(r){const e=r.h*Hd,i=r.c;return Ac({l:r.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:r.alpha})},interpolate:function(r,e,i){return{h:Yd(r.h,e.h,i),c:en(r.c,e.c,i),l:en(r.l,e.l,i),alpha:en(r.alpha,e.alpha,i)}}};var Mc=Object.freeze({__proto__:null,lab:Rs,hcl:Bs});class Pr{constructor(e,i,a,d,m){this.type=e,this.operator=i,this.interpolation=a,this.input=d,this.labels=[],this.outputs=[];for(const[y,x]of m)this.labels.push(y),this.outputs.push(x)}static interpolationFactor(e,i,a,d){let m=0;if(e.name==="exponential")m=Ol(i,e.base,a,d);else if(e.name==="linear")m=Ol(i,1,a,d);else if(e.name==="cubic-bezier"){const y=e.controlPoints;m=new N(y[0],y[1],y[2],y[3]).solve(Ol(i,1,a,d))}return m}static parse(e,i){let[a,d,m,...y]=e;if(!Array.isArray(d)||d.length===0)return i.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const T=d[1];if(typeof T!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:T}}else{if(d[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const T=d.slice(1);if(T.length!==4||T.some(z=>typeof z!="number"||z<0||z>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:T}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(m=i.parse(m,2,Re),!m)return null;const x=[];let b=null;a==="interpolate-hcl"||a==="interpolate-lab"?b=Xn:i.expectedType&&i.expectedType.kind!=="value"&&(b=i.expectedType);for(let T=0;T<y.length;T+=2){const z=y[T],M=y[T+1],L=T+3,B=T+4;if(typeof z!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(x.length&&x[x.length-1][0]>=z)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);const F=i.parse(M,B,b);if(!F)return null;b=b||F.type,x.push([z,F])}return b.kind==="number"||b.kind==="color"||b.kind==="padding"||b.kind==="array"&&b.itemType.kind==="number"&&typeof b.N=="number"?new Pr(b,a,d,m,x):i.error(`Type ${Vt(b)} is not interpolatable.`)}evaluate(e){const i=this.labels,a=this.outputs;if(i.length===1)return a[0].evaluate(e);const d=this.input.evaluate(e);if(d<=i[0])return a[0].evaluate(e);const m=i.length;if(d>=i[m-1])return a[m-1].evaluate(e);const y=Sa(i,d),x=Pr.interpolationFactor(this.interpolation,d,i[y],i[y+1]),b=a[y].evaluate(e),T=a[y+1].evaluate(e);return this.operator==="interpolate"?Ls[this.type.kind.toLowerCase()](b,T,x):this.operator==="interpolate-hcl"?Bs.reverse(Bs.interpolate(Bs.forward(b),Bs.forward(T),x)):Rs.reverse(Rs.interpolate(Rs.forward(b),Rs.forward(T),x))}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Ol(r,e,i,a){const d=a-i,m=r-i;return d===0?0:e===1?m/d:(Math.pow(e,m)-1)/(Math.pow(e,d)-1)}class ka{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expectected at least one argument.");let a=null;const d=i.expectedType;d&&d.kind!=="value"&&(a=d);const m=[];for(const x of e.slice(1)){const b=i.parse(x,1+m.length,a,void 0,{typeAnnotation:"omit"});if(!b)return null;a=a||b.type,m.push(b)}if(!a)throw new Error("No output type");const y=d&&m.some(x=>yi(d,x.type));return new ka(y?ft:a,m)}evaluate(e){let i,a=null,d=0;for(const m of this.args)if(d++,a=m.evaluate(e),a&&a instanceof ne&&!a.available&&(i||(i=a.name),a=null,d===this.args.length&&(a=i)),a!==null)break;return a}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}class Ca{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const a=[];for(let m=1;m<e.length-1;m+=2){const y=e[m];if(typeof y!="string")return i.error(`Expected string, but found ${typeof y} instead.`,m);if(/[^a-zA-Z0-9_]/.test(y))return i.error("Variable names must contain only alphanumeric characters or '_'.",m);const x=i.parse(e[m+1],m+1);if(!x)return null;a.push([y,x])}const d=i.parse(e[e.length-1],e.length-1,i.expectedType,a);return d?new Ca(a,d):null}outputDefined(){return this.result.outputDefined()}}class Nl{constructor(e,i,a){this.type=e,this.index=i,this.input=a}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,Re),d=i.parse(e[2],2,cr(i.expectedType||ft));return a&&d?new Nl(d.type.itemType,a,d):null}evaluate(e){const i=this.index.evaluate(e),a=this.input.evaluate(e);if(i<0)throw new je(`Array index out of bounds: ${i} < 0.`);if(i>=a.length)throw new je(`Array index out of bounds: ${i} > ${a.length-1}.`);if(i!==Math.floor(i))throw new je(`Array index must be an integer, but found ${i} instead.`);return a[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class Ul{constructor(e,i){this.type=mt,this.needle=e,this.haystack=i}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,ft),d=i.parse(e[2],2,ft);return a&&d?ho(a.type,[mt,yt,Re,Xi,ft])?new Ul(a,d):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Vt(a.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!a)return!1;if(!po(i,["boolean","string","number","null"]))throw new je(`Expected first argument to be of type boolean, string, number or null, but found ${Vt(me(i))} instead.`);if(!po(a,["string","array"]))throw new je(`Expected second argument to be of type array or string, but found ${Vt(me(a))} instead.`);return a.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class Ia{constructor(e,i,a){this.type=Re,this.needle=e,this.haystack=i,this.fromIndex=a}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,ft),d=i.parse(e[2],2,ft);if(!a||!d)return null;if(!ho(a.type,[mt,yt,Re,Xi,ft]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Vt(a.type)} instead`);if(e.length===4){const m=i.parse(e[3],3,Re);return m?new Ia(a,d,m):null}return new Ia(a,d)}evaluate(e){const i=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!po(i,["boolean","string","number","null"]))throw new je(`Expected first argument to be of type boolean, string, number or null, but found ${Vt(me(i))} instead.`);if(!po(a,["string","array"]))throw new je(`Expected second argument to be of type array or string, but found ${Vt(me(a))} instead.`);if(this.fromIndex){const d=this.fromIndex.evaluate(e);return a.indexOf(i,d)}return a.indexOf(i)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class Vl{constructor(e,i,a,d,m,y){this.inputType=e,this.type=i,this.input=a,this.cases=d,this.outputs=m,this.otherwise=y}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let a,d;i.expectedType&&i.expectedType.kind!=="value"&&(d=i.expectedType);const m={},y=[];for(let T=2;T<e.length-1;T+=2){let z=e[T];const M=e[T+1];Array.isArray(z)||(z=[z]);const L=i.concat(T);if(z.length===0)return L.error("Expected at least one branch label.");for(const F of z){if(typeof F!="number"&&typeof F!="string")return L.error("Branch labels must be numbers or strings.");if(typeof F=="number"&&Math.abs(F)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof F=="number"&&Math.floor(F)!==F)return L.error("Numeric branch labels must be integer values.");if(a){if(L.checkSubtype(a,me(F)))return null}else a=me(F);if(m[String(F)]!==void 0)return L.error("Branch labels must be unique.");m[String(F)]=y.length}const B=i.parse(M,T,d);if(!B)return null;d=d||B.type,y.push(B)}const x=i.parse(e[1],1,ft);if(!x)return null;const b=i.parse(e[e.length-1],e.length-1,d);return b?x.type.kind!=="value"&&i.concat(1).checkSubtype(a,x.type)?null:new Vl(a,d,x,m,y,b):null}evaluate(e){const i=this.input.evaluate(e);return(me(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class $l{constructor(e,i,a){this.type=e,this.branches=i,this.otherwise=a}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let a;i.expectedType&&i.expectedType.kind!=="value"&&(a=i.expectedType);const d=[];for(let y=1;y<e.length-1;y+=2){const x=i.parse(e[y],y,mt);if(!x)return null;const b=i.parse(e[y+1],y+1,a);if(!b)return null;d.push([x,b]),a=a||b.type}const m=i.parse(e[e.length-1],e.length-1,a);if(!m)return null;if(!a)throw new Error("Can't infer output type");return new $l(a,d,m)}evaluate(e){for(const[i,a]of this.branches)if(i.evaluate(e))return a.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,a]of this.branches)e(i),e(a);e(this.otherwise)}outputDefined(){return this.branches.every(([e,i])=>i.outputDefined())&&this.otherwise.outputDefined()}}class za{constructor(e,i,a,d){this.type=e,this.input=i,this.beginIndex=a,this.endIndex=d}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,ft),d=i.parse(e[2],2,Re);if(!a||!d)return null;if(!ho(a.type,[cr(ft),yt,ft]))return i.error(`Expected first argument to be of type array or string, but found ${Vt(a.type)} instead`);if(e.length===4){const m=i.parse(e[3],3,Re);return m?new za(a.type,a,d,m):null}return new za(a.type,a,d)}evaluate(e){const i=this.input.evaluate(e),a=this.beginIndex.evaluate(e);if(!po(i,["string","array"]))throw new je(`Expected first argument to be of type array or string, but found ${Vt(me(i))} instead.`);if(this.endIndex){const d=this.endIndex.evaluate(e);return i.slice(a,d)}return i.slice(a)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function Pc(r,e){return r==="=="||r==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Dc(r,e,i,a){return a.compare(e,i)===0}function Wo(r,e,i){const a=r!=="=="&&r!=="!=";return class A0{constructor(m,y,x){this.type=mt,this.lhs=m,this.rhs=y,this.collator=x,this.hasUntypedArgument=m.type.kind==="value"||y.type.kind==="value"}static parse(m,y){if(m.length!==3&&m.length!==4)return y.error("Expected two or three arguments.");const x=m[0];let b=y.parse(m[1],1,ft);if(!b)return null;if(!Pc(x,b.type))return y.concat(1).error(`"${x}" comparisons are not supported for type '${Vt(b.type)}'.`);let T=y.parse(m[2],2,ft);if(!T)return null;if(!Pc(x,T.type))return y.concat(2).error(`"${x}" comparisons are not supported for type '${Vt(T.type)}'.`);if(b.type.kind!==T.type.kind&&b.type.kind!=="value"&&T.type.kind!=="value")return y.error(`Cannot compare types '${Vt(b.type)}' and '${Vt(T.type)}'.`);a&&(b.type.kind==="value"&&T.type.kind!=="value"?b=new ht(T.type,[b]):b.type.kind!=="value"&&T.type.kind==="value"&&(T=new ht(b.type,[T])));let z=null;if(m.length===4){if(b.type.kind!=="string"&&T.type.kind!=="string"&&b.type.kind!=="value"&&T.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(z=y.parse(m[3],3,Ai),!z)return null}return new A0(b,T,z)}evaluate(m){const y=this.lhs.evaluate(m),x=this.rhs.evaluate(m);if(a&&this.hasUntypedArgument){const b=me(y),T=me(x);if(b.kind!==T.kind||b.kind!=="string"&&b.kind!=="number")throw new je(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${b.kind}, ${T.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const b=me(y),T=me(x);if(b.kind!=="string"||T.kind!=="string")return e(m,y,x)}return this.collator?i(m,y,x,this.collator.evaluate(m)):e(m,y,x)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const Jd=Wo("==",function(r,e,i){return e===i},Dc),Qd=Wo("!=",function(r,e,i){return e!==i},function(r,e,i,a){return!Dc(0,e,i,a)}),ep=Wo("<",function(r,e,i){return e<i},function(r,e,i,a){return a.compare(e,i)<0}),tp=Wo(">",function(r,e,i){return e>i},function(r,e,i,a){return a.compare(e,i)>0}),np=Wo("<=",function(r,e,i){return e<=i},function(r,e,i,a){return a.compare(e,i)<=0}),rp=Wo(">=",function(r,e,i){return e>=i},function(r,e,i,a){return a.compare(e,i)>=0});class jl{constructor(e,i,a,d,m){this.type=yt,this.number=e,this.locale=i,this.currency=a,this.minFractionDigits=d,this.maxFractionDigits=m}static parse(e,i){if(e.length!==3)return i.error("Expected two arguments.");const a=i.parse(e[1],1,Re);if(!a)return null;const d=e[2];if(typeof d!="object"||Array.isArray(d))return i.error("NumberFormat options argument must be an object.");let m=null;if(d.locale&&(m=i.parse(d.locale,1,yt),!m))return null;let y=null;if(d.currency&&(y=i.parse(d.currency,1,yt),!y))return null;let x=null;if(d["min-fraction-digits"]&&(x=i.parse(d["min-fraction-digits"],1,Re),!x))return null;let b=null;return d["max-fraction-digits"]&&(b=i.parse(d["max-fraction-digits"],1,Re),!b)?null:new jl(a,m,y,x,b)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Aa{constructor(e){this.type=Fn,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const a=e[1];if(!Array.isArray(a)&&typeof a=="object")return i.error("First argument must be an image or text section.");const d=[];let m=!1;for(let y=1;y<=e.length-1;++y){const x=e[y];if(m&&typeof x=="object"&&!Array.isArray(x)){m=!1;let b=null;if(x["font-scale"]&&(b=i.parse(x["font-scale"],1,Re),!b))return null;let T=null;if(x["text-font"]&&(T=i.parse(x["text-font"],1,cr(yt)),!T))return null;let z=null;if(x["text-color"]&&(z=i.parse(x["text-color"],1,Xn),!z))return null;const M=d[d.length-1];M.scale=b,M.font=T,M.textColor=z}else{const b=i.parse(e[y],1,ft);if(!b)return null;const T=b.type.kind;if(T!=="string"&&T!=="value"&&T!=="null"&&T!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,d.push({content:b,scale:null,font:null,textColor:null})}}return new Aa(d)}evaluate(e){return new J(this.sections.map(i=>{const a=i.content.evaluate(e);return me(a)===Sn?new te("",a,null,null,null):new te(Ye(a),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)}))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}outputDefined(){return!1}}class Gl{constructor(e){this.type=Sn,this.input=e}static parse(e,i){if(e.length!==2)return i.error("Expected two arguments.");const a=i.parse(e[1],1,yt);return a?new Gl(a):i.error("No image name provided.")}evaluate(e){const i=this.input.evaluate(e),a=ne.fromString(i);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(i)>-1),a}eachChild(e){e(this.input)}outputDefined(){return!1}}class Zl{constructor(e){this.type=Re,this.input=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=i.parse(e[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${Vt(a.type)} instead.`):new Zl(a):null}evaluate(e){const i=this.input.evaluate(e);if(typeof i=="string"||Array.isArray(i))return i.length;throw new je(`Expected value to be of type string or array, but found ${Vt(me(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const Xo={"==":Jd,"!=":Qd,">":tp,"<":ep,">=":rp,"<=":np,array:ht,at:Nl,boolean:ht,case:$l,coalesce:ka,collator:On,format:Aa,image:Gl,in:Ul,"index-of":Ia,interpolate:Pr,"interpolate-hcl":Pr,"interpolate-lab":Pr,length:Zl,let:Ca,literal:et,match:Vl,number:ht,"number-format":jl,object:ht,slice:za,step:Ds,string:ht,"to-boolean":pt,"to-color":pt,"to-number":pt,"to-string":pt,var:Ea,within:mo};function Lc(r,[e,i,a,d]){e=e.evaluate(r),i=i.evaluate(r),a=a.evaluate(r);const m=d?d.evaluate(r):1,y=ge(e,i,a,m);if(y)throw new je(y);return new U(e/255*m,i/255*m,a/255*m,m)}function Rc(r,e){return r in e}function Ma(r,e){const i=e[r];return i===void 0?null:i}function go(r){return{type:r}}function Bc(r){return{result:"success",value:r}}function Ho(r){return{result:"error",value:r}}function Yt(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function Fc(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function St(r){return!!r.expression&&r.expression.interpolated}function Rt(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function Ht(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function tn(r){return r}function Fs(r,e){const i=e.type==="color",a=r.stops&&typeof r.stops[0][0]=="object",d=a||!(a||r.property!==void 0),m=r.type||(St(e)?"exponential":"interval");if(i||e.type==="padding"){const T=i?U.parse:Y.parse;(r=ri({},r)).stops&&(r.stops=r.stops.map(z=>[z[0],T(z[1])])),r.default=T(r.default?r.default:e.default)}if(r.colorSpace&&r.colorSpace!=="rgb"&&!Mc[r.colorSpace])throw new Error(`Unknown color space: ${r.colorSpace}`);let y,x,b;if(m==="exponential")y=Oc;else if(m==="interval")y=op;else if(m==="categorical"){y=ip,x=Object.create(null);for(const T of r.stops)x[T[0]]=T[1];b=typeof r.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);y=sp}if(a){const T={},z=[];for(let B=0;B<r.stops.length;B++){const F=r.stops[B],H=F[0].zoom;T[H]===void 0&&(T[H]={zoom:H,type:r.type,property:r.property,default:r.default,stops:[]},z.push(H)),T[H].stops.push([F[0].value,F[1]])}const M=[];for(const B of z)M.push([T[B].zoom,Fs(T[B],e)]);const L={name:"linear"};return{kind:"composite",interpolationType:L,interpolationFactor:Pr.interpolationFactor.bind(void 0,L),zoomStops:M.map(B=>B[0]),evaluate:({zoom:B},F)=>Oc({stops:M,base:r.base},e,B).evaluate(B,F)}}if(d){const T=m==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:T,interpolationFactor:Pr.interpolationFactor.bind(void 0,T),zoomStops:r.stops.map(z=>z[0]),evaluate:({zoom:z})=>y(r,e,z,x,b)}}return{kind:"source",evaluate(T,z){const M=z&&z.properties?z.properties[r.property]:void 0;return M===void 0?Ko(r.default,e.default):y(r,e,M,x,b)}}}function Ko(r,e,i){return r!==void 0?r:e!==void 0?e:i!==void 0?i:void 0}function ip(r,e,i,a,d){return Ko(typeof i===d?a[i]:void 0,r.default,e.default)}function op(r,e,i){if(Rt(i)!=="number")return Ko(r.default,e.default);const a=r.stops.length;if(a===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[a-1][0])return r.stops[a-1][1];const d=Sa(r.stops.map(m=>m[0]),i);return r.stops[d][1]}function Oc(r,e,i){const a=r.base!==void 0?r.base:1;if(Rt(i)!=="number")return Ko(r.default,e.default);const d=r.stops.length;if(d===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[d-1][0])return r.stops[d-1][1];const m=Sa(r.stops.map(z=>z[0]),i),y=function(z,M,L,B){const F=B-L,H=z-L;return F===0?0:M===1?H/F:(Math.pow(M,H)-1)/(Math.pow(M,F)-1)}(i,a,r.stops[m][0],r.stops[m+1][0]),x=r.stops[m][1],b=r.stops[m+1][1];let T=Ls[e.type]||tn;if(r.colorSpace&&r.colorSpace!=="rgb"){const z=Mc[r.colorSpace];T=(M,L)=>z.reverse(z.interpolate(z.forward(M),z.forward(L),y))}return typeof x.evaluate=="function"?{evaluate(...z){const M=x.evaluate.apply(void 0,z),L=b.evaluate.apply(void 0,z);if(M!==void 0&&L!==void 0)return T(M,L,y)}}:T(x,b,y)}function sp(r,e,i){switch(e.type){case"color":i=U.parse(i);break;case"formatted":i=J.fromString(i.toString());break;case"resolvedImage":i=ne.fromString(i.toString());break;case"padding":i=Y.parse(i);break;default:Rt(i)===e.type||e.type==="enum"&&e.values[i]||(i=void 0)}return Ko(i,r.default,e.default)}Zt.register(Xo,{error:[{kind:"error"},[yt],(r,[e])=>{throw new je(e.evaluate(r))}],typeof:[yt,[ft],(r,[e])=>Vt(me(e.evaluate(r)))],"to-rgba":[cr(Re,4),[Xn],(r,[e])=>e.evaluate(r).toArray()],rgb:[Xn,[Re,Re,Re],Lc],rgba:[Xn,[Re,Re,Re,Re],Lc],has:{type:mt,overloads:[[[yt],(r,[e])=>Rc(e.evaluate(r),r.properties())],[[yt,Hi],(r,[e,i])=>Rc(e.evaluate(r),i.evaluate(r))]]},get:{type:ft,overloads:[[[yt],(r,[e])=>Ma(e.evaluate(r),r.properties())],[[yt,Hi],(r,[e,i])=>Ma(e.evaluate(r),i.evaluate(r))]]},"feature-state":[ft,[yt],(r,[e])=>Ma(e.evaluate(r),r.featureState||{})],properties:[Hi,[],r=>r.properties()],"geometry-type":[yt,[],r=>r.geometryType()],id:[ft,[],r=>r.id()],zoom:[Re,[],r=>r.globals.zoom],"heatmap-density":[Re,[],r=>r.globals.heatmapDensity||0],"line-progress":[Re,[],r=>r.globals.lineProgress||0],accumulated:[ft,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Re,go(Re),(r,e)=>{let i=0;for(const a of e)i+=a.evaluate(r);return i}],"*":[Re,go(Re),(r,e)=>{let i=1;for(const a of e)i*=a.evaluate(r);return i}],"-":{type:Re,overloads:[[[Re,Re],(r,[e,i])=>e.evaluate(r)-i.evaluate(r)],[[Re],(r,[e])=>-e.evaluate(r)]]},"/":[Re,[Re,Re],(r,[e,i])=>e.evaluate(r)/i.evaluate(r)],"%":[Re,[Re,Re],(r,[e,i])=>e.evaluate(r)%i.evaluate(r)],ln2:[Re,[],()=>Math.LN2],pi:[Re,[],()=>Math.PI],e:[Re,[],()=>Math.E],"^":[Re,[Re,Re],(r,[e,i])=>Math.pow(e.evaluate(r),i.evaluate(r))],sqrt:[Re,[Re],(r,[e])=>Math.sqrt(e.evaluate(r))],log10:[Re,[Re],(r,[e])=>Math.log(e.evaluate(r))/Math.LN10],ln:[Re,[Re],(r,[e])=>Math.log(e.evaluate(r))],log2:[Re,[Re],(r,[e])=>Math.log(e.evaluate(r))/Math.LN2],sin:[Re,[Re],(r,[e])=>Math.sin(e.evaluate(r))],cos:[Re,[Re],(r,[e])=>Math.cos(e.evaluate(r))],tan:[Re,[Re],(r,[e])=>Math.tan(e.evaluate(r))],asin:[Re,[Re],(r,[e])=>Math.asin(e.evaluate(r))],acos:[Re,[Re],(r,[e])=>Math.acos(e.evaluate(r))],atan:[Re,[Re],(r,[e])=>Math.atan(e.evaluate(r))],min:[Re,go(Re),(r,e)=>Math.min(...e.map(i=>i.evaluate(r)))],max:[Re,go(Re),(r,e)=>Math.max(...e.map(i=>i.evaluate(r)))],abs:[Re,[Re],(r,[e])=>Math.abs(e.evaluate(r))],round:[Re,[Re],(r,[e])=>{const i=e.evaluate(r);return i<0?-Math.round(-i):Math.round(i)}],floor:[Re,[Re],(r,[e])=>Math.floor(e.evaluate(r))],ceil:[Re,[Re],(r,[e])=>Math.ceil(e.evaluate(r))],"filter-==":[mt,[yt,ft],(r,[e,i])=>r.properties()[e.value]===i.value],"filter-id-==":[mt,[ft],(r,[e])=>r.id()===e.value],"filter-type-==":[mt,[yt],(r,[e])=>r.geometryType()===e.value],"filter-<":[mt,[yt,ft],(r,[e,i])=>{const a=r.properties()[e.value],d=i.value;return typeof a==typeof d&&a<d}],"filter-id-<":[mt,[ft],(r,[e])=>{const i=r.id(),a=e.value;return typeof i==typeof a&&i<a}],"filter->":[mt,[yt,ft],(r,[e,i])=>{const a=r.properties()[e.value],d=i.value;return typeof a==typeof d&&a>d}],"filter-id->":[mt,[ft],(r,[e])=>{const i=r.id(),a=e.value;return typeof i==typeof a&&i>a}],"filter-<=":[mt,[yt,ft],(r,[e,i])=>{const a=r.properties()[e.value],d=i.value;return typeof a==typeof d&&a<=d}],"filter-id-<=":[mt,[ft],(r,[e])=>{const i=r.id(),a=e.value;return typeof i==typeof a&&i<=a}],"filter->=":[mt,[yt,ft],(r,[e,i])=>{const a=r.properties()[e.value],d=i.value;return typeof a==typeof d&&a>=d}],"filter-id->=":[mt,[ft],(r,[e])=>{const i=r.id(),a=e.value;return typeof i==typeof a&&i>=a}],"filter-has":[mt,[ft],(r,[e])=>e.value in r.properties()],"filter-has-id":[mt,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[mt,[cr(yt)],(r,[e])=>e.value.indexOf(r.geometryType())>=0],"filter-id-in":[mt,[cr(ft)],(r,[e])=>e.value.indexOf(r.id())>=0],"filter-in-small":[mt,[yt,cr(ft)],(r,[e,i])=>i.value.indexOf(r.properties()[e.value])>=0],"filter-in-large":[mt,[yt,cr(ft)],(r,[e,i])=>function(a,d,m,y){for(;m<=y;){const x=m+y>>1;if(d[x]===a)return!0;d[x]>a?y=x-1:m=x+1}return!1}(r.properties()[e.value],i.value,0,i.value.length-1)],all:{type:mt,overloads:[[[mt,mt],(r,[e,i])=>e.evaluate(r)&&i.evaluate(r)],[go(mt),(r,e)=>{for(const i of e)if(!i.evaluate(r))return!1;return!0}]]},any:{type:mt,overloads:[[[mt,mt],(r,[e,i])=>e.evaluate(r)||i.evaluate(r)],[go(mt),(r,e)=>{for(const i of e)if(i.evaluate(r))return!0;return!1}]]},"!":[mt,[mt],(r,[e])=>!e.evaluate(r)],"is-supported-script":[mt,[yt],(r,[e])=>{const i=r.globals&&r.globals.isSupportedScript;return!i||i(e.evaluate(r))}],upcase:[yt,[yt],(r,[e])=>e.evaluate(r).toUpperCase()],downcase:[yt,[yt],(r,[e])=>e.evaluate(r).toLowerCase()],concat:[yt,go(ft),(r,e)=>e.map(i=>Ye(i.evaluate(r))).join("")],"resolved-locale":[yt,[Ai],(r,[e])=>e.evaluate(r).resolvedLocale()]});class Pa{constructor(e,i){this.expression=e,this._warningHistory={},this._evaluator=new At,this._defaultValue=i?function(a){return a.type==="color"&&Ht(a.default)?new U(0,0,0,0):a.type==="color"?U.parse(a.default)||null:a.type==="padding"?Y.parse(a.default)||null:a.default===void 0?null:a.default}(i):null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(e,i,a,d,m,y){return this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=a,this._evaluator.canonical=d,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(e,i,a,d,m,y){this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=a||null,this._evaluator.canonical=d,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y||null;try{const x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new je(`Expected value to be one of ${Object.keys(this._enumValues).map(b=>JSON.stringify(b)).join(", ")}, but found ${JSON.stringify(x)} instead.`);return x}catch(x){return this._warningHistory[x.message]||(this._warningHistory[x.message]=!0,typeof console<"u"&&console.warn(x.message)),this._defaultValue}}}function Os(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in Xo}function Ns(r,e){const i=new qo(Xo,[],e?function(d){const m={color:Xn,string:yt,number:Re,enum:yt,boolean:mt,formatted:Fn,padding:Vo,resolvedImage:Sn};return d.type==="array"?cr(m[d.value]||ft,d.length):m[d.type]}(e):void 0),a=i.parse(r,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?Bc(new Pa(a,e)):Ho(i.errors)}class Us{constructor(e,i){this.kind=e,this._styleExpression=i,this.isStateDependent=e!=="constant"&&!Zo(i.expression)}evaluateWithoutErrorHandling(e,i,a,d,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,i,a,d,m,y)}evaluate(e,i,a,d,m,y){return this._styleExpression.evaluate(e,i,a,d,m,y)}}class ql{constructor(e,i,a,d){this.kind=e,this.zoomStops=a,this._styleExpression=i,this.isStateDependent=e!=="camera"&&!Zo(i.expression),this.interpolationType=d}evaluateWithoutErrorHandling(e,i,a,d,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,i,a,d,m,y)}evaluate(e,i,a,d,m,y){return this._styleExpression.evaluate(e,i,a,d,m,y)}interpolationFactor(e,i,a){return this.interpolationType?Pr.interpolationFactor(this.interpolationType,e,i,a):0}}function Nc(r,e){const i=Ns(r,e);if(i.result==="error")return i;const a=i.value.expression,d=Ps(a);if(!d&&!Yt(e))return Ho([new Ar("","data expressions not supported")]);const m=ba(a,["zoom"]);if(!m&&!Fc(e))return Ho([new Ar("","zoom expressions not supported")]);const y=La(a);return y||m?y instanceof Ar?Ho([y]):y instanceof Pr&&!St(e)?Ho([new Ar("",'"interpolate" expressions cannot be used with this property')]):Bc(y?new ql(d?"camera":"composite",i.value,y.labels,y instanceof Pr?y.interpolation:void 0):new Us(d?"constant":"source",i.value)):Ho([new Ar("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Da{constructor(e,i){this._parameters=e,this._specification=i,ri(this,Fs(this._parameters,this._specification))}static deserialize(e){return new Da(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function La(r){let e=null;if(r instanceof Ca)e=La(r.result);else if(r instanceof ka){for(const i of r.args)if(e=La(i),e)break}else(r instanceof Ds||r instanceof Pr)&&r.input instanceof Zt&&r.input.name==="zoom"&&(e=r);return e instanceof Ar||r.eachChild(i=>{const a=La(i);a instanceof Ar?e=a:!e&&a?e=new Ar("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&a&&e!==a&&(e=new Ar("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function ii(r){const e=r.key,i=r.value,a=r.valueSpec||{},d=r.objectElementValidators||{},m=r.style,y=r.styleSpec;let x=[];const b=Rt(i);if(b!=="object")return[new Oe(e,i,`object expected, ${b} found`)];for(const T in i){const z=T.split(".")[0],M=a[z]||a["*"];let L;if(d[z])L=d[z];else if(a[z])L=Lr;else if(d["*"])L=d["*"];else{if(!a["*"]){x.push(new Oe(e,i[T],`unknown property "${T}"`));continue}L=Lr}x=x.concat(L({key:(e&&`${e}.`)+T,value:i[T],valueSpec:M,style:m,styleSpec:y,object:i,objectKey:T},i))}for(const T in a)d[T]||a[T].required&&a[T].default===void 0&&i[T]===void 0&&x.push(new Oe(e,i,`missing required property "${T}"`));return x}function Uc(r){const e=r.value,i=r.valueSpec,a=r.style,d=r.styleSpec,m=r.key,y=r.arrayElementValidator||Lr;if(Rt(e)!=="array")return[new Oe(m,e,`array expected, ${Rt(e)} found`)];if(i.length&&e.length!==i.length)return[new Oe(m,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new Oe(m,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let x={type:i.value,values:i.values};d.$version<7&&(x.function=i.function),Rt(i.value)==="object"&&(x=i.value);let b=[];for(let T=0;T<e.length;T++)b=b.concat(y({array:e,arrayIndex:T,value:e[T],valueSpec:x,style:a,styleSpec:d,key:`${m}[${T}]`}));return b}function Wl(r){const e=r.key,i=r.value,a=r.valueSpec;let d=Rt(i);return d==="number"&&i!=i&&(d="NaN"),d!=="number"?[new Oe(e,i,`number expected, ${d} found`)]:"minimum"in a&&i<a.minimum?[new Oe(e,i,`${i} is less than the minimum value ${a.minimum}`)]:"maximum"in a&&i>a.maximum?[new Oe(e,i,`${i} is greater than the maximum value ${a.maximum}`)]:[]}function Vc(r){const e=r.valueSpec,i=It(r.value.type);let a,d,m,y={};const x=i!=="categorical"&&r.value.property===void 0,b=!x,T=Rt(r.value.stops)==="array"&&Rt(r.value.stops[0])==="array"&&Rt(r.value.stops[0][0])==="object",z=ii({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(B){if(i==="identity")return[new Oe(B.key,B.value,'identity function may not have a "stops" property')];let F=[];const H=B.value;return F=F.concat(Uc({key:B.key,value:H,valueSpec:B.valueSpec,style:B.style,styleSpec:B.styleSpec,arrayElementValidator:M})),Rt(H)==="array"&&H.length===0&&F.push(new Oe(B.key,H,"array must have at least one stop")),F},default:function(B){return Lr({key:B.key,value:B.value,valueSpec:e,style:B.style,styleSpec:B.styleSpec})}}});return i==="identity"&&x&&z.push(new Oe(r.key,r.value,'missing required property "property"')),i==="identity"||r.value.stops||z.push(new Oe(r.key,r.value,'missing required property "stops"')),i==="exponential"&&r.valueSpec.expression&&!St(r.valueSpec)&&z.push(new Oe(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(b&&!Yt(r.valueSpec)?z.push(new Oe(r.key,r.value,"property functions not supported")):x&&!Fc(r.valueSpec)&&z.push(new Oe(r.key,r.value,"zoom functions not supported"))),i!=="categorical"&&!T||r.value.property!==void 0||z.push(new Oe(r.key,r.value,'"property" property is required')),z;function M(B){let F=[];const H=B.value,X=B.key;if(Rt(H)!=="array")return[new Oe(X,H,`array expected, ${Rt(H)} found`)];if(H.length!==2)return[new Oe(X,H,`array length 2 expected, length ${H.length} found`)];if(T){if(Rt(H[0])!=="object")return[new Oe(X,H,`object expected, ${Rt(H[0])} found`)];if(H[0].zoom===void 0)return[new Oe(X,H,"object stop key must have zoom")];if(H[0].value===void 0)return[new Oe(X,H,"object stop key must have value")];if(m&&m>It(H[0].zoom))return[new Oe(X,H[0].zoom,"stop zoom values must appear in ascending order")];It(H[0].zoom)!==m&&(m=It(H[0].zoom),d=void 0,y={}),F=F.concat(ii({key:`${X}[0]`,value:H[0],valueSpec:{zoom:{}},style:B.style,styleSpec:B.styleSpec,objectElementValidators:{zoom:Wl,value:L}}))}else F=F.concat(L({key:`${X}[0]`,value:H[0],valueSpec:{},style:B.style,styleSpec:B.styleSpec},H));return Os(Gr(H[1]))?F.concat([new Oe(`${X}[1]`,H[1],"expressions are not allowed in function stops.")]):F.concat(Lr({key:`${X}[1]`,value:H[1],valueSpec:e,style:B.style,styleSpec:B.styleSpec}))}function L(B,F){const H=Rt(B.value),X=It(B.value),le=B.value!==null?B.value:F;if(a){if(H!==a)return[new Oe(B.key,le,`${H} stop domain type must match previous stop domain type ${a}`)]}else a=H;if(H!=="number"&&H!=="string"&&H!=="boolean")return[new Oe(B.key,le,"stop domain value must be a number, string, or boolean")];if(H!=="number"&&i!=="categorical"){let fe=`number expected, ${H} found`;return Yt(e)&&i===void 0&&(fe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Oe(B.key,le,fe)]}return i!=="categorical"||H!=="number"||isFinite(X)&&Math.floor(X)===X?i!=="categorical"&&H==="number"&&d!==void 0&&X<d?[new Oe(B.key,le,"stop domain values must appear in ascending order")]:(d=X,i==="categorical"&&X in y?[new Oe(B.key,le,"stop domain values must be unique")]:(y[X]=!0,[])):[new Oe(B.key,le,`integer expected, found ${X}`)]}}function yo(r){const e=(r.expressionContext==="property"?Nc:Ns)(Gr(r.value),r.valueSpec);if(e.result==="error")return e.value.map(a=>new Oe(`${r.key}${a.key}`,r.value,a.message));const i=e.value.expression||e.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!i.outputDefined())return[new Oe(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!Zo(i))return[new Oe(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!Zo(i))return[new Oe(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!ba(i,["zoom","feature-state"]))return[new Oe(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!Ps(i))return[new Oe(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Vs(r){const e=r.key,i=r.value,a=r.valueSpec,d=[];return Array.isArray(a.values)?a.values.indexOf(It(i))===-1&&d.push(new Oe(e,i,`expected one of [${a.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(a.values).indexOf(It(i))===-1&&d.push(new Oe(e,i,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(i)} found`)),d}function Yo(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const e of r.slice(1))if(!Yo(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const ap={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ra(r){if(r==null)return{filter:()=>!0,needGeometry:!1};Yo(r)||(r=$s(r));const e=Ns(r,ap);if(e.result==="error")throw new Error(e.value.map(i=>`${i.key}: ${i.message}`).join(", "));return{filter:(i,a,d)=>e.value.evaluate(i,a,{},d),needGeometry:jc(r)}}function $c(r,e){return r<e?-1:r>e?1:0}function jc(r){if(!Array.isArray(r))return!1;if(r[0]==="within")return!0;for(let e=1;e<r.length;e++)if(jc(r[e]))return!0;return!1}function $s(r){if(!r)return!0;const e=r[0];return r.length<=1?e!=="any":e==="=="?Xl(r[1],r[2],"=="):e==="!="?Jo(Xl(r[1],r[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Xl(r[1],r[2],e):e==="any"?(i=r.slice(1),["any"].concat(i.map($s))):e==="all"?["all"].concat(r.slice(1).map($s)):e==="none"?["all"].concat(r.slice(1).map($s).map(Jo)):e==="in"?Ba(r[1],r.slice(2)):e==="!in"?Jo(Ba(r[1],r.slice(2))):e==="has"?js(r[1]):e==="!has"?Jo(js(r[1])):e!=="within"||r;var i}function Xl(r,e,i){switch(r){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,r,e]}}function Ba(r,e){if(e.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(i=>typeof i!=typeof e[0])?["filter-in-large",r,["literal",e.sort($c)]]:["filter-in-small",r,["literal",e]]}}function js(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Jo(r){return["!",r]}function Gs(r){return Yo(Gr(r.value))?yo(ri({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Gc(r)}function Gc(r){const e=r.value,i=r.key;if(Rt(e)!=="array")return[new Oe(i,e,`array expected, ${Rt(e)} found`)];const a=r.styleSpec;let d,m=[];if(e.length<1)return[new Oe(i,e,"filter array must have at least 1 element")];switch(m=m.concat(Vs({key:`${i}[0]`,value:e[0],valueSpec:a.filter_operator,style:r.style,styleSpec:r.styleSpec})),It(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&It(e[1])==="$type"&&m.push(new Oe(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&m.push(new Oe(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(d=Rt(e[1]),d!=="string"&&m.push(new Oe(`${i}[1]`,e[1],`string expected, ${d} found`)));for(let y=2;y<e.length;y++)d=Rt(e[y]),It(e[1])==="$type"?m=m.concat(Vs({key:`${i}[${y}]`,value:e[y],valueSpec:a.geometry_type,style:r.style,styleSpec:r.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&m.push(new Oe(`${i}[${y}]`,e[y],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let y=1;y<e.length;y++)m=m.concat(Gc({key:`${i}[${y}]`,value:e[y],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":d=Rt(e[1]),e.length!==2?m.push(new Oe(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):d!=="string"&&m.push(new Oe(`${i}[1]`,e[1],`string expected, ${d} found`));break;case"within":d=Rt(e[1]),e.length!==2?m.push(new Oe(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):d!=="object"&&m.push(new Oe(`${i}[1]`,e[1],`object expected, ${d} found`))}return m}function Zs(r,e){const i=r.key,a=r.style,d=r.styleSpec,m=r.value,y=r.objectKey,x=d[`${e}_${r.layerType}`];if(!x)return[];const b=y.match(/^(.*)-transition$/);if(e==="paint"&&b&&x[b[1]]&&x[b[1]].transition)return Lr({key:i,value:m,valueSpec:d.transition,style:a,styleSpec:d});const T=r.valueSpec||x[y];if(!T)return[new Oe(i,m,`unknown property "${y}"`)];let z;if(Rt(m)==="string"&&Yt(T)&&!T.tokens&&(z=/^{([^}]+)}$/.exec(m)))return[new Oe(i,m,`"${y}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(z[1])} }\`.`)];const M=[];return r.layerType==="symbol"&&(y==="text-field"&&a&&!a.glyphs&&M.push(new Oe(i,m,'use of "text-field" requires a style "glyphs" property')),y==="text-font"&&Ht(Gr(m))&&It(m.type)==="identity"&&M.push(new Oe(i,m,'"text-font" does not support identity functions'))),M.concat(Lr({key:r.key,value:m,valueSpec:T,style:a,styleSpec:d,expressionContext:"property",propertyType:e,propertyKey:y}))}function Zc(r){return Zs(r,"paint")}function qc(r){return Zs(r,"layout")}function Wc(r){let e=[];const i=r.value,a=r.key,d=r.style,m=r.styleSpec;i.type||i.ref||e.push(new Oe(a,i,'either "type" or "ref" is required'));let y=It(i.type);const x=It(i.ref);if(i.id){const b=It(i.id);for(let T=0;T<r.arrayIndex;T++){const z=d.layers[T];It(z.id)===b&&e.push(new Oe(a,i.id,`duplicate layer id "${i.id}", previously used at line ${z.id.__line__}`))}}if("ref"in i){let b;["type","source","source-layer","filter","layout"].forEach(T=>{T in i&&e.push(new Oe(a,i[T],`"${T}" is prohibited for ref layers`))}),d.layers.forEach(T=>{It(T.id)===x&&(b=T)}),b?b.ref?e.push(new Oe(a,i.ref,"ref cannot reference another ref layer")):y=It(b.type):e.push(new Oe(a,i.ref,`ref layer "${x}" not found`))}else if(y!=="background")if(i.source){const b=d.sources&&d.sources[i.source],T=b&&It(b.type);b?T==="vector"&&y==="raster"?e.push(new Oe(a,i.source,`layer "${i.id}" requires a raster source`)):T==="raster"&&y!=="raster"?e.push(new Oe(a,i.source,`layer "${i.id}" requires a vector source`)):T!=="vector"||i["source-layer"]?T==="raster-dem"&&y!=="hillshade"?e.push(new Oe(a,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!i.paint||!i.paint["line-gradient"]||T==="geojson"&&b.lineMetrics||e.push(new Oe(a,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Oe(a,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new Oe(a,i.source,`source "${i.source}" not found`))}else e.push(new Oe(a,i,'missing required property "source"'));return e=e.concat(ii({key:a,value:i,valueSpec:m.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Lr({key:`${a}.type`,value:i.type,valueSpec:m.layer.type,style:r.style,styleSpec:r.styleSpec,object:i,objectKey:"type"}),filter:Gs,layout:b=>ii({layer:i,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":T=>qc(ri({layerType:y},T))}}),paint:b=>ii({layer:i,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":T=>Zc(ri({layerType:y},T))}})}})),e}function Qo(r){const e=r.value,i=r.key,a=Rt(e);return a!=="string"?[new Oe(i,e,`string expected, ${a} found`)]:[]}const Xc={promoteId:function({key:r,value:e}){if(Rt(e)==="string")return Qo({key:r,value:e});{const i=[];for(const a in e)i.push(...Qo({key:`${r}.${a}`,value:e[a]}));return i}}};function qs(r){const e=r.value,i=r.key,a=r.styleSpec,d=r.style;if(!e.type)return[new Oe(i,e,'"type" is required')];const m=It(e.type);let y;switch(m){case"vector":case"raster":case"raster-dem":return y=ii({key:i,value:e,valueSpec:a[`source_${m.replace("-","_")}`],style:r.style,styleSpec:a,objectElementValidators:Xc}),y;case"geojson":if(y=ii({key:i,value:e,valueSpec:a.source_geojson,style:d,styleSpec:a,objectElementValidators:Xc}),e.cluster)for(const x in e.clusterProperties){const[b,T]=e.clusterProperties[x],z=typeof b=="string"?[b,["accumulated"],["get",x]]:b;y.push(...yo({key:`${i}.${x}.map`,value:T,expressionContext:"cluster-map"})),y.push(...yo({key:`${i}.${x}.reduce`,value:z,expressionContext:"cluster-reduce"}))}return y;case"video":return ii({key:i,value:e,valueSpec:a.source_video,style:d,styleSpec:a});case"image":return ii({key:i,value:e,valueSpec:a.source_image,style:d,styleSpec:a});case"canvas":return[new Oe(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Vs({key:`${i}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:d,styleSpec:a})}}function Ws(r){const e=r.value,i=r.styleSpec,a=i.light,d=r.style;let m=[];const y=Rt(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new Oe("light",e,`object expected, ${y} found`)]),m;for(const x in e){const b=x.match(/^(.*)-transition$/);m=m.concat(b&&a[b[1]]&&a[b[1]].transition?Lr({key:x,value:e[x],valueSpec:i.transition,style:d,styleSpec:i}):a[x]?Lr({key:x,value:e[x],valueSpec:a[x],style:d,styleSpec:i}):[new Oe(x,e[x],`unknown property "${x}"`)])}return m}function Dr(r){const e=r.value,i=r.styleSpec,a=i.terrain,d=r.style;let m=[];const y=Rt(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new Oe("terrain",e,`object expected, ${y} found`)]),m;for(const x in e)m=m.concat(a[x]?Lr({key:x,value:e[x],valueSpec:a[x],style:d,styleSpec:i}):[new Oe(x,e[x],`unknown property "${x}"`)]);return m}const Xs={"*":()=>[],array:Uc,boolean:function(r){const e=r.value,i=r.key,a=Rt(e);return a!=="boolean"?[new Oe(i,e,`boolean expected, ${a} found`)]:[]},number:Wl,color:function(r){const e=r.key,i=r.value,a=Rt(i);return a!=="string"?[new Oe(e,i,`color expected, ${a} found`)]:jo(i)===null?[new Oe(e,i,`color expected, "${i}" found`)]:[]},constants:co,enum:Vs,filter:Gs,function:Vc,layer:Wc,object:ii,source:qs,light:Ws,terrain:Dr,string:Qo,formatted:function(r){return Qo(r).length===0?[]:yo(r)},resolvedImage:function(r){return Qo(r).length===0?[]:yo(r)},padding:function(r){const e=r.key,i=r.value;if(Rt(i)==="array"){if(i.length<1||i.length>4)return[new Oe(e,i,`padding requires 1 to 4 values; ${i.length} values found`)];const a={type:"number"};let d=[];for(let m=0;m<i.length;m++)d=d.concat(Lr({key:`${e}[${m}]`,value:i[m],valueSpec:a}));return d}return Wl({key:e,value:i,valueSpec:{}})}};function Lr(r){const e=r.value,i=r.valueSpec,a=r.styleSpec;return i.expression&&Ht(It(e))?Vc(r):i.expression&&Os(Gr(e))?yo(r):i.type&&Xs[i.type]?Xs[i.type](r):ii(ri({},r,{valueSpec:i.type?a[i.type]:i}))}function lp(r){const e=r.value,i=r.key,a=Qo(r);return a.length||(e.indexOf("{fontstack}")===-1&&a.push(new Oe(i,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&a.push(new Oe(i,e,'"glyphs" url must include a "{range}" token'))),a}function Ki(r,e=xe){let i=[];return i=i.concat(Lr({key:"",value:r,valueSpec:e.$root,styleSpec:e,style:r,objectElementValidators:{glyphs:lp,"*":()=>[]}})),r.constants&&(i=i.concat(co({key:"constants",value:r.constants,style:r,styleSpec:e}))),Hc(i)}function Hc(r){return[].concat(r).sort((e,i)=>e.line-i.line)}function Mi(r){return function(...e){return Hc(r.apply(this,e))}}Ki.source=Mi(qs),Ki.light=Mi(Ws),Ki.terrain=Mi(Dr),Ki.layer=Mi(Wc),Ki.filter=Mi(Gs),Ki.paintProperty=Mi(Zc),Ki.layoutProperty=Mi(qc);const Hs=Ki,Hl=Hs.light,up=Hs.paintProperty,cp=Hs.layoutProperty;function Fa(r,e){let i=!1;if(e&&e.length)for(const a of e)r.fire(new Wi(new Error(a.message))),i=!0;return i}class Ks{constructor(e,i,a){const d=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const y=new Int32Array(this.arrayBuffer);e=y[0],this.d=(i=y[1])+2*(a=y[2]);for(let b=0;b<this.d*this.d;b++){const T=y[3+b],z=y[3+b+1];d.push(T===z?null:y.subarray(T,z))}const x=y[3+d.length+1];this.keys=y.subarray(y[3+d.length],x),this.bboxes=y.subarray(x),this.insert=this._insertReadonly}else{this.d=i+2*a;for(let y=0;y<this.d*this.d;y++)d.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=e,this.padding=a,this.scale=i/e,this.uid=0;const m=a/i*e;this.min=-m,this.max=e+m}insert(e,i,a,d,m){this._forEachCell(i,a,d,m,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(d),this.bboxes.push(m)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,i,a,d,m,y){this.cells[m].push(y)}query(e,i,a,d,m){const y=this.min,x=this.max;if(e<=y&&i<=y&&x<=a&&x<=d&&!m)return Array.prototype.slice.call(this.keys);{const b=[];return this._forEachCell(e,i,a,d,this._queryCell,b,{},m),b}}_queryCell(e,i,a,d,m,y,x,b){const T=this.cells[m];if(T!==null){const z=this.keys,M=this.bboxes;for(let L=0;L<T.length;L++){const B=T[L];if(x[B]===void 0){const F=4*B;(b?b(M[F+0],M[F+1],M[F+2],M[F+3]):e<=M[F+2]&&i<=M[F+3]&&a>=M[F+0]&&d>=M[F+1])?(x[B]=!0,y.push(z[B])):x[B]=!1}}}}_forEachCell(e,i,a,d,m,y,x,b){const T=this._convertToCellCoord(e),z=this._convertToCellCoord(i),M=this._convertToCellCoord(a),L=this._convertToCellCoord(d);for(let B=T;B<=M;B++)for(let F=z;F<=L;F++){const H=this.d*F+B;if((!b||b(this._convertFromCellCoord(B),this._convertFromCellCoord(F),this._convertFromCellCoord(B+1),this._convertFromCellCoord(F+1)))&&m.call(this,e,i,a,d,H,y,x,b))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,i=3+this.cells.length+1+1;let a=0;for(let y=0;y<this.cells.length;y++)a+=this.cells[y].length;const d=new Int32Array(i+a+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;let m=i;for(let y=0;y<e.length;y++){const x=e[y];d[3+y]=m,d.set(x,m),m+=x.length}return d[3+e.length]=m,d.set(this.keys,m),m+=this.keys.length,d[3+e.length+1]=m,d.set(this.bboxes,m),m+=this.bboxes.length,d.buffer}static serialize(e,i){const a=e.toArrayBuffer();return i&&i.push(a),{buffer:a}}static deserialize(e){return new Ks(e.buffer)}}const Pi={};function He(r,e,i={}){if(Pi[r])throw new Error(`${r} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:r,writeable:!1}),Pi[r]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}He("Object",Object),He("TransferableGridIndex",Ks),He("Color",U),He("Error",Error),He("AJAXError",Pt),He("ResolvedImage",ne),He("StylePropertyFunction",Da),He("StyleExpression",Pa,{omit:["_evaluator"]}),He("ZoomDependentExpression",ql),He("ZoomConstantExpression",Us),He("CompoundExpression",Zt,{omit:["_evaluate"]});for(const r in Xo)Xo[r]._classRegistryKey||He(`Expression_${r}`,Xo[r]);function Kc(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function _o(r,e){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob)return r;if(Kc(r)||ar(r))return e&&e.push(r),r;if(ArrayBuffer.isView(r)){const i=r;return e&&e.push(i.buffer),i}if(r instanceof ImageData)return e&&e.push(r.data.buffer),r;if(Array.isArray(r)){const i=[];for(const a of r)i.push(_o(a,e));return i}if(typeof r=="object"){const i=r.constructor,a=i._classRegistryKey;if(!a)throw new Error("can't serialize object of unregistered class");if(!Pi[a])throw new Error(`${a} is not registered.`);const d=i.serialize?i.serialize(r,e):{};if(i.serialize){if(e&&d===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const m in r){if(!r.hasOwnProperty(m)||Pi[a].omit.indexOf(m)>=0)continue;const y=r[m];d[m]=Pi[a].shallow.indexOf(m)>=0?y:_o(y,e)}r instanceof Error&&(d.message=r.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(d.$name=a),d}throw new Error("can't serialize object of type "+typeof r)}function Yi(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||Kc(r)||ar(r)||ArrayBuffer.isView(r)||r instanceof ImageData)return r;if(Array.isArray(r))return r.map(Yi);if(typeof r=="object"){const e=r.$name||"Object";if(!Pi[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:i}=Pi[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(r);const a=Object.create(i.prototype);for(const d of Object.keys(r)){if(d==="$name")continue;const m=r[d];a[d]=Pi[e].shallow.indexOf(d)>=0?m:Yi(m)}return a}throw new Error("can't deserialize object of type "+typeof r)}class Kl{constructor(){this.first=!0}update(e,i){const a=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=a,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=a,!0):(this.lastFloorZoom>a?(this.lastIntegerZoom=a+1,this.lastIntegerZoomTime=i):this.lastFloorZoom<a&&(this.lastIntegerZoom=a,this.lastIntegerZoomTime=i),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=a,!0))}}const Ue={"Latin-1 Supplement":r=>r>=128&&r<=255,Arabic:r=>r>=1536&&r<=1791,"Arabic Supplement":r=>r>=1872&&r<=1919,"Arabic Extended-A":r=>r>=2208&&r<=2303,"Hangul Jamo":r=>r>=4352&&r<=4607,"Unified Canadian Aboriginal Syllabics":r=>r>=5120&&r<=5759,Khmer:r=>r>=6016&&r<=6143,"Unified Canadian Aboriginal Syllabics Extended":r=>r>=6320&&r<=6399,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"CJK Radicals Supplement":r=>r>=11904&&r<=12031,"Kangxi Radicals":r=>r>=12032&&r<=12255,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Bopomofo:r=>r>=12544&&r<=12591,"Hangul Compatibility Jamo":r=>r>=12592&&r<=12687,Kanbun:r=>r>=12688&&r<=12703,"Bopomofo Extended":r=>r>=12704&&r<=12735,"CJK Strokes":r=>r>=12736&&r<=12783,"Katakana Phonetic Extensions":r=>r>=12784&&r<=12799,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"CJK Unified Ideographs Extension A":r=>r>=13312&&r<=19903,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Yi Syllables":r=>r>=40960&&r<=42127,"Yi Radicals":r=>r>=42128&&r<=42191,"Hangul Jamo Extended-A":r=>r>=43360&&r<=43391,"Hangul Syllables":r=>r>=44032&&r<=55215,"Hangul Jamo Extended-B":r=>r>=55216&&r<=55295,"Private Use Area":r=>r>=57344&&r<=63743,"CJK Compatibility Ideographs":r=>r>=63744&&r<=64255,"Arabic Presentation Forms-A":r=>r>=64336&&r<=65023,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Arabic Presentation Forms-B":r=>r>=65136&&r<=65279,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function Oa(r){for(const e of r)if(Jl(e.charCodeAt(0)))return!0;return!1}function hp(r){for(const e of r)if(!Yl(e.charCodeAt(0)))return!1;return!0}function Yl(r){return!(Ue.Arabic(r)||Ue["Arabic Supplement"](r)||Ue["Arabic Extended-A"](r)||Ue["Arabic Presentation Forms-A"](r)||Ue["Arabic Presentation Forms-B"](r))}function Jl(r){return!(r!==746&&r!==747&&(r<4352||!(Ue["Bopomofo Extended"](r)||Ue.Bopomofo(r)||Ue["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||Ue["CJK Compatibility Ideographs"](r)||Ue["CJK Compatibility"](r)||Ue["CJK Radicals Supplement"](r)||Ue["CJK Strokes"](r)||!(!Ue["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||Ue["CJK Unified Ideographs Extension A"](r)||Ue["CJK Unified Ideographs"](r)||Ue["Enclosed CJK Letters and Months"](r)||Ue["Hangul Compatibility Jamo"](r)||Ue["Hangul Jamo Extended-A"](r)||Ue["Hangul Jamo Extended-B"](r)||Ue["Hangul Jamo"](r)||Ue["Hangul Syllables"](r)||Ue.Hiragana(r)||Ue["Ideographic Description Characters"](r)||Ue.Kanbun(r)||Ue["Kangxi Radicals"](r)||Ue["Katakana Phonetic Extensions"](r)||Ue.Katakana(r)&&r!==12540||!(!Ue["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!Ue["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||Ue["Unified Canadian Aboriginal Syllabics"](r)||Ue["Unified Canadian Aboriginal Syllabics Extended"](r)||Ue["Vertical Forms"](r)||Ue["Yijing Hexagram Symbols"](r)||Ue["Yi Syllables"](r)||Ue["Yi Radicals"](r))))}function Yc(r){return!(Jl(r)||function(e){return!!(Ue["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||Ue["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||Ue["Letterlike Symbols"](e)||Ue["Number Forms"](e)||Ue["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||Ue["Control Pictures"](e)&&e!==9251||Ue["Optical Character Recognition"](e)||Ue["Enclosed Alphanumerics"](e)||Ue["Geometric Shapes"](e)||Ue["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Ue["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ue["CJK Symbols and Punctuation"](e)||Ue.Katakana(e)||Ue["Private Use Area"](e)||Ue["CJK Compatibility Forms"](e)||Ue["Small Form Variants"](e)||Ue["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(r))}function Jc(r){return r>=1424&&r<=2303||Ue["Arabic Presentation Forms-A"](r)||Ue["Arabic Presentation Forms-B"](r)}function dp(r,e){return!(!e&&Jc(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||Ue.Khmer(r))}function Qc(r){for(const e of r)if(Jc(e.charCodeAt(0)))return!0;return!1}const Ql="deferred",eu="loading",tu="loaded";let nu=null,_r="unavailable",Ji=null;const eh=function(r){r&&typeof r=="string"&&r.indexOf("NetworkError")>-1&&(_r="error"),nu&&nu(r)};function es(){ru.fire(new Ir("pluginStateChange",{pluginStatus:_r,pluginURL:Ji}))}const ru=new zr,Ys=function(){return _r},th=function(){if(_r!==Ql||!Ji)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");_r=eu,es(),Ji&&Qn({url:Ji},r=>{r?eh(r):(_r=tu,es())})},Zr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>_r===tu||Zr.applyArabicShaping!=null,isLoading:()=>_r===eu,setState(r){if(!Ke())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");_r=r.pluginStatus,Ji=r.pluginURL},isParsed(){if(!Ke())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return Zr.applyArabicShaping!=null&&Zr.processBidirectionalText!=null&&Zr.processStyledBidirectionalText!=null},getPluginURL(){if(!Ke())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Ji}};class nn{constructor(e,i){this.zoom=e,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.zoomHistory=i.zoomHistory,this.transition=i.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Kl,this.transition={})}isSupportedScript(e){return function(i,a){for(const d of i)if(!dp(d.charCodeAt(0),a))return!1;return!0}(e,Zr.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,i=e-Math.floor(e),a=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:i+(1-i)*a}:{fromScale:.5,toScale:1,t:1-(1-a)*i}}}class Js{constructor(e,i){this.property=e,this.value=i,this.expression=function(a,d){if(Ht(a))return new Da(a,d);if(Os(a)){const m=Nc(a,d);if(m.result==="error")throw new Error(m.value.map(y=>`${y.key}: ${y.message}`).join(", "));return m.value}{let m=a;return d.type==="color"&&typeof a=="string"?m=U.parse(a):d.type!=="padding"||typeof a!="number"&&!Array.isArray(a)||(m=Y.parse(a)),{kind:"constant",evaluate:()=>m}}}(i===void 0?e.specification.default:i,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,i,a){return this.property.possiblyEvaluate(this,e,i,a)}}class Na{constructor(e){this.property=e,this.value=new Js(e,void 0)}transitioned(e,i){return new rh(this.property,this.value,i,Ie({},e.transition,this.transition),e.now)}untransitioned(){return new rh(this.property,this.value,null,{},0)}}class nh{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return ae(this._values[e].value.value)}setValue(e,i){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Na(this._values[e].property)),this._values[e].value=new Js(this._values[e].property,i===null?void 0:ae(i))}getTransition(e){return ae(this._values[e].transition)}setTransition(e,i){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Na(this._values[e].property)),this._values[e].transition=ae(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const a=this.getValue(i);a!==void 0&&(e[i]=a);const d=this.getTransition(i);d!==void 0&&(e[`${i}-transition`]=d)}return e}transitioned(e,i){const a=new ih(this._properties);for(const d of Object.keys(this._values))a._values[d]=this._values[d].transitioned(e,i._values[d]);return a}untransitioned(){const e=new ih(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class rh{constructor(e,i,a,d,m){this.property=e,this.value=i,this.begin=m+d.delay||0,this.end=this.begin+d.duration||0,e.specification.transition&&(d.delay||d.duration)&&(this.prior=a)}possiblyEvaluate(e,i,a){const d=e.now||0,m=this.value.possiblyEvaluate(e,i,a),y=this.prior;if(y){if(d>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(d<this.begin)return y.possiblyEvaluate(e,i,a);{const x=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(e,i,a),m,function(b){if(b<=0)return 0;if(b>=1)return 1;const T=b*b,z=T*b;return 4*(b<.5?z:3*(b-T)+z-.75)}(x))}}return m}}class ih{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,a){const d=new Qs(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].possiblyEvaluate(e,i,a);return d}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class pp{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return ae(this._values[e].value)}setValue(e,i){this._values[e]=new Js(this._values[e].property,i===null?void 0:ae(i))}serialize(){const e={};for(const i of Object.keys(this._values)){const a=this.getValue(i);a!==void 0&&(e[i]=a)}return e}possiblyEvaluate(e,i,a){const d=new Qs(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].possiblyEvaluate(e,i,a);return d}}class _i{constructor(e,i,a){this.property=e,this.value=i,this.parameters=a}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,i,a,d){return this.property.evaluate(this.value,this.parameters,e,i,a,d)}}class Qs{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class tt{constructor(e){this.specification=e}possiblyEvaluate(e,i){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(i)}interpolate(e,i,a){const d=Ls[this.specification.type];return d?d(e,i,a):e}}class ut{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,a,d){return new _i(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(i,null,{},a,d)}:e.expression,i)}interpolate(e,i,a){if(e.value.kind!=="constant"||i.value.kind!=="constant")return e;if(e.value.value===void 0||i.value.value===void 0)return new _i(this,{kind:"constant",value:void 0},e.parameters);const d=Ls[this.specification.type];return d?new _i(this,{kind:"constant",value:d(e.value.value,i.value.value,a)},e.parameters):e}evaluate(e,i,a,d,m,y){return e.kind==="constant"?e.value:e.evaluate(i,a,d,m,y)}}class ts extends ut{possiblyEvaluate(e,i,a,d){if(e.value===void 0)return new _i(this,{kind:"constant",value:void 0},i);if(e.expression.kind==="constant"){const m=e.expression.evaluate(i,null,{},a,d),y=e.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,x=this._calculate(y,y,y,i);return new _i(this,{kind:"constant",value:x},i)}if(e.expression.kind==="camera"){const m=this._calculate(e.expression.evaluate({zoom:i.zoom-1}),e.expression.evaluate({zoom:i.zoom}),e.expression.evaluate({zoom:i.zoom+1}),i);return new _i(this,{kind:"constant",value:m},i)}return new _i(this,e.expression,i)}evaluate(e,i,a,d,m,y){if(e.kind==="source"){const x=e.evaluate(i,a,d,m,y);return this._calculate(x,x,x,i)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(i.zoom)-1},a,d),e.evaluate({zoom:Math.floor(i.zoom)},a,d),e.evaluate({zoom:Math.floor(i.zoom)+1},a,d),i):e.value}_calculate(e,i,a,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:a,to:i}}interpolate(e){return e}}class iu{constructor(e){this.specification=e}possiblyEvaluate(e,i,a,d){if(e.value!==void 0){if(e.expression.kind==="constant"){const m=e.expression.evaluate(i,null,{},a,d);return this._calculate(m,m,m,i)}return this._calculate(e.expression.evaluate(new nn(Math.floor(i.zoom-1),i)),e.expression.evaluate(new nn(Math.floor(i.zoom),i)),e.expression.evaluate(new nn(Math.floor(i.zoom+1),i)),i)}}_calculate(e,i,a,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:a,to:i}}interpolate(e){return e}}class Qi{constructor(e){this.specification=e}possiblyEvaluate(e,i,a,d){return!!e.expression.evaluate(i,null,{},a,d)}interpolate(){return!1}}class Hn{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const i in e){const a=e[i];a.specification.overridable&&this.overridableProperties.push(i);const d=this.defaultPropertyValues[i]=new Js(a,void 0),m=this.defaultTransitionablePropertyValues[i]=new Na(a);this.defaultTransitioningPropertyValues[i]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=d.possiblyEvaluate({})}}}He("DataDrivenProperty",ut),He("DataConstantProperty",tt),He("CrossFadedDataDrivenProperty",ts),He("CrossFadedProperty",iu),He("ColorRampProperty",Qi);const eo="-transition";class vi extends zr{constructor(e,i){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),i.layout&&(this._unevaluatedLayout=new pp(i.layout)),i.paint)){this._transitionablePaint=new nh(i.paint);for(const a in e.paint)this.setPaintProperty(a,e.paint[a],{validate:!1});for(const a in e.layout)this.setLayoutProperty(a,e.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Qs(i.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,i,a={}){i!=null&&this._validate(cp,`layers.${this.id}.layout.${e}`,e,i,a)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,i):this.visibility=i)}getPaintProperty(e){return e.endsWith(eo)?this._transitionablePaint.getTransition(e.slice(0,-eo.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,a={}){if(i!=null&&this._validate(up,`layers.${this.id}.paint.${e}`,e,i,a))return!1;if(e.endsWith(eo))return this._transitionablePaint.setTransition(e.slice(0,-eo.length),i||void 0),!1;{const d=this._transitionablePaint._values[e],m=d.property.specification["property-type"]==="cross-faded-data-driven",y=d.value.isDataDriven(),x=d.value;this._transitionablePaint.setValue(e,i),this._handleSpecialPaintPropertyUpdate(e);const b=this._transitionablePaint._values[e].value;return b.isDataDriven()||y||m||this._handleOverridablePaintPropertyUpdate(e,x,b)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,i,a){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,i){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Q(e,(i,a)=>!(i===void 0||a==="layout"&&!Object.keys(i).length||a==="paint"&&!Object.keys(i).length))}_validate(e,i,a,d,m={}){return(!m||m.validate!==!1)&&Fa(this,e.call(Hs,{key:i,layerType:this.type,objectKey:a,value:d,styleSpec:xe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof _i&&Yt(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}}const oh={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class to{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class pn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Tn(r,e=1){let i=0,a=0;return{members:r.map(d=>{const m=oh[d.type].BYTES_PER_ELEMENT,y=i=ou(i,Math.max(e,m)),x=d.components||1;return a=Math.max(a,m),i+=m*x,{name:d.name,type:d.type,components:x,offset:y}}),size:ou(i,Math.max(a,e)),alignment:e}}function ou(r,e){return Math.ceil(r/e)*e}class vo extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const d=2*e;return this.int16[d+0]=i,this.int16[d+1]=a,e}}vo.prototype.bytesPerElement=4,He("StructArrayLayout2i4",vo);class h extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,a,d)}emplace(e,i,a,d,m){const y=4*e;return this.int16[y+0]=i,this.int16[y+1]=a,this.int16[y+2]=d,this.int16[y+3]=m,e}}h.prototype.bytesPerElement=8,He("StructArrayLayout4i8",h);class t extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,y){const x=this.length;return this.resize(x+1),this.emplace(x,e,i,a,d,m,y)}emplace(e,i,a,d,m,y,x){const b=6*e;return this.int16[b+0]=i,this.int16[b+1]=a,this.int16[b+2]=d,this.int16[b+3]=m,this.int16[b+4]=y,this.int16[b+5]=x,e}}t.prototype.bytesPerElement=12,He("StructArrayLayout2i4i12",t);class s extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,y){const x=this.length;return this.resize(x+1),this.emplace(x,e,i,a,d,m,y)}emplace(e,i,a,d,m,y,x){const b=4*e,T=8*e;return this.int16[b+0]=i,this.int16[b+1]=a,this.uint8[T+4]=d,this.uint8[T+5]=m,this.uint8[T+6]=y,this.uint8[T+7]=x,e}}s.prototype.bytesPerElement=8,He("StructArrayLayout2i4ub8",s);class c extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const d=2*e;return this.float32[d+0]=i,this.float32[d+1]=a,e}}c.prototype.bytesPerElement=8,He("StructArrayLayout2f8",c);class p extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,y,x,b,T,z){const M=this.length;return this.resize(M+1),this.emplace(M,e,i,a,d,m,y,x,b,T,z)}emplace(e,i,a,d,m,y,x,b,T,z,M){const L=10*e;return this.uint16[L+0]=i,this.uint16[L+1]=a,this.uint16[L+2]=d,this.uint16[L+3]=m,this.uint16[L+4]=y,this.uint16[L+5]=x,this.uint16[L+6]=b,this.uint16[L+7]=T,this.uint16[L+8]=z,this.uint16[L+9]=M,e}}p.prototype.bytesPerElement=20,He("StructArrayLayout10ui20",p);class g extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,y,x,b,T,z,M,L){const B=this.length;return this.resize(B+1),this.emplace(B,e,i,a,d,m,y,x,b,T,z,M,L)}emplace(e,i,a,d,m,y,x,b,T,z,M,L,B){const F=12*e;return this.int16[F+0]=i,this.int16[F+1]=a,this.int16[F+2]=d,this.int16[F+3]=m,this.uint16[F+4]=y,this.uint16[F+5]=x,this.uint16[F+6]=b,this.uint16[F+7]=T,this.int16[F+8]=z,this.int16[F+9]=M,this.int16[F+10]=L,this.int16[F+11]=B,e}}g.prototype.bytesPerElement=24,He("StructArrayLayout4i4ui4i24",g);class v extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,a)}emplace(e,i,a,d){const m=3*e;return this.float32[m+0]=i,this.float32[m+1]=a,this.float32[m+2]=d,e}}v.prototype.bytesPerElement=12,He("StructArrayLayout3f12",v);class E extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}E.prototype.bytesPerElement=4,He("StructArrayLayout1ul4",E);class S extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,y,x,b,T){const z=this.length;return this.resize(z+1),this.emplace(z,e,i,a,d,m,y,x,b,T)}emplace(e,i,a,d,m,y,x,b,T,z){const M=10*e,L=5*e;return this.int16[M+0]=i,this.int16[M+1]=a,this.int16[M+2]=d,this.int16[M+3]=m,this.int16[M+4]=y,this.int16[M+5]=x,this.uint32[L+3]=b,this.uint16[M+8]=T,this.uint16[M+9]=z,e}}S.prototype.bytesPerElement=20,He("StructArrayLayout6i1ul2ui20",S);class k extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,y){const x=this.length;return this.resize(x+1),this.emplace(x,e,i,a,d,m,y)}emplace(e,i,a,d,m,y,x){const b=6*e;return this.int16[b+0]=i,this.int16[b+1]=a,this.int16[b+2]=d,this.int16[b+3]=m,this.int16[b+4]=y,this.int16[b+5]=x,e}}k.prototype.bytesPerElement=12,He("StructArrayLayout2i2i2i12",k);class A extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,i,a,d,m)}emplace(e,i,a,d,m,y){const x=4*e,b=8*e;return this.float32[x+0]=i,this.float32[x+1]=a,this.float32[x+2]=d,this.int16[b+6]=m,this.int16[b+7]=y,e}}A.prototype.bytesPerElement=16,He("StructArrayLayout2f1f2i16",A);class D extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,a,d)}emplace(e,i,a,d,m){const y=12*e,x=3*e;return this.uint8[y+0]=i,this.uint8[y+1]=a,this.float32[x+1]=d,this.float32[x+2]=m,e}}D.prototype.bytesPerElement=12,He("StructArrayLayout2ub2f12",D);class R extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,a)}emplace(e,i,a,d){const m=3*e;return this.uint16[m+0]=i,this.uint16[m+1]=a,this.uint16[m+2]=d,e}}R.prototype.bytesPerElement=6,He("StructArrayLayout3ui6",R);class G extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,y,x,b,T,z,M,L,B,F,H,X,le){const fe=this.length;return this.resize(fe+1),this.emplace(fe,e,i,a,d,m,y,x,b,T,z,M,L,B,F,H,X,le)}emplace(e,i,a,d,m,y,x,b,T,z,M,L,B,F,H,X,le,fe){const ie=24*e,de=12*e,be=48*e;return this.int16[ie+0]=i,this.int16[ie+1]=a,this.uint16[ie+2]=d,this.uint16[ie+3]=m,this.uint32[de+2]=y,this.uint32[de+3]=x,this.uint32[de+4]=b,this.uint16[ie+10]=T,this.uint16[ie+11]=z,this.uint16[ie+12]=M,this.float32[de+7]=L,this.float32[de+8]=B,this.uint8[be+36]=F,this.uint8[be+37]=H,this.uint8[be+38]=X,this.uint32[de+10]=le,this.int16[ie+22]=fe,e}}G.prototype.bytesPerElement=48,He("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",G);class $ extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,y,x,b,T,z,M,L,B,F,H,X,le,fe,ie,de,be,we,We,Je,Ve,Fe,De,$e){const Ne=this.length;return this.resize(Ne+1),this.emplace(Ne,e,i,a,d,m,y,x,b,T,z,M,L,B,F,H,X,le,fe,ie,de,be,we,We,Je,Ve,Fe,De,$e)}emplace(e,i,a,d,m,y,x,b,T,z,M,L,B,F,H,X,le,fe,ie,de,be,we,We,Je,Ve,Fe,De,$e,Ne){const Ce=34*e,ot=17*e;return this.int16[Ce+0]=i,this.int16[Ce+1]=a,this.int16[Ce+2]=d,this.int16[Ce+3]=m,this.int16[Ce+4]=y,this.int16[Ce+5]=x,this.int16[Ce+6]=b,this.int16[Ce+7]=T,this.uint16[Ce+8]=z,this.uint16[Ce+9]=M,this.uint16[Ce+10]=L,this.uint16[Ce+11]=B,this.uint16[Ce+12]=F,this.uint16[Ce+13]=H,this.uint16[Ce+14]=X,this.uint16[Ce+15]=le,this.uint16[Ce+16]=fe,this.uint16[Ce+17]=ie,this.uint16[Ce+18]=de,this.uint16[Ce+19]=be,this.uint16[Ce+20]=we,this.uint16[Ce+21]=We,this.uint16[Ce+22]=Je,this.uint32[ot+12]=Ve,this.float32[ot+13]=Fe,this.float32[ot+14]=De,this.float32[ot+15]=$e,this.float32[ot+16]=Ne,e}}$.prototype.bytesPerElement=68,He("StructArrayLayout8i15ui1ul4f68",$);class j extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}j.prototype.bytesPerElement=4,He("StructArrayLayout1f4",j);class ee extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,a)}emplace(e,i,a,d){const m=3*e;return this.int16[m+0]=i,this.int16[m+1]=a,this.int16[m+2]=d,e}}ee.prototype.bytesPerElement=6,He("StructArrayLayout3i6",ee);class re extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,a)}emplace(e,i,a,d){const m=4*e;return this.uint32[2*e+0]=i,this.uint16[m+2]=a,this.uint16[m+3]=d,e}}re.prototype.bytesPerElement=8,He("StructArrayLayout1ul2ui8",re);class ce extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const d=2*e;return this.uint16[d+0]=i,this.uint16[d+1]=a,e}}ce.prototype.bytesPerElement=4,He("StructArrayLayout2ui4",ce);class W extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}W.prototype.bytesPerElement=2,He("StructArrayLayout1ui2",W);class pe extends pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,a,d)}emplace(e,i,a,d,m){const y=4*e;return this.float32[y+0]=i,this.float32[y+1]=a,this.float32[y+2]=d,this.float32[y+3]=m,e}}pe.prototype.bytesPerElement=16,He("StructArrayLayout4f16",pe);class he extends to{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new st(this.anchorPointX,this.anchorPointY)}}he.prototype.size=20;class _e extends S{get(e){return new he(this,e)}}He("CollisionBoxArray",_e);class ve extends to{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}ve.prototype.size=48;class Te extends G{get(e){return new ve(this,e)}}He("PlacedSymbolArray",Te);class ye extends to{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}ye.prototype.size=68;class Ge extends ${get(e){return new ye(this,e)}}He("SymbolInstanceArray",Ge);class Be extends j{getoffsetX(e){return this.float32[1*e+0]}}He("GlyphOffsetArray",Be);class qe extends ee{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}He("SymbolLineVertexArray",qe);class gt extends to{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}gt.prototype.size=8;class vt extends re{get(e){return new gt(this,e)}}He("FeatureIndexArray",vt);class it extends vo{}class Ft extends vo{}class Ot extends vo{}class kt extends t{}class Mt extends s{}class $t extends c{}class Nn extends p{}class xi extends g{}class oi extends v{}class wi extends E{}class no extends k{}class qr extends D{}class vr extends R{}class Di extends ce{}const Ua=Tn([{name:"a_pos",components:2,type:"Int16"}],4),{members:Mn}=Ua;class bt{constructor(e=[]){this.segments=e}prepareSegment(e,i,a,d){let m=this.segments[this.segments.length-1];return e>bt.MAX_VERTEX_ARRAY_LENGTH&&Ae(`Max vertices per segment is ${bt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!m||m.vertexLength+e>bt.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==d)&&(m={vertexOffset:i.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0},d!==void 0&&(m.sortKey=d),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,a,d){return new bt([{vertexOffset:e,primitiveOffset:i,vertexLength:a,primitiveLength:d,vaos:{},sortKey:0}])}}function Bt(r,e){return 256*(r=Z(Math.floor(r),0,255))+Z(Math.floor(e),0,255)}bt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,He("SegmentVector",bt);const Un=Tn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Vn={exports:{}},rn={exports:{}};rn.exports=function(r,e){var i,a,d,m,y,x,b,T;for(a=r.length-(i=3&r.length),d=e,y=3432918353,x=461845907,T=0;T<a;)b=255&r.charCodeAt(T)|(255&r.charCodeAt(++T))<<8|(255&r.charCodeAt(++T))<<16|(255&r.charCodeAt(++T))<<24,++T,d=27492+(65535&(m=5*(65535&(d=(d^=b=(65535&(b=(b=(65535&b)*y+(((b>>>16)*y&65535)<<16)&4294967295)<<15|b>>>17))*x+(((b>>>16)*x&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(b=0,i){case 3:b^=(255&r.charCodeAt(T+2))<<16;case 2:b^=(255&r.charCodeAt(T+1))<<8;case 1:d^=b=(65535&(b=(b=(65535&(b^=255&r.charCodeAt(T)))*y+(((b>>>16)*y&65535)<<16)&4294967295)<<15|b>>>17))*x+(((b>>>16)*x&65535)<<16)&4294967295}return d^=r.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0};var Wr={exports:{}};Wr.exports=function(r,e){for(var i,a=r.length,d=e^a,m=0;a>=4;)i=1540483477*(65535&(i=255&r.charCodeAt(m)|(255&r.charCodeAt(++m))<<8|(255&r.charCodeAt(++m))<<16|(255&r.charCodeAt(++m))<<24))+((1540483477*(i>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),a-=4,++m;switch(a){case 3:d^=(255&r.charCodeAt(m+2))<<16;case 2:d^=(255&r.charCodeAt(m+1))<<8;case 1:d=1540483477*(65535&(d^=255&r.charCodeAt(m)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0};var xo=rn.exports,su=Wr.exports;Vn.exports=xo,Vn.exports.murmur3=xo,Vn.exports.murmur2=su;class ns{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,i,a,d){this.ids.push(sh(e)),this.positions.push(i,a,d)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const i=sh(e);let a=0,d=this.ids.length-1;for(;a<d;){const y=a+d>>1;this.ids[y]>=i?d=y:a=y+1}const m=[];for(;this.ids[a]===i;)m.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return m}static serialize(e,i){const a=new Float64Array(e.ids),d=new Uint32Array(e.positions);return au(a,d,0,a.length-1),i&&i.push(a.buffer,d.buffer),{ids:a,positions:d}}static deserialize(e){const i=new ns;return i.ids=e.ids,i.positions=e.positions,i.indexed=!0,i}}function sh(r){const e=+r;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:Vn.exports(String(r))}function au(r,e,i,a){for(;i<a;){const d=r[i+a>>1];let m=i-1,y=a+1;for(;;){do m++;while(r[m]<d);do y--;while(r[y]>d);if(m>=y)break;ro(r,m,y),ro(e,3*m,3*y),ro(e,3*m+1,3*y+1),ro(e,3*m+2,3*y+2)}y-i<a-y?(au(r,e,i,y),i=y+1):(au(r,e,y+1,a),a=y)}}function ro(r,e,i){const a=r[e];r[e]=r[i],r[i]=a}He("FeaturePositionMap",ns);class wo{constructor(e,i){this.gl=e.gl,this.location=i}}class bo extends wo{constructor(e,i){super(e,i),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Va extends wo{constructor(e,i){super(e,i),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class Mg extends wo{constructor(e,i){super(e,i),this.current=U.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const U0=new Float32Array(16);function fp(r){return[Bt(255*r.r,255*r.g),Bt(255*r.b,255*r.a)]}class lu{constructor(e,i,a){this.value=e,this.uniformNames=i.map(d=>`u_${d}`),this.type=a}setUniform(e,i,a){e.set(a.constantOr(this.value))}getBinding(e,i,a){return this.type==="color"?new Mg(e,i):new bo(e,i)}}class $a{constructor(e,i){this.uniformNames=i.map(a=>`u_${a}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,i){this.pixelRatioFrom=i.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=i.tlbr,this.patternTo=e.tlbr}setUniform(e,i,a,d){const m=d==="u_pattern_to"?this.patternTo:d==="u_pattern_from"?this.patternFrom:d==="u_pixel_ratio_to"?this.pixelRatioTo:d==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&e.set(m)}getBinding(e,i,a){return a.substr(0,9)==="u_pattern"?new Va(e,i):new bo(e,i)}}class Eo{constructor(e,i,a,d){this.expression=e,this.type=a,this.maxValue=0,this.paintVertexAttributes=i.map(m=>({name:`a_${m}`,type:"Float32",components:a==="color"?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(e,i,a,d,m){const y=this.paintVertexArray.length,x=this.expression.evaluate(new nn(0),i,{},d,[],m);this.paintVertexArray.resize(e),this._setPaintValue(y,e,x)}updatePaintArray(e,i,a,d){const m=this.expression.evaluate({zoom:0},a,d);this._setPaintValue(e,i,m)}_setPaintValue(e,i,a){if(this.type==="color"){const d=fp(a);for(let m=e;m<i;m++)this.paintVertexArray.emplace(m,d[0],d[1])}else{for(let d=e;d<i;d++)this.paintVertexArray.emplace(d,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Li{constructor(e,i,a,d,m,y){this.expression=e,this.uniformNames=i.map(x=>`u_${x}_t`),this.type=a,this.useIntegerZoom=d,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=i.map(x=>({name:`a_${x}`,type:"Float32",components:a==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(e,i,a,d,m){const y=this.expression.evaluate(new nn(this.zoom),i,{},d,[],m),x=this.expression.evaluate(new nn(this.zoom+1),i,{},d,[],m),b=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(b,e,y,x)}updatePaintArray(e,i,a,d){const m=this.expression.evaluate({zoom:this.zoom},a,d),y=this.expression.evaluate({zoom:this.zoom+1},a,d);this._setPaintValue(e,i,m,y)}_setPaintValue(e,i,a,d){if(this.type==="color"){const m=fp(a),y=fp(d);for(let x=e;x<i;x++)this.paintVertexArray.emplace(x,m[0],m[1],y[0],y[1])}else{for(let m=e;m<i;m++)this.paintVertexArray.emplace(m,a,d);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(d))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i){const a=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,d=Z(this.expression.interpolationFactor(a,this.zoom,this.zoom+1),0,1);e.set(d)}getBinding(e,i,a){return new bo(e,i)}}class rs{constructor(e,i,a,d,m,y){this.expression=e,this.type=i,this.useIntegerZoom=a,this.zoom=d,this.layerId=y,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(e,i,a){const d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(d,e,i.patterns&&i.patterns[this.layerId],a)}updatePaintArray(e,i,a,d,m){this._setPaintValues(e,i,a.patterns&&a.patterns[this.layerId],m)}_setPaintValues(e,i,a,d){if(!d||!a)return;const{min:m,mid:y,max:x}=a,b=d[m],T=d[y],z=d[x];if(b&&T&&z)for(let M=e;M<i;M++)this.zoomInPaintVertexArray.emplace(M,T.tl[0],T.tl[1],T.br[0],T.br[1],b.tl[0],b.tl[1],b.br[0],b.br[1],T.pixelRatio,b.pixelRatio),this.zoomOutPaintVertexArray.emplace(M,T.tl[0],T.tl[1],T.br[0],T.br[1],z.tl[0],z.tl[1],z.br[0],z.br[1],T.pixelRatio,z.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Un.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Un.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Pg{constructor(e,i,a){this.binders={},this._buffers=[];const d=[];for(const m in e.paint._values){if(!a(m))continue;const y=e.paint.get(m);if(!(y instanceof _i&&Yt(y.property.specification)))continue;const x=V0(m,e.type),b=y.value,T=y.property.specification.type,z=y.property.useIntegerZoom,M=y.property.specification["property-type"],L=M==="cross-faded"||M==="cross-faded-data-driven";if(b.kind==="constant")this.binders[m]=L?new $a(b.value,x):new lu(b.value,x,T),d.push(`/u_${m}`);else if(b.kind==="source"||L){const B=Dg(m,T,"source");this.binders[m]=L?new rs(b,T,z,i,B,e.id):new Eo(b,x,T,B),d.push(`/a_${m}`)}else{const B=Dg(m,T,"composite");this.binders[m]=new Li(b,x,T,z,i,B),d.push(`/z_${m}`)}}this.cacheKey=d.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof Eo||i instanceof Li?i.maxValue:0}populatePaintArrays(e,i,a,d,m){for(const y in this.binders){const x=this.binders[y];(x instanceof Eo||x instanceof Li||x instanceof rs)&&x.populatePaintArray(e,i,a,d,m)}}setConstantPatternPositions(e,i){for(const a in this.binders){const d=this.binders[a];d instanceof $a&&d.setConstantPatternPositions(e,i)}}updatePaintArrays(e,i,a,d,m){let y=!1;for(const x in e){const b=i.getPositions(x);for(const T of b){const z=a.feature(T.index);for(const M in this.binders){const L=this.binders[M];if((L instanceof Eo||L instanceof Li||L instanceof rs)&&L.expression.isStateDependent===!0){const B=d.paint.get(M);L.expression=B.value,L.updatePaintArray(T.start,T.end,z,e[x],m),y=!0}}}}return y}defines(){const e=[];for(const i in this.binders){const a=this.binders[i];(a instanceof lu||a instanceof $a)&&e.push(...a.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof Eo||a instanceof Li)for(let d=0;d<a.paintVertexAttributes.length;d++)e.push(a.paintVertexAttributes[d].name);else if(a instanceof rs)for(let d=0;d<Un.members.length;d++)e.push(Un.members[d].name)}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof lu||a instanceof $a||a instanceof Li)for(const d of a.uniformNames)e.push(d)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,i){const a=[];for(const d in this.binders){const m=this.binders[d];if(m instanceof lu||m instanceof $a||m instanceof Li){for(const y of m.uniformNames)if(i[y]){const x=m.getBinding(e,i[y],y);a.push({name:y,property:d,binding:x})}}}return a}setUniforms(e,i,a,d){for(const{name:m,property:y,binding:x}of i)this.binders[y].setUniform(x,d,a.get(y),m)}updatePaintBuffers(e){this._buffers=[];for(const i in this.binders){const a=this.binders[i];if(e&&a instanceof rs){const d=e.fromScale===2?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(a instanceof Eo||a instanceof Li)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(e){for(const i in this.binders){const a=this.binders[i];(a instanceof Eo||a instanceof Li||a instanceof rs)&&a.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof Eo||i instanceof Li||i instanceof rs)&&i.destroy()}}}class ea{constructor(e,i,a=()=>!0){this.programConfigurations={};for(const d of e)this.programConfigurations[d.id]=new Pg(d,i,a);this.needsUpload=!1,this._featureMap=new ns,this._bufferOffset=0}populatePaintArrays(e,i,a,d,m,y){for(const x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(e,i,d,m,y);i.id!==void 0&&this._featureMap.add(i.id,a,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,a,d){for(const m of a)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(e,this._featureMap,i,m,d)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function V0(r,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${e}-`,"").replace(/-/g,"_")]}function Dg(r,e,i){const a={color:{source:c,composite:pe},number:{source:j,composite:c}},d=function(m){return{"line-pattern":{source:Nn,composite:Nn},"fill-pattern":{source:Nn,composite:Nn},"fill-extrusion-pattern":{source:Nn,composite:Nn}}[m]}(r);return d&&d[i]||a[e][i]}He("ConstantBinder",lu),He("CrossFadedConstantBinder",$a),He("SourceExpressionBinder",Eo),He("CrossFadedCompositeBinder",rs),He("CompositeExpressionBinder",Li),He("ProgramConfiguration",Pg,{omit:["_buffers"]}),He("ProgramConfigurationSet",ea);var Pn=8192;const mp=Math.pow(2,14)-1,Lg=-mp-1;function ta(r){const e=Pn/r.extent,i=r.loadGeometry();for(let a=0;a<i.length;a++){const d=i[a];for(let m=0;m<d.length;m++){const y=d[m],x=Math.round(y.x*e),b=Math.round(y.y*e);y.x=Z(x,Lg,mp),y.y=Z(b,Lg,mp),(x<y.x||x>y.x+1||b<y.y||b>y.y+1)&&Ae("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return i}function na(r,e){return{type:r.type,id:r.id,properties:r.properties,geometry:e?ta(r):[]}}function ah(r,e,i,a,d){r.emplaceBack(2*e+(a+1)/2,2*i+(d+1)/2)}class gp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ft,this.indexArray=new vr,this.segments=new bt,this.programConfigurations=new ea(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,a){const d=this.layers[0],m=[];let y=null,x=!1;d.type==="circle"&&(y=d.layout.get("circle-sort-key"),x=!y.isConstant());for(const{feature:b,id:T,index:z,sourceLayerIndex:M}of e){const L=this.layers[0]._featureFilter.needGeometry,B=na(b,L);if(!this.layers[0]._featureFilter.filter(new nn(this.zoom),B,a))continue;const F=x?y.evaluate(B,{},a):void 0,H={id:T,properties:b.properties,type:b.type,sourceLayerIndex:M,index:z,geometry:L?B.geometry:ta(b),patterns:{},sortKey:F};m.push(H)}x&&m.sort((b,T)=>b.sortKey-T.sortKey);for(const b of m){const{geometry:T,index:z,sourceLayerIndex:M}=b,L=e[z].feature;this.addFeature(b,T,z,a),i.featureIndex.insert(L,T,z,M,this.index)}}update(e,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Mn),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,a,d){for(const m of i)for(const y of m){const x=y.x,b=y.y;if(x<0||x>=Pn||b<0||b>=Pn)continue;const T=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),z=T.vertexLength;ah(this.layoutVertexArray,x,b,-1,-1),ah(this.layoutVertexArray,x,b,1,-1),ah(this.layoutVertexArray,x,b,1,1),ah(this.layoutVertexArray,x,b,-1,1),this.indexArray.emplaceBack(z,z+1,z+2),this.indexArray.emplaceBack(z,z+3,z+2),T.vertexLength+=4,T.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,{},d)}}function Rg(r,e){for(let i=0;i<r.length;i++)if(ja(e,r[i]))return!0;for(let i=0;i<e.length;i++)if(ja(r,e[i]))return!0;return!!yp(r,e)}function $0(r,e,i){return!!ja(r,e)||!!_p(e,r,i)}function Bg(r,e){if(r.length===1)return Og(e,r[0]);for(let i=0;i<e.length;i++){const a=e[i];for(let d=0;d<a.length;d++)if(ja(r,a[d]))return!0}for(let i=0;i<r.length;i++)if(Og(e,r[i]))return!0;for(let i=0;i<e.length;i++)if(yp(r,e[i]))return!0;return!1}function j0(r,e,i){if(r.length>1){if(yp(r,e))return!0;for(let a=0;a<e.length;a++)if(_p(e[a],r,i))return!0}for(let a=0;a<r.length;a++)if(_p(r[a],e,i))return!0;return!1}function yp(r,e){if(r.length===0||e.length===0)return!1;for(let i=0;i<r.length-1;i++){const a=r[i],d=r[i+1];for(let m=0;m<e.length-1;m++)if(G0(a,d,e[m],e[m+1]))return!0}return!1}function G0(r,e,i,a){return Le(r,i,a)!==Le(e,i,a)&&Le(r,e,i)!==Le(r,e,a)}function _p(r,e,i){const a=i*i;if(e.length===1)return r.distSqr(e[0])<a;for(let d=1;d<e.length;d++)if(Fg(r,e[d-1],e[d])<a)return!0;return!1}function Fg(r,e,i){const a=e.distSqr(i);if(a===0)return r.distSqr(e);const d=((r.x-e.x)*(i.x-e.x)+(r.y-e.y)*(i.y-e.y))/a;return r.distSqr(d<0?e:d>1?i:i.sub(e)._mult(d)._add(e))}function Og(r,e){let i,a,d,m=!1;for(let y=0;y<r.length;y++){i=r[y];for(let x=0,b=i.length-1;x<i.length;b=x++)a=i[x],d=i[b],a.y>e.y!=d.y>e.y&&e.x<(d.x-a.x)*(e.y-a.y)/(d.y-a.y)+a.x&&(m=!m)}return m}function ja(r,e){let i=!1;for(let a=0,d=r.length-1;a<r.length;d=a++){const m=r[a],y=r[d];m.y>e.y!=y.y>e.y&&e.x<(y.x-m.x)*(e.y-m.y)/(y.y-m.y)+m.x&&(i=!i)}return i}function Z0(r,e,i){const a=i[0],d=i[2];if(r.x<a.x&&e.x<a.x||r.x>d.x&&e.x>d.x||r.y<a.y&&e.y<a.y||r.y>d.y&&e.y>d.y)return!1;const m=Le(r,e,i[0]);return m!==Le(r,e,i[1])||m!==Le(r,e,i[2])||m!==Le(r,e,i[3])}function uu(r,e,i){const a=e.paint.get(r).value;return a.kind==="constant"?a.value:i.programConfigurations.get(e.id).getMaxValue(r)}function lh(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function uh(r,e,i,a,d){if(!e[0]&&!e[1])return r;const m=st.convert(e)._mult(d);i==="viewport"&&m._rotate(-a);const y=[];for(let x=0;x<r.length;x++)y.push(r[x].sub(m));return y}He("CircleBucket",gp,{omit:["layers"]});const q0=new Hn({"circle-sort-key":new ut(xe.layout_circle["circle-sort-key"])});var W0={paint:new Hn({"circle-radius":new ut(xe.paint_circle["circle-radius"]),"circle-color":new ut(xe.paint_circle["circle-color"]),"circle-blur":new ut(xe.paint_circle["circle-blur"]),"circle-opacity":new ut(xe.paint_circle["circle-opacity"]),"circle-translate":new tt(xe.paint_circle["circle-translate"]),"circle-translate-anchor":new tt(xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new tt(xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new tt(xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ut(xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ut(xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ut(xe.paint_circle["circle-stroke-opacity"])}),layout:q0},xr=1e-6,wr=typeof Float32Array<"u"?Float32Array:Array;function Ng(){var r=new wr(9);return wr!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function vp(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Ug(r,e,i){var a=e[0],d=e[1],m=e[2],y=e[3],x=e[4],b=e[5],T=e[6],z=e[7],M=e[8],L=e[9],B=e[10],F=e[11],H=e[12],X=e[13],le=e[14],fe=e[15],ie=i[0],de=i[1],be=i[2],we=i[3];return r[0]=ie*a+de*x+be*M+we*H,r[1]=ie*d+de*b+be*L+we*X,r[2]=ie*m+de*T+be*B+we*le,r[3]=ie*y+de*z+be*F+we*fe,r[4]=(ie=i[4])*a+(de=i[5])*x+(be=i[6])*M+(we=i[7])*H,r[5]=ie*d+de*b+be*L+we*X,r[6]=ie*m+de*T+be*B+we*le,r[7]=ie*y+de*z+be*F+we*fe,r[8]=(ie=i[8])*a+(de=i[9])*x+(be=i[10])*M+(we=i[11])*H,r[9]=ie*d+de*b+be*L+we*X,r[10]=ie*m+de*T+be*B+we*le,r[11]=ie*y+de*z+be*F+we*fe,r[12]=(ie=i[12])*a+(de=i[13])*x+(be=i[14])*M+(we=i[15])*H,r[13]=ie*d+de*b+be*L+we*X,r[14]=ie*m+de*T+be*B+we*le,r[15]=ie*y+de*z+be*F+we*fe,r}Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});var cu,X0=Ug;function Vg(){var r=new wr(3);return wr!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function $g(r,e,i){var a=new wr(3);return a[0]=r,a[1]=e,a[2]=i,a}function ch(r,e,i){var a=e[0],d=e[1],m=e[2],y=e[3];return r[0]=i[0]*a+i[4]*d+i[8]*m+i[12]*y,r[1]=i[1]*a+i[5]*d+i[9]*m+i[13]*y,r[2]=i[2]*a+i[6]*d+i[10]*m+i[14]*y,r[3]=i[3]*a+i[7]*d+i[11]*m+i[15]*y,r}function jg(){var r=new wr(4);return wr!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function Gg(r,e){const i=ch([],[r.x,r.y,0,1],e);return new st(i[0]/i[3],i[1]/i[3])}Vg(),cu=new wr(4),wr!=Float32Array&&(cu[0]=0,cu[1]=0,cu[2]=0,cu[3]=0),Vg(),$g(1,0,0),$g(0,1,0),jg(),jg(),Ng(),function(){var r;r=new wr(2),wr!=Float32Array&&(r[0]=0,r[1]=0)}();class Zg extends gp{}He("HeatmapBucket",Zg,{omit:["layers"]});var H0={paint:new Hn({"heatmap-radius":new ut(xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ut(xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new tt(xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Qi(xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new tt(xe.paint_heatmap["heatmap-opacity"])})};function xp(r,{width:e,height:i},a,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==e*i*a)throw new RangeError(`mismatched image size. expected: ${d.length} but got: ${e*i*a}`)}else d=new Uint8Array(e*i*a);return r.width=e,r.height=i,r.data=d,r}function qg(r,{width:e,height:i},a){if(e===r.width&&i===r.height)return;const d=xp({},{width:e,height:i},a);wp(r,d,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,e),height:Math.min(r.height,i)},a),r.width=e,r.height=i,r.data=d.data}function wp(r,e,i,a,d,m){if(d.width===0||d.height===0)return e;if(d.width>r.width||d.height>r.height||i.x>r.width-d.width||i.y>r.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>e.width||d.height>e.height||a.x>e.width-d.width||a.y>e.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const y=r.data,x=e.data;if(y===x)throw new Error("srcData equals dstData, so image is already copied");for(let b=0;b<d.height;b++){const T=((i.y+b)*r.width+i.x)*m,z=((a.y+b)*e.width+a.x)*m;for(let M=0;M<d.width*m;M++)x[z+M]=y[T+M]}return e}class hu{constructor(e,i){xp(this,e,1,i)}resize(e){qg(this,e,1)}clone(){return new hu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,a,d,m){wp(e,i,a,d,m,1)}}class si{constructor(e,i){xp(this,e,4,i)}resize(e){qg(this,e,4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new si({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,a,d,m){wp(e,i,a,d,m,4)}}function Wg(r){const e={},i=r.resolution||256,a=r.clips?r.clips.length:1,d=r.image||new si({width:i,height:a});if(Math.log(i)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${i}`);const m=(y,x,b)=>{e[r.evaluationKey]=b;const T=r.expression.evaluate(e);d.data[y+x+0]=Math.floor(255*T.r/T.a),d.data[y+x+1]=Math.floor(255*T.g/T.a),d.data[y+x+2]=Math.floor(255*T.b/T.a),d.data[y+x+3]=Math.floor(255*T.a)};if(r.clips)for(let y=0,x=0;y<a;++y,x+=4*i)for(let b=0,T=0;b<i;b++,T+=4){const z=b/(i-1),{start:M,end:L}=r.clips[y];m(x,T,M*(1-z)+L*z)}else for(let y=0,x=0;y<i;y++,x+=4)m(0,x,y/(i-1));return d}He("AlphaImage",hu),He("RGBAImage",si);var K0={paint:new Hn({"hillshade-illumination-direction":new tt(xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new tt(xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new tt(xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new tt(xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new tt(xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new tt(xe.paint_hillshade["hillshade-accent-color"])})};const Y0=Tn([{name:"a_pos",components:2,type:"Int16"}],4),{members:J0}=Y0;var hh={exports:{}};function dh(r,e,i){i=i||2;var a,d,m,y,x,b,T,z=e&&e.length,M=z?e[0]*i:r.length,L=Xg(r,0,M,i,!0),B=[];if(!L||L.next===L.prev)return B;if(z&&(L=function(H,X,le,fe){var ie,de,be,we=[];for(ie=0,de=X.length;ie<de;ie++)(be=Xg(H,X[ie]*fe,ie<de-1?X[ie+1]*fe:H.length,fe,!1))===be.next&&(be.steiner=!0),we.push(s1(be));for(we.sort(r1),ie=0;ie<we.length;ie++)le=i1(we[ie],le);return le}(r,e,L,i)),r.length>80*i){a=m=r[0],d=y=r[1];for(var F=i;F<M;F+=i)(x=r[F])<a&&(a=x),(b=r[F+1])<d&&(d=b),x>m&&(m=x),b>y&&(y=b);T=(T=Math.max(m-a,y-d))!==0?32767/T:0}return du(L,B,i,a,d,T,0),B}function Xg(r,e,i,a,d){var m,y;if(d===Sp(r,e,i,a)>0)for(m=e;m<i;m+=a)y=Yg(m,r[m],r[m+1],y);else for(m=i-a;m>=e;m-=a)y=Yg(m,r[m],r[m+1],y);return y&&ph(y,y.next)&&(fu(y),y=y.next),y}function ra(r,e){if(!r)return r;e||(e=r);var i,a=r;do if(i=!1,a.steiner||!ph(a,a.next)&&gn(a.prev,a,a.next)!==0)a=a.next;else{if(fu(a),(a=e=a.prev)===a.next)break;i=!0}while(i||a!==e);return e}function du(r,e,i,a,d,m,y){if(r){!y&&m&&function(z,M,L,B){var F=z;do F.z===0&&(F.z=bp(F.x,F.y,M,L,B)),F.prevZ=F.prev,F.nextZ=F.next,F=F.next;while(F!==z);F.prevZ.nextZ=null,F.prevZ=null,function(H){var X,le,fe,ie,de,be,we,We,Je=1;do{for(le=H,H=null,de=null,be=0;le;){for(be++,fe=le,we=0,X=0;X<Je&&(we++,fe=fe.nextZ);X++);for(We=Je;we>0||We>0&&fe;)we!==0&&(We===0||!fe||le.z<=fe.z)?(ie=le,le=le.nextZ,we--):(ie=fe,fe=fe.nextZ,We--),de?de.nextZ=ie:H=ie,ie.prevZ=de,de=ie;le=fe}de.nextZ=null,Je*=2}while(be>1)}(F)}(r,a,d,m);for(var x,b,T=r;r.prev!==r.next;)if(x=r.prev,b=r.next,m?e1(r,a,d,m):Q0(r))e.push(x.i/i|0),e.push(r.i/i|0),e.push(b.i/i|0),fu(r),r=b.next,T=b.next;else if((r=b)===T){y?y===1?du(r=t1(ra(r),e,i),e,i,a,d,m,2):y===2&&n1(r,e,i,a,d,m):du(ra(r),e,i,a,d,m,1);break}}}function Q0(r){var e=r.prev,i=r,a=r.next;if(gn(e,i,a)>=0)return!1;for(var d=e.x,m=i.x,y=a.x,x=e.y,b=i.y,T=a.y,z=d<m?d<y?d:y:m<y?m:y,M=x<b?x<T?x:T:b<T?b:T,L=d>m?d>y?d:y:m>y?m:y,B=x>b?x>T?x:T:b>T?b:T,F=a.next;F!==e;){if(F.x>=z&&F.x<=L&&F.y>=M&&F.y<=B&&Ga(d,x,m,b,y,T,F.x,F.y)&&gn(F.prev,F,F.next)>=0)return!1;F=F.next}return!0}function e1(r,e,i,a){var d=r.prev,m=r,y=r.next;if(gn(d,m,y)>=0)return!1;for(var x=d.x,b=m.x,T=y.x,z=d.y,M=m.y,L=y.y,B=x<b?x<T?x:T:b<T?b:T,F=z<M?z<L?z:L:M<L?M:L,H=x>b?x>T?x:T:b>T?b:T,X=z>M?z>L?z:L:M>L?M:L,le=bp(B,F,e,i,a),fe=bp(H,X,e,i,a),ie=r.prevZ,de=r.nextZ;ie&&ie.z>=le&&de&&de.z<=fe;){if(ie.x>=B&&ie.x<=H&&ie.y>=F&&ie.y<=X&&ie!==d&&ie!==y&&Ga(x,z,b,M,T,L,ie.x,ie.y)&&gn(ie.prev,ie,ie.next)>=0||(ie=ie.prevZ,de.x>=B&&de.x<=H&&de.y>=F&&de.y<=X&&de!==d&&de!==y&&Ga(x,z,b,M,T,L,de.x,de.y)&&gn(de.prev,de,de.next)>=0))return!1;de=de.nextZ}for(;ie&&ie.z>=le;){if(ie.x>=B&&ie.x<=H&&ie.y>=F&&ie.y<=X&&ie!==d&&ie!==y&&Ga(x,z,b,M,T,L,ie.x,ie.y)&&gn(ie.prev,ie,ie.next)>=0)return!1;ie=ie.prevZ}for(;de&&de.z<=fe;){if(de.x>=B&&de.x<=H&&de.y>=F&&de.y<=X&&de!==d&&de!==y&&Ga(x,z,b,M,T,L,de.x,de.y)&&gn(de.prev,de,de.next)>=0)return!1;de=de.nextZ}return!0}function t1(r,e,i){var a=r;do{var d=a.prev,m=a.next.next;!ph(d,m)&&Hg(d,a,a.next,m)&&pu(d,m)&&pu(m,d)&&(e.push(d.i/i|0),e.push(a.i/i|0),e.push(m.i/i|0),fu(a),fu(a.next),a=r=m),a=a.next}while(a!==r);return ra(a)}function n1(r,e,i,a,d,m){var y=r;do{for(var x=y.next.next;x!==y.prev;){if(y.i!==x.i&&a1(y,x)){var b=Kg(y,x);return y=ra(y,y.next),b=ra(b,b.next),du(y,e,i,a,d,m,0),void du(b,e,i,a,d,m,0)}x=x.next}y=y.next}while(y!==r)}function r1(r,e){return r.x-e.x}function i1(r,e){var i=function(d,m){var y,x=m,b=d.x,T=d.y,z=-1/0;do{if(T<=x.y&&T>=x.next.y&&x.next.y!==x.y){var M=x.x+(T-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(M<=b&&M>z&&(z=M,y=x.x<x.next.x?x:x.next,M===b))return y}x=x.next}while(x!==m);if(!y)return null;var L,B=y,F=y.x,H=y.y,X=1/0;x=y;do b>=x.x&&x.x>=F&&b!==x.x&&Ga(T<H?b:z,T,F,H,T<H?z:b,T,x.x,x.y)&&(L=Math.abs(T-x.y)/(b-x.x),pu(x,d)&&(L<X||L===X&&(x.x>y.x||x.x===y.x&&o1(y,x)))&&(y=x,X=L)),x=x.next;while(x!==B);return y}(r,e);if(!i)return e;var a=Kg(i,r);return ra(a,a.next),ra(i,i.next)}function o1(r,e){return gn(r.prev,r,e.prev)<0&&gn(e.next,r,r.next)<0}function bp(r,e,i,a,d){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-i)*d|0)|r<<8))|r<<4))|r<<2))|r<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-a)*d|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function s1(r){var e=r,i=r;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==r);return i}function Ga(r,e,i,a,d,m,y,x){return(d-y)*(e-x)>=(r-y)*(m-x)&&(r-y)*(a-x)>=(i-y)*(e-x)&&(i-y)*(m-x)>=(d-y)*(a-x)}function a1(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!function(i,a){var d=i;do{if(d.i!==i.i&&d.next.i!==i.i&&d.i!==a.i&&d.next.i!==a.i&&Hg(d,d.next,i,a))return!0;d=d.next}while(d!==i);return!1}(r,e)&&(pu(r,e)&&pu(e,r)&&function(i,a){var d=i,m=!1,y=(i.x+a.x)/2,x=(i.y+a.y)/2;do d.y>x!=d.next.y>x&&d.next.y!==d.y&&y<(d.next.x-d.x)*(x-d.y)/(d.next.y-d.y)+d.x&&(m=!m),d=d.next;while(d!==i);return m}(r,e)&&(gn(r.prev,r,e.prev)||gn(r,e.prev,e))||ph(r,e)&&gn(r.prev,r,r.next)>0&&gn(e.prev,e,e.next)>0)}function gn(r,e,i){return(e.y-r.y)*(i.x-e.x)-(e.x-r.x)*(i.y-e.y)}function ph(r,e){return r.x===e.x&&r.y===e.y}function Hg(r,e,i,a){var d=mh(gn(r,e,i)),m=mh(gn(r,e,a)),y=mh(gn(i,a,r)),x=mh(gn(i,a,e));return d!==m&&y!==x||!(d!==0||!fh(r,i,e))||!(m!==0||!fh(r,a,e))||!(y!==0||!fh(i,r,a))||!(x!==0||!fh(i,e,a))}function fh(r,e,i){return e.x<=Math.max(r.x,i.x)&&e.x>=Math.min(r.x,i.x)&&e.y<=Math.max(r.y,i.y)&&e.y>=Math.min(r.y,i.y)}function mh(r){return r>0?1:r<0?-1:0}function pu(r,e){return gn(r.prev,r,r.next)<0?gn(r,e,r.next)>=0&&gn(r,r.prev,e)>=0:gn(r,e,r.prev)<0||gn(r,r.next,e)<0}function Kg(r,e){var i=new Ep(r.i,r.x,r.y),a=new Ep(e.i,e.x,e.y),d=r.next,m=e.prev;return r.next=e,e.prev=r,i.next=d,d.prev=i,a.next=i,i.prev=a,m.next=a,a.prev=m,a}function Yg(r,e,i,a){var d=new Ep(r,e,i);return a?(d.next=a.next,d.prev=a,a.next.prev=d,a.next=d):(d.prev=d,d.next=d),d}function fu(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Ep(r,e,i){this.i=r,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Sp(r,e,i,a){for(var d=0,m=e,y=i-a;m<i;m+=a)d+=(r[y]-r[m])*(r[m+1]+r[y+1]),y=m;return d}function l1(r,e,i,a,d){Jg(r,e,i||0,a||r.length-1,d||u1)}function Jg(r,e,i,a,d){for(;a>i;){if(a-i>600){var m=a-i+1,y=e-i+1,x=Math.log(m),b=.5*Math.exp(2*x/3),T=.5*Math.sqrt(x*b*(m-b)/m)*(y-m/2<0?-1:1);Jg(r,e,Math.max(i,Math.floor(e-y*b/m+T)),Math.min(a,Math.floor(e+(m-y)*b/m+T)),d)}var z=r[e],M=i,L=a;for(mu(r,i,e),d(r[a],z)>0&&mu(r,i,a);M<L;){for(mu(r,M,L),M++,L--;d(r[M],z)<0;)M++;for(;d(r[L],z)>0;)L--}d(r[i],z)===0?mu(r,i,L):mu(r,++L,a),L<=e&&(i=L+1),e<=L&&(a=L-1)}}function mu(r,e,i){var a=r[e];r[e]=r[i],r[i]=a}function u1(r,e){return r<e?-1:r>e?1:0}function Tp(r,e){const i=r.length;if(i<=1)return[r];const a=[];let d,m;for(let y=0;y<i;y++){const x=Me(r[y]);x!==0&&(r[y].area=Math.abs(x),m===void 0&&(m=x<0),m===x<0?(d&&a.push(d),d=[r[y]]):d.push(r[y]))}if(d&&a.push(d),e>1)for(let y=0;y<a.length;y++)a[y].length<=e||(l1(a[y],e,1,a[y].length-1,c1),a[y]=a[y].slice(0,e));return a}function c1(r,e){return e.area-r.area}function kp(r,e,i){const a=i.patternDependencies;let d=!1;for(const m of e){const y=m.paint.get(`${r}-pattern`);y.isConstant()||(d=!0);const x=y.constantOr(null);x&&(d=!0,a[x.to]=!0,a[x.from]=!0)}return d}function Cp(r,e,i,a,d){const m=d.patternDependencies;for(const y of e){const x=y.paint.get(`${r}-pattern`).value;if(x.kind!=="constant"){let b=x.evaluate({zoom:a-1},i,{},d.availableImages),T=x.evaluate({zoom:a},i,{},d.availableImages),z=x.evaluate({zoom:a+1},i,{},d.availableImages);b=b&&b.name?b.name:b,T=T&&T.name?T.name:T,z=z&&z.name?z.name:z,m[b]=!0,m[T]=!0,m[z]=!0,i.patterns[y.id]={min:b,mid:T,max:z}}}return i}hh.exports=dh,hh.exports.default=dh,dh.deviation=function(r,e,i,a){var d=e&&e.length,m=Math.abs(Sp(r,0,d?e[0]*i:r.length,i));if(d)for(var y=0,x=e.length;y<x;y++)m-=Math.abs(Sp(r,e[y]*i,y<x-1?e[y+1]*i:r.length,i));var b=0;for(y=0;y<a.length;y+=3){var T=a[y]*i,z=a[y+1]*i,M=a[y+2]*i;b+=Math.abs((r[T]-r[M])*(r[z+1]-r[T+1])-(r[T]-r[z])*(r[M+1]-r[T+1]))}return m===0&&b===0?0:Math.abs((b-m)/m)},dh.flatten=function(r){for(var e=r[0][0].length,i={vertices:[],holes:[],dimensions:e},a=0,d=0;d<r.length;d++){for(var m=0;m<r[d].length;m++)for(var y=0;y<e;y++)i.vertices.push(r[d][m][y]);d>0&&i.holes.push(a+=r[d-1].length)}return i};class Ip{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ot,this.indexArray=new vr,this.indexArray2=new Di,this.programConfigurations=new ea(e.layers,e.zoom),this.segments=new bt,this.segments2=new bt,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,a){this.hasPattern=kp("fill",this.layers,i);const d=this.layers[0].layout.get("fill-sort-key"),m=!d.isConstant(),y=[];for(const{feature:x,id:b,index:T,sourceLayerIndex:z}of e){const M=this.layers[0]._featureFilter.needGeometry,L=na(x,M);if(!this.layers[0]._featureFilter.filter(new nn(this.zoom),L,a))continue;const B=m?d.evaluate(L,{},a,i.availableImages):void 0,F={id:b,properties:x.properties,type:x.type,sourceLayerIndex:z,index:T,geometry:M?L.geometry:ta(x),patterns:{},sortKey:B};y.push(F)}m&&y.sort((x,b)=>x.sortKey-b.sortKey);for(const x of y){const{geometry:b,index:T,sourceLayerIndex:z}=x;if(this.hasPattern){const M=Cp("fill",this.layers,x,this.zoom,i);this.patternFeatures.push(M)}else this.addFeature(x,b,T,a,{});i.featureIndex.insert(e[T].feature,b,T,z,this.index)}}update(e,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a)}addFeatures(e,i,a){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,i,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,J0),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,a,d,m){for(const y of Tp(i,500)){let x=0;for(const B of y)x+=B.length;const b=this.segments.prepareSegment(x,this.layoutVertexArray,this.indexArray),T=b.vertexLength,z=[],M=[];for(const B of y){if(B.length===0)continue;B!==y[0]&&M.push(z.length/2);const F=this.segments2.prepareSegment(B.length,this.layoutVertexArray,this.indexArray2),H=F.vertexLength;this.layoutVertexArray.emplaceBack(B[0].x,B[0].y),this.indexArray2.emplaceBack(H+B.length-1,H),z.push(B[0].x),z.push(B[0].y);for(let X=1;X<B.length;X++)this.layoutVertexArray.emplaceBack(B[X].x,B[X].y),this.indexArray2.emplaceBack(H+X-1,H+X),z.push(B[X].x),z.push(B[X].y);F.vertexLength+=B.length,F.primitiveLength+=B.length}const L=hh.exports(z,M);for(let B=0;B<L.length;B+=3)this.indexArray.emplaceBack(T+L[B],T+L[B+1],T+L[B+2]);b.vertexLength+=x,b.primitiveLength+=L.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,d)}}He("FillBucket",Ip,{omit:["layers","patternFeatures"]});const h1=new Hn({"fill-sort-key":new ut(xe.layout_fill["fill-sort-key"])});var d1={paint:new Hn({"fill-antialias":new tt(xe.paint_fill["fill-antialias"]),"fill-opacity":new ut(xe.paint_fill["fill-opacity"]),"fill-color":new ut(xe.paint_fill["fill-color"]),"fill-outline-color":new ut(xe.paint_fill["fill-outline-color"]),"fill-translate":new tt(xe.paint_fill["fill-translate"]),"fill-translate-anchor":new tt(xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new ts(xe.paint_fill["fill-pattern"])}),layout:h1};const p1=Tn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),f1=Tn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:m1}=p1;var is={},g1=st,Qg=Za;function Za(r,e,i,a,d){this.properties={},this.extent=i,this.type=0,this._pbf=r,this._geometry=-1,this._keys=a,this._values=d,r.readFields(y1,this,e)}function y1(r,e,i){r==1?e.id=i.readVarint():r==2?function(a,d){for(var m=a.readVarint()+a.pos;a.pos<m;){var y=d._keys[a.readVarint()],x=d._values[a.readVarint()];d.properties[y]=x}}(i,e):r==3?e.type=i.readVarint():r==4&&(e._geometry=i.pos)}function _1(r){for(var e,i,a=0,d=0,m=r.length,y=m-1;d<m;y=d++)a+=((i=r[y]).x-(e=r[d]).x)*(e.y+i.y);return a}Za.types=["Unknown","Point","LineString","Polygon"],Za.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var e,i=r.readVarint()+r.pos,a=1,d=0,m=0,y=0,x=[];r.pos<i;){if(d<=0){var b=r.readVarint();a=7&b,d=b>>3}if(d--,a===1||a===2)m+=r.readSVarint(),y+=r.readSVarint(),a===1&&(e&&x.push(e),e=[]),e.push(new g1(m,y));else{if(a!==7)throw new Error("unknown command "+a);e&&e.push(e[0].clone())}}return e&&x.push(e),x},Za.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var e=r.readVarint()+r.pos,i=1,a=0,d=0,m=0,y=1/0,x=-1/0,b=1/0,T=-1/0;r.pos<e;){if(a<=0){var z=r.readVarint();i=7&z,a=z>>3}if(a--,i===1||i===2)(d+=r.readSVarint())<y&&(y=d),d>x&&(x=d),(m+=r.readSVarint())<b&&(b=m),m>T&&(T=m);else if(i!==7)throw new Error("unknown command "+i)}return[y,b,x,T]},Za.prototype.toGeoJSON=function(r,e,i){var a,d,m=this.extent*Math.pow(2,i),y=this.extent*r,x=this.extent*e,b=this.loadGeometry(),T=Za.types[this.type];function z(B){for(var F=0;F<B.length;F++){var H=B[F];B[F]=[360*(H.x+y)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(H.y+x)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var M=[];for(a=0;a<b.length;a++)M[a]=b[a][0];z(b=M);break;case 2:for(a=0;a<b.length;a++)z(b[a]);break;case 3:for(b=function(B){var F=B.length;if(F<=1)return[B];for(var H,X,le=[],fe=0;fe<F;fe++){var ie=_1(B[fe]);ie!==0&&(X===void 0&&(X=ie<0),X===ie<0?(H&&le.push(H),H=[B[fe]]):H.push(B[fe]))}return H&&le.push(H),le}(b),a=0;a<b.length;a++)for(d=0;d<b[a].length;d++)z(b[a][d])}b.length===1?b=b[0]:T="Multi"+T;var L={type:"Feature",geometry:{type:T,coordinates:b},properties:this.properties};return"id"in this&&(L.id=this.id),L};var v1=Qg,ey=ty;function ty(r,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(x1,this,e),this.length=this._features.length}function x1(r,e,i){r===15?e.version=i.readVarint():r===1?e.name=i.readString():r===5?e.extent=i.readVarint():r===2?e._features.push(i.pos):r===3?e._keys.push(i.readString()):r===4&&e._values.push(function(a){for(var d=null,m=a.readVarint()+a.pos;a.pos<m;){var y=a.readVarint()>>3;d=y===1?a.readString():y===2?a.readFloat():y===3?a.readDouble():y===4?a.readVarint64():y===5?a.readVarint():y===6?a.readSVarint():y===7?a.readBoolean():null}return d}(i))}ty.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var e=this._pbf.readVarint()+this._pbf.pos;return new v1(this._pbf,e,this.extent,this._keys,this._values)};var w1=ey;function b1(r,e,i){if(r===3){var a=new w1(i,i.readVarint()+i.pos);a.length&&(e[a.name]=a)}}is.VectorTile=function(r,e){this.layers=r.readFields(b1,{},e)},is.VectorTileFeature=Qg,is.VectorTileLayer=ey;const E1=is.VectorTileFeature.types,zp=Math.pow(2,13);function gu(r,e,i,a,d,m,y,x){r.emplaceBack(e,i,2*Math.floor(a*zp)+y,d*zp*2,m*zp*2,Math.round(x))}class Ap{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new kt,this.centroidVertexArray=new it,this.indexArray=new vr,this.programConfigurations=new ea(e.layers,e.zoom),this.segments=new bt,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,a){this.features=[],this.hasPattern=kp("fill-extrusion",this.layers,i);for(const{feature:d,id:m,index:y,sourceLayerIndex:x}of e){const b=this.layers[0]._featureFilter.needGeometry,T=na(d,b);if(!this.layers[0]._featureFilter.filter(new nn(this.zoom),T,a))continue;const z={id:m,sourceLayerIndex:x,index:y,geometry:b?T.geometry:ta(d),properties:d.properties,type:d.type,patterns:{}};this.hasPattern?this.features.push(Cp("fill-extrusion",this.layers,z,this.zoom,i)):this.addFeature(z,z.geometry,y,a,{}),i.featureIndex.insert(d,z.geometry,y,x,this.index,!0)}}addFeatures(e,i,a){for(const d of this.features){const{geometry:m}=d;this.addFeature(d,m,d.index,i,a)}}update(e,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,m1),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,f1.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,i,a,d,m){const y={x:0,y:0,vertexCount:0};for(const x of Tp(i,500)){let b=0;for(const F of x)b+=F.length;let T=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const F of x){if(F.length===0||T1(F))continue;let H=0;for(let X=0;X<F.length;X++){const le=F[X];if(X>=1){const fe=F[X-1];if(!S1(le,fe)){T.vertexLength+4>bt.MAX_VERTEX_ARRAY_LENGTH&&(T=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ie=le.sub(fe)._perp()._unit(),de=fe.dist(le);H+de>32768&&(H=0),gu(this.layoutVertexArray,le.x,le.y,ie.x,ie.y,0,0,H),gu(this.layoutVertexArray,le.x,le.y,ie.x,ie.y,0,1,H),y.x+=2*le.x,y.y+=2*le.y,y.vertexCount+=2,H+=de,gu(this.layoutVertexArray,fe.x,fe.y,ie.x,ie.y,0,0,H),gu(this.layoutVertexArray,fe.x,fe.y,ie.x,ie.y,0,1,H),y.x+=2*fe.x,y.y+=2*fe.y,y.vertexCount+=2;const be=T.vertexLength;this.indexArray.emplaceBack(be,be+2,be+1),this.indexArray.emplaceBack(be+1,be+2,be+3),T.vertexLength+=4,T.primitiveLength+=2}}}}if(T.vertexLength+b>bt.MAX_VERTEX_ARRAY_LENGTH&&(T=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray)),E1[e.type]!=="Polygon")continue;const z=[],M=[],L=T.vertexLength;for(const F of x)if(F.length!==0){F!==x[0]&&M.push(z.length/2);for(let H=0;H<F.length;H++){const X=F[H];gu(this.layoutVertexArray,X.x,X.y,0,0,1,1,0),y.x+=X.x,y.y+=X.y,y.vertexCount+=1,z.push(X.x),z.push(X.y)}}const B=hh.exports(z,M);for(let F=0;F<B.length;F+=3)this.indexArray.emplaceBack(L+B[F],L+B[F+2],L+B[F+1]);T.primitiveLength+=B.length/3,T.vertexLength+=b}for(let x=0;x<y.vertexCount;x++)this.centroidVertexArray.emplaceBack(Math.floor(y.x/y.vertexCount),Math.floor(y.y/y.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,d)}}function S1(r,e){return r.x===e.x&&(r.x<0||r.x>Pn)||r.y===e.y&&(r.y<0||r.y>Pn)}function T1(r){return r.every(e=>e.x<0)||r.every(e=>e.x>Pn)||r.every(e=>e.y<0)||r.every(e=>e.y>Pn)}He("FillExtrusionBucket",Ap,{omit:["layers","features"]});var k1={paint:new Hn({"fill-extrusion-opacity":new tt(xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ut(xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new tt(xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new tt(xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ts(xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ut(xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ut(xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new tt(xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function yu(r,e){return r.x*e.x+r.y*e.y}function ny(r,e){if(r.length===1){let i=0;const a=e[i++];let d;for(;!d||a.equals(d);)if(d=e[i++],!d)return 1/0;for(;i<e.length;i++){const m=e[i],y=r[0],x=d.sub(a),b=m.sub(a),T=y.sub(a),z=yu(x,x),M=yu(x,b),L=yu(b,b),B=yu(T,x),F=yu(T,b),H=z*L-M*M,X=(L*B-M*F)/H,le=(z*F-M*B)/H,fe=a.z*(1-X-le)+d.z*X+m.z*le;if(isFinite(fe))return fe}return 1/0}{let i=1/0;for(const a of e)i=Math.min(i,a.z);return i}}const C1=Tn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:I1}=C1,z1=Tn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:A1}=z1,M1=is.VectorTileFeature.types,P1=Math.cos(Math.PI/180*37.5),ry=Math.pow(2,14)/.5;class Mp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new Mt,this.layoutVertexArray2=new $t,this.indexArray=new vr,this.programConfigurations=new ea(e.layers,e.zoom),this.segments=new bt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,a){this.hasPattern=kp("line",this.layers,i);const d=this.layers[0].layout.get("line-sort-key"),m=!d.isConstant(),y=[];for(const{feature:x,id:b,index:T,sourceLayerIndex:z}of e){const M=this.layers[0]._featureFilter.needGeometry,L=na(x,M);if(!this.layers[0]._featureFilter.filter(new nn(this.zoom),L,a))continue;const B=m?d.evaluate(L,{},a):void 0,F={id:b,properties:x.properties,type:x.type,sourceLayerIndex:z,index:T,geometry:M?L.geometry:ta(x),patterns:{},sortKey:B};y.push(F)}m&&y.sort((x,b)=>x.sortKey-b.sortKey);for(const x of y){const{geometry:b,index:T,sourceLayerIndex:z}=x;if(this.hasPattern){const M=Cp("line",this.layers,x,this.zoom,i);this.patternFeatures.push(M)}else this.addFeature(x,b,T,a,{});i.featureIndex.insert(e[T].feature,b,T,z,this.index)}}update(e,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a)}addFeatures(e,i,a){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,i,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,A1)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,I1),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,a,d,m){const y=this.layers[0].layout,x=y.get("line-join").evaluate(e,{}),b=y.get("line-cap"),T=y.get("line-miter-limit"),z=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const M of i)this.addLine(M,e,x,b,T,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,d)}addLine(e,i,a,d,m,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let le=0;le<e.length-1;le++)this.totalDistance+=e[le].dist(e[le+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const x=M1[i.type]==="Polygon";let b=e.length;for(;b>=2&&e[b-1].equals(e[b-2]);)b--;let T=0;for(;T<b-1&&e[T].equals(e[T+1]);)T++;if(b<(x?3:2))return;a==="bevel"&&(m=1.05);const z=this.overscaling<=16?122880/(512*this.overscaling):0,M=this.segments.prepareSegment(10*b,this.layoutVertexArray,this.indexArray);let L,B,F,H,X;this.e1=this.e2=-1,x&&(L=e[b-2],X=e[T].sub(L)._unit()._perp());for(let le=T;le<b;le++){if(F=le===b-1?x?e[T+1]:void 0:e[le+1],F&&e[le].equals(F))continue;X&&(H=X),L&&(B=L),L=e[le],X=F?F.sub(L)._unit()._perp():H,H=H||X;let fe=H.add(X);fe.x===0&&fe.y===0||fe._unit();const ie=H.x*X.x+H.y*X.y,de=fe.x*X.x+fe.y*X.y,be=de!==0?1/de:1/0,we=2*Math.sqrt(2-2*de),We=de<P1&&B&&F,Je=H.x*X.y-H.y*X.x>0;if(We&&le>T){const De=L.dist(B);if(De>2*z){const $e=L.sub(L.sub(B)._mult(z/De)._round());this.updateDistance(B,$e),this.addCurrentVertex($e,H,0,0,M),B=$e}}const Ve=B&&F;let Fe=Ve?a:x?"butt":d;if(Ve&&Fe==="round"&&(be<y?Fe="miter":be<=2&&(Fe="fakeround")),Fe==="miter"&&be>m&&(Fe="bevel"),Fe==="bevel"&&(be>2&&(Fe="flipbevel"),be<m&&(Fe="miter")),B&&this.updateDistance(B,L),Fe==="miter")fe._mult(be),this.addCurrentVertex(L,fe,0,0,M);else if(Fe==="flipbevel"){if(be>100)fe=X.mult(-1);else{const De=be*H.add(X).mag()/H.sub(X).mag();fe._perp()._mult(De*(Je?-1:1))}this.addCurrentVertex(L,fe,0,0,M),this.addCurrentVertex(L,fe.mult(-1),0,0,M)}else if(Fe==="bevel"||Fe==="fakeround"){const De=-Math.sqrt(be*be-1),$e=Je?De:0,Ne=Je?0:De;if(B&&this.addCurrentVertex(L,H,$e,Ne,M),Fe==="fakeround"){const Ce=Math.round(180*we/Math.PI/20);for(let ot=1;ot<Ce;ot++){let nt=ot/Ce;if(nt!==.5){const Jt=nt-.5;nt+=nt*Jt*(nt-1)*((1.0904+ie*(ie*(3.55645-1.43519*ie)-3.2452))*Jt*Jt+(.848013+ie*(.215638*ie-1.06021)))}const xt=X.sub(H)._mult(nt)._add(H)._unit()._mult(Je?-1:1);this.addHalfVertex(L,xt.x,xt.y,!1,Je,0,M)}}F&&this.addCurrentVertex(L,X,-$e,-Ne,M)}else if(Fe==="butt")this.addCurrentVertex(L,fe,0,0,M);else if(Fe==="square"){const De=B?1:-1;this.addCurrentVertex(L,fe,De,De,M)}else Fe==="round"&&(B&&(this.addCurrentVertex(L,H,0,0,M),this.addCurrentVertex(L,H,1,1,M,!0)),F&&(this.addCurrentVertex(L,X,-1,-1,M,!0),this.addCurrentVertex(L,X,0,0,M)));if(We&&le<b-1){const De=L.dist(F);if(De>2*z){const $e=L.add(F.sub(L)._mult(z/De)._round());this.updateDistance(L,$e),this.addCurrentVertex($e,X,0,0,M),L=$e}}}}addCurrentVertex(e,i,a,d,m,y=!1){const x=i.y*d-i.x,b=-i.y-i.x*d;this.addHalfVertex(e,i.x+i.y*a,i.y-i.x*a,y,!1,a,m),this.addHalfVertex(e,x,b,y,!0,-d,m),this.distance>ry/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,i,a,d,m,y))}addHalfVertex({x:e,y:i},a,d,m,y,x,b){const T=.5*(this.lineClips?this.scaledDistance*(ry-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(m?1:0),(i<<1)+(y?1:0),Math.round(63*a)+128,Math.round(63*d)+128,1+(x===0?0:x<0?-1:1)|(63&T)<<2,T>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const z=b.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,z),b.primitiveLength++),y?this.e2=z:this.e1=z}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}}He("LineBucket",Mp,{omit:["layers","patternFeatures"]});const D1=new Hn({"line-cap":new tt(xe.layout_line["line-cap"]),"line-join":new ut(xe.layout_line["line-join"]),"line-miter-limit":new tt(xe.layout_line["line-miter-limit"]),"line-round-limit":new tt(xe.layout_line["line-round-limit"]),"line-sort-key":new ut(xe.layout_line["line-sort-key"])});var iy={paint:new Hn({"line-opacity":new ut(xe.paint_line["line-opacity"]),"line-color":new ut(xe.paint_line["line-color"]),"line-translate":new tt(xe.paint_line["line-translate"]),"line-translate-anchor":new tt(xe.paint_line["line-translate-anchor"]),"line-width":new ut(xe.paint_line["line-width"]),"line-gap-width":new ut(xe.paint_line["line-gap-width"]),"line-offset":new ut(xe.paint_line["line-offset"]),"line-blur":new ut(xe.paint_line["line-blur"]),"line-dasharray":new iu(xe.paint_line["line-dasharray"]),"line-pattern":new ts(xe.paint_line["line-pattern"]),"line-gradient":new Qi(xe.paint_line["line-gradient"])}),layout:D1};const oy=new class extends ut{possiblyEvaluate(r,e){return e=new nn(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(r,e)}evaluate(r,e,i,a){return e=Ie({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(r,e,i,a)}}(iy.paint.properties["line-width"].specification);function sy(r,e){return e>0?e+2*r:r}oy.useIntegerZoom=!0;const L1=Tn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),R1=Tn([{name:"a_projected_pos",components:3,type:"Float32"}],4);Tn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const B1=Tn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Tn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const ay=Tn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),F1=Tn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function O1(r,e,i){return r.sections.forEach(a=>{a.text=function(d,m,y){const x=m.layout.get("text-transform").evaluate(y,{});return x==="uppercase"?d=d.toLocaleUpperCase():x==="lowercase"&&(d=d.toLocaleLowerCase()),Zr.applyArabicShaping&&(d=Zr.applyArabicShaping(d)),d}(a.text,e,i)}),r}Tn([{name:"triangle",components:3,type:"Uint16"}]),Tn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Tn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Tn([{type:"Float32",name:"offsetX"}]),Tn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const _u={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Kn=24,Pp=Wt,ly=function(r,e,i,a,d){var m,y,x=8*d-a-1,b=(1<<x)-1,T=b>>1,z=-7,M=i?d-1:0,L=i?-1:1,B=r[e+M];for(M+=L,m=B&(1<<-z)-1,B>>=-z,z+=x;z>0;m=256*m+r[e+M],M+=L,z-=8);for(y=m&(1<<-z)-1,m>>=-z,z+=a;z>0;y=256*y+r[e+M],M+=L,z-=8);if(m===0)m=1-T;else{if(m===b)return y?NaN:1/0*(B?-1:1);y+=Math.pow(2,a),m-=T}return(B?-1:1)*y*Math.pow(2,m-a)},uy=function(r,e,i,a,d,m){var y,x,b,T=8*m-d-1,z=(1<<T)-1,M=z>>1,L=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,B=a?0:m-1,F=a?1:-1,H=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(x=isNaN(e)?1:0,y=z):(y=Math.floor(Math.log(e)/Math.LN2),e*(b=Math.pow(2,-y))<1&&(y--,b*=2),(e+=y+M>=1?L/b:L*Math.pow(2,1-M))*b>=2&&(y++,b/=2),y+M>=z?(x=0,y=z):y+M>=1?(x=(e*b-1)*Math.pow(2,d),y+=M):(x=e*Math.pow(2,M-1)*Math.pow(2,d),y=0));d>=8;r[i+B]=255&x,B+=F,x/=256,d-=8);for(y=y<<d|x,T+=d;T>0;r[i+B]=255&y,B+=F,y/=256,T-=8);r[i+B-F]|=128*H};function Wt(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}Wt.Varint=0,Wt.Fixed64=1,Wt.Bytes=2,Wt.Fixed32=5;var os,Dp=4294967296,cy=1/Dp,hy=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function So(r){return r.type===Wt.Bytes?r.readVarint()+r.pos:r.pos+1}function qa(r,e,i){return i?4294967296*e+(r>>>0):4294967296*(e>>>0)+(r>>>0)}function dy(r,e,i){var a=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(a);for(var d=i.pos-1;d>=r;d--)i.buf[d+a]=i.buf[d]}function N1(r,e){for(var i=0;i<r.length;i++)e.writeVarint(r[i])}function U1(r,e){for(var i=0;i<r.length;i++)e.writeSVarint(r[i])}function V1(r,e){for(var i=0;i<r.length;i++)e.writeFloat(r[i])}function $1(r,e){for(var i=0;i<r.length;i++)e.writeDouble(r[i])}function j1(r,e){for(var i=0;i<r.length;i++)e.writeBoolean(r[i])}function G1(r,e){for(var i=0;i<r.length;i++)e.writeFixed32(r[i])}function Z1(r,e){for(var i=0;i<r.length;i++)e.writeSFixed32(r[i])}function q1(r,e){for(var i=0;i<r.length;i++)e.writeFixed64(r[i])}function W1(r,e){for(var i=0;i<r.length;i++)e.writeSFixed64(r[i])}function gh(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+16777216*r[e+3]}function Wa(r,e,i){r[i]=e,r[i+1]=e>>>8,r[i+2]=e>>>16,r[i+3]=e>>>24}function py(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+(r[e+3]<<24)}function X1(r,e,i){r===1&&i.readMessage(H1,e)}function H1(r,e,i){if(r===3){const{id:a,bitmap:d,width:m,height:y,left:x,top:b,advance:T}=i.readMessage(K1,{});e.push({id:a,bitmap:new hu({width:m+6,height:y+6},d),metrics:{width:m,height:y,left:x,top:b,advance:T}})}}function K1(r,e,i){r===1?e.id=i.readVarint():r===2?e.bitmap=i.readBytes():r===3?e.width=i.readVarint():r===4?e.height=i.readVarint():r===5?e.left=i.readSVarint():r===6?e.top=i.readSVarint():r===7&&(e.advance=i.readVarint())}function fy(r){let e=0,i=0;for(const y of r)e+=y.w*y.h,i=Math.max(i,y.w);r.sort((y,x)=>x.h-y.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let d=0,m=0;for(const y of r)for(let x=a.length-1;x>=0;x--){const b=a[x];if(!(y.w>b.w||y.h>b.h)){if(y.x=b.x,y.y=b.y,m=Math.max(m,y.y+y.h),d=Math.max(d,y.x+y.w),y.w===b.w&&y.h===b.h){const T=a.pop();x<a.length&&(a[x]=T)}else y.h===b.h?(b.x+=y.w,b.w-=y.w):y.w===b.w?(b.y+=y.h,b.h-=y.h):(a.push({x:b.x+y.w,y:b.y,w:b.w-y.w,h:y.h}),b.y+=y.h,b.h-=y.h);break}}return{w:d,h:m,fill:e/(d*m)||0}}Wt.prototype={destroy:function(){this.buf=null},readFields:function(r,e,i){for(i=i||this.length;this.pos<i;){var a=this.readVarint(),d=a>>3,m=this.pos;this.type=7&a,r(d,e,this),this.pos===m&&this.skip(a)}return e},readMessage:function(r,e){return this.readFields(r,e,this.readVarint()+this.pos)},readFixed32:function(){var r=gh(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=py(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=gh(this.buf,this.pos)+gh(this.buf,this.pos+4)*Dp;return this.pos+=8,r},readSFixed64:function(){var r=gh(this.buf,this.pos)+py(this.buf,this.pos+4)*Dp;return this.pos+=8,r},readFloat:function(){var r=ly(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=ly(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var e,i,a=this.buf;return e=127&(i=a[this.pos++]),i<128?e:(e|=(127&(i=a[this.pos++]))<<7,i<128?e:(e|=(127&(i=a[this.pos++]))<<14,i<128?e:(e|=(127&(i=a[this.pos++]))<<21,i<128?e:function(d,m,y){var x,b,T=y.buf;if(x=(112&(b=T[y.pos++]))>>4,b<128||(x|=(127&(b=T[y.pos++]))<<3,b<128)||(x|=(127&(b=T[y.pos++]))<<10,b<128)||(x|=(127&(b=T[y.pos++]))<<17,b<128)||(x|=(127&(b=T[y.pos++]))<<24,b<128)||(x|=(1&(b=T[y.pos++]))<<31,b<128))return qa(d,x,m);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=a[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var r=this.readVarint()+this.pos,e=this.pos;return this.pos=r,r-e>=12&&hy?function(i,a,d){return hy.decode(i.subarray(a,d))}(this.buf,e,r):function(i,a,d){for(var m="",y=a;y<d;){var x,b,T,z=i[y],M=null,L=z>239?4:z>223?3:z>191?2:1;if(y+L>d)break;L===1?z<128&&(M=z):L===2?(192&(x=i[y+1]))==128&&(M=(31&z)<<6|63&x)<=127&&(M=null):L===3?(b=i[y+2],(192&(x=i[y+1]))==128&&(192&b)==128&&((M=(15&z)<<12|(63&x)<<6|63&b)<=2047||M>=55296&&M<=57343)&&(M=null)):L===4&&(b=i[y+2],T=i[y+3],(192&(x=i[y+1]))==128&&(192&b)==128&&(192&T)==128&&((M=(15&z)<<18|(63&x)<<12|(63&b)<<6|63&T)<=65535||M>=1114112)&&(M=null)),M===null?(M=65533,L=1):M>65535&&(M-=65536,m+=String.fromCharCode(M>>>10&1023|55296),M=56320|1023&M),m+=String.fromCharCode(M),y+=L}return m}(this.buf,e,r)},readBytes:function(){var r=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,r);return this.pos=r,e},readPackedVarint:function(r,e){if(this.type!==Wt.Bytes)return r.push(this.readVarint(e));var i=So(this);for(r=r||[];this.pos<i;)r.push(this.readVarint(e));return r},readPackedSVarint:function(r){if(this.type!==Wt.Bytes)return r.push(this.readSVarint());var e=So(this);for(r=r||[];this.pos<e;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==Wt.Bytes)return r.push(this.readBoolean());var e=So(this);for(r=r||[];this.pos<e;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==Wt.Bytes)return r.push(this.readFloat());var e=So(this);for(r=r||[];this.pos<e;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==Wt.Bytes)return r.push(this.readDouble());var e=So(this);for(r=r||[];this.pos<e;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==Wt.Bytes)return r.push(this.readFixed32());var e=So(this);for(r=r||[];this.pos<e;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==Wt.Bytes)return r.push(this.readSFixed32());var e=So(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==Wt.Bytes)return r.push(this.readFixed64());var e=So(this);for(r=r||[];this.pos<e;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==Wt.Bytes)return r.push(this.readSFixed64());var e=So(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed64());return r},skip:function(r){var e=7&r;if(e===Wt.Varint)for(;this.buf[this.pos++]>127;);else if(e===Wt.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Wt.Fixed32)this.pos+=4;else{if(e!==Wt.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(r,e){this.writeVarint(r<<3|e)},realloc:function(r){for(var e=this.length||16;e<this.pos+r;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),Wa(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),Wa(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),Wa(this.buf,-1&r,this.pos),Wa(this.buf,Math.floor(r*cy),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),Wa(this.buf,-1&r,this.pos),Wa(this.buf,Math.floor(r*cy),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(e,i){var a,d;if(e>=0?(a=e%4294967296|0,d=e/4294967296|0):(d=~(-e/4294967296),4294967295^(a=~(-e%4294967296))?a=a+1|0:(a=0,d=d+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(m,y,x){x.buf[x.pos++]=127&m|128,m>>>=7,x.buf[x.pos++]=127&m|128,m>>>=7,x.buf[x.pos++]=127&m|128,m>>>=7,x.buf[x.pos++]=127&m|128,x.buf[x.pos]=127&(m>>>=7)}(a,0,i),function(m,y){var x=(7&m)<<4;y.buf[y.pos++]|=x|((m>>>=3)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m)))))}(d,i)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(Boolean(r))},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var e=this.pos;this.pos=function(a,d,m){for(var y,x,b=0;b<d.length;b++){if((y=d.charCodeAt(b))>55295&&y<57344){if(!x){y>56319||b+1===d.length?(a[m++]=239,a[m++]=191,a[m++]=189):x=y;continue}if(y<56320){a[m++]=239,a[m++]=191,a[m++]=189,x=y;continue}y=x-55296<<10|y-56320|65536,x=null}else x&&(a[m++]=239,a[m++]=191,a[m++]=189,x=null);y<128?a[m++]=y:(y<2048?a[m++]=y>>6|192:(y<65536?a[m++]=y>>12|224:(a[m++]=y>>18|240,a[m++]=y>>12&63|128),a[m++]=y>>6&63|128),a[m++]=63&y|128)}return m}(this.buf,r,this.pos);var i=this.pos-e;i>=128&&dy(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(r){this.realloc(4),uy(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),uy(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var e=r.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=r[i]},writeRawMessage:function(r,e){this.pos++;var i=this.pos;r(e,this);var a=this.pos-i;a>=128&&dy(i,a,this),this.pos=i-1,this.writeVarint(a),this.pos+=a},writeMessage:function(r,e,i){this.writeTag(r,Wt.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(r,e){e.length&&this.writeMessage(r,N1,e)},writePackedSVarint:function(r,e){e.length&&this.writeMessage(r,U1,e)},writePackedBoolean:function(r,e){e.length&&this.writeMessage(r,j1,e)},writePackedFloat:function(r,e){e.length&&this.writeMessage(r,V1,e)},writePackedDouble:function(r,e){e.length&&this.writeMessage(r,$1,e)},writePackedFixed32:function(r,e){e.length&&this.writeMessage(r,G1,e)},writePackedSFixed32:function(r,e){e.length&&this.writeMessage(r,Z1,e)},writePackedFixed64:function(r,e){e.length&&this.writeMessage(r,q1,e)},writePackedSFixed64:function(r,e){e.length&&this.writeMessage(r,W1,e)},writeBytesField:function(r,e){this.writeTag(r,Wt.Bytes),this.writeBytes(e)},writeFixed32Field:function(r,e){this.writeTag(r,Wt.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(r,e){this.writeTag(r,Wt.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(r,e){this.writeTag(r,Wt.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(r,e){this.writeTag(r,Wt.Fixed64),this.writeSFixed64(e)},writeVarintField:function(r,e){this.writeTag(r,Wt.Varint),this.writeVarint(e)},writeSVarintField:function(r,e){this.writeTag(r,Wt.Varint),this.writeSVarint(e)},writeStringField:function(r,e){this.writeTag(r,Wt.Bytes),this.writeString(e)},writeFloatField:function(r,e){this.writeTag(r,Wt.Fixed32),this.writeFloat(e)},writeDoubleField:function(r,e){this.writeTag(r,Wt.Fixed64),this.writeDouble(e)},writeBooleanField:function(r,e){this.writeVarintField(r,Boolean(e))}};class Lp{constructor(e,{pixelRatio:i,version:a,stretchX:d,stretchY:m,content:y}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=d,this.stretchY=m,this.content=y,this.version=a}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class my{constructor(e,i){const a={},d={};this.haveRenderCallbacks=[];const m=[];this.addImages(e,a,m),this.addImages(i,d,m);const{w:y,h:x}=fy(m),b=new si({width:y||1,height:x||1});for(const T in e){const z=e[T],M=a[T].paddedRect;si.copy(z.data,b,{x:0,y:0},{x:M.x+1,y:M.y+1},z.data)}for(const T in i){const z=i[T],M=d[T].paddedRect,L=M.x+1,B=M.y+1,F=z.data.width,H=z.data.height;si.copy(z.data,b,{x:0,y:0},{x:L,y:B},z.data),si.copy(z.data,b,{x:0,y:H-1},{x:L,y:B-1},{width:F,height:1}),si.copy(z.data,b,{x:0,y:0},{x:L,y:B+H},{width:F,height:1}),si.copy(z.data,b,{x:F-1,y:0},{x:L-1,y:B},{width:1,height:H}),si.copy(z.data,b,{x:0,y:0},{x:L+F,y:B},{width:1,height:H})}this.image=b,this.iconPositions=a,this.patternPositions=d}addImages(e,i,a){for(const d in e){const m=e[d],y={x:0,y:0,w:m.data.width+2,h:m.data.height+2};a.push(y),i[d]=new Lp(y,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(e,i){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in e.updatedImages)this.patchUpdatedImage(this.iconPositions[a],e.getImage(a),i),this.patchUpdatedImage(this.patternPositions[a],e.getImage(a),i)}patchUpdatedImage(e,i,a){if(!e||!i||e.version===i.version)return;e.version=i.version;const[d,m]=e.tl;a.update(i.data,void 0,{x:d,y:m})}}He("ImagePosition",Lp),He("ImageAtlas",my),u.WritingMode=void 0,(os=u.WritingMode||(u.WritingMode={}))[os.none=0]="none",os[os.horizontal=1]="horizontal",os[os.vertical=2]="vertical",os[os.horizontalOnly=3]="horizontalOnly";const yh=-17;class vu{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,i){const a=new vu;return a.scale=e||1,a.fontStack=i,a}static forImage(e){const i=new vu;return i.imageName=e,i}}class Xa{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,i){const a=new Xa;for(let d=0;d<e.sections.length;d++){const m=e.sections[d];m.image?a.addImageSection(m):a.addTextSection(m,i)}return a}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let i="";for(let a=0;a<e.length;a++){const d=e.charCodeAt(a+1)||null,m=e.charCodeAt(a-1)||null;i+=d&&Yc(d)&&!_u[e[a+1]]||m&&Yc(m)&&!_u[e[a-1]]||!_u[e[a]]?e[a]:_u[e[a]]}return i}(this.text)}trim(){let e=0;for(let a=0;a<this.text.length&&vh[this.text.charCodeAt(a)];a++)e++;let i=this.text.length;for(let a=this.text.length-1;a>=0&&a>=e&&vh[this.text.charCodeAt(a)];a--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)}substring(e,i){const a=new Xa;return a.text=this.text.substring(e,i),a.sectionIndex=this.sectionIndex.slice(e,i),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,i)=>Math.max(e,this.sections[i].scale),0)}addTextSection(e,i){this.text+=e.text,this.sections.push(vu.forText(e.scale,e.fontStack||i));const a=this.sections.length-1;for(let d=0;d<e.text.length;++d)this.sectionIndex.push(a)}addImageSection(e){const i=e.image?e.image.name:"";if(i.length===0)return void Ae("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(vu.forImage(i)),this.sectionIndex.push(this.sections.length-1)):Ae("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function _h(r,e,i,a,d,m,y,x,b,T,z,M,L,B,F,H){const X=Xa.fromFeature(r,d);let le;M===u.WritingMode.vertical&&X.verticalizePunctuation();const{processBidirectionalText:fe,processStyledBidirectionalText:ie}=Zr;if(fe&&X.sections.length===1){le=[];const we=fe(X.toString(),Rp(X,T,m,e,a,B,F));for(const We of we){const Je=new Xa;Je.text=We,Je.sections=X.sections;for(let Ve=0;Ve<We.length;Ve++)Je.sectionIndex.push(0);le.push(Je)}}else if(ie){le=[];const we=ie(X.text,X.sectionIndex,Rp(X,T,m,e,a,B,F));for(const We of we){const Je=new Xa;Je.text=We[0],Je.sectionIndex=We[1],Je.sections=X.sections,le.push(Je)}}else le=function(we,We){const Je=[],Ve=we.text;let Fe=0;for(const De of We)Je.push(we.substring(Fe,De)),Fe=De;return Fe<Ve.length&&Je.push(we.substring(Fe,Ve.length)),Je}(X,Rp(X,T,m,e,a,B,F));const de=[],be={positionedLines:de,text:X.toString(),top:z[1],bottom:z[1],left:z[0],right:z[0],writingMode:M,iconsInText:!1,verticalizable:!1};return function(we,We,Je,Ve,Fe,De,$e,Ne,Ce,ot,nt,xt){let Jt=0,on=yh,Dn=0,li=0;const tr=Ne==="right"?1:Ne==="left"?0:.5;let kn=0;for(const Cn of Fe){Cn.trim();const rr=Cn.getMaxScale(),dr=(rr-1)*Kn,br={positionedGlyphs:[],lineOffset:0};we.positionedLines[kn]=br;const Br=br.positionedGlyphs;let Fr=0;if(!Cn.length()){on+=De,++kn;continue}for(let jn=0;jn<Cn.length();jn++){const Et=Cn.getSection(jn),Xr=Cn.getSectionIndex(jn),ir=Cn.getCharCode(jn);let pr=0,bi=null,Ri=null,Bi=null,ko=Kn;const Ei=!(Ce===u.WritingMode.horizontal||!nt&&!Jl(ir)||nt&&(vh[ir]||($n=ir,Ue.Arabic($n)||Ue["Arabic Supplement"]($n)||Ue["Arabic Extended-A"]($n)||Ue["Arabic Presentation Forms-A"]($n)||Ue["Arabic Presentation Forms-B"]($n))));if(Et.imageName){const ui=Ve[Et.imageName];if(!ui)continue;Bi=Et.imageName,we.iconsInText=we.iconsInText||!0,Ri=ui.paddedRect;const Or=ui.displaySize;Et.scale=Et.scale*Kn/xt,bi={width:Or[0],height:Or[1],left:1,top:-3,advance:Ei?Or[1]:Or[0]},pr=dr+(Kn-Or[1]*Et.scale),ko=bi.advance;const Co=Ei?Or[0]*Et.scale-Kn*rr:Or[1]*Et.scale-Kn*rr;Co>0&&Co>Fr&&(Fr=Co)}else{const ui=Je[Et.fontStack],Or=ui&&ui[ir];if(Or&&Or.rect)Ri=Or.rect,bi=Or.metrics;else{const Co=We[Et.fontStack],bu=Co&&Co[ir];if(!bu)continue;bi=bu.metrics}pr=(rr-Et.scale)*Kn}Ei?(we.verticalizable=!0,Br.push({glyph:ir,imageName:Bi,x:Jt,y:on+pr,vertical:Ei,scale:Et.scale,fontStack:Et.fontStack,sectionIndex:Xr,metrics:bi,rect:Ri}),Jt+=ko*Et.scale+ot):(Br.push({glyph:ir,imageName:Bi,x:Jt,y:on+pr,vertical:Ei,scale:Et.scale,fontStack:Et.fontStack,sectionIndex:Xr,metrics:bi,rect:Ri}),Jt+=bi.advance*Et.scale+ot)}Br.length!==0&&(Dn=Math.max(Jt-ot,Dn),Q1(Br,0,Br.length-1,tr,Fr)),Jt=0;const ln=De*rr+Fr;br.lineOffset=Math.max(Fr,dr),on+=ln,li=Math.max(ln,li),++kn}var $n;const nr=on-yh,{horizontalAlign:hr,verticalAlign:Rr}=Bp($e);(function(Cn,rr,dr,br,Br,Fr,ln,jn,Et){const Xr=(rr-dr)*Br;let ir=0;ir=Fr!==ln?-jn*br-yh:(-br*Et+.5)*ln;for(const pr of Cn)for(const bi of pr.positionedGlyphs)bi.x+=Xr,bi.y+=ir})(we.positionedLines,tr,hr,Rr,Dn,li,De,nr,Fe.length),we.top+=-Rr*nr,we.bottom=we.top+nr,we.left+=-hr*Dn,we.right=we.left+Dn}(be,e,i,a,le,y,x,b,M,T,L,H),!function(we){for(const We of we)if(We.positionedGlyphs.length!==0)return!1;return!0}(de)&&be}const vh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Y1={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function gy(r,e,i,a,d,m){if(e.imageName){const y=a[e.imageName];return y?y.displaySize[0]*e.scale*Kn/m+d:0}{const y=i[e.fontStack],x=y&&y[r];return x?x.metrics.advance*e.scale+d:0}}function yy(r,e,i,a){const d=Math.pow(r-e,2);return a?r<e?d/2:2*d:d+Math.abs(i)*i}function J1(r,e,i){let a=0;return r===10&&(a-=1e4),i&&(a+=150),r!==40&&r!==65288||(a+=50),e!==41&&e!==65289||(a+=50),a}function _y(r,e,i,a,d,m){let y=null,x=yy(e,i,d,m);for(const b of a){const T=yy(e-b.x,i,d,m)+b.badness;T<=x&&(y=b,x=T)}return{index:r,x:e,priorBreak:y,badness:x}}function vy(r){return r?vy(r.priorBreak).concat(r.index):[]}function Rp(r,e,i,a,d,m,y){if(m!=="point")return[];if(!r)return[];const x=[],b=function(L,B,F,H,X,le){let fe=0;for(let ie=0;ie<L.length();ie++){const de=L.getSection(ie);fe+=gy(L.getCharCode(ie),de,H,X,B,le)}return fe/Math.max(1,Math.ceil(fe/F))}(r,e,i,a,d,y),T=r.text.indexOf("")>=0;let z=0;for(let L=0;L<r.length();L++){const B=r.getSection(L),F=r.getCharCode(L);if(vh[F]||(z+=gy(F,B,a,d,e,y)),L<r.length()-1){const H=!((M=F)<11904||!(Ue["Bopomofo Extended"](M)||Ue.Bopomofo(M)||Ue["CJK Compatibility Forms"](M)||Ue["CJK Compatibility Ideographs"](M)||Ue["CJK Compatibility"](M)||Ue["CJK Radicals Supplement"](M)||Ue["CJK Strokes"](M)||Ue["CJK Symbols and Punctuation"](M)||Ue["CJK Unified Ideographs Extension A"](M)||Ue["CJK Unified Ideographs"](M)||Ue["Enclosed CJK Letters and Months"](M)||Ue["Halfwidth and Fullwidth Forms"](M)||Ue.Hiragana(M)||Ue["Ideographic Description Characters"](M)||Ue["Kangxi Radicals"](M)||Ue["Katakana Phonetic Extensions"](M)||Ue.Katakana(M)||Ue["Vertical Forms"](M)||Ue["Yi Radicals"](M)||Ue["Yi Syllables"](M)));(Y1[F]||H||B.imageName)&&x.push(_y(L+1,z,b,x,J1(F,r.getCharCode(L+1),H&&T),!1))}}var M;return vy(_y(r.length(),z,b,x,0,!0))}function Bp(r){let e=.5,i=.5;switch(r){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function Q1(r,e,i,a,d){if(!a&&!d)return;const m=r[i],y=(r[i].x+m.metrics.advance*m.scale)*a;for(let x=e;x<=i;x++)r[x].x-=y,r[x].y+=d}function ew(r,e,i){const{horizontalAlign:a,verticalAlign:d}=Bp(i),m=e[0]-r.displaySize[0]*a,y=e[1]-r.displaySize[1]*d;return{image:r,top:y,bottom:y+r.displaySize[1],left:m,right:m+r.displaySize[0]}}function xy(r,e,i,a,d,m){const y=r.image;let x;if(y.content){const X=y.content,le=y.pixelRatio||1;x=[X[0]/le,X[1]/le,y.displaySize[0]-X[2]/le,y.displaySize[1]-X[3]/le]}const b=e.left*m,T=e.right*m;let z,M,L,B;i==="width"||i==="both"?(B=d[0]+b-a[3],M=d[0]+T+a[1]):(B=d[0]+(b+T-y.displaySize[0])/2,M=B+y.displaySize[0]);const F=e.top*m,H=e.bottom*m;return i==="height"||i==="both"?(z=d[1]+F-a[0],L=d[1]+H+a[2]):(z=d[1]+(F+H-y.displaySize[1])/2,L=z+y.displaySize[1]),{image:y,top:z,right:M,bottom:L,left:B,collisionPadding:x}}const To=128;function wy(r,e){const{expression:i}=e;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new nn(r+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:a,interpolationType:d}=i;let m=0;for(;m<a.length&&a[m]<=r;)m++;m=Math.max(0,m-1);let y=m;for(;y<a.length&&a[y]<r+1;)y++;y=Math.min(a.length-1,y);const x=a[m],b=a[y];return i.kind==="composite"?{kind:"composite",minZoom:x,maxZoom:b,interpolationType:d}:{kind:"camera",minZoom:x,maxZoom:b,minSize:i.evaluate(new nn(x)),maxSize:i.evaluate(new nn(b)),interpolationType:d}}}class ss extends st{constructor(e,i,a,d){super(e,i),this.angle=a,d!==void 0&&(this.segment=d)}clone(){return new ss(this.x,this.y,this.angle,this.segment)}}function by(r,e,i,a,d){if(e.segment===void 0)return!0;let m=e,y=e.segment+1,x=0;for(;x>-i/2;){if(y--,y<0)return!1;x-=r[y].dist(m),m=r[y]}x+=r[y].dist(r[y+1]),y++;const b=[];let T=0;for(;x<i/2;){const z=r[y],M=r[y+1];if(!M)return!1;let L=r[y-1].angleTo(z)-z.angleTo(M);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),b.push({distance:x,angleDelta:L}),T+=L;x-b[0].distance>a;)T-=b.shift().angleDelta;if(T>d)return!1;y++,x+=z.dist(M)}return!0}function Ey(r){let e=0;for(let i=0;i<r.length-1;i++)e+=r[i].dist(r[i+1]);return e}function Sy(r,e,i){return r?.6*e*i:0}function Ty(r,e){return Math.max(r?r.right-r.left:0,e?e.right-e.left:0)}function tw(r,e,i,a,d,m){const y=Sy(i,d,m),x=Ty(i,a)*m;let b=0;const T=Ey(r)/2;for(let z=0;z<r.length-1;z++){const M=r[z],L=r[z+1],B=M.dist(L);if(b+B>T){const F=(T-b)/B,H=en(M.x,L.x,F),X=en(M.y,L.y,F),le=new ss(H,X,L.angleTo(M),z);return le._round(),!y||by(r,le,x,y,e)?le:void 0}b+=B}}function nw(r,e,i,a,d,m,y,x,b){const T=Sy(a,m,y),z=Ty(a,d),M=z*y,L=r[0].x===0||r[0].x===b||r[0].y===0||r[0].y===b;return e-M<e/4&&(e=M+e/4),ky(r,L?e/2*x%e:(z/2+2*m)*y*x%e,e,T,i,M,L,!1,b)}function ky(r,e,i,a,d,m,y,x,b){const T=m/2,z=Ey(r);let M=0,L=e-i,B=[];for(let F=0;F<r.length-1;F++){const H=r[F],X=r[F+1],le=H.dist(X),fe=X.angleTo(H);for(;L+i<M+le;){L+=i;const ie=(L-M)/le,de=en(H.x,X.x,ie),be=en(H.y,X.y,ie);if(de>=0&&de<b&&be>=0&&be<b&&L-T>=0&&L+T<=z){const we=new ss(de,be,fe,F);we._round(),a&&!by(r,we,m,a,d)||B.push(we)}}M+=le}return x||B.length||y||(B=ky(r,M/2,i,a,d,m,y,!0,b)),B}function Cy(r,e,i,a,d){const m=[];for(let y=0;y<r.length;y++){const x=r[y];let b;for(let T=0;T<x.length-1;T++){let z=x[T],M=x[T+1];z.x<e&&M.x<e||(z.x<e?z=new st(e,z.y+(e-z.x)/(M.x-z.x)*(M.y-z.y))._round():M.x<e&&(M=new st(e,z.y+(e-z.x)/(M.x-z.x)*(M.y-z.y))._round()),z.y<i&&M.y<i||(z.y<i?z=new st(z.x+(i-z.y)/(M.y-z.y)*(M.x-z.x),i)._round():M.y<i&&(M=new st(z.x+(i-z.y)/(M.y-z.y)*(M.x-z.x),i)._round()),z.x>=a&&M.x>=a||(z.x>=a?z=new st(a,z.y+(a-z.x)/(M.x-z.x)*(M.y-z.y))._round():M.x>=a&&(M=new st(a,z.y+(a-z.x)/(M.x-z.x)*(M.y-z.y))._round()),z.y>=d&&M.y>=d||(z.y>=d?z=new st(z.x+(d-z.y)/(M.y-z.y)*(M.x-z.x),d)._round():M.y>=d&&(M=new st(z.x+(d-z.y)/(M.y-z.y)*(M.x-z.x),d)._round()),b&&z.equals(b[b.length-1])||(b=[z],m.push(b)),b.push(M)))))}}return m}function Iy(r,e,i,a){const d=[],m=r.image,y=m.pixelRatio,x=m.paddedRect.w-2,b=m.paddedRect.h-2,T=r.right-r.left,z=r.bottom-r.top,M=m.stretchX||[[0,x]],L=m.stretchY||[[0,b]],B=(De,$e)=>De+$e[1]-$e[0],F=M.reduce(B,0),H=L.reduce(B,0),X=x-F,le=b-H;let fe=0,ie=F,de=0,be=H,we=0,We=X,Je=0,Ve=le;if(m.content&&a){const De=m.content;fe=xh(M,0,De[0]),de=xh(L,0,De[1]),ie=xh(M,De[0],De[2]),be=xh(L,De[1],De[3]),we=De[0]-fe,Je=De[1]-de,We=De[2]-De[0]-ie,Ve=De[3]-De[1]-be}const Fe=(De,$e,Ne,Ce)=>{const ot=wh(De.stretch-fe,ie,T,r.left),nt=bh(De.fixed-we,We,De.stretch,F),xt=wh($e.stretch-de,be,z,r.top),Jt=bh($e.fixed-Je,Ve,$e.stretch,H),on=wh(Ne.stretch-fe,ie,T,r.left),Dn=bh(Ne.fixed-we,We,Ne.stretch,F),li=wh(Ce.stretch-de,be,z,r.top),tr=bh(Ce.fixed-Je,Ve,Ce.stretch,H),kn=new st(ot,xt),$n=new st(on,xt),nr=new st(on,li),hr=new st(ot,li),Rr=new st(nt/y,Jt/y),Cn=new st(Dn/y,tr/y),rr=e*Math.PI/180;if(rr){const Br=Math.sin(rr),Fr=Math.cos(rr),ln=[Fr,-Br,Br,Fr];kn._matMult(ln),$n._matMult(ln),hr._matMult(ln),nr._matMult(ln)}const dr=De.stretch+De.fixed,br=$e.stretch+$e.fixed;return{tl:kn,tr:$n,bl:hr,br:nr,tex:{x:m.paddedRect.x+1+dr,y:m.paddedRect.y+1+br,w:Ne.stretch+Ne.fixed-dr,h:Ce.stretch+Ce.fixed-br},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Rr,pixelOffsetBR:Cn,minFontScaleX:We/y/T,minFontScaleY:Ve/y/z,isSDF:i}};if(a&&(m.stretchX||m.stretchY)){const De=zy(M,X,F),$e=zy(L,le,H);for(let Ne=0;Ne<De.length-1;Ne++){const Ce=De[Ne],ot=De[Ne+1];for(let nt=0;nt<$e.length-1;nt++)d.push(Fe(Ce,$e[nt],ot,$e[nt+1]))}}else d.push(Fe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:b+1}));return d}function xh(r,e,i){let a=0;for(const d of r)a+=Math.max(e,Math.min(i,d[1]))-Math.max(e,Math.min(i,d[0]));return a}function zy(r,e,i){const a=[{fixed:-1,stretch:0}];for(const[d,m]of r){const y=a[a.length-1];a.push({fixed:d-y.stretch,stretch:y.stretch}),a.push({fixed:d-y.stretch,stretch:y.stretch+(m-d)})}return a.push({fixed:e+1,stretch:i}),a}function wh(r,e,i,a){return r/e*i+a}function bh(r,e,i,a){return r-e*i/a}He("Anchor",ss);class Eh{constructor(e,i,a,d,m,y,x,b,T,z){if(this.boxStartIndex=e.length,T){let M=y.top,L=y.bottom;const B=y.collisionPadding;B&&(M-=B[1],L+=B[3]);let F=L-M;F>0&&(F=Math.max(10,F),this.circleDiameter=F)}else{let M=y.top*x-b[0],L=y.bottom*x+b[2],B=y.left*x-b[3],F=y.right*x+b[1];const H=y.collisionPadding;if(H&&(B-=H[0]*x,M-=H[1]*x,F+=H[2]*x,L+=H[3]*x),z){const X=new st(B,M),le=new st(F,M),fe=new st(B,L),ie=new st(F,L),de=z*Math.PI/180;X._rotate(de),le._rotate(de),fe._rotate(de),ie._rotate(de),B=Math.min(X.x,le.x,fe.x,ie.x),F=Math.max(X.x,le.x,fe.x,ie.x),M=Math.min(X.y,le.y,fe.y,ie.y),L=Math.max(X.y,le.y,fe.y,ie.y)}e.emplaceBack(i.x,i.y,B,M,F,L,a,d,m)}this.boxEndIndex=e.length}}class rw{constructor(e=[],i=iw){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:a}=this,d=i[e];for(;e>0;){const m=e-1>>1,y=i[m];if(a(d,y)>=0)break;i[e]=y,e=m}i[e]=d}_down(e){const{data:i,compare:a}=this,d=this.length>>1,m=i[e];for(;e<d;){let y=1+(e<<1),x=i[y];const b=y+1;if(b<this.length&&a(i[b],x)<0&&(y=b,x=i[b]),a(x,m)>=0)break;i[e]=x,e=y}i[e]=m}}function iw(r,e){return r<e?-1:r>e?1:0}function ow(r,e=1,i=!1){let a=1/0,d=1/0,m=-1/0,y=-1/0;const x=r[0];for(let B=0;B<x.length;B++){const F=x[B];(!B||F.x<a)&&(a=F.x),(!B||F.y<d)&&(d=F.y),(!B||F.x>m)&&(m=F.x),(!B||F.y>y)&&(y=F.y)}const b=Math.min(m-a,y-d);let T=b/2;const z=new rw([],sw);if(b===0)return new st(a,d);for(let B=a;B<m;B+=b)for(let F=d;F<y;F+=b)z.push(new Ha(B+T,F+T,T,r));let M=function(B){let F=0,H=0,X=0;const le=B[0];for(let fe=0,ie=le.length,de=ie-1;fe<ie;de=fe++){const be=le[fe],we=le[de],We=be.x*we.y-we.x*be.y;H+=(be.x+we.x)*We,X+=(be.y+we.y)*We,F+=3*We}return new Ha(H/F,X/F,0,B)}(r),L=z.length;for(;z.length;){const B=z.pop();(B.d>M.d||!M.d)&&(M=B,i&&console.log("found best %d after %d probes",Math.round(1e4*B.d)/1e4,L)),B.max-M.d<=e||(T=B.h/2,z.push(new Ha(B.p.x-T,B.p.y-T,T,r)),z.push(new Ha(B.p.x+T,B.p.y-T,T,r)),z.push(new Ha(B.p.x-T,B.p.y+T,T,r)),z.push(new Ha(B.p.x+T,B.p.y+T,T,r)),L+=4)}return i&&(console.log(`num probes: ${L}`),console.log(`best distance: ${M.d}`)),M.p}function sw(r,e){return e.max-r.max}function Ha(r,e,i,a){this.p=new st(r,e),this.h=i,this.d=function(d,m){let y=!1,x=1/0;for(let b=0;b<m.length;b++){const T=m[b];for(let z=0,M=T.length,L=M-1;z<M;L=z++){const B=T[z],F=T[L];B.y>d.y!=F.y>d.y&&d.x<(F.x-B.x)*(d.y-B.y)/(F.y-B.y)+B.x&&(y=!y),x=Math.min(x,Fg(d,B,F))}}return(y?1:-1)*Math.sqrt(x)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}const Fp=Number.POSITIVE_INFINITY;function Ay(r,e){return e[1]!==Fp?function(i,a,d){let m=0,y=0;switch(a=Math.abs(a),d=Math.abs(d),i){case"top-right":case"top-left":case"top":y=d-7;break;case"bottom-right":case"bottom-left":case"bottom":y=7-d}switch(i){case"top-right":case"bottom-right":case"right":m=-a;break;case"top-left":case"bottom-left":case"left":m=a}return[m,y]}(r,e[0],e[1]):function(i,a){let d=0,m=0;a<0&&(a=0);const y=a/Math.sqrt(2);switch(i){case"top-right":case"top-left":m=y-7;break;case"bottom-right":case"bottom-left":m=7-y;break;case"bottom":m=7-a;break;case"top":m=a-7}switch(i){case"top-right":case"bottom-right":d=-y;break;case"top-left":case"bottom-left":d=y;break;case"left":d=a;break;case"right":d=-a}return[d,m]}(r,e[0])}function Op(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function aw(r,e,i,a,d,m,y,x,b,T,z){let M=m.textMaxSize.evaluate(e,{});M===void 0&&(M=y);const L=r.layers[0].layout,B=L.get("icon-offset").evaluate(e,{},z),F=Py(i.horizontal),H=y/24,X=r.tilePixelRatio*H,le=r.tilePixelRatio*M/24,fe=r.tilePixelRatio*x,ie=r.tilePixelRatio*L.get("symbol-spacing"),de=L.get("text-padding")*r.tilePixelRatio,be=function(Ce,ot,nt,xt=1){const Jt=Ce.get("icon-padding").evaluate(ot,{},nt),on=Jt&&Jt.values;return[on[0]*xt,on[1]*xt,on[2]*xt,on[3]*xt]}(L,e,z,r.tilePixelRatio),we=L.get("text-max-angle")/180*Math.PI,We=L.get("text-rotation-alignment")!=="viewport"&&L.get("symbol-placement")!=="point",Je=L.get("icon-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",Ve=L.get("symbol-placement"),Fe=ie/2,De=L.get("icon-text-fit");let $e;a&&De!=="none"&&(r.allowVerticalPlacement&&i.vertical&&($e=xy(a,i.vertical,De,L.get("icon-text-fit-padding"),B,H)),F&&(a=xy(a,F,De,L.get("icon-text-fit-padding"),B,H)));const Ne=(Ce,ot)=>{ot.x<0||ot.x>=Pn||ot.y<0||ot.y>=Pn||function(nt,xt,Jt,on,Dn,li,tr,kn,$n,nr,hr,Rr,Cn,rr,dr,br,Br,Fr,ln,jn,Et,Xr,ir,pr,bi){const Ri=nt.addToLineVertexArray(xt,Jt);let Bi,ko,Ei,ui,Or=0,Co=0,bu=0,Xy=0,Xp=-1,Hp=-1;const Io={};let Hy=Vn.exports(""),Kp=0,Yp=0;if(kn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Kp,Yp]=kn.layout.get("text-offset").evaluate(Et,{},pr).map(Nr=>Nr*Kn):(Kp=kn.layout.get("text-radial-offset").evaluate(Et,{},pr)*Kn,Yp=Fp),nt.allowVerticalPlacement&&on.vertical){const Nr=kn.layout.get("text-rotate").evaluate(Et,{},pr)+90;Ei=new Eh($n,xt,nr,hr,Rr,on.vertical,Cn,rr,dr,Nr),tr&&(ui=new Eh($n,xt,nr,hr,Rr,tr,Br,Fr,dr,Nr))}if(Dn){const Nr=kn.layout.get("icon-rotate").evaluate(Et,{}),io=kn.layout.get("icon-text-fit")!=="none",Eu=Iy(Dn,Nr,ir,io),Su=tr?Iy(tr,Nr,ir,io):void 0;ko=new Eh($n,xt,nr,hr,Rr,Dn,Br,Fr,!1,Nr),Or=4*Eu.length;const Jy=nt.iconSizeData;let oa=null;Jy.kind==="source"?(oa=[To*kn.layout.get("icon-size").evaluate(Et,{})],oa[0]>as&&Ae(`${nt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Jy.kind==="composite"&&(oa=[To*Xr.compositeIconSizes[0].evaluate(Et,{},pr),To*Xr.compositeIconSizes[1].evaluate(Et,{},pr)],(oa[0]>as||oa[1]>as)&&Ae(`${nt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),nt.addSymbols(nt.icon,Eu,oa,jn,ln,Et,u.WritingMode.none,xt,Ri.lineStartIndex,Ri.lineLength,-1,pr),Xp=nt.icon.placedSymbolArray.length-1,Su&&(Co=4*Su.length,nt.addSymbols(nt.icon,Su,oa,jn,ln,Et,u.WritingMode.vertical,xt,Ri.lineStartIndex,Ri.lineLength,-1,pr),Hp=nt.icon.placedSymbolArray.length-1)}const Ky=Object.keys(on.horizontal);for(const Nr of Ky){const io=on.horizontal[Nr];if(!Bi){Hy=Vn.exports(io.text);const Su=kn.layout.get("text-rotate").evaluate(Et,{},pr);Bi=new Eh($n,xt,nr,hr,Rr,io,Cn,rr,dr,Su)}const Eu=io.positionedLines.length===1;if(bu+=My(nt,xt,io,li,kn,dr,Et,br,Ri,on.vertical?u.WritingMode.horizontal:u.WritingMode.horizontalOnly,Eu?Ky:[Nr],Io,Xp,Xr,pr),Eu)break}on.vertical&&(Xy+=My(nt,xt,on.vertical,li,kn,dr,Et,br,Ri,u.WritingMode.vertical,["vertical"],Io,Hp,Xr,pr));const xw=Bi?Bi.boxStartIndex:nt.collisionBoxArray.length,ww=Bi?Bi.boxEndIndex:nt.collisionBoxArray.length,bw=Ei?Ei.boxStartIndex:nt.collisionBoxArray.length,Ew=Ei?Ei.boxEndIndex:nt.collisionBoxArray.length,Sw=ko?ko.boxStartIndex:nt.collisionBoxArray.length,Tw=ko?ko.boxEndIndex:nt.collisionBoxArray.length,kw=ui?ui.boxStartIndex:nt.collisionBoxArray.length,Cw=ui?ui.boxEndIndex:nt.collisionBoxArray.length;let Fi=-1;const Ih=(Nr,io)=>Nr&&Nr.circleDiameter?Math.max(Nr.circleDiameter,io):io;Fi=Ih(Bi,Fi),Fi=Ih(Ei,Fi),Fi=Ih(ko,Fi),Fi=Ih(ui,Fi);const Yy=Fi>-1?1:0;Yy&&(Fi*=bi/Kn),nt.glyphOffsetArray.length>=Ka.MAX_GLYPHS&&Ae("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Et.sortKey!==void 0&&nt.addToSortKeyRanges(nt.symbolInstances.length,Et.sortKey),nt.symbolInstances.emplaceBack(xt.x,xt.y,Io.right>=0?Io.right:-1,Io.center>=0?Io.center:-1,Io.left>=0?Io.left:-1,Io.vertical||-1,Xp,Hp,Hy,xw,ww,bw,Ew,Sw,Tw,kw,Cw,nr,bu,Xy,Or,Co,Yy,0,Cn,Kp,Yp,Fi)}(r,ot,Ce,i,a,d,$e,r.layers[0],r.collisionBoxArray,e.index,e.sourceLayerIndex,r.index,X,[de,de,de,de],We,b,fe,be,Je,B,e,m,T,z,y)};if(Ve==="line")for(const Ce of Cy(e.geometry,0,0,Pn,Pn)){const ot=nw(Ce,ie,we,i.vertical||F,a,24,le,r.overscaling,Pn);for(const nt of ot){const xt=F;xt&&lw(r,xt.text,Fe,nt)||Ne(Ce,nt)}}else if(Ve==="line-center"){for(const Ce of e.geometry)if(Ce.length>1){const ot=tw(Ce,we,i.vertical||F,a,24,le);ot&&Ne(Ce,ot)}}else if(e.type==="Polygon")for(const Ce of Tp(e.geometry,0)){const ot=ow(Ce,16);Ne(Ce[0],new ss(ot.x,ot.y,0))}else if(e.type==="LineString")for(const Ce of e.geometry)Ne(Ce,new ss(Ce[0].x,Ce[0].y,0));else if(e.type==="Point")for(const Ce of e.geometry)for(const ot of Ce)Ne([ot],new ss(ot.x,ot.y,0))}const as=32640;function My(r,e,i,a,d,m,y,x,b,T,z,M,L,B,F){const H=function(fe,ie,de,be,we,We,Je,Ve){const Fe=be.layout.get("text-rotate").evaluate(We,{})*Math.PI/180,De=[];for(const $e of ie.positionedLines)for(const Ne of $e.positionedGlyphs){if(!Ne.rect)continue;const Ce=Ne.rect||{};let ot=4,nt=!0,xt=1,Jt=0;const on=(we||Ve)&&Ne.vertical,Dn=Ne.metrics.advance*Ne.scale/2;if(Ve&&ie.verticalizable){const ln=(Ne.scale-1)*Kn,jn=(Kn-Ne.metrics.width*Ne.scale)/2;Jt=$e.lineOffset/2-(Ne.imageName?-jn:ln)}if(Ne.imageName){const ln=Je[Ne.imageName];nt=ln.sdf,xt=ln.pixelRatio,ot=1/xt}const li=we?[Ne.x+Dn,Ne.y]:[0,0];let tr=we?[0,0]:[Ne.x+Dn+de[0],Ne.y+de[1]-Jt],kn=[0,0];on&&(kn=tr,tr=[0,0]);const $n=(Ne.metrics.left-ot)*Ne.scale-Dn+tr[0],nr=(-Ne.metrics.top-ot)*Ne.scale+tr[1],hr=$n+Ce.w*Ne.scale/xt,Rr=nr+Ce.h*Ne.scale/xt,Cn=new st($n,nr),rr=new st(hr,nr),dr=new st($n,Rr),br=new st(hr,Rr);if(on){const ln=new st(-Dn,Dn-yh),jn=-Math.PI/2,Et=12-Dn,Xr=new st(22-Et,-(Ne.imageName?Et:0)),ir=new st(...kn);Cn._rotateAround(jn,ln)._add(Xr)._add(ir),rr._rotateAround(jn,ln)._add(Xr)._add(ir),dr._rotateAround(jn,ln)._add(Xr)._add(ir),br._rotateAround(jn,ln)._add(Xr)._add(ir)}if(Fe){const ln=Math.sin(Fe),jn=Math.cos(Fe),Et=[jn,-ln,ln,jn];Cn._matMult(Et),rr._matMult(Et),dr._matMult(Et),br._matMult(Et)}const Br=new st(0,0),Fr=new st(0,0);De.push({tl:Cn,tr:rr,bl:dr,br,tex:Ce,writingMode:ie.writingMode,glyphOffset:li,sectionIndex:Ne.sectionIndex,isSDF:nt,pixelOffsetTL:Br,pixelOffsetBR:Fr,minFontScaleX:0,minFontScaleY:0})}return De}(0,i,x,d,m,y,a,r.allowVerticalPlacement),X=r.textSizeData;let le=null;X.kind==="source"?(le=[To*d.layout.get("text-size").evaluate(y,{})],le[0]>as&&Ae(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):X.kind==="composite"&&(le=[To*B.compositeTextSizes[0].evaluate(y,{},F),To*B.compositeTextSizes[1].evaluate(y,{},F)],(le[0]>as||le[1]>as)&&Ae(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),r.addSymbols(r.text,H,le,x,m,y,T,e,b.lineStartIndex,b.lineLength,L,F);for(const fe of z)M[fe]=r.text.placedSymbolArray.length-1;return 4*H.length}function Py(r){for(const e in r)return r[e];return null}function lw(r,e,i,a){const d=r.compareText;if(e in d){const m=d[e];for(let y=m.length-1;y>=0;y--)if(a.dist(m[y])<i)return!0}else d[e]=[];return d[e].push(a),!1}const uw=is.VectorTileFeature.types,cw=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Sh(r,e,i,a,d,m,y,x,b,T,z,M,L){const B=x?Math.min(as,Math.round(x[0])):0,F=x?Math.min(as,Math.round(x[1])):0;r.emplaceBack(e,i,Math.round(32*a),Math.round(32*d),m,y,(B<<1)+(b?1:0),F,16*T,16*z,256*M,256*L)}function Np(r,e,i){r.emplaceBack(e.x,e.y,i),r.emplaceBack(e.x,e.y,i),r.emplaceBack(e.x,e.y,i),r.emplaceBack(e.x,e.y,i)}function hw(r){for(const e of r.sections)if(Qc(e.text))return!0;return!1}class Up{constructor(e){this.layoutVertexArray=new xi,this.indexArray=new vr,this.programConfigurations=e,this.segments=new bt,this.dynamicLayoutVertexArray=new oi,this.opacityVertexArray=new wi,this.placedSymbolArray=new Te}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,i,a,d){this.isEmpty()||(a&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,L1.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,R1.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,cw,!0),this.opacityVertexBuffer.itemSize=1),(a||d)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}He("SymbolBuffers",Up);class Vp{constructor(e,i,a){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new a,this.segments=new bt,this.collisionVertexArray=new qr}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,B1.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}He("CollisionBuffers",Vp);class Ka{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(y=>y.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=vp([]),this.placementViewportMatrix=vp([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=wy(this.zoom,i["text-size"]),this.iconSizeData=wy(this.zoom,i["icon-size"]);const a=this.layers[0].layout,d=a.get("symbol-sort-key"),m=a.get("symbol-z-order");this.canOverlap=jp(a,"text-overlap","text-allow-overlap")!=="never"||jp(a,"icon-overlap","icon-allow-overlap")!=="never"||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&!d.isConstant(),this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,a.get("symbol-placement")==="point"&&(this.writingModes=a.get("text-writing-mode").map(y=>u.WritingMode[y])),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=e.sourceID}createArrays(){this.text=new Up(new ea(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Up(new ea(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Be,this.lineVertexArray=new qe,this.symbolInstances=new Ge}calculateGlyphDependencies(e,i,a,d,m){for(let y=0;y<e.length;y++)if(i[e.charCodeAt(y)]=!0,(a||d)&&m){const x=_u[e.charAt(y)];x&&(i[x.charCodeAt(0)]=!0)}}populate(e,i,a){const d=this.layers[0],m=d.layout,y=m.get("text-font"),x=m.get("text-field"),b=m.get("icon-image"),T=(x.value.kind!=="constant"||x.value.value instanceof J&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),z=b.value.kind!=="constant"||!!b.value.value||Object.keys(b.parameters).length>0,M=m.get("symbol-sort-key");if(this.features=[],!T&&!z)return;const L=i.iconDependencies,B=i.glyphDependencies,F=i.availableImages,H=new nn(this.zoom);for(const{feature:X,id:le,index:fe,sourceLayerIndex:ie}of e){const de=d._featureFilter.needGeometry,be=na(X,de);if(!d._featureFilter.filter(H,be,a))continue;let we,We;if(de||(be.geometry=ta(X)),T){const Ve=d.getValueAndResolveTokens("text-field",be,a,F),Fe=J.factory(Ve);hw(Fe)&&(this.hasRTLText=!0),(!this.hasRTLText||Ys()==="unavailable"||this.hasRTLText&&Zr.isParsed())&&(we=O1(Fe,d,be))}if(z){const Ve=d.getValueAndResolveTokens("icon-image",be,a,F);We=Ve instanceof ne?Ve:ne.fromString(Ve)}if(!we&&!We)continue;const Je=this.sortFeaturesByKey?M.evaluate(be,{},a):void 0;if(this.features.push({id:le,text:we,icon:We,index:fe,sourceLayerIndex:ie,geometry:be.geometry,properties:X.properties,type:uw[X.type],sortKey:Je}),We&&(L[We.name]=!0),we){const Ve=y.evaluate(be,{},a).join(","),Fe=m.get("text-rotation-alignment")!=="viewport"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(u.WritingMode.vertical)>=0;for(const De of we.sections)if(De.image)L[De.image.name]=!0;else{const $e=Oa(we.toString()),Ne=De.fontStack||Ve,Ce=B[Ne]=B[Ne]||{};this.calculateGlyphDependencies(De.text,Ce,Fe,this.allowVerticalPlacement,$e)}}}m.get("symbol-placement")==="line"&&(this.features=function(X){const le={},fe={},ie=[];let de=0;function be(Ve){ie.push(X[Ve]),de++}function we(Ve,Fe,De){const $e=fe[Ve];return delete fe[Ve],fe[Fe]=$e,ie[$e].geometry[0].pop(),ie[$e].geometry[0]=ie[$e].geometry[0].concat(De[0]),$e}function We(Ve,Fe,De){const $e=le[Fe];return delete le[Fe],le[Ve]=$e,ie[$e].geometry[0].shift(),ie[$e].geometry[0]=De[0].concat(ie[$e].geometry[0]),$e}function Je(Ve,Fe,De){const $e=De?Fe[0][Fe[0].length-1]:Fe[0][0];return`${Ve}:${$e.x}:${$e.y}`}for(let Ve=0;Ve<X.length;Ve++){const Fe=X[Ve],De=Fe.geometry,$e=Fe.text?Fe.text.toString():null;if(!$e){be(Ve);continue}const Ne=Je($e,De),Ce=Je($e,De,!0);if(Ne in fe&&Ce in le&&fe[Ne]!==le[Ce]){const ot=We(Ne,Ce,De),nt=we(Ne,Ce,ie[ot].geometry);delete le[Ne],delete fe[Ce],fe[Je($e,ie[nt].geometry,!0)]=nt,ie[ot].geometry=null}else Ne in fe?we(Ne,Ce,De):Ce in le?We(Ne,Ce,De):(be(Ve),le[Ne]=de-1,fe[Ce]=de-1)}return ie.filter(Ve=>Ve.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((X,le)=>X.sortKey-le.sortKey)}update(e,i,a){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,i,this.layers,a),this.icon.programConfigurations.updatePaintArrays(e,i,this.layers,a))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const a=this.lineVertexArray.length;if(e.segment!==void 0){let d=e.dist(i[e.segment+1]),m=e.dist(i[e.segment]);const y={};for(let x=e.segment+1;x<i.length;x++)y[x]={x:i[x].x,y:i[x].y,tileUnitDistanceFromAnchor:d},x<i.length-1&&(d+=i[x+1].dist(i[x]));for(let x=e.segment||0;x>=0;x--)y[x]={x:i[x].x,y:i[x].y,tileUnitDistanceFromAnchor:m},x>0&&(m+=i[x-1].dist(i[x]));for(let x=0;x<i.length;x++){const b=y[x];this.lineVertexArray.emplaceBack(b.x,b.y,b.tileUnitDistanceFromAnchor)}}return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(e,i,a,d,m,y,x,b,T,z,M,L){const B=e.indexArray,F=e.layoutVertexArray,H=e.segments.prepareSegment(4*i.length,F,B,this.canOverlap?y.sortKey:void 0),X=this.glyphOffsetArray.length,le=H.vertexLength,fe=this.allowVerticalPlacement&&x===u.WritingMode.vertical?Math.PI/2:0,ie=y.text&&y.text.sections;for(let de=0;de<i.length;de++){const{tl:be,tr:we,bl:We,br:Je,tex:Ve,pixelOffsetTL:Fe,pixelOffsetBR:De,minFontScaleX:$e,minFontScaleY:Ne,glyphOffset:Ce,isSDF:ot,sectionIndex:nt}=i[de],xt=H.vertexLength,Jt=Ce[1];Sh(F,b.x,b.y,be.x,Jt+be.y,Ve.x,Ve.y,a,ot,Fe.x,Fe.y,$e,Ne),Sh(F,b.x,b.y,we.x,Jt+we.y,Ve.x+Ve.w,Ve.y,a,ot,De.x,Fe.y,$e,Ne),Sh(F,b.x,b.y,We.x,Jt+We.y,Ve.x,Ve.y+Ve.h,a,ot,Fe.x,De.y,$e,Ne),Sh(F,b.x,b.y,Je.x,Jt+Je.y,Ve.x+Ve.w,Ve.y+Ve.h,a,ot,De.x,De.y,$e,Ne),Np(e.dynamicLayoutVertexArray,b,fe),B.emplaceBack(xt,xt+1,xt+2),B.emplaceBack(xt+1,xt+2,xt+3),H.vertexLength+=4,H.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ce[0]),de!==i.length-1&&nt===i[de+1].sectionIndex||e.programConfigurations.populatePaintArrays(F.length,y,y.index,{},L,ie&&ie[nt])}e.placedSymbolArray.emplaceBack(b.x,b.y,X,this.glyphOffsetArray.length-X,le,T,z,b.segment,a?a[0]:0,a?a[1]:0,d[0],d[1],x,0,!1,0,M)}_addCollisionDebugVertex(e,i,a,d,m,y){return i.emplaceBack(0,0),e.emplaceBack(a.x,a.y,d,m,Math.round(y.x),Math.round(y.y))}addCollisionDebugVertices(e,i,a,d,m,y,x){const b=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),T=b.vertexLength,z=m.layoutVertexArray,M=m.collisionVertexArray,L=x.anchorX,B=x.anchorY;this._addCollisionDebugVertex(z,M,y,L,B,new st(e,i)),this._addCollisionDebugVertex(z,M,y,L,B,new st(a,i)),this._addCollisionDebugVertex(z,M,y,L,B,new st(a,d)),this._addCollisionDebugVertex(z,M,y,L,B,new st(e,d)),b.vertexLength+=4;const F=m.indexArray;F.emplaceBack(T,T+1),F.emplaceBack(T+1,T+2),F.emplaceBack(T+2,T+3),F.emplaceBack(T+3,T),b.primitiveLength+=4}addDebugCollisionBoxes(e,i,a,d){for(let m=e;m<i;m++){const y=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(y.x1,y.y1,y.x2,y.y2,d?this.textCollisionBox:this.iconCollisionBox,y.anchorPoint,a)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Vp(no,ay.members,Di),this.iconCollisionBox=new Vp(no,ay.members,Di);for(let e=0;e<this.symbolInstances.length;e++){const i=this.symbolInstances.get(e);this.addDebugCollisionBoxes(i.textBoxStartIndex,i.textBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.iconBoxStartIndex,i.iconBoxEndIndex,i,!1),this.addDebugCollisionBoxes(i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex,i,!1)}}_deserializeCollisionBoxesForSymbol(e,i,a,d,m,y,x,b,T){const z={};for(let M=i;M<a;M++){const L=e.get(M);z.textBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},z.textFeatureIndex=L.featureIndex;break}for(let M=d;M<m;M++){const L=e.get(M);z.verticalTextBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},z.verticalTextFeatureIndex=L.featureIndex;break}for(let M=y;M<x;M++){const L=e.get(M);z.iconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},z.iconFeatureIndex=L.featureIndex;break}for(let M=b;M<T;M++){const L=e.get(M);z.verticalIconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},z.verticalIconFeatureIndex=L.featureIndex;break}return z}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const a=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,i){const a=e.placedSymbolArray.get(i),d=a.vertexStartIndex+4*a.numGlyphs;for(let m=a.vertexStartIndex;m<d;m+=4)e.indexArray.emplaceBack(m,m+1,m+2),e.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(e),a=Math.cos(e),d=[],m=[],y=[];for(let x=0;x<this.symbolInstances.length;++x){y.push(x);const b=this.symbolInstances.get(x);d.push(0|Math.round(i*b.anchorX+a*b.anchorY)),m.push(b.featureIndex)}return y.sort((x,b)=>d[x]-d[b]||m[b]-m[x]),y}addToSortKeyRanges(e,i){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===i?a.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const a=this.symbolInstances.get(i);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((d,m,y)=>{d>=0&&y.indexOf(d)===m&&this.addIndicesForPlacedSymbol(this.text,d)}),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}He("SymbolBucket",Ka,{omit:["layers","collisionBoxArray","features","compareText"]}),Ka.MAX_GLYPHS=65535,Ka.addDynamicAttributes=Np;const dw=new Hn({"symbol-placement":new tt(xe.layout_symbol["symbol-placement"]),"symbol-spacing":new tt(xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new tt(xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ut(xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new tt(xe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new tt(xe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new tt(xe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new tt(xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new tt(xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new tt(xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new ut(xe.layout_symbol["icon-size"]),"icon-text-fit":new tt(xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new tt(xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new ut(xe.layout_symbol["icon-image"]),"icon-rotate":new ut(xe.layout_symbol["icon-rotate"]),"icon-padding":new ut(xe.layout_symbol["icon-padding"]),"icon-keep-upright":new tt(xe.layout_symbol["icon-keep-upright"]),"icon-offset":new ut(xe.layout_symbol["icon-offset"]),"icon-anchor":new ut(xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new tt(xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new tt(xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new tt(xe.layout_symbol["text-rotation-alignment"]),"text-field":new ut(xe.layout_symbol["text-field"]),"text-font":new ut(xe.layout_symbol["text-font"]),"text-size":new ut(xe.layout_symbol["text-size"]),"text-max-width":new ut(xe.layout_symbol["text-max-width"]),"text-line-height":new tt(xe.layout_symbol["text-line-height"]),"text-letter-spacing":new ut(xe.layout_symbol["text-letter-spacing"]),"text-justify":new ut(xe.layout_symbol["text-justify"]),"text-radial-offset":new ut(xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new tt(xe.layout_symbol["text-variable-anchor"]),"text-anchor":new ut(xe.layout_symbol["text-anchor"]),"text-max-angle":new tt(xe.layout_symbol["text-max-angle"]),"text-writing-mode":new tt(xe.layout_symbol["text-writing-mode"]),"text-rotate":new ut(xe.layout_symbol["text-rotate"]),"text-padding":new tt(xe.layout_symbol["text-padding"]),"text-keep-upright":new tt(xe.layout_symbol["text-keep-upright"]),"text-transform":new ut(xe.layout_symbol["text-transform"]),"text-offset":new ut(xe.layout_symbol["text-offset"]),"text-allow-overlap":new tt(xe.layout_symbol["text-allow-overlap"]),"text-overlap":new tt(xe.layout_symbol["text-overlap"]),"text-ignore-placement":new tt(xe.layout_symbol["text-ignore-placement"]),"text-optional":new tt(xe.layout_symbol["text-optional"])});var $p={paint:new Hn({"icon-opacity":new ut(xe.paint_symbol["icon-opacity"]),"icon-color":new ut(xe.paint_symbol["icon-color"]),"icon-halo-color":new ut(xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new ut(xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ut(xe.paint_symbol["icon-halo-blur"]),"icon-translate":new tt(xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new tt(xe.paint_symbol["icon-translate-anchor"]),"text-opacity":new ut(xe.paint_symbol["text-opacity"]),"text-color":new ut(xe.paint_symbol["text-color"],{runtimeType:Xn,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new ut(xe.paint_symbol["text-halo-color"]),"text-halo-width":new ut(xe.paint_symbol["text-halo-width"]),"text-halo-blur":new ut(xe.paint_symbol["text-halo-blur"]),"text-translate":new tt(xe.paint_symbol["text-translate"]),"text-translate-anchor":new tt(xe.paint_symbol["text-translate-anchor"])}),layout:dw};class Dy{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Xi,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}He("FormatSectionOverride",Dy,{omit:["defaultValue"]});class Th extends vi{constructor(e){super(e,$p)}recalculate(e,i){if(super.recalculate(e,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const a=this.layout.get("text-writing-mode");if(a){const d=[];for(const m of a)d.indexOf(m)<0&&d.push(m);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,i,a,d){const m=this.layout.get(e).evaluate(i,{},a,d),y=this._unevaluatedLayout._values[e];return y.isDataDriven()||Os(y.value)||!m?m:function(x,b){return b.replace(/{([^{}]+)}/g,(T,z)=>z in x?String(x[z]):"")}(i.properties,m)}createBucket(e){return new Ka(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of $p.paint.overridableProperties){if(!Th.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),a=new Dy(i),d=new Pa(a,i.property.specification);let m=null;m=i.value.kind==="constant"||i.value.kind==="source"?new Us("source",d):new ql("composite",d,i.value.zoomStops),this.paint._values[e]=new _i(i.property,m,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,a){return!(!this.layout||i.isDataDriven()||a.isDataDriven())&&Th.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const a=e.get("text-field"),d=$p.paint.properties[i];let m=!1;const y=x=>{for(const b of x)if(d.overrides&&d.overrides.hasOverride(b))return void(m=!0)};if(a.value.kind==="constant"&&a.value.value instanceof J)y(a.value.value.sections);else if(a.value.kind==="source"){const x=T=>{m||(T instanceof et&&me(T.value)===Fn?y(T.value.sections):T instanceof Aa?y(T.sections):T.eachChild(x))},b=a.value;b._styleExpression&&x(b._styleExpression.expression)}return m}}function jp(r,e,i){let a="never";const d=r.get(e);return d?a=d:r.get(i)&&(a="always"),a}var pw={paint:new Hn({"background-color":new tt(xe.paint_background["background-color"]),"background-pattern":new iu(xe.paint_background["background-pattern"]),"background-opacity":new tt(xe.paint_background["background-opacity"])})},fw={paint:new Hn({"raster-opacity":new tt(xe.paint_raster["raster-opacity"]),"raster-hue-rotate":new tt(xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new tt(xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new tt(xe.paint_raster["raster-brightness-max"]),"raster-saturation":new tt(xe.paint_raster["raster-saturation"]),"raster-contrast":new tt(xe.paint_raster["raster-contrast"]),"raster-resampling":new tt(xe.paint_raster["raster-resampling"]),"raster-fade-duration":new tt(xe.paint_raster["raster-fade-duration"])})};class mw extends vi{constructor(e){super(e,{}),this.onAdd=i=>{this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},this.onRemove=i=>{this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const gw={circle:class extends vi{constructor(r){super(r,W0)}createBucket(r){return new gp(r)}queryRadius(r){const e=r;return uu("circle-radius",this,e)+uu("circle-stroke-width",this,e)+lh(this.paint.get("circle-translate"))}queryIntersectsFeature(r,e,i,a,d,m,y,x){const b=uh(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,y),T=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i),z=this.paint.get("circle-pitch-alignment")==="map",M=z?b:function(B,F){return B.map(H=>Gg(H,F))}(b,x),L=z?T*y:T;for(const B of a)for(const F of B){const H=z?F:Gg(F,x);let X=L;const le=ch([],[F.x,F.y,0,1],x);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?X*=le[3]/m.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(X*=m.cameraToCenterDistance/le[3]),$0(M,H,X))return!0}return!1}},heatmap:class extends vi{constructor(r){super(r,H0),this._updateColorRamp()}createBucket(r){return new Zg(r)}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Wg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends vi{constructor(r){super(r,K0)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends vi{constructor(r){super(r,d1)}recalculate(r,e){super.recalculate(r,e);const i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new Ip(r)}queryRadius(){return lh(this.paint.get("fill-translate"))}queryIntersectsFeature(r,e,i,a,d,m,y){return Bg(uh(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,y),a)}isTileClipped(){return!0}},"fill-extrusion":class extends vi{constructor(r){super(r,k1)}createBucket(r){return new Ap(r)}queryRadius(){return lh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(r,e,i,a,d,m,y,x){const b=uh(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,y),T=this.paint.get("fill-extrusion-height").evaluate(e,i),z=this.paint.get("fill-extrusion-base").evaluate(e,i),M=function(B,F,H,X){const le=[];for(const fe of B){const ie=[fe.x,fe.y,0,1];ch(ie,ie,F),le.push(new st(ie[0]/ie[3],ie[1]/ie[3]))}return le}(b,x),L=function(B,F,H,X){const le=[],fe=[],ie=X[8]*F,de=X[9]*F,be=X[10]*F,we=X[11]*F,We=X[8]*H,Je=X[9]*H,Ve=X[10]*H,Fe=X[11]*H;for(const De of B){const $e=[],Ne=[];for(const Ce of De){const ot=Ce.x,nt=Ce.y,xt=X[0]*ot+X[4]*nt+X[12],Jt=X[1]*ot+X[5]*nt+X[13],on=X[2]*ot+X[6]*nt+X[14],Dn=X[3]*ot+X[7]*nt+X[15],li=on+be,tr=Dn+we,kn=xt+We,$n=Jt+Je,nr=on+Ve,hr=Dn+Fe,Rr=new st((xt+ie)/tr,(Jt+de)/tr);Rr.z=li/tr,$e.push(Rr);const Cn=new st(kn/hr,$n/hr);Cn.z=nr/hr,Ne.push(Cn)}le.push($e),fe.push(Ne)}return[le,fe]}(a,z,T,x);return function(B,F,H){let X=1/0;Bg(H,F)&&(X=ny(H,F[0]));for(let le=0;le<F.length;le++){const fe=F[le],ie=B[le];for(let de=0;de<fe.length-1;de++){const be=fe[de],we=[be,fe[de+1],ie[de+1],ie[de],be];Rg(H,we)&&(X=Math.min(X,ny(H,we)))}}return X!==1/0&&X}(L[0],L[1],M)}},line:class extends vi{constructor(r){super(r,iy),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ds,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,e){super.recalculate(r,e),this.paint._values["line-floorwidth"]=oy.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new Mp(r)}queryRadius(r){const e=r,i=sy(uu("line-width",this,e),uu("line-gap-width",this,e)),a=uu("line-offset",this,e);return i/2+Math.abs(a)+lh(this.paint.get("line-translate"))}queryIntersectsFeature(r,e,i,a,d,m,y){const x=uh(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,y),b=y/2*sy(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),T=this.paint.get("line-offset").evaluate(e,i);return T&&(a=function(z,M){const L=[];for(let B=0;B<z.length;B++){const F=z[B],H=[];for(let X=0;X<F.length;X++){const le=F[X-1],fe=F[X],ie=F[X+1],de=X===0?new st(0,0):fe.sub(le)._unit()._perp(),be=X===F.length-1?new st(0,0):ie.sub(fe)._unit()._perp(),we=de._add(be)._unit(),We=we.x*be.x+we.y*be.y;We!==0&&we._mult(1/We),H.push(we._mult(M)._add(fe))}L.push(H)}return L}(a,T*y)),function(z,M,L){for(let B=0;B<M.length;B++){const F=M[B];if(z.length>=3){for(let H=0;H<F.length;H++)if(ja(z,F[H]))return!0}if(j0(z,F,L))return!0}return!1}(x,a,b)}isTileClipped(){return!0}},symbol:Th,background:class extends vi{constructor(r){super(r,pw)}},raster:class extends vi{constructor(r){super(r,fw)}}};class yw{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const Ly=63710088e-1;class fn{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new fn(ze(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,a=this.lat*i,d=e.lat*i,m=Math.sin(a)*Math.sin(d)+Math.cos(a)*Math.cos(d)*Math.cos((e.lng-this.lng)*i);return Ly*Math.acos(Math.min(m,1))}toBounds(e=0){const i=360*e/40075017,a=i/Math.cos(Math.PI/180*this.lat);return new ia(new fn(this.lng-a,this.lat-i),new fn(this.lng+a,this.lat+i))}static convert(e){if(e instanceof fn)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new fn(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new fn(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class ia{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof fn?new fn(e.lng,e.lat):fn.convert(e),this}setSouthWest(e){return this._sw=e instanceof fn?new fn(e.lng,e.lat):fn.convert(e),this}extend(e){const i=this._sw,a=this._ne;let d,m;if(e instanceof fn)d=e,m=e;else{if(!(e instanceof ia))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(ia.convert(e)):this.extend(fn.convert(e)):this;if(d=e._sw,m=e._ne,!d||!m)return this}return i||a?(i.lng=Math.min(d.lng,i.lng),i.lat=Math.min(d.lat,i.lat),a.lng=Math.max(m.lng,a.lng),a.lat=Math.max(m.lat,a.lat)):(this._sw=new fn(d.lng,d.lat),this._ne=new fn(m.lng,m.lat)),this}getCenter(){return new fn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new fn(this.getWest(),this.getNorth())}getSouthEast(){return new fn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:a}=fn.convert(e);let d=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=a&&a<=this._ne.lat&&d}static convert(e){return e instanceof ia?e:e&&new ia(e)}}const Ry=2*Math.PI*Ly;function By(r){return Ry*Math.cos(r*Math.PI/180)}function Fy(r){return(180+r)/360}function Oy(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Ny(r,e){return r/By(e)}function Gp(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}class kh{constructor(e,i,a=0){this.x=+e,this.y=+i,this.z=+a}static fromLngLat(e,i=0){const a=fn.convert(e);return new kh(Fy(a.lng),Oy(a.lat),Ny(i,a.lat))}toLngLat(){return new fn(360*this.x-180,Gp(this.y))}toAltitude(){return this.z*By(Gp(this.y))}meterInMercatorCoordinateUnits(){return 1/Ry*(e=Gp(this.y),1/Math.cos(e*Math.PI/180));var e}}function Uy(r,e,i){var a=2*Math.PI*6378137/256/Math.pow(2,i);return[r*a-2*Math.PI*6378137/2,e*a-2*Math.PI*6378137/2]}class Zp{constructor(e,i,a){if(e<0||e>25||a<0||a>=Math.pow(2,e)||i<0||i>=Math.pow(2,e))throw new Error(`x=${i}, y=${a}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=i,this.y=a,this.key=xu(0,e,e,i,a)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i,a){const d=(y=this.y,x=this.z,b=Uy(256*(m=this.x),256*(y=Math.pow(2,x)-y-1),x),T=Uy(256*(m+1),256*(y+1),x),b[0]+","+b[1]+","+T[0]+","+T[1]);var m,y,x,b,T;const z=function(M,L,B){let F,H="";for(let X=M;X>0;X--)F=1<<X-1,H+=(L&F?1:0)+(B&F?2:0);return H}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,i>1?"@2x":"").replace(/{quadkey}/g,z).replace(/{bbox-epsg-3857}/g,d)}isChildOf(e){const i=this.z-e.z;return i>0&&e.x===this.x>>i&&e.y===this.y>>i}getTilePoint(e){const i=Math.pow(2,this.z);return new st((e.x*i-this.x)*Pn,(e.y*i-this.y)*Pn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Vy{constructor(e,i){this.wrap=e,this.canonical=i,this.key=xu(e,i.z,i.z,i.x,i.y)}}class ai{constructor(e,i,a,d,m){if(e<a)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${a}`);this.overscaledZ=e,this.wrap=i,this.canonical=new Zp(a,+d,+m),this.key=xu(i,e,a,d,m)}clone(){return new ai(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const i=this.canonical.z-e;return e>this.canonical.z?new ai(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ai(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(e,i){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-e;return e>this.canonical.z?xu(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y):xu(this.wrap*+i,e,e,this.canonical.x>>a,this.canonical.y>>a)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const i=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new ai(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,a=2*this.canonical.x,d=2*this.canonical.y;return[new ai(i,this.wrap,i,a,d),new ai(i,this.wrap,i,a+1,d),new ai(i,this.wrap,i,a,d+1),new ai(i,this.wrap,i,a+1,d+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new ai(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new ai(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Vy(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new kh(e.x-this.wrap,e.y))}}function xu(r,e,i,a,d){(r*=2)<0&&(r=-1*r-1);const m=1<<i;return(m*m*r+m*d+a).toString(36)+i.toString(36)+e.toString(36)}He("CanonicalTileID",Zp),He("OverscaledTileID",ai,{omit:["posMatrix"]});class $y{constructor(e,i,a){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(a&&a!=="mapbox"&&a!=="terrarium")return void Ae(`"${a}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const d=this.dim=i.height-2;this.data=new Uint32Array(i.data.buffer),this.encoding=a||"mapbox";for(let m=0;m<d;m++)this.data[this._idx(-1,m)]=this.data[this._idx(0,m)],this.data[this._idx(d,m)]=this.data[this._idx(d-1,m)],this.data[this._idx(m,-1)]=this.data[this._idx(m,0)],this.data[this._idx(m,d)]=this.data[this._idx(m,d-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(d,-1)]=this.data[this._idx(d-1,0)],this.data[this._idx(-1,d)]=this.data[this._idx(0,d-1)],this.data[this._idx(d,d)]=this.data[this._idx(d-1,d-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let m=0;m<d;m++)for(let y=0;y<d;y++){const x=this.get(m,y);x>this.max&&(this.max=x),x<this.min&&(this.min=x)}}get(e,i){const a=new Uint8Array(this.data.buffer),d=4*this._idx(e,i);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(a[d],a[d+1],a[d+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(e+1)}_unpackMapbox(e,i,a){return(256*e*256+256*i+a)/10-1e4}_unpackTerrarium(e,i,a){return 256*e+i+a/256-32768}getPixels(){return new si({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,i,a){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let d=i*this.dim,m=i*this.dim+this.dim,y=a*this.dim,x=a*this.dim+this.dim;switch(i){case-1:d=m-1;break;case 1:m=d+1}switch(a){case-1:y=x-1;break;case 1:x=y+1}const b=-i*this.dim,T=-a*this.dim;for(let z=y;z<x;z++)for(let M=d;M<m;M++)this.data[this._idx(M,z)]=e.data[this._idx(M+b,z+T)]}}He("DEMData",$y);class jy{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const a=e[i];this._stringToNumber[a]=i,this._numberToString[i]=a}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class Gy{constructor(e,i,a,d,m){this.type="Feature",this._vectorTileFeature=e,e._z=i,e._x=a,e._y=d,this.properties=e.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const i in this)i!=="_geometry"&&i!=="_vectorTileFeature"&&(e[i]=this[i]);return e}}class Zy{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ks(Pn,16,0),this.grid3D=new Ks(Pn,16,0),this.featureIndexArray=new vt,this.promoteId=i}insert(e,i,a,d,m,y){const x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,d,m);const b=y?this.grid3D:this.grid;for(let T=0;T<i.length;T++){const z=i[T],M=[1/0,1/0,-1/0,-1/0];for(let L=0;L<z.length;L++){const B=z[L];M[0]=Math.min(M[0],B.x),M[1]=Math.min(M[1],B.y),M[2]=Math.max(M[2],B.x),M[3]=Math.max(M[3],B.y)}M[0]<Pn&&M[1]<Pn&&M[2]>=0&&M[3]>=0&&b.insert(x,M[0],M[1],M[2],M[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new is.VectorTile(new Pp(this.rawTileData)).layers,this.sourceLayerCoder=new jy(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,i,a,d){this.loadVTLayers();const m=e.params||{},y=Pn/e.tileSize/e.scale,x=Ra(m.filter),b=e.queryGeometry,T=e.queryPadding*y,z=Wy(b),M=this.grid.query(z.minX-T,z.minY-T,z.maxX+T,z.maxY+T),L=Wy(e.cameraQueryGeometry),B=this.grid3D.query(L.minX-T,L.minY-T,L.maxX+T,L.maxY+T,(X,le,fe,ie)=>function(de,be,we,We,Je){for(const Fe of de)if(be<=Fe.x&&we<=Fe.y&&We>=Fe.x&&Je>=Fe.y)return!0;const Ve=[new st(be,we),new st(be,Je),new st(We,Je),new st(We,we)];if(de.length>2){for(const Fe of Ve)if(ja(de,Fe))return!0}for(let Fe=0;Fe<de.length-1;Fe++)if(Z0(de[Fe],de[Fe+1],Ve))return!0;return!1}(e.cameraQueryGeometry,X-T,le-T,fe+T,ie+T));for(const X of B)M.push(X);M.sort(_w);const F={};let H;for(let X=0;X<M.length;X++){const le=M[X];if(le===H)continue;H=le;const fe=this.featureIndexArray.get(le);let ie=null;this.loadMatchingFeature(F,fe.bucketIndex,fe.sourceLayerIndex,fe.featureIndex,x,m.layers,m.availableImages,i,a,d,(de,be,we)=>(ie||(ie=ta(de)),be.queryIntersectsFeature(b,de,we,ie,this.z,e.transform,y,e.pixelPosMatrix)))}return F}loadMatchingFeature(e,i,a,d,m,y,x,b,T,z,M){const L=this.bucketLayerIDs[i];if(y&&!function(X,le){for(let fe=0;fe<X.length;fe++)if(le.indexOf(X[fe])>=0)return!0;return!1}(y,L))return;const B=this.sourceLayerCoder.decode(a),F=this.vtLayers[B].feature(d);if(m.needGeometry){const X=na(F,!0);if(!m.filter(new nn(this.tileID.overscaledZ),X,this.tileID.canonical))return}else if(!m.filter(new nn(this.tileID.overscaledZ),F))return;const H=this.getId(F,B);for(let X=0;X<L.length;X++){const le=L[X];if(y&&y.indexOf(le)<0)continue;const fe=b[le];if(!fe)continue;let ie={};H&&z&&(ie=z.getState(fe.sourceLayer||"_geojsonTileLayer",H));const de=Ie({},T[le]);de.paint=qy(de.paint,fe.paint,F,ie,x),de.layout=qy(de.layout,fe.layout,F,ie,x);const be=!M||M(F,fe,ie);if(!be)continue;const we=new Gy(F,this.z,this.x,this.y,H);we.layer=de;let We=e[le];We===void 0&&(We=e[le]=[]),We.push({featureIndex:d,feature:we,intersectionZ:be})}}lookupSymbolFeatures(e,i,a,d,m,y,x,b){const T={};this.loadVTLayers();const z=Ra(m);for(const M of e)this.loadMatchingFeature(T,a,d,M,z,y,x,b,i);return T}hasLayer(e){for(const i of this.bucketLayerIDs)for(const a of i)if(e===a)return!0;return!1}getId(e,i){let a=e.id;return this.promoteId&&(a=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[i]],typeof a=="boolean"&&(a=Number(a))),a}}function qy(r,e,i,a,d){return se(r,(m,y)=>{const x=e instanceof Qs?e.get(y):null;return x&&x.evaluate?x.evaluate(i,a,d):x})}function Wy(r){let e=1/0,i=1/0,a=-1/0,d=-1/0;for(const m of r)e=Math.min(e,m.x),i=Math.min(i,m.y),a=Math.max(a,m.x),d=Math.max(d,m.y);return{minX:e,minY:i,maxX:a,maxY:d}}function _w(r,e){return e-r}var qp;He("FeatureIndex",Zy,{omit:["rawTileData","sourceLayerCoder"]}),u.PerformanceMarkers=void 0,(qp=u.PerformanceMarkers||(u.PerformanceMarkers={})).create="create",qp.load="load",qp.fullLoad="fullLoad";let Ch=null,wu=[];const Wp=1e3/30,vw={mark(r){performance.mark(r)},frame(r){const e=r;Ch!=null&&wu.push(e-Ch),Ch=e},clearMetrics(){Ch=null,wu=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const r in u.PerformanceMarkers)performance.clearMarks(u.PerformanceMarkers[r])},getPerformanceMetrics(){performance.measure("loadTime",u.PerformanceMarkers.create,u.PerformanceMarkers.load),performance.measure("fullLoadTime",u.PerformanceMarkers.create,u.PerformanceMarkers.fullLoad);const r=performance.getEntriesByName("loadTime")[0].duration,e=performance.getEntriesByName("fullLoadTime")[0].duration,i=wu.length,a=1/(wu.reduce((m,y)=>m+y,0)/i/1e3),d=wu.filter(m=>m>Wp).reduce((m,y)=>m+(y-Wp)/Wp,0);return{loadTime:r,fullLoadTime:e,fps:a,percentDroppedFrames:d/(i+d)*100}}};u.AJAXError=Pt,u.ARRAY_TYPE=wr,u.Actor=class{constructor(r,e,i){this.target=r,this.parent=e,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Xe(["receive","process"],this),this.invoker=new yw(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ke()?r:window}send(r,e,i,a,d=!1){const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[m]=i);const y=an(this.globalScope)?void 0:[];return this.target.postMessage({id:m,type:r,hasCallback:!!i,targetMapId:a,mustQueue:d,sourceMapId:this.mapId,data:_o(e,y)},y),{cancel:()=>{i&&delete this.callbacks[m],this.target.postMessage({id:m,type:"<cancel>",targetMapId:a,sourceMapId:this.mapId})}}}receive(r){const e=r.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){delete this.tasks[i];const a=this.cancelCallbacks[i];delete this.cancelCallbacks[i],a&&a()}else Ke()||e.mustQueue?(this.tasks[i]=e,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,e)}process(){if(!this.taskQueue.length)return;const r=this.taskQueue.shift(),e=this.tasks[r];delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(r,e)}processTask(r,e){if(e.type==="<response>"){const i=this.callbacks[r];delete this.callbacks[r],i&&(e.error?i(Yi(e.error)):i(null,Yi(e.data)))}else{let i=!1;const a=an(this.globalScope)?void 0:[],d=e.hasCallback?(x,b)=>{i=!0,delete this.cancelCallbacks[r],this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:x?_o(x):null,data:_o(b,a)},a)}:x=>{i=!0};let m=null;const y=Yi(e.data);if(this.parent[e.type])m=this.parent[e.type](e.sourceMapId,y,d);else if(this.parent.getWorkerSource){const x=e.type.split(".");m=this.parent.getWorkerSource(e.sourceMapId,x[0],y.source)[x[1]](y,d)}else d(new Error(`Could not find function ${e.type}`));!i&&m&&m.cancel&&(this.cancelCallbacks[r]=m.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},u.AlphaImage=hu,u.CanonicalTileID=Zp,u.CollisionBoxArray=_e,u.CollisionCircleLayoutArray=class extends A{},u.Color=U,u.DEMData=$y,u.DataConstantProperty=tt,u.DictionaryCoder=jy,u.EXTENT=Pn,u.ErrorEvent=Wi,u.EvaluationParameters=nn,u.Event=Ir,u.Evented=zr,u.FeatureIndex=Zy,u.FillBucket=Ip,u.FillExtrusionBucket=Ap,u.GeoJSONFeature=Gy,u.ImageAtlas=my,u.ImagePosition=Lp,u.LineBucket=Mp,u.LineStripIndexArray=class extends W{},u.LngLat=fn,u.LngLatBounds=ia,u.MercatorCoordinate=kh,u.ONE_EM=Kn,u.OverscaledTileID=ai,u.PerformanceUtils=vw,u.PosArray=it,u.Properties=Hn,u.QuadTriangleArray=class extends R{},u.RGBAImage=si,u.RasterBoundsArray=class extends h{},u.RequestPerformance=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},u.ResourceType=jt,u.SegmentVector=bt,u.SymbolBucket=Ka,u.Transitionable=nh,u.TriangleIndexArray=vr,u.Uniform1f=bo,u.Uniform1i=class extends wo{constructor(r,e){super(r,e),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},u.Uniform2f=class extends wo{constructor(r,e){super(r,e),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},u.Uniform3f=class extends wo{constructor(r,e){super(r,e),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},u.Uniform4f=Va,u.UniformColor=Mg,u.UniformMatrix4f=class extends wo{constructor(r,e){super(r,e),this.current=U0}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let e=1;e<16;e++)if(r[e]!==this.current[e]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},u.UnwrappedTileID=Vy,u.ValidationError=Oe,u.ZoomHistory=Kl,u.add=function(r,e,i){return r[0]=e[0]+i[0],r[1]=e[1]+i[1],r[2]=e[2]+i[2],r},u.addDynamicAttributes=Np,u.asyncAll=function(r,e,i){if(!r.length)return i(null,[]);let a=r.length;const d=new Array(r.length);let m=null;r.forEach((y,x)=>{e(y,(b,T)=>{b&&(m=b),d[x]=T,--a==0&&i(m,d)})})},u.bezier=ue,u.bindAll=Xe,u.cacheEntryPossiblyAdded=function(r){Wn++,Wn>yr&&(r.getActor().send("enforceCacheSizeLimit",Ut),Wn=0)},u.clamp=Z,u.clearTileCache=function(r){const e=caches.delete(ct);r&&e.catch(r).then(()=>r())},u.clipLine=Cy,u.clone=function(r){var e=new wr(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e},u.clone$1=ae,u.clone$2=function(r){var e=new wr(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e},u.collisionCircleLayout=F1,u.config=Ze,u.copy=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},u.create=function(){var r=new wr(16);return wr!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},u.create$1=Ng,u.createExpression=Ns,u.createFilter=Ra,u.createLayout=Tn,u.createStyleLayer=function(r){return r.type==="custom"?new mw(r):new gw[r.type](r)},u.cross=function(r,e,i){var a=e[0],d=e[1],m=e[2],y=i[0],x=i[1],b=i[2];return r[0]=d*b-m*x,r[1]=m*y-a*b,r[2]=a*x-d*y,r},u.dot=function(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]},u.dot$1=function(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]*e[3]},u.ease=oe,u.emitValidationErrors=Fa,u.enforceCacheSizeLimit=function(r){Rn(),at&&at.then(e=>{e.keys().then(i=>{for(let a=0;a<i.length-r;a++)e.delete(i[a])})})},u.equals=function(r,e){var i=r[0],a=r[1],d=r[2],m=r[3],y=r[4],x=r[5],b=r[6],T=r[7],z=r[8],M=r[9],L=r[10],B=r[11],F=r[12],H=r[13],X=r[14],le=r[15],fe=e[0],ie=e[1],de=e[2],be=e[3],we=e[4],We=e[5],Je=e[6],Ve=e[7],Fe=e[8],De=e[9],$e=e[10],Ne=e[11],Ce=e[12],ot=e[13],nt=e[14],xt=e[15];return Math.abs(i-fe)<=xr*Math.max(1,Math.abs(i),Math.abs(fe))&&Math.abs(a-ie)<=xr*Math.max(1,Math.abs(a),Math.abs(ie))&&Math.abs(d-de)<=xr*Math.max(1,Math.abs(d),Math.abs(de))&&Math.abs(m-be)<=xr*Math.max(1,Math.abs(m),Math.abs(be))&&Math.abs(y-we)<=xr*Math.max(1,Math.abs(y),Math.abs(we))&&Math.abs(x-We)<=xr*Math.max(1,Math.abs(x),Math.abs(We))&&Math.abs(b-Je)<=xr*Math.max(1,Math.abs(b),Math.abs(Je))&&Math.abs(T-Ve)<=xr*Math.max(1,Math.abs(T),Math.abs(Ve))&&Math.abs(z-Fe)<=xr*Math.max(1,Math.abs(z),Math.abs(Fe))&&Math.abs(M-De)<=xr*Math.max(1,Math.abs(M),Math.abs(De))&&Math.abs(L-$e)<=xr*Math.max(1,Math.abs(L),Math.abs($e))&&Math.abs(B-Ne)<=xr*Math.max(1,Math.abs(B),Math.abs(Ne))&&Math.abs(F-Ce)<=xr*Math.max(1,Math.abs(F),Math.abs(Ce))&&Math.abs(H-ot)<=xr*Math.max(1,Math.abs(H),Math.abs(ot))&&Math.abs(X-nt)<=xr*Math.max(1,Math.abs(X),Math.abs(nt))&&Math.abs(le-xt)<=xr*Math.max(1,Math.abs(le),Math.abs(xt))},u.evaluateSizeForFeature=function(r,{uSize:e,uSizeT:i},{lowerSize:a,upperSize:d}){return r.kind==="source"?a/To:r.kind==="composite"?en(a/To,d/To,i):e},u.evaluateSizeForZoom=function(r,e){let i=0,a=0;if(r.kind==="constant")a=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:d,minZoom:m,maxZoom:y}=r,x=d?Z(Pr.interpolationFactor(d,e,m,y),0,1):0;r.kind==="camera"?a=en(r.minSize,r.maxSize,x):i=x}return{uSizeT:i,uSize:a}},u.evaluateVariableOffset=Ay,u.evented=ru,u.exported=qn,u.exported$1=zn,u.extend=Ie,u.filterObject=Q,u.fromRotation=function(r,e){var i=Math.sin(e),a=Math.cos(e);return r[0]=a,r[1]=i,r[2]=0,r[3]=-i,r[4]=a,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},u.fromScaling=function(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},u.getAnchorAlignment=Bp,u.getAnchorJustification=Op,u.getArrayBuffer=Qn,u.getImage=ni,u.getJSON=function(r,e){return ur(Ie(r,{type:"json"}),e)},u.getOverlapMode=jp,u.getRTLTextPluginStatus=Ys,u.getReferrer=En,u.getVideo=function(r,e){const i=window.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let a=0;a<r.length;a++){const d=window.document.createElement("source");ei(r[a])||(i.crossOrigin="Anonymous"),d.src=r[a],i.appendChild(d)}return{cancel:()=>{}}},u.identity=vp,u.invert=function(r,e){var i=e[0],a=e[1],d=e[2],m=e[3],y=e[4],x=e[5],b=e[6],T=e[7],z=e[8],M=e[9],L=e[10],B=e[11],F=e[12],H=e[13],X=e[14],le=e[15],fe=i*x-a*y,ie=i*b-d*y,de=i*T-m*y,be=a*b-d*x,we=a*T-m*x,We=d*T-m*b,Je=z*H-M*F,Ve=z*X-L*F,Fe=z*le-B*F,De=M*X-L*H,$e=M*le-B*H,Ne=L*le-B*X,Ce=fe*Ne-ie*$e+de*De+be*Fe-we*Ve+We*Je;return Ce?(r[0]=(x*Ne-b*$e+T*De)*(Ce=1/Ce),r[1]=(d*$e-a*Ne-m*De)*Ce,r[2]=(H*We-X*we+le*be)*Ce,r[3]=(L*we-M*We-B*be)*Ce,r[4]=(b*Fe-y*Ne-T*Ve)*Ce,r[5]=(i*Ne-d*Fe+m*Ve)*Ce,r[6]=(X*de-F*We-le*ie)*Ce,r[7]=(z*We-L*de+B*ie)*Ce,r[8]=(y*$e-x*Fe+T*Je)*Ce,r[9]=(a*Fe-i*$e-m*Je)*Ce,r[10]=(F*we-H*de+le*fe)*Ce,r[11]=(M*de-z*we-B*fe)*Ce,r[12]=(x*Ve-y*De-b*Je)*Ce,r[13]=(i*De-a*Ve+d*Je)*Ce,r[14]=(H*ie-F*be-X*fe)*Ce,r[15]=(z*be-M*ie+L*fe)*Ce,r):null},u.isImageBitmap=ar,u.isSafari=an,u.isWorker=Ke,u.keysDifference=function(r,e){const i=[];for(const a in r)a in e||i.push(a);return i},u.lazyLoadRTLTextPlugin=function(){Zr.isLoading()||Zr.isLoaded()||Ys()!=="deferred"||th()},u.makeRequest=ur,u.mapObject=se,u.mercatorXfromLng=Fy,u.mercatorYfromLat=Oy,u.mercatorZfromAltitude=Ny,u.mul=X0,u.mul$1=function(r,e,i){return r[0]=e[0]*i[0],r[1]=e[1]*i[1],r[2]=e[2]*i[2],r[3]=e[3]*i[3],r},u.multiply=Ug,u.nextPowerOfTwo=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},u.normalize=function(r,e){var i=e[0],a=e[1],d=e[2],m=i*i+a*a+d*d;return m>0&&(m=1/Math.sqrt(m)),r[0]=e[0]*m,r[1]=e[1]*m,r[2]=e[2]*m,r},u.number=en,u.ortho=function(r,e,i,a,d,m,y){var x=1/(e-i),b=1/(a-d),T=1/(m-y);return r[0]=-2*x,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*b,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*T,r[11]=0,r[12]=(e+i)*x,r[13]=(d+a)*b,r[14]=(y+m)*T,r[15]=1,r},u.parseCacheControl=Ct,u.parseGlyphPbf=function(r){return new Pp(r).readFields(X1,[])},u.pbf=Pp,u.performSymbolLayout=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=Pn/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const e=r.bucket.layers[0].layout,i=r.bucket.layers[0]._unevaluatedLayout._values,a={layoutIconSize:i["icon-size"].possiblyEvaluate(new nn(r.bucket.zoom+1),r.canonical),layoutTextSize:i["text-size"].possiblyEvaluate(new nn(r.bucket.zoom+1),r.canonical),textMaxSize:i["text-size"].possiblyEvaluate(new nn(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:b,maxZoom:T}=r.bucket.textSizeData;a.compositeTextSizes=[i["text-size"].possiblyEvaluate(new nn(b),r.canonical),i["text-size"].possiblyEvaluate(new nn(T),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:b,maxZoom:T}=r.bucket.iconSizeData;a.compositeIconSizes=[i["icon-size"].possiblyEvaluate(new nn(b),r.canonical),i["icon-size"].possiblyEvaluate(new nn(T),r.canonical)]}const d=e.get("text-line-height")*Kn,m=e.get("text-rotation-alignment")!=="viewport"&&e.get("symbol-placement")!=="point",y=e.get("text-keep-upright"),x=e.get("text-size");for(const b of r.bucket.features){const T=e.get("text-font").evaluate(b,{},r.canonical).join(","),z=x.evaluate(b,{},r.canonical),M=a.layoutTextSize.evaluate(b,{},r.canonical),L=a.layoutIconSize.evaluate(b,{},r.canonical),B={horizontal:{},vertical:void 0},F=b.text;let H,X=[0,0];if(F){const ie=F.toString(),de=e.get("text-letter-spacing").evaluate(b,{},r.canonical)*Kn,be=hp(ie)?de:0,we=e.get("text-anchor").evaluate(b,{},r.canonical),We=e.get("text-variable-anchor");if(!We){const $e=e.get("text-radial-offset").evaluate(b,{},r.canonical);X=$e?Ay(we,[$e*Kn,Fp]):e.get("text-offset").evaluate(b,{},r.canonical).map(Ne=>Ne*Kn)}let Je=m?"center":e.get("text-justify").evaluate(b,{},r.canonical);const Ve=e.get("symbol-placement"),Fe=Ve==="point"?e.get("text-max-width").evaluate(b,{},r.canonical)*Kn:0,De=()=>{r.bucket.allowVerticalPlacement&&Oa(ie)&&(B.vertical=_h(F,r.glyphMap,r.glyphPositions,r.imagePositions,T,Fe,d,we,"left",be,X,u.WritingMode.vertical,!0,Ve,M,z))};if(!m&&We){const $e=Je==="auto"?We.map(Ce=>Op(Ce)):[Je];let Ne=!1;for(let Ce=0;Ce<$e.length;Ce++){const ot=$e[Ce];if(!B.horizontal[ot])if(Ne)B.horizontal[ot]=B.horizontal[0];else{const nt=_h(F,r.glyphMap,r.glyphPositions,r.imagePositions,T,Fe,d,"center",ot,be,X,u.WritingMode.horizontal,!1,Ve,M,z);nt&&(B.horizontal[ot]=nt,Ne=nt.positionedLines.length===1)}}De()}else{Je==="auto"&&(Je=Op(we));const $e=_h(F,r.glyphMap,r.glyphPositions,r.imagePositions,T,Fe,d,we,Je,be,X,u.WritingMode.horizontal,!1,Ve,M,z);$e&&(B.horizontal[Je]=$e),De(),Oa(ie)&&m&&y&&(B.vertical=_h(F,r.glyphMap,r.glyphPositions,r.imagePositions,T,Fe,d,we,Je,be,X,u.WritingMode.vertical,!1,Ve,M,z))}}let le=!1;if(b.icon&&b.icon.name){const ie=r.imageMap[b.icon.name];ie&&(H=ew(r.imagePositions[b.icon.name],e.get("icon-offset").evaluate(b,{},r.canonical),e.get("icon-anchor").evaluate(b,{},r.canonical)),le=!!ie.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=le:r.bucket.sdfIcons!==le&&Ae("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ie.pixelRatio!==r.bucket.pixelRatio||e.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const fe=Py(B.horizontal)||B.vertical;r.bucket.iconsInText=!!fe&&fe.iconsInText,(fe||H)&&aw(r.bucket,b,B,H,r.imageMap,a,M,L,X,le,r.canonical)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},u.perspective=function(r,e,i,a,d){var m,y=1/Math.tan(e/2);return r[0]=y/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=y,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,d!=null&&d!==1/0?(r[10]=(d+a)*(m=1/(a-d)),r[14]=2*d*a*m):(r[10]=-1,r[14]=-2*a),r},u.pick=function(r,e){const i={};for(let a=0;a<e.length;a++){const d=e[a];d in r&&(i[d]=r[d])}return i},u.plugin=Zr,u.pointGeometry=st,u.polygonIntersectsPolygon=Rg,u.potpack=fy,u.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],u.register=He,u.registerForPluginStateChange=function(r){return r({pluginStatus:_r,pluginURL:Ji}),ru.on("pluginStateChange",r),r},u.renderColorRamp=Wg,u.rotateX=function(r,e,i){var a=Math.sin(i),d=Math.cos(i),m=e[4],y=e[5],x=e[6],b=e[7],T=e[8],z=e[9],M=e[10],L=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=m*d+T*a,r[5]=y*d+z*a,r[6]=x*d+M*a,r[7]=b*d+L*a,r[8]=T*d-m*a,r[9]=z*d-y*a,r[10]=M*d-x*a,r[11]=L*d-b*a,r},u.rotateZ=function(r,e,i){var a=Math.sin(i),d=Math.cos(i),m=e[0],y=e[1],x=e[2],b=e[3],T=e[4],z=e[5],M=e[6],L=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=m*d+T*a,r[1]=y*d+z*a,r[2]=x*d+M*a,r[3]=b*d+L*a,r[4]=T*d-m*a,r[5]=z*d-y*a,r[6]=M*d-x*a,r[7]=L*d-b*a,r},u.scale=function(r,e,i){var a=i[0],d=i[1],m=i[2];return r[0]=e[0]*a,r[1]=e[1]*a,r[2]=e[2]*a,r[3]=e[3]*a,r[4]=e[4]*d,r[5]=e[5]*d,r[6]=e[6]*d,r[7]=e[7]*d,r[8]=e[8]*m,r[9]=e[9]*m,r[10]=e[10]*m,r[11]=e[11]*m,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},u.scale$1=function(r,e,i){return r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r},u.setCacheLimits=function(r,e){Ut=r,yr=e},u.setRTLTextPlugin=function(r,e,i=!1){if(_r===Ql||_r===eu||_r===tu)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ji=qn.resolveURL(r),_r=Ql,nu=e,es(),i||th()},u.spec=xe,u.sphericalToCartesian=function([r,e,i]){return e+=90,e*=Math.PI/180,i*=Math.PI/180,{x:r*Math.cos(e)*Math.sin(i),y:r*Math.sin(e)*Math.sin(i),z:r*Math.cos(i)}},u.sqrLen=function(r){var e=r[0],i=r[1];return e*e+i*i},u.sub=function(r,e,i){return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],r},u.toEvaluationFeature=na,u.transformMat3=function(r,e,i){var a=e[0],d=e[1],m=e[2];return r[0]=a*i[0]+d*i[3]+m*i[6],r[1]=a*i[1]+d*i[4]+m*i[7],r[2]=a*i[2]+d*i[5]+m*i[8],r},u.transformMat4=ch,u.transformMat4$1=function(r,e,i){var a=e[0],d=e[1];return r[0]=i[0]*a+i[4]*d+i[12],r[1]=i[1]*a+i[5]*d+i[13],r},u.translate=function(r,e,i){var a,d,m,y,x,b,T,z,M,L,B,F,H=i[0],X=i[1],le=i[2];return e===r?(r[12]=e[0]*H+e[4]*X+e[8]*le+e[12],r[13]=e[1]*H+e[5]*X+e[9]*le+e[13],r[14]=e[2]*H+e[6]*X+e[10]*le+e[14],r[15]=e[3]*H+e[7]*X+e[11]*le+e[15]):(d=e[1],m=e[2],y=e[3],x=e[4],b=e[5],T=e[6],z=e[7],M=e[8],L=e[9],B=e[10],F=e[11],r[0]=a=e[0],r[1]=d,r[2]=m,r[3]=y,r[4]=x,r[5]=b,r[6]=T,r[7]=z,r[8]=M,r[9]=L,r[10]=B,r[11]=F,r[12]=a*H+x*X+M*le+e[12],r[13]=d*H+b*X+L*le+e[13],r[14]=m*H+T*X+B*le+e[14],r[15]=y*H+z*X+F*le+e[15]),r},u.triggerPluginCompletionEvent=eh,u.unicodeBlockLookup=Ue,u.uniqueId=function(){return ke++},u.validateCustomStyleLayer=function(r){const e=[],i=r.id;return i===void 0&&e.push({message:`layers.${i}: missing required property "id"`}),r.render===void 0&&e.push({message:`layers.${i}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},u.validateLight=Hl,u.validateStyle=Hs,u.vectorTile=is,u.warnOnce=Ae,u.wrap=ze}),w(["./shared"],function(u){function N(V){const C=typeof V;if(C==="number"||C==="boolean"||C==="string"||V==null)return JSON.stringify(V);if(Array.isArray(V)){let U="[";for(const K of V)U+=`${N(K)},`;return`${U}]`}const P=Object.keys(V).sort();let O="{";for(let U=0;U<P.length;U++)O+=`${JSON.stringify(P[U])}:${N(V[P[U]])},`;return`${O}}`}function q(V){let C="";for(const P of u.refProperties)C+=`/${N(V[P])}`;return C}class ue{constructor(C){this.keyCache={},C&&this.replace(C)}replace(C){this._layerConfigs={},this._layers={},this.update(C,[])}update(C,P){for(const U of C){this._layerConfigs[U.id]=U;const K=this._layers[U.id]=u.createStyleLayer(U);K._featureFilter=u.createFilter(K.filter),this.keyCache[U.id]&&delete this.keyCache[U.id]}for(const U of P)delete this.keyCache[U],delete this._layerConfigs[U],delete this._layers[U];this.familiesBySource={};const O=function(U,K){const te={};for(let Y=0;Y<U.length;Y++){const ne=K&&K[U[Y].id]||q(U[Y]);K&&(K[U[Y].id]=ne);let ge=te[ne];ge||(ge=te[ne]=[]),ge.push(U[Y])}const J=[];for(const Y in te)J.push(te[Y]);return J}(Object.values(this._layerConfigs),this.keyCache);for(const U of O){const K=U.map(Ee=>this._layers[Ee.id]),te=K[0];if(te.visibility==="none")continue;const J=te.source||"";let Y=this.familiesBySource[J];Y||(Y=this.familiesBySource[J]={});const ne=te.sourceLayer||"_geojsonTileLayer";let ge=Y[ne];ge||(ge=Y[ne]=[]),ge.push(K)}}}class oe{constructor(C){const P={},O=[];for(const J in C){const Y=C[J],ne=P[J]={};for(const ge in Y){const Ee=Y[+ge];if(!Ee||Ee.bitmap.width===0||Ee.bitmap.height===0)continue;const me={x:0,y:0,w:Ee.bitmap.width+2,h:Ee.bitmap.height+2};O.push(me),ne[ge]={rect:me,metrics:Ee.metrics}}}const{w:U,h:K}=u.potpack(O),te=new u.AlphaImage({width:U||1,height:K||1});for(const J in C){const Y=C[J];for(const ne in Y){const ge=Y[+ne];if(!ge||ge.bitmap.width===0||ge.bitmap.height===0)continue;const Ee=P[J][ne].rect;u.AlphaImage.copy(ge.bitmap,te,{x:0,y:0},{x:Ee.x+1,y:Ee.y+1},ge.bitmap)}}this.image=te,this.positions=P}}u.register("GlyphAtlas",oe);class Z{constructor(C){this.tileID=new u.OverscaledTileID(C.tileID.overscaledZ,C.tileID.wrap,C.tileID.canonical.z,C.tileID.canonical.x,C.tileID.canonical.y),this.uid=C.uid,this.zoom=C.zoom,this.pixelRatio=C.pixelRatio,this.tileSize=C.tileSize,this.source=C.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=C.showCollisionBoxes,this.collectResourceTiming=!!C.collectResourceTiming,this.returnDependencies=!!C.returnDependencies,this.promoteId=C.promoteId}parse(C,P,O,U,K){this.status="parsing",this.data=C,this.collisionBoxArray=new u.CollisionBoxArray;const te=new u.DictionaryCoder(Object.keys(C.layers).sort()),J=new u.FeatureIndex(this.tileID,this.promoteId);J.bucketLayerIDs=[];const Y={},ne={featureIndex:J,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:O},ge=P.familiesBySource[this.source];for(const pt in ge){const _t=C.layers[pt];if(!_t)continue;_t.version===1&&u.warnOnce(`Vector tile source "${this.source}" layer "${pt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const At=te.encode(pt),Zt=[];for(let On=0;On<_t.length;On++){const Qt=_t.feature(On),er=J.getId(Qt,pt);Zt.push({feature:Qt,id:er,index:On,sourceLayerIndex:At})}for(const On of ge[pt]){const Qt=On[0];Qt.source!==this.source&&u.warnOnce(`layer.source = ${Qt.source} does not equal this.source = ${this.source}`),Qt.minzoom&&this.zoom<Math.floor(Qt.minzoom)||Qt.maxzoom&&this.zoom>=Qt.maxzoom||Qt.visibility!=="none"&&(ze(On,this.zoom,O),(Y[Qt.id]=Qt.createBucket({index:J.bucketLayerIDs.length,layers:On,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:At,sourceID:this.source})).populate(Zt,ne,this.tileID.canonical),J.bucketLayerIDs.push(On.map(er=>er.id)))}}let Ee,me,Ye,et;const je=u.mapObject(ne.glyphDependencies,pt=>Object.keys(pt).map(Number));Object.keys(je).length?U.send("getGlyphs",{uid:this.uid,stacks:je},(pt,_t)=>{Ee||(Ee=pt,me=_t,zt.call(this))}):me={};const lt=Object.keys(ne.iconDependencies);lt.length?U.send("getImages",{icons:lt,source:this.source,tileID:this.tileID,type:"icons"},(pt,_t)=>{Ee||(Ee=pt,Ye=_t,zt.call(this))}):Ye={};const ht=Object.keys(ne.patternDependencies);function zt(){if(Ee)return K(Ee);if(me&&Ye&&et){const pt=new oe(me),_t=new u.ImageAtlas(Ye,et);for(const At in Y){const Zt=Y[At];Zt instanceof u.SymbolBucket?(ze(Zt.layers,this.zoom,O),u.performSymbolLayout({bucket:Zt,glyphMap:me,glyphPositions:pt.positions,imageMap:Ye,imagePositions:_t.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Zt.hasPattern&&(Zt instanceof u.LineBucket||Zt instanceof u.FillBucket||Zt instanceof u.FillExtrusionBucket)&&(ze(Zt.layers,this.zoom,O),Zt.addFeatures(ne,this.tileID.canonical,_t.patternPositions))}this.status="done",K(null,{buckets:Object.values(Y).filter(At=>!At.isEmpty()),featureIndex:J,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:pt.image,imageAtlas:_t,glyphMap:this.returnDependencies?me:null,iconMap:this.returnDependencies?Ye:null,glyphPositions:this.returnDependencies?pt.positions:null})}}ht.length?U.send("getImages",{icons:ht,source:this.source,tileID:this.tileID,type:"patterns"},(pt,_t)=>{Ee||(Ee=pt,et=_t,zt.call(this))}):et={},zt.call(this)}}function ze(V,C,P){const O=new u.EvaluationParameters(C);for(const U of V)U.recalculate(O,P)}function Ie(V,C){const P=u.getArrayBuffer(V.request,(O,U,K,te)=>{O?C(O):U&&C(null,{vectorTile:new u.vectorTile.VectorTile(new u.pbf(U)),rawData:U,cacheControl:K,expires:te})});return()=>{P.cancel(),C()}}class ke{constructor(C,P,O,U){this.actor=C,this.layerIndex=P,this.availableImages=O,this.loadVectorData=U||Ie,this.loading={},this.loaded={}}loadTile(C,P){const O=C.uid;this.loading||(this.loading={});const U=!!(C&&C.request&&C.request.collectResourceTiming)&&new u.RequestPerformance(C.request),K=this.loading[O]=new Z(C);K.abort=this.loadVectorData(C,(te,J)=>{if(delete this.loading[O],te||!J)return K.status="done",this.loaded[O]=K,P(te);const Y=J.rawData,ne={};J.expires&&(ne.expires=J.expires),J.cacheControl&&(ne.cacheControl=J.cacheControl);const ge={};if(U){const Ee=U.finish();Ee&&(ge.resourceTiming=JSON.parse(JSON.stringify(Ee)))}K.vectorTile=J.vectorTile,K.parse(J.vectorTile,this.layerIndex,this.availableImages,this.actor,(Ee,me)=>{if(Ee||!me)return P(Ee);P(null,u.extend({rawTileData:Y.slice(0)},me,ne,ge))}),this.loaded=this.loaded||{},this.loaded[O]=K})}reloadTile(C,P){const O=this.loaded,U=C.uid,K=this;if(O&&O[U]){const te=O[U];te.showCollisionBoxes=C.showCollisionBoxes;const J=(Y,ne)=>{const ge=te.reloadCallback;ge&&(delete te.reloadCallback,te.parse(te.vectorTile,K.layerIndex,this.availableImages,K.actor,ge)),P(Y,ne)};te.status==="parsing"?te.reloadCallback=J:te.status==="done"&&(te.vectorTile?te.parse(te.vectorTile,this.layerIndex,this.availableImages,this.actor,J):J())}}abortTile(C,P){const O=this.loading,U=C.uid;O&&O[U]&&O[U].abort&&(O[U].abort(),delete O[U]),P()}removeTile(C,P){const O=this.loaded,U=C.uid;O&&O[U]&&delete O[U],P()}}class Xe{constructor(){this.loaded={}}loadTile(C,P){const{uid:O,encoding:U,rawImageData:K}=C,te=u.isImageBitmap(K)?this.getImageData(K):K,J=new u.DEMData(O,te,U);this.loaded=this.loaded||{},this.loaded[O]=J,P(null,J)}getImageData(C){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(C.width,C.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=C.width,this.offscreenCanvas.height=C.height,this.offscreenCanvasContext.drawImage(C,0,0,C.width,C.height);const P=this.offscreenCanvasContext.getImageData(-1,-1,C.width+2,C.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new u.RGBAImage({width:P.width,height:P.height},P.data)}removeTile(C){const P=this.loaded,O=C.uid;P&&P[O]&&delete P[O]}}var se=function V(C,P){var O,U=C&&C.type;if(U==="FeatureCollection")for(O=0;O<C.features.length;O++)V(C.features[O],P);else if(U==="GeometryCollection")for(O=0;O<C.geometries.length;O++)V(C.geometries[O],P);else if(U==="Feature")V(C.geometry,P);else if(U==="Polygon")Q(C.coordinates,P);else if(U==="MultiPolygon")for(O=0;O<C.coordinates.length;O++)Q(C.coordinates[O],P);return C};function Q(V,C){if(V.length!==0){ae(V[0],C);for(var P=1;P<V.length;P++)ae(V[P],!C)}}function ae(V,C){for(var P=0,O=0,U=0,K=V.length,te=K-1;U<K;te=U++){var J=(V[U][0]-V[te][0])*(V[te][1]+V[U][1]),Y=P+J;O+=Math.abs(P)>=Math.abs(J)?P-Y+J:J-Y+P,P=Y}P+O>=0!=!!C&&V.reverse()}const Se=u.vectorTile.VectorTileFeature.prototype.toGeoJSON;class Ae{constructor(C){this._feature=C,this.extent=u.EXTENT,this.type=C.type,this.properties=C.tags,"id"in C&&!isNaN(C.id)&&(this.id=parseInt(C.id,10))}loadGeometry(){if(this._feature.type===1){const C=[];for(const P of this._feature.geometry)C.push([new u.pointGeometry(P[0],P[1])]);return C}{const C=[];for(const P of this._feature.geometry){const O=[];for(const U of P)O.push(new u.pointGeometry(U[0],U[1]));C.push(O)}return C}}toGeoJSON(C,P,O){return Se.call(this,C,P,O)}}class Le{constructor(C){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=u.EXTENT,this.length=C.length,this._features=C}feature(C){return new Ae(this._features[C])}}var Me={exports:{}},Ke=u.pointGeometry,Ct=u.vectorTile.VectorTileFeature,dt=cn;function cn(V,C){this.options=C||{},this.features=V,this.length=V.length}function xn(V,C){this.id=typeof V.id=="number"?V.id:void 0,this.type=V.type,this.rawGeometry=V.type===1?[V.geometry]:V.geometry,this.properties=V.tags,this.extent=C||4096}cn.prototype.feature=function(V){return new xn(this.features[V],this.options.extent)},xn.prototype.loadGeometry=function(){var V=this.rawGeometry;this.geometry=[];for(var C=0;C<V.length;C++){for(var P=V[C],O=[],U=0;U<P.length;U++)O.push(new Ke(P[U][0],P[U][1]));this.geometry.push(O)}return this.geometry},xn.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var V=this.geometry,C=1/0,P=-1/0,O=1/0,U=-1/0,K=0;K<V.length;K++)for(var te=V[K],J=0;J<te.length;J++){var Y=te[J];C=Math.min(C,Y.x),P=Math.max(P,Y.x),O=Math.min(O,Y.y),U=Math.max(U,Y.y)}return[C,O,P,U]},xn.prototype.toGeoJSON=Ct.prototype.toGeoJSON;var an=u.pbf,ar=dt;function qn(V){var C=new an;return function(P,O){for(var U in P.layers)O.writeMessage(3,st,P.layers[U])}(V,C),C.finish()}function st(V,C){var P;C.writeVarintField(15,V.version||1),C.writeStringField(1,V.name||""),C.writeVarintField(5,V.extent||4096);var O={keys:[],values:[],keycache:{},valuecache:{}};for(P=0;P<V.length;P++)O.feature=V.feature(P),C.writeMessage(2,wn,O);var U=O.keys;for(P=0;P<U.length;P++)C.writeStringField(3,U[P]);var K=O.values;for(P=0;P<K.length;P++)C.writeMessage(4,Ut,K[P])}function wn(V,C){var P=V.feature;P.id!==void 0&&C.writeVarintField(1,P.id),C.writeMessage(2,Ze,V),C.writeVarintField(3,P.type),C.writeMessage(4,Tt,P)}function Ze(V,C){var P=V.feature,O=V.keys,U=V.values,K=V.keycache,te=V.valuecache;for(var J in P.properties){var Y=P.properties[J],ne=K[J];if(Y!==null){ne===void 0&&(O.push(J),K[J]=ne=O.length-1),C.writeVarint(ne);var ge=typeof Y;ge!=="string"&&ge!=="boolean"&&ge!=="number"&&(Y=JSON.stringify(Y));var Ee=ge+":"+Y,me=te[Ee];me===void 0&&(U.push(Y),te[Ee]=me=U.length-1),C.writeVarint(me)}}}function ct(V,C){return(C<<3)+(7&V)}function at(V){return V<<1^V>>31}function Tt(V,C){for(var P=V.loadGeometry(),O=V.type,U=0,K=0,te=P.length,J=0;J<te;J++){var Y=P[J],ne=1;O===1&&(ne=Y.length),C.writeVarint(ct(1,ne));for(var ge=O===3?Y.length-1:Y.length,Ee=0;Ee<ge;Ee++){Ee===1&&O!==1&&C.writeVarint(ct(2,ge-1));var me=Y[Ee].x-U,Ye=Y[Ee].y-K;C.writeVarint(at(me)),C.writeVarint(at(Ye)),U+=me,K+=Ye}O===3&&C.writeVarint(ct(7,1))}}function Ut(V,C){var P=typeof V;P==="string"?C.writeStringField(1,V):P==="boolean"?C.writeBooleanField(7,V):P==="number"&&(V%1!=0?C.writeDoubleField(3,V):V<0?C.writeSVarintField(6,V):C.writeVarintField(5,V))}function yr(V,C,P,O,U,K){if(U-O<=P)return;const te=O+U>>1;Rn(V,C,te,O,U,K%2),yr(V,C,P,O,te-1,K+1),yr(V,C,P,te+1,U,K+1)}function Rn(V,C,P,O,U,K){for(;U>O;){if(U-O>600){const ne=U-O+1,ge=P-O+1,Ee=Math.log(ne),me=.5*Math.exp(2*Ee/3),Ye=.5*Math.sqrt(Ee*me*(ne-me)/ne)*(ge-ne/2<0?-1:1);Rn(V,C,P,Math.max(O,Math.floor(P-ge*me/ne+Ye)),Math.min(U,Math.floor(P+(ne-ge)*me/ne+Ye)),K)}const te=C[2*P+K];let J=O,Y=U;for(Wn(V,C,O,P),C[2*U+K]>te&&Wn(V,C,O,U);J<Y;){for(Wn(V,C,J,Y),J++,Y--;C[2*J+K]<te;)J++;for(;C[2*Y+K]>te;)Y--}C[2*O+K]===te?Wn(V,C,O,Y):(Y++,Wn(V,C,Y,U)),Y<=P&&(O=Y+1),P<=Y&&(U=Y-1)}}function Wn(V,C,P,O){zn(V,P,O),zn(C,2*P,2*O),zn(C,2*P+1,2*O+1)}function zn(V,C,P){const O=V[C];V[C]=V[P],V[P]=O}function lr(V,C,P,O){const U=V-P,K=C-O;return U*U+K*K}Me.exports=qn,Me.exports.fromVectorTileJs=qn,Me.exports.fromGeojsonVt=function(V,C){C=C||{};var P={};for(var O in V)P[O]=new ar(V[O].features,C),P[O].name=O,P[O].version=C.version,P[O].extent=C.extent;return qn({layers:P})},Me.exports.GeoJSONWrapper=ar;const gi=V=>V[0],bn=V=>V[1];class qi{constructor(C,P=gi,O=bn,U=64,K=Float64Array){this.nodeSize=U,this.points=C;const te=C.length<65536?Uint16Array:Uint32Array,J=this.ids=new te(C.length),Y=this.coords=new K(2*C.length);for(let ne=0;ne<C.length;ne++)J[ne]=ne,Y[2*ne]=P(C[ne]),Y[2*ne+1]=O(C[ne]);yr(J,Y,U,0,J.length-1,0)}range(C,P,O,U){return function(K,te,J,Y,ne,ge,Ee){const me=[0,K.length-1,0],Ye=[];let et,je;for(;me.length;){const lt=me.pop(),ht=me.pop(),zt=me.pop();if(ht-zt<=Ee){for(let At=zt;At<=ht;At++)et=te[2*At],je=te[2*At+1],et>=J&&et<=ne&&je>=Y&&je<=ge&&Ye.push(K[At]);continue}const pt=Math.floor((zt+ht)/2);et=te[2*pt],je=te[2*pt+1],et>=J&&et<=ne&&je>=Y&&je<=ge&&Ye.push(K[pt]);const _t=(lt+1)%2;(lt===0?J<=et:Y<=je)&&(me.push(zt),me.push(pt-1),me.push(_t)),(lt===0?ne>=et:ge>=je)&&(me.push(pt+1),me.push(ht),me.push(_t))}return Ye}(this.ids,this.coords,C,P,O,U,this.nodeSize)}within(C,P,O){return function(U,K,te,J,Y,ne){const ge=[0,U.length-1,0],Ee=[],me=Y*Y;for(;ge.length;){const Ye=ge.pop(),et=ge.pop(),je=ge.pop();if(et-je<=ne){for(let _t=je;_t<=et;_t++)lr(K[2*_t],K[2*_t+1],te,J)<=me&&Ee.push(U[_t]);continue}const lt=Math.floor((je+et)/2),ht=K[2*lt],zt=K[2*lt+1];lr(ht,zt,te,J)<=me&&Ee.push(U[lt]);const pt=(Ye+1)%2;(Ye===0?te-Y<=ht:J-Y<=zt)&&(ge.push(je),ge.push(lt-1),ge.push(pt)),(Ye===0?te+Y>=ht:J+Y>=zt)&&(ge.push(lt+1),ge.push(et),ge.push(pt))}return Ee}(this.ids,this.coords,C,P,O,this.nodeSize)}}const Xt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:V=>V},jt=Math.fround||(Pt=new Float32Array(1),V=>(Pt[0]=+V,Pt[0]));var Pt;class En{constructor(C){this.options=ni(Object.create(Xt),C),this.trees=new Array(this.options.maxZoom+1)}load(C){const{log:P,minZoom:O,maxZoom:U,nodeSize:K}=this.options;P&&console.time("total time");const te=`prepare ${C.length} points`;P&&console.time(te),this.points=C;let J=[];for(let Y=0;Y<C.length;Y++)C[Y].geometry&&J.push(ur(C[Y],Y));this.trees[U+1]=new qi(J,Bn,An,K,Float32Array),P&&console.timeEnd(te);for(let Y=U;Y>=O;Y--){const ne=+Date.now();J=this._cluster(J,Y),this.trees[Y]=new qi(J,Bn,An,K,Float32Array),P&&console.log("z%d: %d clusters in %dms",Y,J.length,+Date.now()-ne)}return P&&console.timeEnd("total time"),this}getClusters(C,P){let O=((C[0]+180)%360+360)%360-180;const U=Math.max(-90,Math.min(90,C[1]));let K=C[2]===180?180:((C[2]+180)%360+360)%360-180;const te=Math.max(-90,Math.min(90,C[3]));if(C[2]-C[0]>=360)O=-180,K=180;else if(O>K){const ge=this.getClusters([O,U,180,te],P),Ee=this.getClusters([-180,U,K,te],P);return ge.concat(Ee)}const J=this.trees[this._limitZoom(P)],Y=J.range(wt(O),Cr(te),wt(K),Cr(U)),ne=[];for(const ge of Y){const Ee=J.points[ge];ne.push(Ee.numPoints?Qn(Ee):this.points[Ee.index])}return ne}getChildren(C){const P=this._getOriginId(C),O=this._getOriginZoom(C),U="No cluster with the specified id.",K=this.trees[O];if(!K)throw new Error(U);const te=K.points[P];if(!te)throw new Error(U);const J=this.options.radius/(this.options.extent*Math.pow(2,O-1)),Y=K.within(te.x,te.y,J),ne=[];for(const ge of Y){const Ee=K.points[ge];Ee.parentId===C&&ne.push(Ee.numPoints?Qn(Ee):this.points[Ee.index])}if(ne.length===0)throw new Error(U);return ne}getLeaves(C,P,O){const U=[];return this._appendLeaves(U,C,P=P||10,O=O||0,0),U}getTile(C,P,O){const U=this.trees[this._limitZoom(C)],K=Math.pow(2,C),{extent:te,radius:J}=this.options,Y=J/te,ne=(O-Y)/K,ge=(O+1+Y)/K,Ee={features:[]};return this._addTileFeatures(U.range((P-Y)/K,ne,(P+1+Y)/K,ge),U.points,P,O,K,Ee),P===0&&this._addTileFeatures(U.range(1-Y/K,ne,1,ge),U.points,K,O,K,Ee),P===K-1&&this._addTileFeatures(U.range(0,ne,Y/K,ge),U.points,-1,O,K,Ee),Ee.features.length?Ee:null}getClusterExpansionZoom(C){let P=this._getOriginZoom(C)-1;for(;P<=this.options.maxZoom;){const O=this.getChildren(C);if(P++,O.length!==1)break;C=O[0].properties.cluster_id}return P}_appendLeaves(C,P,O,U,K){const te=this.getChildren(P);for(const J of te){const Y=J.properties;if(Y&&Y.cluster?K+Y.point_count<=U?K+=Y.point_count:K=this._appendLeaves(C,Y.cluster_id,O,U,K):K<U?K++:C.push(J),C.length===O)break}return K}_addTileFeatures(C,P,O,U,K,te){for(const J of C){const Y=P[J],ne=Y.numPoints;let ge,Ee,me;if(ne)ge=ei(Y),Ee=Y.x,me=Y.y;else{const je=this.points[Y.index];ge=je.properties,Ee=wt(je.geometry.coordinates[0]),me=Cr(je.geometry.coordinates[1])}const Ye={type:1,geometry:[[Math.round(this.options.extent*(Ee*K-O)),Math.round(this.options.extent*(me*K-U))]],tags:ge};let et;ne?et=Y.id:this.options.generateId?et=Y.index:this.points[Y.index].id&&(et=this.points[Y.index].id),et!==void 0&&(Ye.id=et),te.features.push(Ye)}}_limitZoom(C){return Math.max(this.options.minZoom,Math.min(Math.floor(+C),this.options.maxZoom+1))}_cluster(C,P){const O=[],{radius:U,extent:K,reduce:te,minPoints:J}=this.options,Y=U/(K*Math.pow(2,P));for(let ne=0;ne<C.length;ne++){const ge=C[ne];if(ge.zoom<=P)continue;ge.zoom=P;const Ee=this.trees[P+1],me=Ee.within(ge.x,ge.y,Y),Ye=ge.numPoints||1;let et=Ye;for(const je of me){const lt=Ee.points[je];lt.zoom>P&&(et+=lt.numPoints||1)}if(et>Ye&&et>=J){let je=ge.x*Ye,lt=ge.y*Ye,ht=te&&Ye>1?this._map(ge,!0):null;const zt=(ne<<5)+(P+1)+this.points.length;for(const pt of me){const _t=Ee.points[pt];if(_t.zoom<=P)continue;_t.zoom=P;const At=_t.numPoints||1;je+=_t.x*At,lt+=_t.y*At,_t.parentId=zt,te&&(ht||(ht=this._map(ge,!0)),te(ht,this._map(_t)))}ge.parentId=zt,O.push(Gt(je/et,lt/et,zt,et,ht))}else if(O.push(ge),et>1)for(const je of me){const lt=Ee.points[je];lt.zoom<=P||(lt.zoom=P,O.push(lt))}}return O}_getOriginId(C){return C-this.points.length>>5}_getOriginZoom(C){return(C-this.points.length)%32}_map(C,P){if(C.numPoints)return P?ni({},C.properties):C.properties;const O=this.points[C.index].properties,U=this.options.map(O);return P&&U===O?ni({},U):U}}function Gt(V,C,P,O,U){return{x:jt(V),y:jt(C),zoom:1/0,id:P,parentId:-1,numPoints:O,properties:U}}function ur(V,C){const[P,O]=V.geometry.coordinates;return{x:jt(wt(P)),y:jt(Cr(O)),zoom:1/0,index:C,parentId:-1}}function Qn(V){return{type:"Feature",id:V.id,properties:ei(V),geometry:{type:"Point",coordinates:[(C=V.x,360*(C-.5)),ti(V.y)]}};var C}function ei(V){const C=V.numPoints,P=C>=1e4?`${Math.round(C/1e3)}k`:C>=1e3?Math.round(C/100)/10+"k":C;return ni(ni({},V.properties),{cluster:!0,cluster_id:V.id,point_count:C,point_count_abbreviated:P})}function wt(V){return V/360+.5}function Cr(V){const C=Math.sin(V*Math.PI/180),P=.5-.25*Math.log((1+C)/(1-C))/Math.PI;return P<0?0:P>1?1:P}function ti(V){const C=(180-360*V)*Math.PI/180;return 360*Math.atan(Math.exp(C))/Math.PI-90}function ni(V,C){for(const P in C)V[P]=C[P];return V}function Bn(V){return V.x}function An(V){return V.y}function Ir(V,C,P,O){for(var U,K=O,te=P-C>>1,J=P-C,Y=V[C],ne=V[C+1],ge=V[P],Ee=V[P+1],me=C+3;me<P;me+=3){var Ye=Wi(V[me],V[me+1],Y,ne,ge,Ee);if(Ye>K)U=me,K=Ye;else if(Ye===K){var et=Math.abs(me-te);et<J&&(U=me,J=et)}}K>O&&(U-C>3&&Ir(V,C,U,O),V[U+2]=K,P-U>3&&Ir(V,U,P,O))}function Wi(V,C,P,O,U,K){var te=U-P,J=K-O;if(te!==0||J!==0){var Y=((V-P)*te+(C-O)*J)/(te*te+J*J);Y>1?(P=U,O=K):Y>0&&(P+=te*Y,O+=J*Y)}return(te=V-P)*te+(J=C-O)*J}function zr(V,C,P,O){var U={id:V===void 0?null:V,type:C,geometry:P,tags:O,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(K){var te=K.geometry,J=K.type;if(J==="Point"||J==="MultiPoint"||J==="LineString")xe(K,te);else if(J==="Polygon"||J==="MultiLineString")for(var Y=0;Y<te.length;Y++)xe(K,te[Y]);else if(J==="MultiPolygon")for(Y=0;Y<te.length;Y++)for(var ne=0;ne<te[Y].length;ne++)xe(K,te[Y][ne])}(U),U}function xe(V,C){for(var P=0;P<C.length;P+=3)V.minX=Math.min(V.minX,C[P]),V.minY=Math.min(V.minY,C[P+1]),V.maxX=Math.max(V.maxX,C[P]),V.maxY=Math.max(V.maxY,C[P+1])}function Oe(V,C,P,O){if(C.geometry){var U=C.geometry.coordinates,K=C.geometry.type,te=Math.pow(P.tolerance/((1<<P.maxZoom)*P.extent),2),J=[],Y=C.id;if(P.promoteId?Y=C.properties[P.promoteId]:P.generateId&&(Y=O||0),K==="Point")co(U,J);else if(K==="MultiPoint")for(var ne=0;ne<U.length;ne++)co(U[ne],J);else if(K==="LineString")ri(U,J,te,!1);else if(K==="MultiLineString"){if(P.lineMetrics){for(ne=0;ne<U.length;ne++)ri(U[ne],J=[],te,!1),V.push(zr(Y,"LineString",J,C.properties));return}It(U,J,te,!1)}else if(K==="Polygon")It(U,J,te,!0);else{if(K!=="MultiPolygon"){if(K==="GeometryCollection"){for(ne=0;ne<C.geometry.geometries.length;ne++)Oe(V,{id:Y,geometry:C.geometry.geometries[ne],properties:C.properties},P,O);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ne=0;ne<U.length;ne++){var ge=[];It(U[ne],ge,te,!0),J.push(ge)}}V.push(zr(Y,K,J,C.properties))}}function co(V,C){C.push(Gr(V[0])),C.push(Ar(V[1])),C.push(0)}function ri(V,C,P,O){for(var U,K,te=0,J=0;J<V.length;J++){var Y=Gr(V[J][0]),ne=Ar(V[J][1]);C.push(Y),C.push(ne),C.push(0),J>0&&(te+=O?(U*ne-Y*K)/2:Math.sqrt(Math.pow(Y-U,2)+Math.pow(ne-K,2))),U=Y,K=ne}var ge=C.length-3;C[2]=1,Ir(C,0,ge,P),C[ge+2]=1,C.size=Math.abs(te),C.start=0,C.end=C.size}function It(V,C,P,O){for(var U=0;U<V.length;U++){var K=[];ri(V[U],K,P,O),C.push(K)}}function Gr(V){return V/360+.5}function Ar(V){var C=Math.sin(V*Math.PI/180),P=.5-.25*Math.log((1+C)/(1-C))/Math.PI;return P<0?0:P>1?1:P}function Mr(V,C,P,O,U,K,te,J){if(O/=C,K>=(P/=C)&&te<O)return V;if(te<P||K>=O)return null;for(var Y=[],ne=0;ne<V.length;ne++){var ge=V[ne],Ee=ge.geometry,me=ge.type,Ye=U===0?ge.minX:ge.minY,et=U===0?ge.maxX:ge.maxY;if(Ye>=P&&et<O)Y.push(ge);else if(!(et<P||Ye>=O)){var je=[];if(me==="Point"||me==="MultiPoint")Xi(Ee,je,P,O,U);else if(me==="LineString")Re(Ee,je,P,O,U,!1,J.lineMetrics);else if(me==="MultiLineString")mt(Ee,je,P,O,U,!1);else if(me==="Polygon")mt(Ee,je,P,O,U,!0);else if(me==="MultiPolygon")for(var lt=0;lt<Ee.length;lt++){var ht=[];mt(Ee[lt],ht,P,O,U,!0),ht.length&&je.push(ht)}if(je.length){if(J.lineMetrics&&me==="LineString"){for(lt=0;lt<je.length;lt++)Y.push(zr(ge.id,me,je[lt],ge.tags));continue}me!=="LineString"&&me!=="MultiLineString"||(je.length===1?(me="LineString",je=je[0]):me="MultiLineString"),me!=="Point"&&me!=="MultiPoint"||(me=je.length===3?"Point":"MultiPoint"),Y.push(zr(ge.id,me,je,ge.tags))}}}return Y.length?Y:null}function Xi(V,C,P,O,U){for(var K=0;K<V.length;K+=3){var te=V[K+U];te>=P&&te<=O&&(C.push(V[K]),C.push(V[K+1]),C.push(V[K+2]))}}function Re(V,C,P,O,U,K,te){for(var J,Y,ne=yt(V),ge=U===0?Hi:ft,Ee=V.start,me=0;me<V.length-3;me+=3){var Ye=V[me],et=V[me+1],je=V[me+2],lt=V[me+3],ht=V[me+4],zt=U===0?Ye:et,pt=U===0?lt:ht,_t=!1;te&&(J=Math.sqrt(Math.pow(Ye-lt,2)+Math.pow(et-ht,2))),zt<P?pt>P&&(Y=ge(ne,Ye,et,lt,ht,P),te&&(ne.start=Ee+J*Y)):zt>O?pt<O&&(Y=ge(ne,Ye,et,lt,ht,O),te&&(ne.start=Ee+J*Y)):Xn(ne,Ye,et,je),pt<P&&zt>=P&&(Y=ge(ne,Ye,et,lt,ht,P),_t=!0),pt>O&&zt<=O&&(Y=ge(ne,Ye,et,lt,ht,O),_t=!0),!K&&_t&&(te&&(ne.end=Ee+J*Y),C.push(ne),ne=yt(V)),te&&(Ee+=J)}var At=V.length-3;Ye=V[At],et=V[At+1],je=V[At+2],(zt=U===0?Ye:et)>=P&&zt<=O&&Xn(ne,Ye,et,je),At=ne.length-3,K&&At>=3&&(ne[At]!==ne[0]||ne[At+1]!==ne[1])&&Xn(ne,ne[0],ne[1],ne[2]),ne.length&&C.push(ne)}function yt(V){var C=[];return C.size=V.size,C.start=V.start,C.end=V.end,C}function mt(V,C,P,O,U,K){for(var te=0;te<V.length;te++)Re(V[te],C,P,O,U,K,!1)}function Xn(V,C,P,O){V.push(C),V.push(P),V.push(O)}function Hi(V,C,P,O,U,K){var te=(K-C)/(O-C);return V.push(K),V.push(P+(U-P)*te),V.push(1),te}function ft(V,C,P,O,U,K){var te=(K-P)/(U-P);return V.push(C+(O-C)*te),V.push(K),V.push(1),te}function Ai(V,C){for(var P=[],O=0;O<V.length;O++){var U,K=V[O],te=K.type;if(te==="Point"||te==="MultiPoint"||te==="LineString")U=Fn(K.geometry,C);else if(te==="MultiLineString"||te==="Polygon"){U=[];for(var J=0;J<K.geometry.length;J++)U.push(Fn(K.geometry[J],C))}else if(te==="MultiPolygon")for(U=[],J=0;J<K.geometry.length;J++){for(var Y=[],ne=0;ne<K.geometry[J].length;ne++)Y.push(Fn(K.geometry[J][ne],C));U.push(Y)}P.push(zr(K.id,te,U,K.tags))}return P}function Fn(V,C){var P=[];P.size=V.size,V.start!==void 0&&(P.start=V.start,P.end=V.end);for(var O=0;O<V.length;O+=3)P.push(V[O]+C,V[O+1],V[O+2]);return P}function Vo(V,C){if(V.transformed)return V;var P,O,U,K=1<<V.z,te=V.x,J=V.y;for(P=0;P<V.features.length;P++){var Y=V.features[P],ne=Y.geometry,ge=Y.type;if(Y.geometry=[],ge===1)for(O=0;O<ne.length;O+=2)Y.geometry.push(Sn(ne[O],ne[O+1],C,K,te,J));else for(O=0;O<ne.length;O++){var Ee=[];for(U=0;U<ne[O].length;U+=2)Ee.push(Sn(ne[O][U],ne[O][U+1],C,K,te,J));Y.geometry.push(Ee)}}return V.transformed=!0,V}function Sn(V,C,P,O,U,K){return[Math.round(P*(V*O-U)),Math.round(P*(C*O-K))]}function cr(V,C,P,O,U){for(var K=C===U.maxZoom?0:U.tolerance/((1<<C)*U.extent),te={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:P,y:O,z:C,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},J=0;J<V.length;J++){te.numFeatures++,Vt(te,V[J],K,U);var Y=V[J].minX,ne=V[J].minY,ge=V[J].maxX,Ee=V[J].maxY;Y<te.minX&&(te.minX=Y),ne<te.minY&&(te.minY=ne),ge>te.maxX&&(te.maxX=ge),Ee>te.maxY&&(te.maxY=Ee)}return te}function Vt(V,C,P,O){var U=C.geometry,K=C.type,te=[];if(K==="Point"||K==="MultiPoint")for(var J=0;J<U.length;J+=3)te.push(U[J]),te.push(U[J+1]),V.numPoints++,V.numSimplified++;else if(K==="LineString")$o(te,U,V,P,!1,!1);else if(K==="MultiLineString"||K==="Polygon")for(J=0;J<U.length;J++)$o(te,U[J],V,P,K==="Polygon",J===0);else if(K==="MultiPolygon")for(var Y=0;Y<U.length;Y++){var ne=U[Y];for(J=0;J<ne.length;J++)$o(te,ne[J],V,P,!0,J===0)}if(te.length){var ge=C.tags||null;if(K==="LineString"&&O.lineMetrics){for(var Ee in ge={},C.tags)ge[Ee]=C.tags[Ee];ge.mapbox_clip_start=U.start/U.size,ge.mapbox_clip_end=U.end/U.size}var me={geometry:te,type:K==="Polygon"||K==="MultiPolygon"?3:K==="LineString"||K==="MultiLineString"?2:1,tags:ge};C.id!==null&&(me.id=C.id),V.features.push(me)}}function $o(V,C,P,O,U,K){var te=O*O;if(O>0&&C.size<(U?te:O))P.numPoints+=C.length/3;else{for(var J=[],Y=0;Y<C.length;Y+=3)(O===0||C[Y+2]>te)&&(P.numSimplified++,J.push(C[Y]),J.push(C[Y+1])),P.numPoints++;U&&function(ne,ge){for(var Ee=0,me=0,Ye=ne.length,et=Ye-2;me<Ye;et=me,me+=2)Ee+=(ne[me]-ne[et])*(ne[me+1]+ne[et+1]);if(Ee>0===ge)for(me=0,Ye=ne.length;me<Ye/2;me+=2){var je=ne[me],lt=ne[me+1];ne[me]=ne[Ye-2-me],ne[me+1]=ne[Ye-1-me],ne[Ye-2-me]=je,ne[Ye-1-me]=lt}}(J,K),V.push(J)}}function yi(V,C){var P=(C=this.options=function(U,K){for(var te in K)U[te]=K[te];return U}(Object.create(this.options),C)).debug;if(P&&console.time("preprocess data"),C.maxZoom<0||C.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(C.promoteId&&C.generateId)throw new Error("promoteId and generateId cannot be used together.");var O=function(U,K){var te=[];if(U.type==="FeatureCollection")for(var J=0;J<U.features.length;J++)Oe(te,U.features[J],K,J);else Oe(te,U.type==="Feature"?U:{geometry:U},K);return te}(V,C);this.tiles={},this.tileCoords=[],P&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",C.indexMaxZoom,C.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),O=function(U,K){var te=K.buffer/K.extent,J=U,Y=Mr(U,1,-1-te,te,0,-1,2,K),ne=Mr(U,1,1-te,2+te,0,-1,2,K);return(Y||ne)&&(J=Mr(U,1,-te,1+te,0,-1,2,K)||[],Y&&(J=Ai(Y,1).concat(J)),ne&&(J=J.concat(Ai(ne,-1)))),J}(O,C),O.length&&this.splitTile(O,0,0,0),P&&(O.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ho(V,C,P){return 32*((1<<V)*P+C)+V}function po(V,C){const P=V.tileID.canonical;if(!this._geoJSONIndex)return C(null,null);const O=this._geoJSONIndex.getTile(P.z,P.x,P.y);if(!O)return C(null,null);const U=new Le(O.features);let K=Me.exports(U);K.byteOffset===0&&K.byteLength===K.buffer.byteLength||(K=new Uint8Array(K)),C(null,{vectorTile:U,rawData:K.buffer})}yi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},yi.prototype.splitTile=function(V,C,P,O,U,K,te){for(var J=[V,C,P,O],Y=this.options,ne=Y.debug;J.length;){O=J.pop(),P=J.pop(),C=J.pop(),V=J.pop();var ge=1<<C,Ee=ho(C,P,O),me=this.tiles[Ee];if(!me&&(ne>1&&console.time("creation"),me=this.tiles[Ee]=cr(V,C,P,O,Y),this.tileCoords.push({z:C,x:P,y:O}),ne)){ne>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",C,P,O,me.numFeatures,me.numPoints,me.numSimplified),console.timeEnd("creation"));var Ye="z"+C;this.stats[Ye]=(this.stats[Ye]||0)+1,this.total++}if(me.source=V,U){if(C===Y.maxZoom||C===U)continue;var et=1<<U-C;if(P!==Math.floor(K/et)||O!==Math.floor(te/et))continue}else if(C===Y.indexMaxZoom||me.numPoints<=Y.indexMaxPoints)continue;if(me.source=null,V.length!==0){ne>1&&console.time("clipping");var je,lt,ht,zt,pt,_t,At=.5*Y.buffer/Y.extent,Zt=.5-At,On=.5+At,Qt=1+At;je=lt=ht=zt=null,pt=Mr(V,ge,P-At,P+On,0,me.minX,me.maxX,Y),_t=Mr(V,ge,P+Zt,P+Qt,0,me.minX,me.maxX,Y),V=null,pt&&(je=Mr(pt,ge,O-At,O+On,1,me.minY,me.maxY,Y),lt=Mr(pt,ge,O+Zt,O+Qt,1,me.minY,me.maxY,Y),pt=null),_t&&(ht=Mr(_t,ge,O-At,O+On,1,me.minY,me.maxY,Y),zt=Mr(_t,ge,O+Zt,O+Qt,1,me.minY,me.maxY,Y),_t=null),ne>1&&console.timeEnd("clipping"),J.push(je||[],C+1,2*P,2*O),J.push(lt||[],C+1,2*P,2*O+1),J.push(ht||[],C+1,2*P+1,2*O),J.push(zt||[],C+1,2*P+1,2*O+1)}}},yi.prototype.getTile=function(V,C,P){var O=this.options,U=O.extent,K=O.debug;if(V<0||V>24)return null;var te=1<<V,J=ho(V,C=(C%te+te)%te,P);if(this.tiles[J])return Vo(this.tiles[J],U);K>1&&console.log("drilling down to z%d-%d-%d",V,C,P);for(var Y,ne=V,ge=C,Ee=P;!Y&&ne>0;)ne--,ge=Math.floor(ge/2),Ee=Math.floor(Ee/2),Y=this.tiles[ho(ne,ge,Ee)];return Y&&Y.source?(K>1&&console.log("found parent tile z%d-%d-%d",ne,ge,Ee),K>1&&console.time("drilling down"),this.splitTile(Y.source,ne,ge,Ee,V,C,P),K>1&&console.timeEnd("drilling down"),this.tiles[J]?Vo(this.tiles[J],U):null):null};class jo extends ke{constructor(C,P,O,U){super(C,P,O,po),U&&(this.loadGeoJSON=U)}loadData(C,P){var O;(O=this._pendingRequest)===null||O===void 0||O.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const U=!!(C&&C.request&&C.request.collectResourceTiming)&&new u.RequestPerformance(C.request);this._pendingCallback=P,this._pendingRequest=this.loadGeoJSON(C,(K,te)=>{if(delete this._pendingCallback,delete this._pendingRequest,K||!te)return P(K);if(typeof te!="object")return P(new Error(`Input data given to '${C.source}' is not a valid GeoJSON object.`));{se(te,!0);try{if(C.filter){const Y=u.createExpression(C.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Y.result==="error")throw new Error(Y.value.map(ge=>`${ge.key}: ${ge.message}`).join(", "));te={type:"FeatureCollection",features:te.features.filter(ge=>Y.value.evaluate({zoom:0},ge))}}this._geoJSONIndex=C.cluster?new En(function({superclusterOptions:Y,clusterProperties:ne}){if(!ne||!Y)return Y;const ge={},Ee={},me={accumulated:null,zoom:0},Ye={properties:null},et=Object.keys(ne);for(const je of et){const[lt,ht]=ne[je],zt=u.createExpression(ht),pt=u.createExpression(typeof lt=="string"?[lt,["accumulated"],["get",je]]:lt);ge[je]=zt.value,Ee[je]=pt.value}return Y.map=je=>{Ye.properties=je;const lt={};for(const ht of et)lt[ht]=ge[ht].evaluate(me,Ye);return lt},Y.reduce=(je,lt)=>{Ye.properties=lt;for(const ht of et)me.accumulated=je[ht],je[ht]=Ee[ht].evaluate(me,Ye)},Y}(C)).load(te.features):function(Y,ne){return new yi(Y,ne)}(te,C.geojsonVtOptions)}catch(Y){return P(Y)}this.loaded={};const J={};if(U){const Y=U.finish();Y&&(J.resourceTiming={},J.resourceTiming[C.source]=JSON.parse(JSON.stringify(Y)))}P(null,J)}})}reloadTile(C,P){const O=this.loaded;return O&&O[C.uid]?super.reloadTile(C,P):this.loadTile(C,P)}loadGeoJSON(C,P){if(C.request)return u.getJSON(C.request,P);if(typeof C.data=="string")try{P(null,JSON.parse(C.data))}catch{P(new Error(`Input data given to '${C.source}' is not a valid GeoJSON object.`))}else P(new Error(`Input data given to '${C.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(C,P){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),P()}getClusterExpansionZoom(C,P){try{P(null,this._geoJSONIndex.getClusterExpansionZoom(C.clusterId))}catch(O){P(O)}}getClusterChildren(C,P){try{P(null,this._geoJSONIndex.getChildren(C.clusterId))}catch(O){P(O)}}getClusterLeaves(C,P){try{P(null,this._geoJSONIndex.getLeaves(C.clusterId,C.limit,C.offset))}catch(O){P(O)}}}class fo{constructor(C){this.self=C,this.actor=new u.Actor(C,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:ke,geojson:jo},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(P,O)=>{if(this.workerSourceTypes[P])throw new Error(`Worker source with name "${P}" already registered.`);this.workerSourceTypes[P]=O},this.self.registerRTLTextPlugin=P=>{if(u.plugin.isParsed())throw new Error("RTL text plugin already registered.");u.plugin.applyArabicShaping=P.applyArabicShaping,u.plugin.processBidirectionalText=P.processBidirectionalText,u.plugin.processStyledBidirectionalText=P.processStyledBidirectionalText}}setReferrer(C,P){this.referrer=P}setImages(C,P,O){this.availableImages[C]=P;for(const U in this.workerSources[C]){const K=this.workerSources[C][U];for(const te in K)K[te].availableImages=P}O()}setLayers(C,P,O){this.getLayerIndex(C).replace(P),O()}updateLayers(C,P,O){this.getLayerIndex(C).update(P.layers,P.removedIds),O()}loadTile(C,P,O){this.getWorkerSource(C,P.type,P.source).loadTile(P,O)}loadDEMTile(C,P,O){this.getDEMWorkerSource(C,P.source).loadTile(P,O)}reloadTile(C,P,O){this.getWorkerSource(C,P.type,P.source).reloadTile(P,O)}abortTile(C,P,O){this.getWorkerSource(C,P.type,P.source).abortTile(P,O)}removeTile(C,P,O){this.getWorkerSource(C,P.type,P.source).removeTile(P,O)}removeDEMTile(C,P){this.getDEMWorkerSource(C,P.source).removeTile(P)}removeSource(C,P,O){if(!this.workerSources[C]||!this.workerSources[C][P.type]||!this.workerSources[C][P.type][P.source])return;const U=this.workerSources[C][P.type][P.source];delete this.workerSources[C][P.type][P.source],U.removeSource!==void 0?U.removeSource(P,O):O()}loadWorkerSource(C,P,O){try{this.self.importScripts(P.url),O()}catch(U){O(U.toString())}}syncRTLPluginState(C,P,O){try{u.plugin.setState(P);const U=u.plugin.getPluginURL();if(u.plugin.isLoaded()&&!u.plugin.isParsed()&&U!=null){this.self.importScripts(U);const K=u.plugin.isParsed();O(K?void 0:new Error(`RTL Text Plugin failed to import scripts from ${U}`),K)}}catch(U){O(U.toString())}}getAvailableImages(C){let P=this.availableImages[C];return P||(P=[]),P}getLayerIndex(C){let P=this.layerIndexes[C];return P||(P=this.layerIndexes[C]=new ue),P}getWorkerSource(C,P,O){if(this.workerSources[C]||(this.workerSources[C]={}),this.workerSources[C][P]||(this.workerSources[C][P]={}),!this.workerSources[C][P][O]){const U={send:(K,te,J)=>{this.actor.send(K,te,J,C)}};this.workerSources[C][P][O]=new this.workerSourceTypes[P](U,this.getLayerIndex(C),this.getAvailableImages(C))}return this.workerSources[C][P][O]}getDEMWorkerSource(C,P){return this.demWorkerSources[C]||(this.demWorkerSources[C]={}),this.demWorkerSources[C][P]||(this.demWorkerSources[C][P]=new Xe),this.demWorkerSources[C][P]}enforceCacheSizeLimit(C,P){u.enforceCacheSizeLimit(P)}}return u.isWorker()&&(self.worker=new fo(self)),fo}),w(["./shared"],function(u){var N=q;function q(h){return!function(t){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var c,p,g=new Blob([""],{type:"text/javascript"}),v=URL.createObjectURL(g);try{p=new Worker(v),c=!0}catch{c=!1}return p&&p.terminate(),URL.revokeObjectURL(v),c}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var c=document.createElement("canvas");c.width=c.height=1;var p=c.getContext("2d");if(!p)return!1;var g=p.getImageData(0,0,1,1);return g&&g.width===c.width}()?(ue[s=t&&t.failIfMajorPerformanceCaveat]===void 0&&(ue[s]=function(c){var p,g=function(v){var E=document.createElement("canvas"),S=Object.create(q.webGLContextAttributes);return S.failIfMajorPerformanceCaveat=v,E.getContext("webgl",S)||E.getContext("experimental-webgl",S)}(c);if(!g)return!1;try{p=g.createShader(g.VERTEX_SHADER)}catch{return!1}return!(!p||g.isContextLost())&&(g.shaderSource(p,"void main() {}"),g.compileShader(p),g.getShaderParameter(p,g.COMPILE_STATUS)===!0)}(s)),ue[s]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var s}(h)}var ue={};function oe(h,t){if(Array.isArray(h)){if(!Array.isArray(t)||h.length!==t.length)return!1;for(let s=0;s<h.length;s++)if(!oe(h[s],t[s]))return!1;return!0}if(typeof h=="object"&&h!==null&&t!==null){if(typeof t!="object"||Object.keys(h).length!==Object.keys(t).length)return!1;for(const s in h)if(!oe(h[s],t[s]))return!1;return!0}return h===t}q.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class Z{static testProp(t){if(!Z.docStyle)return t[0];for(let s=0;s<t.length;s++)if(t[s]in Z.docStyle)return t[s];return t[0]}static create(t,s,c){const p=window.document.createElement(t);return s!==void 0&&(p.className=s),c&&c.appendChild(p),p}static createNS(t,s){return window.document.createElementNS(t,s)}static disableDrag(){Z.docStyle&&Z.selectProp&&(Z.userSelect=Z.docStyle[Z.selectProp],Z.docStyle[Z.selectProp]="none")}static enableDrag(){Z.docStyle&&Z.selectProp&&(Z.docStyle[Z.selectProp]=Z.userSelect)}static setTransform(t,s){t.style[Z.transformProp]=s}static addEventListener(t,s,c,p={}){t.addEventListener(s,c,"passive"in p?p:p.capture)}static removeEventListener(t,s,c,p={}){t.removeEventListener(s,c,"passive"in p?p:p.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",Z.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",Z.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",Z.suppressClickInternal,!0)},0)}static mousePos(t,s){const c=t.getBoundingClientRect();return new u.pointGeometry(s.clientX-c.left-t.clientLeft,s.clientY-c.top-t.clientTop)}static touchPos(t,s){const c=t.getBoundingClientRect(),p=[];for(let g=0;g<s.length;g++)p.push(new u.pointGeometry(s[g].clientX-c.left-t.clientLeft,s[g].clientY-c.top-t.clientTop));return p}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}Z.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,Z.selectProp=Z.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),Z.transformProp=Z.testProp(["transform","WebkitTransform"]);class ze{constructor(t){this._transformRequestFn=t}transformRequest(t,s){return this._transformRequestFn&&this._transformRequestFn(t,s)||{url:t}}normalizeSpriteURL(t,s,c){const p=function(g){const v=g.match(Ie);if(!v)throw new Error(`Unable to parse URL "${g}"`);return{protocol:v[1],authority:v[2],path:v[3]||"/",params:v[4]?v[4].split("&"):[]}}(t);return p.path+=`${s}${c}`,function(g){const v=g.params.length?`?${g.params.join("&")}`:"";return`${g.protocol}://${g.authority}${g.path}${v}`}(p)}setTransformRequest(t){this._transformRequestFn=t}}const Ie=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class ke{constructor(t,s,c,p){this.context=t,this.format=c,this.texture=t.gl.createTexture(),this.update(s,p)}update(t,s,c){const{width:p,height:g}=t,v=!(this.size&&this.size[0]===p&&this.size[1]===g||c),{context:E}=this,{gl:S}=E;if(this.useMipmap=Boolean(s&&s.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!s||s.premultiply!==!1)),v)this.size=[p,g],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||u.isImageBitmap(t)?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,t):S.texImage2D(S.TEXTURE_2D,0,this.format,p,g,0,this.format,S.UNSIGNED_BYTE,t.data);else{const{x:k,y:A}=c||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||u.isImageBitmap(t)?S.texSubImage2D(S.TEXTURE_2D,0,k,A,S.RGBA,S.UNSIGNED_BYTE,t):S.texSubImage2D(S.TEXTURE_2D,0,k,A,p,g,S.RGBA,S.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D)}bind(t,s,c){const{context:p}=this,{gl:g}=p;g.bindTexture(g.TEXTURE_2D,this.texture),c!==g.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=g.LINEAR),t!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,t),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,c||t),this.filter=t),s!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,s),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function Xe(h){const{userImage:t}=h;return!!(t&&t.render&&t.render())&&(h.data.replace(new Uint8Array(t.data.buffer)),!0)}class se extends u.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:s,callback:c}of this.requestors)this._notify(s,c);this.requestors=[]}}getImage(t){return this.images[t]}addImage(t,s){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,s)&&(this.images[t]=s)}_validate(t,s){let c=!0;return this._validateStretch(s.stretchX,s.data&&s.data.width)||(this.fire(new u.ErrorEvent(new Error(`Image "${t}" has invalid "stretchX" value`))),c=!1),this._validateStretch(s.stretchY,s.data&&s.data.height)||(this.fire(new u.ErrorEvent(new Error(`Image "${t}" has invalid "stretchY" value`))),c=!1),this._validateContent(s.content,s)||(this.fire(new u.ErrorEvent(new Error(`Image "${t}" has invalid "content" value`))),c=!1),c}_validateStretch(t,s){if(!t)return!0;let c=0;for(const p of t){if(p[0]<c||p[1]<p[0]||s<p[1])return!1;c=p[1]}return!0}_validateContent(t,s){return!(t&&(t.length!==4||t[0]<0||s.data.width<t[0]||t[1]<0||s.data.height<t[1]||t[2]<0||s.data.width<t[2]||t[3]<0||s.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,s){const c=this.images[t];if(c.data.width!==s.data.width||c.data.height!==s.data.height)throw new Error(`size mismatch between old image (${c.data.width}x${c.data.height}) and new image (${s.data.width}x${s.data.height}).`);s.version=c.version+1,this.images[t]=s,this.updatedImages[t]=!0}removeImage(t){const s=this.images[t];delete this.images[t],delete this.patterns[t],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,s){let c=!0;if(!this.isLoaded())for(const p of t)this.images[p]||(c=!1);this.isLoaded()||c?this._notify(t,s):this.requestors.push({ids:t,callback:s})}_notify(t,s){const c={};for(const p of t){this.images[p]||this.fire(new u.Event("styleimagemissing",{id:p}));const g=this.images[p];g?c[p]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,hasRenderCallback:Boolean(g.userImage&&g.userImage.render)}:u.warnOnce(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}s(null,c)}getPixelSize(){const{width:t,height:s}=this.atlasImage;return{width:t,height:s}}getPattern(t){const s=this.patterns[t],c=this.getImage(t);if(!c)return null;if(s&&s.position.version===c.version)return s.position;if(s)s.position.version=c.version;else{const p={w:c.data.width+2,h:c.data.height+2,x:0,y:0},g=new u.ImagePosition(p,c);this.patterns[t]={bin:p,position:g}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const s=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ke(t,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const g in this.patterns)t.push(this.patterns[g].bin);const{w:s,h:c}=u.potpack(t),p=this.atlasImage;p.resize({width:s||1,height:c||1});for(const g in this.patterns){const{bin:v}=this.patterns[g],E=v.x+1,S=v.y+1,k=this.images[g].data,A=k.width,D=k.height;u.RGBAImage.copy(k,p,{x:0,y:0},{x:E,y:S},{width:A,height:D}),u.RGBAImage.copy(k,p,{x:0,y:D-1},{x:E,y:S-1},{width:A,height:1}),u.RGBAImage.copy(k,p,{x:0,y:0},{x:E,y:S+D},{width:A,height:1}),u.RGBAImage.copy(k,p,{x:A-1,y:0},{x:E-1,y:S},{width:1,height:D}),u.RGBAImage.copy(k,p,{x:0,y:0},{x:E+A,y:S},{width:1,height:D})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const s of t){if(this.callbackDispatchedThisFrame[s])continue;this.callbackDispatchedThisFrame[s]=!0;const c=this.images[s];c||u.warnOnce(`Image with ID: "${s}" was not found`),Xe(c)&&this.updateImage(s,c)}}}const Q=1e20;function ae(h,t,s,c,p,g,v,E,S){for(let k=t;k<t+c;k++)Se(h,s*g+k,g,p,v,E,S);for(let k=s;k<s+p;k++)Se(h,k*g+t,1,c,v,E,S)}function Se(h,t,s,c,p,g,v){g[0]=0,v[0]=-Q,v[1]=Q,p[0]=h[t];for(let E=1,S=0,k=0;E<c;E++){p[E]=h[t+E*s];const A=E*E;do{const D=g[S];k=(p[E]-p[D]+A-D*D)/(E-D)/2}while(k<=v[S]&&--S>-1);S++,g[S]=E,v[S]=k,v[S+1]=Q}for(let E=0,S=0;E<c;E++){for(;v[S+1]<E;)S++;const k=g[S],A=E-k;h[t+E*s]=p[k]+A*A}}class Ae{constructor(t,s){this.requestManager=t,this.localIdeographFontFamily=s,this.entries={}}setURL(t){this.url=t}getGlyphs(t,s){const c=[];for(const p in t)for(const g of t[p])c.push({stack:p,id:g});u.asyncAll(c,({stack:p,id:g},v)=>{let E=this.entries[p];E||(E=this.entries[p]={glyphs:{},requests:{},ranges:{}});let S=E.glyphs[g];if(S!==void 0)return void v(null,{stack:p,id:g,glyph:S});if(S=this._tinySDF(E,p,g),S)return E.glyphs[g]=S,void v(null,{stack:p,id:g,glyph:S});const k=Math.floor(g/256);if(256*k>65535)return void v(new Error("glyphs > 65535 not supported"));if(E.ranges[k])return void v(null,{stack:p,id:g,glyph:S});let A=E.requests[k];A||(A=E.requests[k]=[],Ae.loadGlyphRange(p,k,this.url,this.requestManager,(D,R)=>{if(R){for(const G in R)this._doesCharSupportLocalGlyph(+G)||(E.glyphs[+G]=R[+G]);E.ranges[k]=!0}for(const G of A)G(D,R);delete E.requests[k]})),A.push((D,R)=>{D?v(D):R&&v(null,{stack:p,id:g,glyph:R[g]||null})})},(p,g)=>{if(p)s(p);else if(g){const v={};for(const{stack:E,id:S,glyph:k}of g)(v[E]||(v[E]={}))[S]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics};s(null,v)}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(u.unicodeBlockLookup["CJK Unified Ideographs"](t)||u.unicodeBlockLookup["Hangul Syllables"](t)||u.unicodeBlockLookup.Hiragana(t)||u.unicodeBlockLookup.Katakana(t))}_tinySDF(t,s,c){const p=this.localIdeographFontFamily;if(!p||!this._doesCharSupportLocalGlyph(c))return;let g=t.tinySDF;if(!g){let E="400";/bold/i.test(s)?E="900":/medium/i.test(s)?E="500":/light/i.test(s)&&(E="200"),g=t.tinySDF=new Ae.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:p,fontWeight:E})}const v=g.draw(String.fromCharCode(c));return{id:c,bitmap:new u.AlphaImage({width:v.width||30,height:v.height||30},v.data),metrics:{width:v.glyphWidth||24,height:v.glyphHeight||24,left:v.glyphLeft||0,top:v.glyphTop-27||-8,advance:v.glyphAdvance||24}}}}Ae.loadGlyphRange=function(h,t,s,c,p){const g=256*t,v=g+255,E=c.transformRequest(s.replace("{fontstack}",h).replace("{range}",`${g}-${v}`),u.ResourceType.Glyphs);u.getArrayBuffer(E,(S,k)=>{if(S)p(S);else if(k){const A={};for(const D of u.parseGlyphPbf(k))A[D.id]=D;p(null,A)}})},Ae.TinySDF=class{constructor({fontSize:h=24,buffer:t=3,radius:s=8,cutoff:c=.25,fontFamily:p="sans-serif",fontWeight:g="normal",fontStyle:v="normal"}={}){this.buffer=t,this.cutoff=c,this.radius=s;const E=this.size=h+4*t,S=this._createCanvas(E),k=this.ctx=S.getContext("2d",{willReadFrequently:!0});k.font=`${v} ${g} ${h}px ${p}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(h){const t=document.createElement("canvas");return t.width=t.height=h,t}draw(h){const{width:t,actualBoundingBoxAscent:s,actualBoundingBoxDescent:c,actualBoundingBoxLeft:p,actualBoundingBoxRight:g}=this.ctx.measureText(h),v=Math.ceil(s),E=Math.min(this.size-this.buffer,Math.ceil(g-p)),S=Math.min(this.size-this.buffer,v+Math.ceil(c)),k=E+2*this.buffer,A=S+2*this.buffer,D=Math.max(k*A,0),R=new Uint8ClampedArray(D),G={data:R,width:k,height:A,glyphWidth:E,glyphHeight:S,glyphTop:v,glyphLeft:0,glyphAdvance:t};if(E===0||S===0)return G;const{ctx:$,buffer:j,gridInner:ee,gridOuter:re}=this;$.clearRect(j,j,E,S),$.fillText(h,j,j+v);const ce=$.getImageData(j,j,E,S);re.fill(Q,0,D),ee.fill(0,0,D);for(let W=0;W<S;W++)for(let pe=0;pe<E;pe++){const he=ce.data[4*(W*E+pe)+3]/255;if(he===0)continue;const _e=(W+j)*k+pe+j;if(he===1)re[_e]=0,ee[_e]=Q;else{const ve=.5-he;re[_e]=ve>0?ve*ve:0,ee[_e]=ve<0?ve*ve:0}}ae(re,0,0,k,A,k,this.f,this.v,this.z),ae(ee,j,j,E,S,k,this.f,this.v,this.z);for(let W=0;W<D;W++){const pe=Math.sqrt(re[W])-Math.sqrt(ee[W]);R[W]=Math.round(255-255*(pe/this.radius+this.cutoff))}return G}};const Le=new u.Properties({anchor:new u.DataConstantProperty(u.spec.light.anchor),position:new class{constructor(){this.specification=u.spec.light.position}possiblyEvaluate(h,t){return u.sphericalToCartesian(h.expression.evaluate(t))}interpolate(h,t,s){return{x:u.number(h.x,t.x,s),y:u.number(h.y,t.y,s),z:u.number(h.z,t.z,s)}}},color:new u.DataConstantProperty(u.spec.light.color),intensity:new u.DataConstantProperty(u.spec.light.intensity)}),Me="-transition";class Ke extends u.Evented{constructor(t){super(),this._transitionable=new u.Transitionable(Le),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,s={}){if(!this._validate(u.validateLight,t,s))for(const c in t){const p=t[c];c.endsWith(Me)?this._transitionable.setTransition(c.slice(0,-Me.length),p):this._transitionable.setValue(c,p)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,s,c){return(!c||c.validate!==!1)&&u.emitValidationErrors(this,t.call(u.validateStyle,u.extend({value:s,style:{glyphs:!0,sprite:!0},styleSpec:u.spec})))}}class Ct{constructor(t,s){this.width=t,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,s){const c=t.join(",")+String(s);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(t,s)),this.dashEntry[c]}getDashRanges(t,s,c){const p=[];let g=t.length%2==1?-t[t.length-1]*c:0,v=t[0]*c,E=!0;p.push({left:g,right:v,isDash:E,zeroLength:t[0]===0});let S=t[0];for(let k=1;k<t.length;k++){E=!E;const A=t[k];g=S*c,S+=A,v=S*c,p.push({left:g,right:v,isDash:E,zeroLength:A===0})}return p}addRoundDash(t,s,c){const p=s/2;for(let g=-c;g<=c;g++){const v=this.width*(this.nextRow+c+g);let E=0,S=t[E];for(let k=0;k<this.width;k++){k/S.right>1&&(S=t[++E]);const A=Math.abs(k-S.left),D=Math.abs(k-S.right),R=Math.min(A,D);let G;const $=g/c*(p+1);if(S.isDash){const j=p-Math.abs($);G=Math.sqrt(R*R+j*j)}else G=p-Math.sqrt(R*R+$*$);this.data[v+k]=Math.max(0,Math.min(255,G+128))}}}addRegularDash(t){for(let E=t.length-1;E>=0;--E){const S=t[E],k=t[E+1];S.zeroLength?t.splice(E,1):k&&k.isDash===S.isDash&&(k.left=S.left,t.splice(E,1))}const s=t[0],c=t[t.length-1];s.isDash===c.isDash&&(s.left=c.left-this.width,c.right=s.right+this.width);const p=this.width*this.nextRow;let g=0,v=t[g];for(let E=0;E<this.width;E++){E/v.right>1&&(v=t[++g]);const S=Math.abs(E-v.left),k=Math.abs(E-v.right),A=Math.min(S,k);this.data[p+E]=Math.max(0,Math.min(255,(v.isDash?A:-A)+128))}}addDash(t,s){const c=s?7:0,p=2*c+1;if(this.nextRow+p>this.height)return u.warnOnce("LineAtlas out of space"),null;let g=0;for(let E=0;E<t.length;E++)g+=t[E];if(g!==0){const E=this.width/g,S=this.getDashRanges(t,this.width,E);s?this.addRoundDash(S,E,c):this.addRegularDash(S)}const v={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:g};return this.nextRow+=p,this.dirty=!0,v}bind(t){const s=t.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))}}class dt{constructor(t,s){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=u.uniqueId();const c=this.workerPool.acquire(this.id);for(let p=0;p<c.length;p++){const g=new dt.Actor(c[p],s,this.id);g.name=`Worker ${p}`,this.actors.push(g)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,s,c){u.asyncAll(this.actors,(p,g)=>{p.send(t,s,g)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}function cn(h,t,s){const c=function(p,g){if(p)return s(p);if(g){const v=u.pick(u.extend(g,h),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);g.vector_layers&&(v.vectorLayers=g.vector_layers,v.vectorLayerIds=v.vectorLayers.map(E=>E.id)),s(null,v)}};return h.url?u.getJSON(t.transformRequest(h.url,u.ResourceType.Source),c):u.exported.frame(()=>c(null,h))}dt.Actor=u.Actor;class xn{constructor(t,s,c){this.bounds=u.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=s||0,this.maxzoom=c||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const s=Math.pow(2,t.z),c=Math.floor(u.mercatorXfromLng(this.bounds.getWest())*s),p=Math.floor(u.mercatorYfromLat(this.bounds.getNorth())*s),g=Math.ceil(u.mercatorXfromLng(this.bounds.getEast())*s),v=Math.ceil(u.mercatorYfromLat(this.bounds.getSouth())*s);return t.x>=c&&t.x<g&&t.y>=p&&t.y<v}}class an extends u.Evented{constructor(t,s,c,p){if(super(),this.id=t,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.extend(this,u.pick(s,["url","scheme","tileSize","promoteId"])),this._options=u.extend({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p)}load(){this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=cn(this._options,this.map._requestManager,(t,s)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t?this.fire(new u.ErrorEvent(t)):s&&(u.extend(this,s),s.bounds&&(this.tileBounds=new xn(s.bounds,this.minzoom,this.maxzoom)),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return u.extend({},this._options)}loadTile(t,s){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(c,u.ResourceType.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function g(v,E){return delete t.request,t.aborted?s(null):v&&v.status!==404?s(v):(E&&E.resourceTiming&&(t.resourceTiming=E.resourceTiming),this.map._refreshExpiredTiles&&E&&t.setExpiryData(E),t.loadVectorData(E,this.map.painter),u.cacheEntryPossiblyAdded(this.dispatcher),s(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}p.request.collectResourceTiming=this._collectResourceTiming,t.actor&&t.state!=="expired"?t.state==="loading"?t.reloadCallback=s:t.request=t.actor.send("reloadTile",p,g.bind(this)):(t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",p,g.bind(this)))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class ar extends u.Evented{constructor(t,s,c,p){super(),this.id=t,this.dispatcher=c,this.setEventedParent(p),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.extend({type:"raster"},s),u.extend(this,u.pick(s,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=cn(this._options,this.map._requestManager,(t,s)=>{this._tileJSONRequest=null,this._loaded=!0,t?this.fire(new u.ErrorEvent(t)):s&&(u.extend(this,s),s.bounds&&(this.tileBounds=new xn(s.bounds,this.minzoom,this.maxzoom)),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return u.extend({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,s){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.request=u.getImage(this.map._requestManager.transformRequest(c,u.ResourceType.Tile),(p,g,v)=>{if(delete t.request,t.aborted)t.state="unloaded",s(null);else if(p)t.state="errored",s(p);else if(g){this.map._refreshExpiredTiles&&t.setExpiryData(v);const E=this.map.painter.context,S=E.gl;t.texture=this.map.painter.getTileTexture(g.width),t.texture?t.texture.update(g,{useMipmap:!0}):(t.texture=new ke(E,g,S.RGBA,{useMipmap:!0}),t.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST),E.extTextureFilterAnisotropic&&S.texParameterf(S.TEXTURE_2D,E.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,E.extTextureFilterAnisotropicMax)),t.state="loaded",u.cacheEntryPossiblyAdded(this.dispatcher),s(null)}})}abortTile(t,s){t.request&&(t.request.cancel(),delete t.request),s()}unloadTile(t,s){t.texture&&this.map.painter.saveTileTexture(t.texture),s()}hasTransition(){return!1}}let qn;class st extends ar{constructor(t,s,c,p){super(t,s,c,p),this.type="raster-dem",this.maxzoom=22,this._options=u.extend({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(t,s){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function p(g,v){g&&(t.state="errored",s(g)),v&&(t.dem=v,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded",s(null))}t.request=u.getImage(this.map._requestManager.transformRequest(c,u.ResourceType.Tile),function(g,v){if(delete t.request,t.aborted)t.state="unloaded",s(null);else if(g)t.state="errored",s(g);else if(v){this.map._refreshExpiredTiles&&t.setExpiryData(v),delete v.cacheControl,delete v.expires;const E=u.isImageBitmap(v)&&(qn==null&&(qn=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),qn)?v:u.exported.getImageData(v,1),S={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:E,encoding:this.encoding};t.actor&&t.state!=="expired"||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",S,p.bind(this)))}}.bind(this)),t.neighboringTiles=this._getNeighboringTiles(t.tileID)}_getNeighboringTiles(t){const s=t.canonical,c=Math.pow(2,s.z),p=(s.x-1+c)%c,g=s.x===0?t.wrap-1:t.wrap,v=(s.x+1+c)%c,E=s.x+1===c?t.wrap+1:t.wrap,S={};return S[new u.OverscaledTileID(t.overscaledZ,g,s.z,p,s.y).key]={backfilled:!1},S[new u.OverscaledTileID(t.overscaledZ,E,s.z,v,s.y).key]={backfilled:!1},s.y>0&&(S[new u.OverscaledTileID(t.overscaledZ,g,s.z,p,s.y-1).key]={backfilled:!1},S[new u.OverscaledTileID(t.overscaledZ,t.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},S[new u.OverscaledTileID(t.overscaledZ,E,s.z,v,s.y-1).key]={backfilled:!1}),s.y+1<c&&(S[new u.OverscaledTileID(t.overscaledZ,g,s.z,p,s.y+1).key]={backfilled:!1},S[new u.OverscaledTileID(t.overscaledZ,t.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},S[new u.OverscaledTileID(t.overscaledZ,E,s.z,v,s.y+1).key]={backfilled:!1}),S}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})}}class wn extends u.Evented{constructor(t,s,c,p){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(p),this._data=s.data,this._options=u.extend({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const g=u.EXTENT/this.tileSize;this.workerOptions=u.extend({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*g,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*g,extent:u.EXTENT,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:u.EXTENT,radius:(s.clusterRadius||50)*g,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData("content"),this}getClusterExpansionZoom(t,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},s),this}getClusterChildren(t,s){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},s),this}getClusterLeaves(t,s,c,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:s,offset:c},p),this}_updateWorkerData(t){const s=u.extend({},this.workerOptions),c=this._data;typeof c=="string"?(s.request=this.map._requestManager.transformRequest(u.exported.resolveURL(c),u.ResourceType.Source),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(c),this._pendingLoads++,this.fire(new u.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,s,(p,g)=>{if(this._pendingLoads--,this._removed||g&&g.abandoned)return void this.fire(new u.Event("dataabort",{dataType:"source",sourceDataType:t}));let v=null;if(g&&g.resourceTiming&&g.resourceTiming[this.id]&&(v=g.resourceTiming[this.id].slice(0)),p)return void this.fire(new u.ErrorEvent(p));const E={dataType:"source",sourceDataType:t};this._collectResourceTiming&&v&&v.length>0&&u.extend(E,{resourceTiming:v}),this.fire(new u.Event("data",E))})}loaded(){return this._pendingLoads===0}loadTile(t,s){const c=t.actor?"reloadTile":"loadTile";t.actor=this.actor;const p={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.request=this.actor.send(c,p,(g,v)=>(delete t.request,t.unloadVectorData(),t.aborted?s(null):g?s(g):(t.loadVectorData(v,this.map.painter,c==="reloadTile"),s(null))))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return u.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Ze=u.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class ct extends u.Evented{constructor(t,s,c,p){super(),this.id=t,this.dispatcher=c,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(p),this.options=s}load(t,s){this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this.url=this.options.url,u.getImage(this.map._requestManager.transformRequest(this.url,u.ResourceType.Image),(c,p)=>{this._loaded=!0,c?this.fire(new u.ErrorEvent(c)):p&&(this.image=p,t&&(this.coordinates=t),s&&s(),this._finishLoading())})}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}setCoordinates(t){this.coordinates=t;const s=t.map(u.MercatorCoordinate.fromLngLat);this.tileID=function(p){let g=1/0,v=1/0,E=-1/0,S=-1/0;for(const R of p)g=Math.min(g,R.x),v=Math.min(v,R.y),E=Math.max(E,R.x),S=Math.max(S,R.y);const k=Math.max(E-g,S-v),A=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),D=Math.pow(2,A);return new u.CanonicalTileID(A,Math.floor((g+E)/2*D),Math.floor((v+S)/2*D))}(s),this.minzoom=this.maxzoom=this.tileID.z;const c=s.map(p=>this.tileID.getTilePoint(p)._round());return this._boundsArray=new u.RasterBoundsArray,this._boundsArray.emplaceBack(c[0].x,c[0].y,0,0),this._boundsArray.emplaceBack(c[1].x,c[1].y,u.EXTENT,0),this._boundsArray.emplaceBack(c[3].x,c[3].y,0,u.EXTENT),this._boundsArray.emplaceBack(c[2].x,c[2].y,u.EXTENT,u.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,s=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,Ze.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new ke(t,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));for(const c in this.tiles){const p=this.tiles[c];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture)}}loadTile(t,s){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},s(null)):(t.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class at extends ct{constructor(t,s,c,p){super(t,s,c,p),this.roundZoom=!0,this.type="video",this.options=s}load(){this._loaded=!1;const t=this.options;this.urls=[];for(const s of t.urls)this.urls.push(this.map._requestManager.transformRequest(s,u.ResourceType.Source).url);u.getVideo(this.urls,(s,c)=>{this._loaded=!0,s?this.fire(new u.ErrorEvent(s)):c&&(this.video=c,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const s=this.video.seekable;t<s.start(0)||t>s.end(0)?this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,s=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,Ze.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new ke(t,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));for(const c in this.tiles){const p=this.tiles[c];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Tt extends ct{constructor(t,s,c,p){super(t,s,c,p),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(g=>!Array.isArray(g)||g.length!==2||g.some(v=>typeof v!="number"))||this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${t}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${t}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context,c=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,Ze.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ke(s,this.canvas,c.RGBA,{premultiply:!0});for(const p in this.tiles){const g=this.tiles[p];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const Ut={vector:an,raster:ar,"raster-dem":st,geojson:wn,video:at,image:ct,canvas:Tt};function yr(h,t){const s=u.create();return u.translate(s,s,[1,1,0]),u.scale(s,s,[.5*h.width,.5*h.height,1]),u.multiply(s,s,h.calculatePosMatrix(t.toUnwrapped()))}function Rn(h,t,s,c,p,g){const v=function(D,R,G){if(D)for(const $ of D){const j=R[$];if(j&&j.source===G&&j.type==="fill-extrusion")return!0}else for(const $ in R){const j=R[$];if(j.source===G&&j.type==="fill-extrusion")return!0}return!1}(p&&p.layers,t,h.id),E=g.maxPitchScaleFactor(),S=h.tilesIn(c,E,v);S.sort(Wn);const k=[];for(const D of S)k.push({wrappedTileID:D.tileID.wrapped().key,queryResults:D.tile.queryRenderedFeatures(t,s,h._state,D.queryGeometry,D.cameraQueryGeometry,D.scale,p,g,E,yr(h.transform,D.tileID))});const A=function(D){const R={},G={};for(const $ of D){const j=$.queryResults,ee=$.wrappedTileID,re=G[ee]=G[ee]||{};for(const ce in j){const W=j[ce],pe=re[ce]=re[ce]||{},he=R[ce]=R[ce]||[];for(const _e of W)pe[_e.featureIndex]||(pe[_e.featureIndex]=!0,he.push(_e))}}return R}(k);for(const D in A)A[D].forEach(R=>{const G=R.feature,$=h.getFeatureState(G.layer["source-layer"],G.id);G.source=G.layer.source,G.layer["source-layer"]&&(G.sourceLayer=G.layer["source-layer"]),G.state=$});return A}function Wn(h,t){const s=h.tileID,c=t.tileID;return s.overscaledZ-c.overscaledZ||s.canonical.y-c.canonical.y||s.wrap-c.wrap||s.canonical.x-c.canonical.x}class zn{constructor(t,s){this.tileID=t,this.uid=u.uniqueId(),this.uses=0,this.tileSize=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const s=t+this.timeAdded;s<u.exported.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.textures.forEach(s=>t.saveTileTexture(s)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(t,s,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(p,g){const v={};if(!g)return v;for(const E of p){const S=E.layerIds.map(k=>g.getLayer(k)).filter(Boolean);if(S.length!==0){E.layers=S,E.stateDependentLayerIds&&(E.stateDependentLayers=E.stateDependentLayerIds.map(k=>S.filter(A=>A.id===k)[0]));for(const k of S)v[k.id]=E}}return v}(t.buckets,s.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const g=this.buckets[p];if(g instanceof u.SymbolBucket){if(this.hasSymbolBuckets=!0,!c)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const g=this.buckets[p];if(g instanceof u.SymbolBucket&&g.hasRTLText){this.hasRTLText=!0,u.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const p in this.buckets){const g=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(p).queryRadius(g))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new u.CollisionBoxArray}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const c in this.buckets){const p=this.buckets[c];p.uploadPending()&&p.upload(t)}const s=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ke(t,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ke(t,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,s,c,p,g,v,E,S,k,A){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:p,cameraQueryGeometry:g,scale:v,tileSize:this.tileSize,pixelPosMatrix:A,transform:S,params:E,queryPadding:this.queryPadding*k},t,s,c):{}}querySourceFeatures(t,s){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const p=c.loadVTLayers(),g=s?s.sourceLayer:"",v=p._geojsonTileLayer||p[g];if(!v)return;const E=u.createFilter(s&&s.filter),{z:S,x:k,y:A}=this.tileID.canonical,D={z:S,x:k,y:A};for(let R=0;R<v.length;R++){const G=v.feature(R);if(E.needGeometry){const ee=u.toEvaluationFeature(G,!0);if(!E.filter(new u.EvaluationParameters(this.tileID.overscaledZ),ee,this.tileID.canonical))continue}else if(!E.filter(new u.EvaluationParameters(this.tileID.overscaledZ),G))continue;const $=c.getId(G,g),j=new u.GeoJSONFeature(G,S,k,A,$);j.tile=D,t.push(j)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const s=this.expirationTime;if(t.cacheControl){const c=u.parseCacheControl(t.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const c=Date.now();let p=!1;if(this.expirationTime>c)p=!1;else if(s)if(this.expirationTime<s)p=!0;else{const g=this.expirationTime-s;g?this.expirationTime=c+Math.max(g,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const p in this.buckets){if(!s.style.hasLayer(p))continue;const g=this.buckets[p],v=g.layers[0].sourceLayer||"_geojsonTileLayer",E=c[v],S=t[v];if(!E||!S||Object.keys(S).length===0)continue;g.update(S,E,this.imageAtlas&&this.imageAtlas.patternPositions||{});const k=s&&s.style&&s.style.getLayer(p);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<u.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=u.exported.now()+t}setDependencies(t,s){const c={};for(const p of s)c[p]=!0;this.dependencies[t]=c}hasDependency(t,s){for(const c of t){const p=this.dependencies[c];if(p){for(const g of s)if(p[g])return!0}}return!1}}class lr{constructor(t,s){this.max=t,this.onRemove=s,this.reset()}reset(){for(const t in this.data)for(const s of this.data[t])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(t,s,c){const p=t.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const g={value:s,timeout:void 0};if(c!==void 0&&(g.timeout=setTimeout(()=>{this.remove(t,g)},c)),this.data[p].push(g),this.order.push(p),this.order.length>this.max){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const s=this.data[t].shift();return s.timeout&&clearTimeout(s.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),s.value}getByKey(t){const s=this.data[t];return s?s[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,s){if(!this.has(t))return this;const c=t.wrapped().key,p=s===void 0?0:this.data[c].indexOf(s),g=this.data[c][p];return this.data[c].splice(p,1),g.timeout&&clearTimeout(g.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(g.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(t){const s=[];for(const c in this.data)for(const p of this.data[c])t(p.value)||s.push(p);for(const c of s)this.remove(c.value.tileID,c)}}class gi{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,s,c){const p=String(s);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][p]=this.stateChanges[t][p]||{},u.extend(this.stateChanges[t][p],c),this.deletedStates[t]===null){this.deletedStates[t]={};for(const g in this.state[t])g!==p&&(this.deletedStates[t][g]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][p]===null){this.deletedStates[t][p]={};for(const g in this.state[t][p])c[g]||(this.deletedStates[t][p][g]=null)}else for(const g in c)this.deletedStates[t]&&this.deletedStates[t][p]&&this.deletedStates[t][p][g]===null&&delete this.deletedStates[t][p][g]}removeFeatureState(t,s,c){if(this.deletedStates[t]===null)return;const p=String(s);if(this.deletedStates[t]=this.deletedStates[t]||{},c&&s!==void 0)this.deletedStates[t][p]!==null&&(this.deletedStates[t][p]=this.deletedStates[t][p]||{},this.deletedStates[t][p][c]=null);else if(s!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][p])for(c in this.deletedStates[t][p]={},this.stateChanges[t][p])this.deletedStates[t][p][c]=null;else this.deletedStates[t][p]=null;else this.deletedStates[t]=null}getState(t,s){const c=String(s),p=u.extend({},(this.state[t]||{})[c],(this.stateChanges[t]||{})[c]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const g=this.deletedStates[t][s];if(g===null)return{};for(const v in g)delete p[v]}return p}initializeTileState(t,s){t.setFeatureState(this.state,s)}coalesceChanges(t,s){const c={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const g={};for(const v in this.stateChanges[p])this.state[p][v]||(this.state[p][v]={}),u.extend(this.state[p][v],this.stateChanges[p][v]),g[v]=this.state[p][v];c[p]=g}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const g={};if(this.deletedStates[p]===null)for(const v in this.state[p])g[v]={},this.state[p][v]={};else for(const v in this.deletedStates[p]){if(this.deletedStates[p][v]===null)this.state[p][v]={};else for(const E of Object.keys(this.deletedStates[p][v]))delete this.state[p][v][E];g[v]=this.state[p][v]}c[p]=c[p]||{},u.extend(c[p],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const p in t)t[p].setFeatureState(c,s)}}class bn extends u.Evented{constructor(t,s,c){super(),this.id=t,this.dispatcher=c,this.on("data",p=>{p.dataType==="source"&&p.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&p.dataType==="source"&&p.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(p,g,v,E){const S=new Ut[g.type](p,g,v,E);if(S.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${S.id}`);return u.bindAll(["load","abort","unload","serialize","prepare"],S),S}(t,s,c,this),this._tiles={},this._cache=new lr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new gi}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const s=this._tiles[t];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,s){return this._source.loadTile(t,s)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){this._source.abortTile&&this._source.abortTile(t,()=>{}),this._source.fire(new u.Event("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const c=this._tiles[s];c.upload(t),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(qi).map(t=>t.key)}getRenderableIds(t){const s=[];for(const c in this._tiles)this._isIdRenderable(c,t)&&s.push(this._tiles[c]);return t?s.sort((c,p)=>{const g=c.tileID,v=p.tileID,E=new u.pointGeometry(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),S=new u.pointGeometry(v.canonical.x,v.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-v.overscaledZ||S.y-E.y||S.x-E.x}).map(c=>c.tileID.key):s.map(c=>c.tileID).sort(qi).map(c=>c.key)}hasRenderableParent(t){const s=this.findLoadedParent(t,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(t,s){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(s||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(t,"reloading")}}_reloadTile(t,s){const c=this._tiles[t];c&&(c.state!=="loading"&&(c.state=s),this._loadTile(c,this._tileLoaded.bind(this,c,t,s)))}_tileLoaded(t,s,c,p){if(p)return t.state="errored",void(p.status!==404?this._source.fire(new u.ErrorEvent(p,{tile:t})):this.update(this.transform,this.terrain));t.timeAdded=u.exported.now(),c==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(s,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new u.Event("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const s=this.getRenderableIds();for(let p=0;p<s.length;p++){const g=s[p];if(t.neighboringTiles&&t.neighboringTiles[g]){const v=this.getTileByID(g);c(t,v),c(v,t)}}function c(p,g){p.needsHillshadePrepare=!0,p.needsTerrainPrepare=!0;let v=g.tileID.canonical.x-p.tileID.canonical.x;const E=g.tileID.canonical.y-p.tileID.canonical.y,S=Math.pow(2,p.tileID.canonical.z),k=g.tileID.key;v===0&&E===0||Math.abs(E)>1||(Math.abs(v)>1&&(Math.abs(v+S)===1?v+=S:Math.abs(v-S)===1&&(v-=S)),g.dem&&p.dem&&(p.dem.backfillBorder(g.dem,v,E),p.neighboringTiles&&p.neighboringTiles[k]&&(p.neighboringTiles[k].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,s,c,p){for(const g in this._tiles){let v=this._tiles[g];if(p[g]||!v.hasData()||v.tileID.overscaledZ<=s||v.tileID.overscaledZ>c)continue;let E=v.tileID;for(;v&&v.tileID.overscaledZ>s+1;){const k=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[k.key],v&&v.hasData()&&(E=k)}let S=E;for(;S.overscaledZ>s;)if(S=S.scaledTo(S.overscaledZ-1),t[S.key]){p[E.key]=E;break}}}findLoadedParent(t,s){if(t.key in this._loadedParentTiles){const c=this._loadedParentTiles[t.key];return c&&c.tileID.overscaledZ>=s?c:null}for(let c=t.overscaledZ-1;c>=s;c--){const p=t.scaledTo(c),g=this._getLoadedTile(p);if(g)return g}}_getLoadedTile(t){const s=this._tiles[t.key];return s&&s.hasData()?s:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const s=Math.ceil(t.width/this._source.tileSize)+1,c=Math.ceil(t.height/this._source.tileSize)+1,p=Math.floor(s*c*5),g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(g)}handleWrapJump(t){const s=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,s){const c={};for(const p in this._tiles){const g=this._tiles[p];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+s),c[g.tileID.key]=g}this._tiles=c;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(p,this._tiles[p])}}update(t,s){if(this.transform=t,this.terrain=s,!this._sourceLoaded||this._paused)return;let c;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(k=>new u.OverscaledTileID(k.canonical.z,k.wrap,k.canonical.z,k.canonical.x,k.canonical.y)):(c=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:s}),this._source.hasTile&&(c=c.filter(k=>this._source.hasTile(k)))):c=[];const p=t.coveringZoomLevel(this._source),g=Math.max(p-bn.maxOverzooming,this._source.minzoom),v=Math.max(p+bn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const k={};for(const A of c)if(A.canonical.z>this._source.minzoom){const D=A.scaledTo(A.canonical.z-1);k[D.key]=D;const R=A.scaledTo(Math.max(this._source.minzoom,Math.min(A.canonical.z,5)));k[R.key]=R}c=c.concat(Object.values(k))}const E=this._updateRetainedTiles(c,p);if(Xt(this._source.type)){const k={},A={},D=Object.keys(E);for(const R of D){const G=E[R],$=this._tiles[R];if(!$||$.fadeEndTime&&$.fadeEndTime<=u.exported.now())continue;const j=this.findLoadedParent(G,g);j&&(this._addTile(j.tileID),k[j.tileID.key]=j.tileID),A[R]=G}this._retainLoadedChildren(A,p,v,E);for(const R in k)E[R]||(this._coveredTiles[R]=!0,E[R]=k[R]);if(s){const R={},G={};for(const $ of c)this._tiles[$.key].hasData()?R[$.key]=$:G[$.key]=$;for(const $ in G){const j=G[$].children(this._source.maxzoom);this._tiles[j[0].key]&&this._tiles[j[1].key]&&this._tiles[j[2].key]&&this._tiles[j[3].key]&&(R[j[0].key]=E[j[0].key]=j[0],R[j[1].key]=E[j[1].key]=j[1],R[j[2].key]=E[j[2].key]=j[2],R[j[3].key]=E[j[3].key]=j[3],delete G[$])}for(const $ in G){const j=this.findLoadedParent(G[$],this._source.minzoom);if(j){R[j.tileID.key]=E[j.tileID.key]=j.tileID;for(const ee in R)R[ee].isChildOf(j.tileID)&&delete R[ee]}}for(const $ in this._tiles)R[$]||(this._coveredTiles[$]=!0)}}for(const k in E)this._tiles[k].clearFadeHold();const S=u.keysDifference(this._tiles,E);for(const k of S){const A=this._tiles[k];A.hasSymbolBuckets&&!A.holdingForFade()?A.setHoldDuration(this.map._fadeDuration):A.hasSymbolBuckets&&!A.symbolFadeFinished()||this._removeTile(k)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,s){const c={},p={},g=Math.max(s-bn.maxOverzooming,this._source.minzoom),v=Math.max(s+bn.maxUnderzooming,this._source.minzoom),E={};for(const S of t){const k=this._addTile(S);c[S.key]=S,k.hasData()||s<this._source.maxzoom&&(E[S.key]=S)}this._retainLoadedChildren(E,s,v,c);for(const S of t){let k=this._tiles[S.key];if(k.hasData())continue;if(s+1>this._source.maxzoom){const D=S.children(this._source.maxzoom)[0],R=this.getTile(D);if(R&&R.hasData()){c[D.key]=D;continue}}else{const D=S.children(this._source.maxzoom);if(c[D[0].key]&&c[D[1].key]&&c[D[2].key]&&c[D[3].key])continue}let A=k.wasRequested();for(let D=S.overscaledZ-1;D>=g;--D){const R=S.scaledTo(D);if(p[R.key]||(p[R.key]=!0,k=this.getTile(R),!k&&A&&(k=this._addTile(R)),k&&(c[R.key]=R,A=k.wasRequested(),k.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const s=[];let c,p=this._tiles[t].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){c=this._loadedParentTiles[p.key];break}s.push(p.key);const g=p.scaledTo(p.overscaledZ-1);if(c=this._getLoadedTile(g),c)break;p=g}for(const g of s)this._loadedParentTiles[g]=c}}_addTile(t){let s=this._tiles[t.key];if(s)return s;s=this._cache.getAndRemove(t),s&&(this._setTileReloadTimer(t.key,s),s.tileID=t,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,s)));const c=s;return s||(s=new zn(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(s,this._tileLoaded.bind(this,s,t.key,s.state))),s.uses++,this._tiles[t.key]=s,c||this._source.fire(new u.Event("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s}_setTileReloadTimer(t,s){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const c=s.getExpiryTimeout();c&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},c))}_removeTile(t){const s=this._tiles[t];s&&(s.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,s,c){const p=[],g=this.transform;if(!g)return p;const v=c?g.getCameraQueryGeometry(t):t,E=t.map($=>g.pointCoordinate($,this.terrain)),S=v.map($=>g.pointCoordinate($,this.terrain)),k=this.getIds();let A=1/0,D=1/0,R=-1/0,G=-1/0;for(const $ of S)A=Math.min(A,$.x),D=Math.min(D,$.y),R=Math.max(R,$.x),G=Math.max(G,$.y);for(let $=0;$<k.length;$++){const j=this._tiles[k[$]];if(j.holdingForFade())continue;const ee=j.tileID,re=Math.pow(2,g.zoom-j.tileID.overscaledZ),ce=s*j.queryPadding*u.EXTENT/j.tileSize/re,W=[ee.getTilePoint(new u.MercatorCoordinate(A,D)),ee.getTilePoint(new u.MercatorCoordinate(R,G))];if(W[0].x-ce<u.EXTENT&&W[0].y-ce<u.EXTENT&&W[1].x+ce>=0&&W[1].y+ce>=0){const pe=E.map(_e=>ee.getTilePoint(_e)),he=S.map(_e=>ee.getTilePoint(_e));p.push({tile:j,tileID:ee,queryGeometry:pe,cameraQueryGeometry:he,scale:re})}}return p}getVisibleCoordinates(t){const s=this.getRenderableIds(t).map(c=>this._tiles[c].tileID);for(const c of s)c.posMatrix=this.transform.calculatePosMatrix(c.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(Xt(this._source.type))for(const t in this._tiles){const s=this._tiles[t];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=u.exported.now())return!0}return!1}setFeatureState(t,s,c){this._state.updateState(t=t||"_geojsonTileLayer",s,c)}removeFeatureState(t,s,c){this._state.removeFeatureState(t=t||"_geojsonTileLayer",s,c)}getFeatureState(t,s){return this._state.getState(t=t||"_geojsonTileLayer",s)}setDependencies(t,s,c){const p=this._tiles[t];p&&p.setDependencies(s,c)}reloadTilesForDependencies(t,s){for(const c in this._tiles)this._tiles[c].hasDependency(t,s)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(t,s))}}function qi(h,t){const s=Math.abs(2*h.wrap)-+(h.wrap<0),c=Math.abs(2*t.wrap)-+(t.wrap<0);return h.overscaledZ-t.overscaledZ||c-s||t.canonical.y-h.canonical.y||t.canonical.x-h.canonical.x}function Xt(h){return h==="raster"||h==="image"||h==="video"}bn.maxOverzooming=10,bn.maxUnderzooming=3;const jt="mapboxgl_preloaded_worker_pool";class Pt{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Pt.workerCount;)this.workers.push(new Worker(vo.workerUrl));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[jt]}numActive(){return Object.keys(this.active).length}}const En=Math.floor(u.exported.hardwareConcurrency/2);let Gt;function ur(){return Gt||(Gt=new Pt),Gt}function Qn(h,t){const s={};for(const c in h)c!=="ref"&&(s[c]=h[c]);return u.refProperties.forEach(c=>{c in t&&(s[c]=t[c])}),s}function ei(h){h=h.slice();const t=Object.create(null);for(let s=0;s<h.length;s++)t[h[s].id]=h[s];for(let s=0;s<h.length;s++)"ref"in h[s]&&(h[s]=Qn(h[s],t[h[s].ref]));return h}Pt.workerCount=Math.max(Math.min(En,6),1);const wt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Cr(h,t,s){s.push({command:wt.addSource,args:[h,t[h]]})}function ti(h,t,s){t.push({command:wt.removeSource,args:[h]}),s[h]=!0}function ni(h,t,s,c){ti(h,s,c),Cr(h,t,s)}function Bn(h,t,s){let c;for(c in h[s])if(Object.prototype.hasOwnProperty.call(h[s],c)&&c!=="data"&&!oe(h[s][c],t[s][c]))return!1;for(c in t[s])if(Object.prototype.hasOwnProperty.call(t[s],c)&&c!=="data"&&!oe(h[s][c],t[s][c]))return!1;return!0}function An(h,t,s,c,p,g){let v;for(v in t=t||{},h=h||{})Object.prototype.hasOwnProperty.call(h,v)&&(oe(h[v],t[v])||s.push({command:g,args:[c,v,t[v],p]}));for(v in t)Object.prototype.hasOwnProperty.call(t,v)&&!Object.prototype.hasOwnProperty.call(h,v)&&(oe(h[v],t[v])||s.push({command:g,args:[c,v,t[v],p]}))}function Ir(h){return h.id}function Wi(h,t){return h[t.id]=t,h}class zr{constructor(t,s){this.reset(t,s)}reset(t,s){this.points=t||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=u.clamp(t,0,1);let s=1,c=this._distances[s];const p=t*this.paddedLength+this.padding;for(;c<p&&s<this._distances.length;)c=this._distances[++s];const g=s-1,v=this._distances[g],E=c-v,S=E>0?(p-v)/E:0;return this.points[g].mult(1-S).add(this.points[s].mult(S))}}function xe(h,t){let s=!0;return h==="always"||h!=="never"&&t!=="never"||(s=!1),s}class Oe{constructor(t,s,c){const p=this.boxCells=[],g=this.circleCells=[];this.xCellCount=Math.ceil(t/c),this.yCellCount=Math.ceil(s/c);for(let v=0;v<this.xCellCount*this.yCellCount;v++)p.push([]),g.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=s,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,s,c,p,g){this._forEachCell(s,c,p,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(g)}insertCircle(t,s,c,p){this._forEachCell(s-p,c-p,s+p,c+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(s),this.circles.push(c),this.circles.push(p)}_insertBoxCell(t,s,c,p,g,v){this.boxCells[g].push(v)}_insertCircleCell(t,s,c,p,g,v){this.circleCells[g].push(v)}_query(t,s,c,p,g,v,E){if(c<0||t>this.width||p<0||s>this.height)return[];const S=[];if(t<=0&&s<=0&&this.width<=c&&this.height<=p){if(g)return[{key:null,x1:t,y1:s,x2:c,y2:p}];for(let k=0;k<this.boxKeys.length;k++)S.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const A=this.circles[3*k],D=this.circles[3*k+1],R=this.circles[3*k+2];S.push({key:this.circleKeys[k],x1:A-R,y1:D-R,x2:A+R,y2:D+R})}}else this._forEachCell(t,s,c,p,this._queryCell,S,{hitTest:g,overlapMode:v,seenUids:{box:{},circle:{}}},E);return S}query(t,s,c,p){return this._query(t,s,c,p,!1,null)}hitTest(t,s,c,p,g,v){return this._query(t,s,c,p,!0,g,v).length>0}hitTestCircle(t,s,c,p,g){const v=t-c,E=t+c,S=s-c,k=s+c;if(E<0||v>this.width||k<0||S>this.height)return!1;const A=[];return this._forEachCell(v,S,E,k,this._queryCellCircle,A,{hitTest:!0,overlapMode:p,circle:{x:t,y:s,radius:c},seenUids:{box:{},circle:{}}},g),A.length>0}_queryCell(t,s,c,p,g,v,E,S){const{seenUids:k,hitTest:A,overlapMode:D}=E,R=this.boxCells[g];if(R!==null){const $=this.bboxes;for(const j of R)if(!k.box[j]){k.box[j]=!0;const ee=4*j,re=this.boxKeys[j];if(t<=$[ee+2]&&s<=$[ee+3]&&c>=$[ee+0]&&p>=$[ee+1]&&(!S||S(re))&&(!A||!xe(D,re.overlapMode))&&(v.push({key:re,x1:$[ee],y1:$[ee+1],x2:$[ee+2],y2:$[ee+3]}),A))return!0}}const G=this.circleCells[g];if(G!==null){const $=this.circles;for(const j of G)if(!k.circle[j]){k.circle[j]=!0;const ee=3*j,re=this.circleKeys[j];if(this._circleAndRectCollide($[ee],$[ee+1],$[ee+2],t,s,c,p)&&(!S||S(re))&&(!A||!xe(D,re.overlapMode))){const ce=$[ee],W=$[ee+1],pe=$[ee+2];if(v.push({key:re,x1:ce-pe,y1:W-pe,x2:ce+pe,y2:W+pe}),A)return!0}}}return!1}_queryCellCircle(t,s,c,p,g,v,E,S){const{circle:k,seenUids:A,overlapMode:D}=E,R=this.boxCells[g];if(R!==null){const $=this.bboxes;for(const j of R)if(!A.box[j]){A.box[j]=!0;const ee=4*j,re=this.boxKeys[j];if(this._circleAndRectCollide(k.x,k.y,k.radius,$[ee+0],$[ee+1],$[ee+2],$[ee+3])&&(!S||S(re))&&!xe(D,re.overlapMode))return v.push(!0),!0}}const G=this.circleCells[g];if(G!==null){const $=this.circles;for(const j of G)if(!A.circle[j]){A.circle[j]=!0;const ee=3*j,re=this.circleKeys[j];if(this._circlesCollide($[ee],$[ee+1],$[ee+2],k.x,k.y,k.radius)&&(!S||S(re))&&!xe(D,re.overlapMode))return v.push(!0),!0}}}_forEachCell(t,s,c,p,g,v,E,S){const k=this._convertToXCellCoord(t),A=this._convertToYCellCoord(s),D=this._convertToXCellCoord(c),R=this._convertToYCellCoord(p);for(let G=k;G<=D;G++)for(let $=A;$<=R;$++)if(g.call(this,t,s,c,p,this.xCellCount*$+G,v,E,S))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,s,c,p,g,v){const E=p-t,S=g-s,k=c+v;return k*k>E*E+S*S}_circleAndRectCollide(t,s,c,p,g,v,E){const S=(v-p)/2,k=Math.abs(t-(p+S));if(k>S+c)return!1;const A=(E-g)/2,D=Math.abs(s-(g+A));if(D>A+c)return!1;if(k<=S||D<=A)return!0;const R=k-S,G=D-A;return R*R+G*G<=c*c}}function co(h,t,s,c,p){const g=u.create();return t?(u.scale(g,g,[1/p,1/p,1]),s||u.rotateZ(g,g,c.angle)):u.multiply(g,c.labelPlaneMatrix,h),g}function ri(h,t,s,c,p){if(t){const g=u.clone(h);return u.scale(g,g,[p,p,1]),s||u.rotateZ(g,g,-c.angle),g}return c.glCoordMatrix}function It(h,t,s){let c;s?(c=[h.x,h.y,s(h.x,h.y),1],u.transformMat4(c,c,t)):(c=[h.x,h.y,0,1],Ai(c,c,t));const p=c[3];return{point:new u.pointGeometry(c[0]/p,c[1]/p),signedDistanceFromCamera:p}}function Gr(h,t){return .5+h/t*.5}function Ar(h,t){const s=h[0]/h[3],c=h[1]/h[3];return s>=-t[0]&&s<=t[0]&&c>=-t[1]&&c<=t[1]}function Mr(h,t,s,c,p,g,v,E,S,k){const A=c?h.textSizeData:h.iconSizeData,D=u.evaluateSizeForZoom(A,s.transform.zoom),R=[256/s.width*2+1,256/s.height*2+1],G=c?h.text.dynamicLayoutVertexArray:h.icon.dynamicLayoutVertexArray;G.clear();const $=h.lineVertexArray,j=c?h.text.placedSymbolArray:h.icon.placedSymbolArray,ee=s.transform.width/s.transform.height;let re=!1;for(let ce=0;ce<j.length;ce++){const W=j.get(ce);if(W.hidden||W.writingMode===u.WritingMode.vertical&&!re){ft(W.numGlyphs,G);continue}let pe;if(re=!1,k?(pe=[W.anchorX,W.anchorY,k(W.anchorX,W.anchorY),1],u.transformMat4(pe,pe,t)):(pe=[W.anchorX,W.anchorY,0,1],Ai(pe,pe,t)),!Ar(pe,R)){ft(W.numGlyphs,G);continue}const he=Gr(s.transform.cameraToCenterDistance,pe[3]),_e=u.evaluateSizeForFeature(A,D,W),ve=v?_e/he:_e*he,Te=new u.pointGeometry(W.anchorX,W.anchorY),ye=It(Te,p,k).point,Ge={},Be=yt(W,ve,!1,E,t,p,g,h.glyphOffsetArray,$,G,ye,Te,Ge,ee,S,k);re=Be.useVertical,(Be.notEnoughRoom||re||Be.needsFlipping&&yt(W,ve,!0,E,t,p,g,h.glyphOffsetArray,$,G,ye,Te,Ge,ee,S,k).notEnoughRoom)&&ft(W.numGlyphs,G)}c?h.text.dynamicLayoutVertexBuffer.updateData(G):h.icon.dynamicLayoutVertexBuffer.updateData(G)}function Xi(h,t,s,c,p,g,v,E,S,k,A,D,R){const G=E.glyphStartIndex+E.numGlyphs,$=E.lineStartIndex,j=E.lineStartIndex+E.lineLength,ee=t.getoffsetX(E.glyphStartIndex),re=t.getoffsetX(G-1),ce=Xn(h*ee,s,c,p,g,v,E.segment,$,j,S,k,A,D,R);if(!ce)return null;const W=Xn(h*re,s,c,p,g,v,E.segment,$,j,S,k,A,D,R);return W?{first:ce,last:W}:null}function Re(h,t,s,c){return h===u.WritingMode.horizontal&&Math.abs(s.y-t.y)>Math.abs(s.x-t.x)*c?{useVertical:!0}:(h===u.WritingMode.vertical?t.y<s.y:t.x>s.x)?{needsFlipping:!0}:null}function yt(h,t,s,c,p,g,v,E,S,k,A,D,R,G,$,j){const ee=t/24,re=h.lineOffsetX*ee,ce=h.lineOffsetY*ee;let W;if(h.numGlyphs>1){const pe=h.glyphStartIndex+h.numGlyphs,he=h.lineStartIndex,_e=h.lineStartIndex+h.lineLength,ve=Xi(ee,E,re,ce,s,A,D,h,S,g,R,$,j);if(!ve)return{notEnoughRoom:!0};const Te=It(ve.first.point,v,j).point,ye=It(ve.last.point,v,j).point;if(c&&!s){const Ge=Re(h.writingMode,Te,ye,G);if(Ge)return Ge}W=[ve.first];for(let Ge=h.glyphStartIndex+1;Ge<pe-1;Ge++)W.push(Xn(ee*E.getoffsetX(Ge),re,ce,s,A,D,h.segment,he,_e,S,g,R,$,j));W.push(ve.last)}else{if(c&&!s){const he=It(D,p,j).point,_e=h.lineStartIndex+h.segment+1,ve=new u.pointGeometry(S.getx(_e),S.gety(_e)),Te=It(ve,p,j),ye=Te.signedDistanceFromCamera>0?Te.point:mt(D,ve,he,1,p,j),Ge=Re(h.writingMode,he,ye,G);if(Ge)return Ge}const pe=Xn(ee*E.getoffsetX(h.glyphStartIndex),re,ce,s,A,D,h.segment,h.lineStartIndex,h.lineStartIndex+h.lineLength,S,g,R,$,j);if(!pe)return{notEnoughRoom:!0};W=[pe]}for(const pe of W)u.addDynamicAttributes(k,pe.point,pe.angle);return{}}function mt(h,t,s,c,p,g){const v=It(h.add(h.sub(t)._unit()),p,g).point,E=s.sub(v);return s.add(E._mult(c/E.mag()))}function Xn(h,t,s,c,p,g,v,E,S,k,A,D,R,G){const $=c?h-t:h+t;let j=$>0?1:-1,ee=0;c&&(j*=-1,ee=Math.PI),j<0&&(ee+=Math.PI);let re=j>0?E+v:E+v+1,ce=p,W=p,pe=0,he=0;const _e=Math.abs($),ve=[];for(;pe+he<=_e;){if(re+=j,re<E||re>=S)return null;if(W=ce,ve.push(ce),ce=D[re],ce===void 0){const qe=new u.pointGeometry(k.getx(re),k.gety(re)),gt=It(qe,A,G);if(gt.signedDistanceFromCamera>0)ce=D[re]=gt.point;else{const vt=re-j;ce=mt(pe===0?g:new u.pointGeometry(k.getx(vt),k.gety(vt)),qe,W,_e-pe+1,A,G)}}pe+=he,he=W.dist(ce)}const Te=(_e-pe)/he,ye=ce.sub(W),Ge=ye.mult(Te)._add(W);Ge._add(ye._unit()._perp()._mult(s*j));const Be=ee+Math.atan2(ce.y-W.y,ce.x-W.x);return ve.push(Ge),{point:Ge,angle:R?Be:0,path:ve}}const Hi=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ft(h,t){for(let s=0;s<h;s++){const c=t.length;t.resize(c+4),t.float32.set(Hi,3*c)}}function Ai(h,t,s){const c=t[0],p=t[1];return h[0]=s[0]*c+s[4]*p+s[12],h[1]=s[1]*c+s[5]*p+s[13],h[3]=s[3]*c+s[7]*p+s[15],h}const Fn=100;class Vo{constructor(t,s=new Oe(t.width+200,t.height+200,25),c=new Oe(t.width+200,t.height+200,25)){this.transform=t,this.grid=s,this.ignoredGrid=c,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Fn,this.screenBottomBoundary=t.height+Fn,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,s,c,p,g,v){const E=this.projectAndGetPerspectiveRatio(p,t.anchorPointX,t.anchorPointY,v),S=c*E.perspectiveRatio,k=t.x1*S+E.point.x,A=t.y1*S+E.point.y,D=t.x2*S+E.point.x,R=t.y2*S+E.point.y;return!this.isInsideGrid(k,A,D,R)||s!=="always"&&this.grid.hitTest(k,A,D,R,s,g)||E.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[k,A,D,R],offscreen:this.isOffscreen(k,A,D,R)}}placeCollisionCircles(t,s,c,p,g,v,E,S,k,A,D,R,G,$){const j=[],ee=new u.pointGeometry(s.anchorX,s.anchorY),re=It(ee,v,$),ce=Gr(this.transform.cameraToCenterDistance,re.signedDistanceFromCamera),W=(A?g/ce:g*ce)/u.ONE_EM,pe=It(ee,E,$).point,he=Xi(W,p,s.lineOffsetX*W,s.lineOffsetY*W,!1,pe,ee,s,c,E,{},!1,$);let _e=!1,ve=!1,Te=!0;if(he){const ye=.5*R*ce+G,Ge=new u.pointGeometry(-100,-100),Be=new u.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),qe=new zr,gt=he.first,vt=he.last;let it=[];for(let kt=gt.path.length-1;kt>=1;kt--)it.push(gt.path[kt]);for(let kt=1;kt<vt.path.length;kt++)it.push(vt.path[kt]);const Ft=2.5*ye;if(S){const kt=it.map(Mt=>It(Mt,S,$));it=kt.some(Mt=>Mt.signedDistanceFromCamera<=0)?[]:kt.map(Mt=>Mt.point)}let Ot=[];if(it.length>0){const kt=it[0].clone(),Mt=it[0].clone();for(let $t=1;$t<it.length;$t++)kt.x=Math.min(kt.x,it[$t].x),kt.y=Math.min(kt.y,it[$t].y),Mt.x=Math.max(Mt.x,it[$t].x),Mt.y=Math.max(Mt.y,it[$t].y);Ot=kt.x>=Ge.x&&Mt.x<=Be.x&&kt.y>=Ge.y&&Mt.y<=Be.y?[it]:Mt.x<Ge.x||kt.x>Be.x||Mt.y<Ge.y||kt.y>Be.y?[]:u.clipLine([it],Ge.x,Ge.y,Be.x,Be.y)}for(const kt of Ot){qe.reset(kt,.25*ye);let Mt=0;Mt=qe.length<=.5*ye?1:Math.ceil(qe.paddedLength/Ft)+1;for(let $t=0;$t<Mt;$t++){const Nn=$t/Math.max(Mt-1,1),xi=qe.lerp(Nn),oi=xi.x+Fn,wi=xi.y+Fn;j.push(oi,wi,ye,0);const no=oi-ye,qr=wi-ye,vr=oi+ye,Di=wi+ye;if(Te=Te&&this.isOffscreen(no,qr,vr,Di),ve=ve||this.isInsideGrid(no,qr,vr,Di),t!=="always"&&this.grid.hitTestCircle(oi,wi,ye,t,D)&&(_e=!0,!k))return{circles:[],offscreen:!1,collisionDetected:_e}}}}return{circles:!k&&_e||!ve||ce<this.perspectiveRatioCutoff?[]:j,offscreen:Te,collisionDetected:_e}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let c=1/0,p=1/0,g=-1/0,v=-1/0;for(const A of t){const D=new u.pointGeometry(A.x+Fn,A.y+Fn);c=Math.min(c,D.x),p=Math.min(p,D.y),g=Math.max(g,D.x),v=Math.max(v,D.y),s.push(D)}const E=this.grid.query(c,p,g,v).concat(this.ignoredGrid.query(c,p,g,v)),S={},k={};for(const A of E){const D=A.key;if(S[D.bucketInstanceId]===void 0&&(S[D.bucketInstanceId]={}),S[D.bucketInstanceId][D.featureIndex])continue;const R=[new u.pointGeometry(A.x1,A.y1),new u.pointGeometry(A.x2,A.y1),new u.pointGeometry(A.x2,A.y2),new u.pointGeometry(A.x1,A.y2)];u.polygonIntersectsPolygon(s,R)&&(S[D.bucketInstanceId][D.featureIndex]=!0,k[D.bucketInstanceId]===void 0&&(k[D.bucketInstanceId]=[]),k[D.bucketInstanceId].push(D.featureIndex))}return k}insertCollisionBox(t,s,c,p,g,v){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:g,collisionGroupID:v,overlapMode:s},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,s,c,p,g,v){const E=c?this.ignoredGrid:this.grid,S={bucketInstanceId:p,featureIndex:g,collisionGroupID:v,overlapMode:s};for(let k=0;k<t.length;k+=4)E.insertCircle(S,t[k],t[k+1],t[k+2])}projectAndGetPerspectiveRatio(t,s,c,p){let g;return p?(g=[s,c,p(s,c),1],u.transformMat4(g,g,t)):(g=[s,c,0,1],Ai(g,g,t)),{point:new u.pointGeometry((g[0]/g[3]+1)/2*this.transform.width+Fn,(-g[1]/g[3]+1)/2*this.transform.height+Fn),perspectiveRatio:.5+this.transform.cameraToCenterDistance/g[3]*.5}}isOffscreen(t,s,c,p){return c<Fn||t>=this.screenRightBoundary||p<Fn||s>this.screenBottomBoundary}isInsideGrid(t,s,c,p){return c>=0&&t<this.gridRightBoundary&&p>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const t=u.identity([]);return u.translate(t,t,[-100,-100,0]),t}}function Sn(h,t,s){return t*(u.EXTENT/(h.tileSize*Math.pow(2,s-h.tileID.overscaledZ)))}class cr{constructor(t,s,c,p){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?s:-s))):p&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class Vt{constructor(t,s,c,p,g){this.text=new cr(t?t.text:null,s,c,g),this.icon=new cr(t?t.icon:null,s,p,g)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class $o{constructor(t,s,c){this.text=t,this.icon=s,this.skipFade=c}}class yi{constructor(){this.invProjMatrix=u.create(),this.viewportMatrix=u.create(),this.circles=[]}}class ho{constructor(t,s,c,p,g){this.bucketInstanceId=t,this.featureIndex=s,this.sourceLayerIndex=c,this.bucketIndex=p,this.tileID=g}}class po{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const s=++this.maxGroupID;this.collisionGroups[t]={ID:s,predicate:c=>c.collisionGroupID===s}}return this.collisionGroups[t]}}function jo(h,t,s,c,p){const{horizontalAlign:g,verticalAlign:v}=u.getAnchorAlignment(h),E=-(g-.5)*t,S=-(v-.5)*s,k=u.evaluateVariableOffset(h,c);return new u.pointGeometry(E+k[0]*p,S+k[1]*p)}function fo(h,t,s,c,p,g){const{x1:v,x2:E,y1:S,y2:k,anchorPointX:A,anchorPointY:D}=h,R=new u.pointGeometry(t,s);return c&&R._rotate(p?g:-g),{x1:v+R.x,y1:S+R.y,x2:E+R.x,y2:k+R.y,anchorPointX:A,anchorPointY:D}}class V{constructor(t,s,c,p,g){this.transform=t.clone(),this.terrain=s,this.collisionIndex=new Vo(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new po(p),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,s,c,p){const g=c.getBucket(s),v=c.latestFeatureIndex;if(!g||!v||s.id!==g.layerIds[0])return;const E=c.collisionBoxArray,S=g.layers[0].layout,k=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),A=c.tileSize/u.EXTENT,D=this.transform.calculatePosMatrix(c.tileID.toUnwrapped()),R=S.get("text-pitch-alignment")==="map",G=S.get("text-rotation-alignment")==="map",$=Sn(c,1,this.transform.zoom),j=co(D,R,G,this.transform,$);let ee=null;if(R){const ce=ri(D,R,G,this.transform,$);ee=u.multiply([],this.transform.labelPlaneMatrix,ce)}this.retainedQueryData[g.bucketInstanceId]=new ho(g.bucketInstanceId,v,g.sourceLayerIndex,g.index,c.tileID);const re={bucket:g,layout:S,posMatrix:D,textLabelPlaneMatrix:j,labelToScreenMatrix:ee,scale:k,textPixelRatio:A,holdingForFade:c.holdingForFade(),collisionBoxArray:E,partiallyEvaluatedTextSize:u.evaluateSizeForZoom(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(p)for(const ce of g.sortKeyRanges){const{sortKey:W,symbolInstanceStart:pe,symbolInstanceEnd:he}=ce;t.push({sortKey:W,symbolInstanceStart:pe,symbolInstanceEnd:he,parameters:re})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:re})}attemptAnchorPlacement(t,s,c,p,g,v,E,S,k,A,D,R,G,$,j,ee){const re=[R.textOffset0,R.textOffset1],ce=jo(t,c,p,re,g),W=this.collisionIndex.placeCollisionBox(fo(s,ce.x,ce.y,v,E,this.transform.angle),D,S,k,A.predicate,ee);if((!j||this.collisionIndex.placeCollisionBox(fo(j,ce.x,ce.y,v,E,this.transform.angle),D,S,k,A.predicate,ee).box.length!==0)&&W.box.length>0){let pe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[R.crossTileID]&&this.prevPlacement.placements[R.crossTileID]&&this.prevPlacement.placements[R.crossTileID].text&&(pe=this.prevPlacement.variableOffsets[R.crossTileID].anchor),R.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[R.crossTileID]={textOffset:re,width:c,height:p,anchor:t,textBoxScale:g,prevAnchor:pe},this.markUsedJustification(G,t,R,$),G.allowVerticalPlacement&&(this.markUsedOrientation(G,$,R),this.placedOrientations[R.crossTileID]=$),{shift:ce,placedGlyphBoxes:W}}}placeLayerBucketPart(t,s,c){const{bucket:p,layout:g,posMatrix:v,textLabelPlaneMatrix:E,labelToScreenMatrix:S,textPixelRatio:k,holdingForFade:A,collisionBoxArray:D,partiallyEvaluatedTextSize:R,collisionGroup:G}=t.parameters,$=g.get("text-optional"),j=g.get("icon-optional"),ee=u.getOverlapMode(g,"text-overlap","text-allow-overlap"),re=ee==="always",ce=u.getOverlapMode(g,"icon-overlap","icon-allow-overlap"),W=ce==="always",pe=g.get("text-rotation-alignment")==="map",he=g.get("text-pitch-alignment")==="map",_e=g.get("icon-text-fit")!=="none",ve=g.get("symbol-z-order")==="viewport-y",Te=re&&(W||!p.hasIconData()||j),ye=W&&(re||!p.hasTextData()||$);!p.collisionArrays&&D&&p.deserializeCollisionBoxes(D);const Ge=(Be,qe)=>{if(s[Be.crossTileID])return;if(A)return void(this.placements[Be.crossTileID]=new $o(!1,!1,!1));let gt=!1,vt=!1,it=!0,Ft=null,Ot={box:null,offscreen:null},kt={box:null,offscreen:null},Mt=null,$t=null,Nn=null,xi=0,oi=0,wi=0;qe.textFeatureIndex?xi=qe.textFeatureIndex:Be.useRuntimeCollisionCircles&&(xi=Be.featureIndex),qe.verticalTextFeatureIndex&&(oi=qe.verticalTextFeatureIndex);const no=this.retainedQueryData[p.bucketInstanceId].tileID,qr=this.terrain?(Mn,bt)=>this.terrain.getElevation(no,Mn,bt):null;for(const Mn of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const bt=qe[Mn];bt&&(bt.elevation=qr?qr(bt.anchorPointX,bt.anchorPointY):0)}const vr=qe.textBox;if(vr){const Mn=Bt=>{let Un=u.WritingMode.horizontal;if(p.allowVerticalPlacement&&!Bt&&this.prevPlacement){const Vn=this.prevPlacement.placedOrientations[Be.crossTileID];Vn&&(this.placedOrientations[Be.crossTileID]=Vn,Un=Vn,this.markUsedOrientation(p,Un,Be))}return Un},bt=(Bt,Un)=>{if(p.allowVerticalPlacement&&Be.numVerticalGlyphVertices>0&&qe.verticalTextBox){for(const Vn of p.writingModes)if(Vn===u.WritingMode.vertical?(Ot=Un(),kt=Ot):Ot=Bt(),Ot&&Ot.box&&Ot.box.length)break}else Ot=Bt()};if(g.get("text-variable-anchor")){let Bt=g.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Be.crossTileID]){const rn=this.prevPlacement.variableOffsets[Be.crossTileID];Bt.indexOf(rn.anchor)>0&&(Bt=Bt.filter(Wr=>Wr!==rn.anchor),Bt.unshift(rn.anchor))}const Un=(rn,Wr,xo)=>{const su=rn.x2-rn.x1,ns=rn.y2-rn.y1,sh=Be.textBoxScale,au=_e&&ce==="never"?Wr:null;let ro={box:[],offscreen:!1};const wo=ee!=="never"?2*Bt.length:Bt.length;for(let bo=0;bo<wo;++bo){const Va=this.attemptAnchorPlacement(Bt[bo%Bt.length],rn,su,ns,sh,pe,he,k,v,G,bo>=Bt.length?ee:"never",Be,p,xo,au,qr);if(Va&&(ro=Va.placedGlyphBoxes,ro&&ro.box&&ro.box.length)){gt=!0,Ft=Va.shift;break}}return ro};bt(()=>Un(vr,qe.iconBox,u.WritingMode.horizontal),()=>{const rn=qe.verticalTextBox;return p.allowVerticalPlacement&&!(Ot&&Ot.box&&Ot.box.length)&&Be.numVerticalGlyphVertices>0&&rn?Un(rn,qe.verticalIconBox,u.WritingMode.vertical):{box:null,offscreen:null}}),Ot&&(gt=Ot.box,it=Ot.offscreen);const Vn=Mn(Ot&&Ot.box);if(!gt&&this.prevPlacement){const rn=this.prevPlacement.variableOffsets[Be.crossTileID];rn&&(this.variableOffsets[Be.crossTileID]=rn,this.markUsedJustification(p,rn.anchor,Be,Vn))}}else{const Bt=(Un,Vn)=>{const rn=this.collisionIndex.placeCollisionBox(Un,ee,k,v,G.predicate,qr);return rn&&rn.box&&rn.box.length&&(this.markUsedOrientation(p,Vn,Be),this.placedOrientations[Be.crossTileID]=Vn),rn};bt(()=>Bt(vr,u.WritingMode.horizontal),()=>{const Un=qe.verticalTextBox;return p.allowVerticalPlacement&&Be.numVerticalGlyphVertices>0&&Un?Bt(Un,u.WritingMode.vertical):{box:null,offscreen:null}}),Mn(Ot&&Ot.box&&Ot.box.length)}}if(Mt=Ot,gt=Mt&&Mt.box&&Mt.box.length>0,it=Mt&&Mt.offscreen,Be.useRuntimeCollisionCircles){const Mn=p.text.placedSymbolArray.get(Be.centerJustifiedTextSymbolIndex),bt=u.evaluateSizeForFeature(p.textSizeData,R,Mn),Bt=g.get("text-padding");$t=this.collisionIndex.placeCollisionCircles(ee,Mn,p.lineVertexArray,p.glyphOffsetArray,bt,v,E,S,c,he,G.predicate,Be.collisionCircleDiameter,Bt,qr),$t.circles.length&&$t.collisionDetected&&!c&&u.warnOnce("Collisions detected, but collision boxes are not shown"),gt=re||$t.circles.length>0&&!$t.collisionDetected,it=it&&$t.offscreen}if(qe.iconFeatureIndex&&(wi=qe.iconFeatureIndex),qe.iconBox){const Mn=bt=>{const Bt=_e&&Ft?fo(bt,Ft.x,Ft.y,pe,he,this.transform.angle):bt;return this.collisionIndex.placeCollisionBox(Bt,ce,k,v,G.predicate,qr)};kt&&kt.box&&kt.box.length&&qe.verticalIconBox?(Nn=Mn(qe.verticalIconBox),vt=Nn.box.length>0):(Nn=Mn(qe.iconBox),vt=Nn.box.length>0),it=it&&Nn.offscreen}const Di=$||Be.numHorizontalGlyphVertices===0&&Be.numVerticalGlyphVertices===0,Ua=j||Be.numIconVertices===0;if(Di||Ua?Ua?Di||(vt=vt&&gt):gt=vt&&gt:vt=gt=vt&&gt,gt&&Mt&&Mt.box&&this.collisionIndex.insertCollisionBox(Mt.box,ee,g.get("text-ignore-placement"),p.bucketInstanceId,kt&&kt.box&&oi?oi:xi,G.ID),vt&&Nn&&this.collisionIndex.insertCollisionBox(Nn.box,ce,g.get("icon-ignore-placement"),p.bucketInstanceId,wi,G.ID),$t&&(gt&&this.collisionIndex.insertCollisionCircles($t.circles,ee,g.get("text-ignore-placement"),p.bucketInstanceId,xi,G.ID),c)){const Mn=p.bucketInstanceId;let bt=this.collisionCircleArrays[Mn];bt===void 0&&(bt=this.collisionCircleArrays[Mn]=new yi);for(let Bt=0;Bt<$t.circles.length;Bt+=4)bt.circles.push($t.circles[Bt+0]),bt.circles.push($t.circles[Bt+1]),bt.circles.push($t.circles[Bt+2]),bt.circles.push($t.collisionDetected?1:0)}if(Be.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(p.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Be.crossTileID]=new $o(gt||Te,vt||ye,it||p.justReloaded),s[Be.crossTileID]=!0};if(ve){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Be=p.getSortedSymbolIndexes(this.transform.angle);for(let qe=Be.length-1;qe>=0;--qe){const gt=Be[qe];Ge(p.symbolInstances.get(gt),p.collisionArrays[gt])}}else for(let Be=t.symbolInstanceStart;Be<t.symbolInstanceEnd;Be++)Ge(p.symbolInstances.get(Be),p.collisionArrays[Be]);if(c&&p.bucketInstanceId in this.collisionCircleArrays){const Be=this.collisionCircleArrays[p.bucketInstanceId];u.invert(Be.invProjMatrix,v),Be.viewportMatrix=this.collisionIndex.getViewportMatrix()}p.justReloaded=!1}markUsedJustification(t,s,c,p){let g;g=p===u.WritingMode.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[u.getAnchorJustification(s)];const v=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const E of v)E>=0&&(t.text.placedSymbolArray.get(E).crossTileID=g>=0&&E!==g?0:c.crossTileID)}markUsedOrientation(t,s,c){const p=s===u.WritingMode.horizontal||s===u.WritingMode.horizontalOnly?s:0,g=s===u.WritingMode.vertical?s:0,v=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const E of v)t.text.placedSymbolArray.get(E).placedOrientation=p;c.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=g)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let c=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const p=s?s.symbolFadeChange(t):1,g=s?s.opacities:{},v=s?s.variableOffsets:{},E=s?s.placedOrientations:{};for(const S in this.placements){const k=this.placements[S],A=g[S];A?(this.opacities[S]=new Vt(A,p,k.text,k.icon),c=c||k.text!==A.text.placed||k.icon!==A.icon.placed):(this.opacities[S]=new Vt(null,p,k.text,k.icon,k.skipFade),c=c||k.text||k.icon)}for(const S in g){const k=g[S];if(!this.opacities[S]){const A=new Vt(k,p,!1,!1);A.isHidden()||(this.opacities[S]=A,c=c||k.text.placed||k.icon.placed)}}for(const S in v)this.variableOffsets[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.variableOffsets[S]=v[S]);for(const S in E)this.placedOrientations[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.placedOrientations[S]=E[S]);if(s&&s.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:t)}updateLayerOpacities(t,s){const c={};for(const p of s){const g=p.getBucket(t);g&&p.latestFeatureIndex&&t.id===g.layerIds[0]&&this.updateBucketOpacities(g,c,p.collisionBoxArray)}}updateBucketOpacities(t,s,c){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const p=t.layers[0].layout,g=new Vt(null,0,!1,!1,!0),v=p.get("text-allow-overlap"),E=p.get("icon-allow-overlap"),S=p.get("text-variable-anchor"),k=p.get("text-rotation-alignment")==="map",A=p.get("text-pitch-alignment")==="map",D=p.get("icon-text-fit")!=="none",R=new Vt(null,0,v&&(E||!t.hasIconData()||p.get("icon-optional")),E&&(v||!t.hasTextData()||p.get("text-optional")),!0);!t.collisionArrays&&c&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(c);const G=($,j,ee)=>{for(let re=0;re<j/4;re++)$.opacityVertexArray.emplaceBack(ee)};for(let $=0;$<t.symbolInstances.length;$++){const j=t.symbolInstances.get($),{numHorizontalGlyphVertices:ee,numVerticalGlyphVertices:re,crossTileID:ce}=j;let W=this.opacities[ce];s[ce]?W=g:W||(W=R,this.opacities[ce]=W),s[ce]=!0;const pe=j.numIconVertices>0,he=this.placedOrientations[j.crossTileID],_e=he===u.WritingMode.vertical,ve=he===u.WritingMode.horizontal||he===u.WritingMode.horizontalOnly;if(ee>0||re>0){const Te=ne(W.text);G(t.text,ee,_e?ge:Te),G(t.text,re,ve?ge:Te);const ye=W.text.isHidden();[j.rightJustifiedTextSymbolIndex,j.centerJustifiedTextSymbolIndex,j.leftJustifiedTextSymbolIndex].forEach(qe=>{qe>=0&&(t.text.placedSymbolArray.get(qe).hidden=ye||_e?1:0)}),j.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(j.verticalPlacedTextSymbolIndex).hidden=ye||ve?1:0);const Ge=this.variableOffsets[j.crossTileID];Ge&&this.markUsedJustification(t,Ge.anchor,j,he);const Be=this.placedOrientations[j.crossTileID];Be&&(this.markUsedJustification(t,"left",j,Be),this.markUsedOrientation(t,Be,j))}if(pe){const Te=ne(W.icon),ye=!(D&&j.verticalPlacedIconSymbolIndex&&_e);j.placedIconSymbolIndex>=0&&(G(t.icon,j.numIconVertices,ye?Te:ge),t.icon.placedSymbolArray.get(j.placedIconSymbolIndex).hidden=W.icon.isHidden()),j.verticalPlacedIconSymbolIndex>=0&&(G(t.icon,j.numVerticalIconVertices,ye?ge:Te),t.icon.placedSymbolArray.get(j.verticalPlacedIconSymbolIndex).hidden=W.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Te=t.collisionArrays[$];if(Te){let ye=new u.pointGeometry(0,0);if(Te.textBox||Te.verticalTextBox){let Be=!0;if(S){const qe=this.variableOffsets[ce];qe?(ye=jo(qe.anchor,qe.width,qe.height,qe.textOffset,qe.textBoxScale),k&&ye._rotate(A?this.transform.angle:-this.transform.angle)):Be=!1}Te.textBox&&C(t.textCollisionBox.collisionVertexArray,W.text.placed,!Be||_e,ye.x,ye.y),Te.verticalTextBox&&C(t.textCollisionBox.collisionVertexArray,W.text.placed,!Be||ve,ye.x,ye.y)}const Ge=Boolean(!ve&&Te.verticalIconBox);Te.iconBox&&C(t.iconCollisionBox.collisionVertexArray,W.icon.placed,Ge,D?ye.x:0,D?ye.y:0),Te.verticalIconBox&&C(t.iconCollisionBox.collisionVertexArray,W.icon.placed,!Ge,D?ye.x:0,D?ye.y:0)}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const $=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=$.invProjMatrix,t.placementViewportMatrix=$.viewportMatrix,t.collisionCircleArray=$.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,s){const c=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*c>t}setStale(){this.stale=!0}}function C(h,t,s,c,p){h.emplaceBack(t?1:0,s?1:0,c||0,p||0),h.emplaceBack(t?1:0,s?1:0,c||0,p||0),h.emplaceBack(t?1:0,s?1:0,c||0,p||0),h.emplaceBack(t?1:0,s?1:0,c||0,p||0)}const P=Math.pow(2,25),O=Math.pow(2,24),U=Math.pow(2,17),K=Math.pow(2,16),te=Math.pow(2,9),J=Math.pow(2,8),Y=Math.pow(2,1);function ne(h){if(h.opacity===0&&!h.placed)return 0;if(h.opacity===1&&h.placed)return 4294967295;const t=h.placed?1:0,s=Math.floor(127*h.opacity);return s*P+t*O+s*U+t*K+s*te+t*J+s*Y+t}const ge=0;class Ee{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,s,c,p,g){const v=this._bucketParts;for(;this._currentTileIndex<t.length;)if(s.getBucketParts(v,p,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,v.sort((E,S)=>E.sortKey-S.sortKey));this._currentPartIndex<v.length;)if(s.placeLayerBucketPart(v[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,g())return!0;return!1}}class me{constructor(t,s,c,p,g,v,E,S){this.placement=new V(t,s,v,E,S),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(t,s,c){const p=u.exported.now(),g=()=>{const v=u.exported.now()-p;return!this._forceFullPlacement&&v>2};for(;this._currentPlacementIndex>=0;){const v=s[t[this._currentPlacementIndex]],E=this.placement.collisionIndex.transform.zoom;if(v.type==="symbol"&&(!v.minzoom||v.minzoom<=E)&&(!v.maxzoom||v.maxzoom>E)){if(this._inProgressLayer||(this._inProgressLayer=new Ee(v)),this._inProgressLayer.continuePlacement(c[v.source],this.placement,this._showCollisionBoxes,v,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Ye=512/u.EXTENT/2;class et{constructor(t,s,c){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=c;for(let p=0;p<s.length;p++){const g=s.get(p),v=g.key;this.indexedSymbolInstances[v]||(this.indexedSymbolInstances[v]=[]),this.indexedSymbolInstances[v].push({crossTileID:g.crossTileID,coord:this.getScaledCoordinates(g,t)})}}getScaledCoordinates(t,s){const c=Ye/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*u.EXTENT+t.anchorX)*c),y:Math.floor((s.canonical.y*u.EXTENT+t.anchorY)*c)}}findMatches(t,s,c){const p=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z);for(let g=0;g<t.length;g++){const v=t.get(g);if(v.crossTileID)continue;const E=this.indexedSymbolInstances[v.key];if(!E)continue;const S=this.getScaledCoordinates(v,s);for(const k of E)if(Math.abs(k.coord.x-S.x)<=p&&Math.abs(k.coord.y-S.y)<=p&&!c[k.crossTileID]){c[k.crossTileID]=!0,v.crossTileID=k.crossTileID;break}}}}class je{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class lt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const s=Math.round((t-this.lng)/360);if(s!==0)for(const c in this.indexes){const p=this.indexes[c],g={};for(const v in p){const E=p[v];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+s),g[E.tileID.key]=E}this.indexes[c]=g}this.lng=t}addBucket(t,s,c){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let g=0;g<s.symbolInstances.length;g++)s.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const p=this.usedCrossTileIDs[t.overscaledZ];for(const g in this.indexes){const v=this.indexes[g];if(Number(g)>t.overscaledZ)for(const E in v){const S=v[E];S.tileID.isChildOf(t)&&S.findMatches(s.symbolInstances,t,p)}else{const E=v[t.scaledTo(Number(g)).key];E&&E.findMatches(s.symbolInstances,t,p)}}for(let g=0;g<s.symbolInstances.length;g++){const v=s.symbolInstances.get(g);v.crossTileID||(v.crossTileID=c.generate(),p[v.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new et(t,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(t,s){for(const c in s.indexedSymbolInstances)for(const p of s.indexedSymbolInstances[c])delete this.usedCrossTileIDs[t][p.crossTileID]}removeStaleBuckets(t){let s=!1;for(const c in this.indexes){const p=this.indexes[c];for(const g in p)t[p[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,p[g]),delete p[g],s=!0)}return s}}class ht{constructor(){this.layerIndexes={},this.crossTileIDs=new je,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,s,c){let p=this.layerIndexes[t.id];p===void 0&&(p=this.layerIndexes[t.id]=new lt);let g=!1;const v={};p.handleWrapJump(c);for(const E of s){const S=E.getBucket(t);S&&t.id===S.layerIds[0]&&(S.bucketInstanceId||(S.bucketInstanceId=++this.maxBucketInstanceId),p.addBucket(E.tileID,S,this.crossTileIDs)&&(g=!0),v[S.bucketInstanceId]=!0)}return p.removeStaleBuckets(v)&&(g=!0),g}pruneUnusedLayers(t){const s={};t.forEach(c=>{s[c]=!0});for(const c in this.layerIndexes)s[c]||delete this.layerIndexes[c]}}var zt=u.createLayout([{name:"a_pos",type:"Int16",components:2}]);class pt extends u.Evented{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=t._cache.max,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const t in this._tiles){const s=this._tiles[t];s.textures.forEach(c=>c.destroy()),s.textures=[]}}update(t,s){this.sourceCache.update(t,s),this._renderableTilesKeys=[];for(const c of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:s}))this._renderableTilesKeys.push(c.key),this._tiles[c.key]||(c.posMatrix=new Float64Array(16),u.ortho(c.posMatrix,0,u.EXTENT,0,u.EXTENT,0,1),this._tiles[c.key]=new zn(c,this.tileSize))}removeOutdated(t){const s={};this.renderHistory=this.renderHistory.filter((c,p)=>this.renderHistory.indexOf(c)===p).slice(0,this.renderHistorySize);for(const c of this._renderableTilesKeys)s[c]=!0;for(const c of this.renderHistory)s[c]=!0;for(const c in this._tiles)s[c]||(this._tiles[c].clearTextures(t),delete this._tiles[c])}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const s={};for(const c of this._renderableTilesKeys){const p=this._tiles[c].tileID;if(p.canonical.equals(t.canonical)){const g=t.clone();g.posMatrix=new Float64Array(16),u.ortho(g.posMatrix,0,u.EXTENT,0,u.EXTENT,0,1),s[c]=g}else if(p.canonical.isChildOf(t.canonical)){const g=t.clone();g.posMatrix=new Float64Array(16);const v=p.canonical.z-t.canonical.z,E=p.canonical.x-(p.canonical.x>>v<<v),S=p.canonical.y-(p.canonical.y>>v<<v),k=u.EXTENT>>v;u.ortho(g.posMatrix,0,k,0,k,0,1),u.translate(g.posMatrix,g.posMatrix,[-E*k,-S*k,0]),s[c]=g}else if(t.canonical.isChildOf(p.canonical)){const g=t.clone();g.posMatrix=new Float64Array(16);const v=t.canonical.z-p.canonical.z,E=t.canonical.x-(t.canonical.x>>v<<v),S=t.canonical.y-(t.canonical.y>>v<<v),k=u.EXTENT>>v;u.ortho(g.posMatrix,0,u.EXTENT,0,u.EXTENT,0,1),u.translate(g.posMatrix,g.posMatrix,[E*k,S*k,0]),u.scale(g.posMatrix,g.posMatrix,[1/2**v,1/2**v,0]),s[c]=g}}return s}getSourceTile(t,s){const c=this.sourceCache._source;let p=t.overscaledZ-this.deltaZoom;if(p>c.maxzoom&&(p=c.maxzoom),p<c.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(p).key);let g=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!g||!g.dem)&&s)for(;p>=c.minzoom&&(!g||!g.dem);)g=this.sourceCache.getTileByID(t.scaledTo(p--).key);return g}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter(s=>s.timeLoaded>=t)}}class _t{constructor(t,s,c){this.style=t,this.sourceCache=new pt(s),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.elevationOffset=typeof c.elevationOffset=="number"?c.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(t,s,c,p=u.EXTENT){if(!(s>=0&&s<p&&c>=0&&c<p))return this.elevationOffset;let g=0;const v=this.getTerrainData(t);if(v.tile&&v.tile.dem){const E=u.transformMat4$1([],[s/p*u.EXTENT,c/p*u.EXTENT],v.u_terrain_matrix),S=[E[0]*v.tile.dem.dim,E[1]*v.tile.dem.dim],k=[Math.floor(S[0]),Math.floor(S[1])],A=v.tile.dem.get(k[0],k[1]),D=v.tile.dem.get(k[0],k[1]+1),R=v.tile.dem.get(k[0]+1,k[1]),G=v.tile.dem.get(k[0]+1,k[1]+1);g=u.number(u.number(A,D,S[0]-k[0]),u.number(R,G,S[0]-k[0]),S[1]-k[1])}return g}rememberForRerender(t,s){for(const c in this.sourceCache._tiles){const p=this.sourceCache._tiles[c];(p.tileID.equals(s)||p.tileID.isChildOf(s))&&(t===this.sourceCache.sourceCache.id&&(p.timeLoaded=Date.now()),this._rerender[t]=this._rerender[t]||{},this._rerender[t][p.tileID.key]=!0)}}needsRerender(t,s){return this._rerender[t]&&this._rerender[t][s.key]}clearRerenderCache(){this._rerender={}}getElevation(t,s,c,p=u.EXTENT){return(this.getDEMElevation(t,s,c,p)+this.elevationOffset)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const p=this.style.map.painter.context,g=new u.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ke(p,g,p.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ke(p,new u.RGBAImage({width:1,height:1}),p.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=u.identity([])}const s=this.sourceCache.getSourceTile(t,!0);if(s&&s.dem&&(!s.demTexture||s.needsTerrainPrepare)){const p=this.style.map.painter.context;s.demTexture=this.style.map.painter.getTileTexture(s.dem.stride),s.demTexture?s.demTexture.update(s.dem.getPixels(),{premultiply:!1}):s.demTexture=new ke(p,s.dem.getPixels(),p.gl.RGBA,{premultiply:!1}),s.demTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),s.needsTerrainPrepare=!1}const c=s&&s+s.tileID.key+t.key;if(c&&!this._demMatrixCache[c]){const p=this.sourceCache.sourceCache._source.maxzoom;let g=t.canonical.z-s.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=p?g=t.canonical.z-p:u.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const v=t.canonical.x-(t.canonical.x>>g<<g),E=t.canonical.y-(t.canonical.y>>g<<g),S=u.fromScaling(new Float64Array(16),[1/(u.EXTENT<<g),1/(u.EXTENT<<g),0]);u.translate(S,S,[v*u.EXTENT,E*u.EXTENT,0]),this._demMatrixCache[t.key]={matrix:S,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:s&&s.dem&&s.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:s&&s.dem&&s.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(s&&s.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:s}}getRTTFramebuffer(){const t=this.style.map.painter;if(!this._rttFramebuffer){const s=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=t.context.createFramebuffer(s,s,!0),this._rttFramebuffer.depthAttachment.set(t.context.createRenderbuffer(t.context.gl.DEPTH_COMPONENT16,s,s))}return this._rttFramebuffer}getFramebuffer(t){const s=this.style.map.painter,c=s.width/devicePixelRatio,p=s.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===p||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ke(s.context,{width:c,height:p,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ke(s.context,{width:c,height:p,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=s.context.createFramebuffer(c,p,!0),this._fbo.depthAttachment.set(s.context.createRenderbuffer(s.context.gl.DEPTH_COMPONENT16,c,p))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const s=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let g=0,v=0;g<this._coordsTextureSize;g++)for(let E=0;E<this._coordsTextureSize;E++,v+=4)s[v+0]=255&E,s[v+1]=255&g,s[v+2]=E>>8<<4|g>>8,s[v+3]=0;const c=new u.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(s.buffer)),p=new ke(t,c,t.gl.RGBA,{premultiply:!1});return p.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=p,p}pointCoordinate(t){const s=new Uint8Array(4),c=this.style.map.painter,p=c.context,g=p.gl;p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),g.readPixels(t.x,c.height/devicePixelRatio-t.y-1,1,1,g.RGBA,g.UNSIGNED_BYTE,s),p.bindFramebuffer.set(null);const v=s[0]+(s[2]>>4<<8),E=s[1]+((15&s[2])<<8),S=this.coordsIndex[255-s[3]],k=S&&this.sourceCache.getTileByID(S);if(!k)return null;const A=this._coordsTextureSize,D=(1<<k.tileID.canonical.z)*A;return new u.MercatorCoordinate((k.tileID.canonical.x*A+v)/D,(k.tileID.canonical.y*A+E)/D,this.getElevation(k.tileID,v,E,A))}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.style.map.painter.context,s=new u.PosArray,c=new u.TriangleIndexArray,p=this.meshSize,g=u.EXTENT/p,v=p*p;for(let E=0;E<=p;E++)for(let S=0;S<=p;S++)s.emplaceBack(S*g,E*g);for(let E=0;E<v;E+=p+1)for(let S=0;S<p;S++)c.emplaceBack(S+E,p+S+E+1,p+S+E+2),c.emplaceBack(S+E,p+S+E+2,S+E+1);return this._mesh={indexBuffer:t.createIndexBuffer(c),vertexBuffer:t.createVertexBuffer(s,zt.members),segments:u.SegmentVector.simpleSegment(0,0,s.length,c.length)},this._mesh}getMinMaxElevation(t){const s=this.getTerrainData(t).tile,c={minElevation:null,maxElevation:null};return s&&s.dem&&(c.minElevation=(s.dem.min+this.elevationOffset)*this.exaggeration,c.maxElevation=(s.dem.max+this.elevationOffset)*this.exaggeration),c}}const At=(h,t)=>u.emitValidationErrors(h,t&&t.filter(s=>s.identifier!=="source.canvas")),Zt=u.pick(wt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),On=u.pick(wt,["setCenter","setZoom","setBearing","setPitch"]),Qt=function(){const h={},t=u.spec.$version;for(const s in u.spec.$root){const c=u.spec.$root[s];if(c.required){let p=null;p=s==="version"?t:c.type==="array"?[]:{},p!=null&&(h[s]=p)}}return h}();class er extends u.Evented{constructor(t,s={}){super(),this.map=t,this.dispatcher=new dt(ur(),this),this.imageManager=new se,this.imageManager.setEventedParent(this),this.glyphManager=new Ae(t._requestManager,s.localIdeographFontFamily),this.lineAtlas=new Ct(256,512),this.crossTileSymbolIndex=new ht,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new u.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",u.getReferrer());const c=this;this._rtlTextPluginCallback=er.registerForPluginStateChange(p=>{c.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:p.pluginStatus,pluginURL:p.pluginURL},(g,v)=>{if(u.triggerPluginCompletionEvent(g),v&&v.every(E=>E))for(const E in c.sourceCaches)c.sourceCaches[E].reload()})}),this.on("data",p=>{if(p.dataType!=="source"||p.sourceDataType!=="metadata")return;const g=this.sourceCaches[p.sourceId];if(!g)return;const v=g.getSource();if(v&&v.vectorLayerIds)for(const E in this._layers){const S=this._layers[E];S.source===v.id&&this._validateLayer(S)}})}loadURL(t,s={}){this.fire(new u.Event("dataloading",{dataType:"style"}));const c=typeof s.validate!="boolean"||s.validate,p=this.map._requestManager.transformRequest(t,u.ResourceType.Style);this._request=u.getJSON(p,(g,v)=>{this._request=null,g?this.fire(new u.ErrorEvent(g)):v&&this._load(v,c)})}loadJSON(t,s={}){this.fire(new u.Event("dataloading",{dataType:"style"})),this._request=u.exported.frame(()=>{this._request=null,this._load(t,s.validate!==!1)})}loadEmpty(){this.fire(new u.Event("dataloading",{dataType:"style"})),this._load(Qt,!1)}_load(t,s){if(s&&At(this,u.validateStyle(t)))return;this._loaded=!0,this.stylesheet=t;for(const p in t.sources)this.addSource(p,t.sources[p],{validate:!1});t.sprite?this._loadSprite(t.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(t.glyphs);const c=ei(this.stylesheet.layers);this._order=c.map(p=>p.id),this._layers={},this._serializedLayers={};for(let p of c)p=u.createStyleLayer(p),p.setEventedParent(this,{layer:{id:p.id}}),this._layers[p.id]=p,this._serializedLayers[p.id]=p.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ke(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new u.Event("data",{dataType:"style"})),this.fire(new u.Event("style.load"))}_loadSprite(t){this._spriteRequest=function(s,c,p,g){let v,E,S;const k=p>1?"@2x":"";let A=u.getJSON(c.transformRequest(c.normalizeSpriteURL(s,k,".json"),u.ResourceType.SpriteJSON),(G,$)=>{A=null,S||(S=G,v=$,R())}),D=u.getImage(c.transformRequest(c.normalizeSpriteURL(s,k,".png"),u.ResourceType.SpriteImage),(G,$)=>{D=null,S||(S=G,E=$,R())});function R(){if(S)g(S);else if(v&&E){const G=u.exported.getImageData(E),$={};for(const j in v){const{width:ee,height:re,x:ce,y:W,sdf:pe,pixelRatio:he,stretchX:_e,stretchY:ve,content:Te}=v[j],ye=new u.RGBAImage({width:ee,height:re});u.RGBAImage.copy(G,ye,{x:ce,y:W},{x:0,y:0},{width:ee,height:re}),$[j]={data:ye,pixelRatio:he,sdf:pe,stretchX:_e,stretchY:ve,content:Te}}g(null,$)}}return{cancel(){A&&(A.cancel(),A=null),D&&(D.cancel(),D=null)}}}(t,this.map._requestManager,this.map.getPixelRatio(),(s,c)=>{if(this._spriteRequest=null,s)this.fire(new u.ErrorEvent(s));else if(c)for(const p in c)this.imageManager.addImage(p,c[p]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"}))})}_validateLayer(t){const s=this.sourceCaches[t.source];if(!s)return;const c=t.sourceLayer;if(!c)return;const p=s.getSource();(p.type==="geojson"||p.vectorLayerIds&&p.vectorLayerIds.indexOf(c)===-1)&&this.fire(new u.ErrorEvent(new Error(`Source layer "${c}" does not exist on source "${p.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(t){const s=[];for(const c of t){const p=this._layers[c];p.type!=="custom"&&s.push(p.serialize())}return s}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const s=this._changed;if(this._changed){const p=Object.keys(this._updatedLayers),g=Object.keys(this._removedLayers);(p.length||g.length)&&this._updateWorkerLayers(p,g);for(const v in this._updatedSources){const E=this._updatedSources[v];if(E==="reload")this._reloadSource(v);else{if(E!=="clear")throw new Error(`Invalid action ${E}`);this._clearSource(v)}}this._updateTilesForChangedImages();for(const v in this._updatedPaintProps)this._layers[v].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}const c={};for(const p in this.sourceCaches){const g=this.sourceCaches[p];c[p]=g.used,g.used=!1}for(const p of this._order){const g=this._layers[p];g.recalculate(t,this._availableImages),!g.isHidden(t.zoom)&&g.source&&(this.sourceCaches[g.source].used=!0)}for(const p in c){const g=this.sourceCaches[p];c[p]!==g.used&&g.fire(new u.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:p}))}this.light.recalculate(t),this.z=t.zoom,s&&this.fire(new u.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateWorkerLayers(t,s){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:s})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(t){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),t){const s=this.sourceCaches[t.source];if(!s)throw new Error(`cannot load terrain, because there exists no source with ID: ${t.source}`);this.terrain=new _t(this,s,t),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=c=>{c.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=c=>{c.tile&&(c.sourceId===t.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(c.sourceId,c.tile.tileID)):c.source.type==="geojson"&&this.terrain.rememberForRerender(c.sourceId,c.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new u.Event("terrain",{terrain:t}))}setState(t){if(this._checkLoaded(),At(this,u.validateStyle(t)))return!1;(t=u.clone$1(t)).layers=ei(t.layers);const s=function(p,g){if(!p)return[{command:wt.setStyle,args:[g]}];let v=[];try{if(!oe(p.version,g.version))return[{command:wt.setStyle,args:[g]}];oe(p.center,g.center)||v.push({command:wt.setCenter,args:[g.center]}),oe(p.zoom,g.zoom)||v.push({command:wt.setZoom,args:[g.zoom]}),oe(p.bearing,g.bearing)||v.push({command:wt.setBearing,args:[g.bearing]}),oe(p.pitch,g.pitch)||v.push({command:wt.setPitch,args:[g.pitch]}),oe(p.sprite,g.sprite)||v.push({command:wt.setSprite,args:[g.sprite]}),oe(p.glyphs,g.glyphs)||v.push({command:wt.setGlyphs,args:[g.glyphs]}),oe(p.transition,g.transition)||v.push({command:wt.setTransition,args:[g.transition]}),oe(p.light,g.light)||v.push({command:wt.setLight,args:[g.light]});const E={},S=[];(function(A,D,R,G){let $;for($ in D=D||{},A=A||{})Object.prototype.hasOwnProperty.call(A,$)&&(Object.prototype.hasOwnProperty.call(D,$)||ti($,R,G));for($ in D)Object.prototype.hasOwnProperty.call(D,$)&&(Object.prototype.hasOwnProperty.call(A,$)?oe(A[$],D[$])||(A[$].type==="geojson"&&D[$].type==="geojson"&&Bn(A,D,$)?R.push({command:wt.setGeoJSONSourceData,args:[$,D[$].data]}):ni($,D,R,G)):Cr($,D,R))})(p.sources,g.sources,S,E);const k=[];p.layers&&p.layers.forEach(A=>{E[A.source]?v.push({command:wt.removeLayer,args:[A.id]}):k.push(A)}),v=v.concat(S),function(A,D,R){D=D||[];const G=(A=A||[]).map(Ir),$=D.map(Ir),j=A.reduce(Wi,{}),ee=D.reduce(Wi,{}),re=G.slice(),ce=Object.create(null);let W,pe,he,_e,ve,Te,ye;for(W=0,pe=0;W<G.length;W++)he=G[W],Object.prototype.hasOwnProperty.call(ee,he)?pe++:(R.push({command:wt.removeLayer,args:[he]}),re.splice(re.indexOf(he,pe),1));for(W=0,pe=0;W<$.length;W++)he=$[$.length-1-W],re[re.length-1-W]!==he&&(Object.prototype.hasOwnProperty.call(j,he)?(R.push({command:wt.removeLayer,args:[he]}),re.splice(re.lastIndexOf(he,re.length-pe),1)):pe++,Te=re[re.length-W],R.push({command:wt.addLayer,args:[ee[he],Te]}),re.splice(re.length-W,0,he),ce[he]=!0);for(W=0;W<$.length;W++)if(he=$[W],_e=j[he],ve=ee[he],!ce[he]&&!oe(_e,ve))if(oe(_e.source,ve.source)&&oe(_e["source-layer"],ve["source-layer"])&&oe(_e.type,ve.type)){for(ye in An(_e.layout,ve.layout,R,he,null,wt.setLayoutProperty),An(_e.paint,ve.paint,R,he,null,wt.setPaintProperty),oe(_e.filter,ve.filter)||R.push({command:wt.setFilter,args:[he,ve.filter]}),oe(_e.minzoom,ve.minzoom)&&oe(_e.maxzoom,ve.maxzoom)||R.push({command:wt.setLayerZoomRange,args:[he,ve.minzoom,ve.maxzoom]}),_e)Object.prototype.hasOwnProperty.call(_e,ye)&&ye!=="layout"&&ye!=="paint"&&ye!=="filter"&&ye!=="metadata"&&ye!=="minzoom"&&ye!=="maxzoom"&&(ye.indexOf("paint.")===0?An(_e[ye],ve[ye],R,he,ye.slice(6),wt.setPaintProperty):oe(_e[ye],ve[ye])||R.push({command:wt.setLayerProperty,args:[he,ye,ve[ye]]}));for(ye in ve)Object.prototype.hasOwnProperty.call(ve,ye)&&!Object.prototype.hasOwnProperty.call(_e,ye)&&ye!=="layout"&&ye!=="paint"&&ye!=="filter"&&ye!=="metadata"&&ye!=="minzoom"&&ye!=="maxzoom"&&(ye.indexOf("paint.")===0?An(_e[ye],ve[ye],R,he,ye.slice(6),wt.setPaintProperty):oe(_e[ye],ve[ye])||R.push({command:wt.setLayerProperty,args:[he,ye,ve[ye]]}))}else R.push({command:wt.removeLayer,args:[he]}),Te=re[re.lastIndexOf(he)+1],R.push({command:wt.addLayer,args:[ve,Te]})}(k,g.layers,v)}catch(E){console.warn("Unable to compute style diff:",E),v=[{command:wt.setStyle,args:[g]}]}return v}(this.serialize(),t).filter(p=>!(p.command in On));if(s.length===0)return!1;const c=s.filter(p=>!(p.command in Zt));if(c.length>0)throw new Error(`Unimplemented: ${c.map(p=>p.command).join(", ")}.`);return s.forEach(p=>{p.command!=="setTransition"&&this[p.command].apply(this,p.args)}),this.stylesheet=t,!0}addImage(t,s){if(this.getImage(t))return this.fire(new u.ErrorEvent(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,s),this._afterImageUpdated(t)}updateImage(t,s){this.imageManager.updateImage(t,s)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new u.ErrorEvent(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,s,c={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(u.validateStyle.source,`sources.${t}`,s,null,c))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const p=this.sourceCaches[t]=new bn(t,s,this.dispatcher);p.style=this,p.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:p.serialize(),sourceId:t})),p.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===t)return this.fire(new u.ErrorEvent(new Error(`Source "${t}" cannot be removed while layer "${c}" is using it.`)));const s=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],s.fire(new u.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),s.setEventedParent(null),s.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,s){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const c=this.sourceCaches[t].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(s),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,s,c={}){this._checkLoaded();const p=t.id;if(this.getLayer(p))return void this.fire(new u.ErrorEvent(new Error(`Layer "${p}" already exists on this map.`)));let g;if(t.type==="custom"){if(At(this,u.validateCustomStyleLayer(t)))return;g=u.createStyleLayer(t)}else{if(typeof t.source=="object"&&(this.addSource(p,t.source),t=u.clone$1(t),t=u.extend(t,{source:p})),this._validate(u.validateStyle.layer,`layers.${p}`,t,{arrayIndex:-1},c))return;g=u.createStyleLayer(t),this._validateLayer(g),g.setEventedParent(this,{layer:{id:p}}),this._serializedLayers[g.id]=g.serialize()}const v=s?this._order.indexOf(s):this._order.length;if(s&&v===-1)this.fire(new u.ErrorEvent(new Error(`Cannot add layer "${p}" before non-existing layer "${s}".`)));else{if(this._order.splice(v,0,p),this._layerOrderChanged=!0,this._layers[p]=g,this._removedLayers[p]&&g.source&&g.type!=="custom"){const E=this._removedLayers[p];delete this._removedLayers[p],E.type!==g.type?this._updatedSources[g.source]="clear":(this._updatedSources[g.source]="reload",this.sourceCaches[g.source].pause())}this._updateLayer(g),g.onAdd&&g.onAdd(this.map)}}moveLayer(t,s){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new u.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===s)return;const c=this._order.indexOf(t);this._order.splice(c,1);const p=s?this._order.indexOf(s):this._order.length;s&&p===-1?this.fire(new u.ErrorEvent(new Error(`Cannot move layer "${t}" before non-existing layer "${s}".`))):(this._order.splice(p,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const s=this._layers[t];if(!s)return void this.fire(new u.ErrorEvent(new Error(`Cannot remove non-existing layer "${t}".`)));s.setEventedParent(null);const c=this._order.indexOf(t);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=s,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],s.onRemove&&s.onRemove(this.map)}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,s,c){this._checkLoaded();const p=this.getLayer(t);p?p.minzoom===s&&p.maxzoom===c||(s!=null&&(p.minzoom=s),c!=null&&(p.maxzoom=c),this._updateLayer(p)):this.fire(new u.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,s,c={}){this._checkLoaded();const p=this.getLayer(t);if(p){if(!oe(p.filter,s))return s==null?(p.filter=void 0,void this._updateLayer(p)):void(this._validate(u.validateStyle.filter,`layers.${p.id}.filter`,s,null,c)||(p.filter=u.clone$1(s),this._updateLayer(p)))}else this.fire(new u.ErrorEvent(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return u.clone$1(this.getLayer(t).filter)}setLayoutProperty(t,s,c,p={}){this._checkLoaded();const g=this.getLayer(t);g?oe(g.getLayoutProperty(s),c)||(g.setLayoutProperty(s,c,p),this._updateLayer(g)):this.fire(new u.ErrorEvent(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,s){const c=this.getLayer(t);if(c)return c.getLayoutProperty(s);this.fire(new u.ErrorEvent(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,s,c,p={}){this._checkLoaded();const g=this.getLayer(t);g?oe(g.getPaintProperty(s),c)||(g.setPaintProperty(s,c,p)&&this._updateLayer(g),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new u.ErrorEvent(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,s){return this.getLayer(t).getPaintProperty(s)}setFeatureState(t,s){this._checkLoaded();const c=t.source,p=t.sourceLayer,g=this.sourceCaches[c];if(g===void 0)return void this.fire(new u.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)));const v=g.getSource().type;v==="geojson"&&p?this.fire(new u.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):v!=="vector"||p?(t.id===void 0&&this.fire(new u.ErrorEvent(new Error("The feature id parameter must be provided."))),g.setFeatureState(p,t.id,s)):this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,s){this._checkLoaded();const c=t.source,p=this.sourceCaches[c];if(p===void 0)return void this.fire(new u.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)));const g=p.getSource().type,v=g==="vector"?t.sourceLayer:void 0;g!=="vector"||v?s&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new u.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):p.removeFeatureState(v,t.id,s):this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const s=t.source,c=t.sourceLayer,p=this.sourceCaches[s];if(p!==void 0)return p.getSource().type!=="vector"||c?(t.id===void 0&&this.fire(new u.ErrorEvent(new Error("The feature id parameter must be provided."))),p.getFeatureState(c,t.id)):void this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new u.ErrorEvent(new Error(`The source '${s}' does not exist in the map's style.`)))}getTransition(){return u.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return u.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:u.mapObject(this.sourceCaches,t=>t.serialize()),layers:this._serializeLayers(this._order)},t=>t!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(t){const s=v=>this._layers[v].type==="fill-extrusion",c={},p=[];for(let v=this._order.length-1;v>=0;v--){const E=this._order[v];if(s(E)){c[E]=v;for(const S of t){const k=S[E];if(k)for(const A of k)p.push(A)}}}p.sort((v,E)=>E.intersectionZ-v.intersectionZ);const g=[];for(let v=this._order.length-1;v>=0;v--){const E=this._order[v];if(s(E))for(let S=p.length-1;S>=0;S--){const k=p[S].feature;if(c[k.layer.id]<v)break;g.push(k),p.pop()}else for(const S of t){const k=S[E];if(k)for(const A of k)g.push(A.feature)}}return g}queryRenderedFeatures(t,s,c){s&&s.filter&&this._validate(u.validateStyle.filter,"queryRenderedFeatures.filter",s.filter,null,s);const p={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new u.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const v of s.layers){const E=this._layers[v];if(!E)return this.fire(new u.ErrorEvent(new Error(`The layer '${v}' does not exist in the map's style and cannot be queried for features.`))),[];p[E.source]=!0}}const g=[];s.availableImages=this._availableImages;for(const v in this.sourceCaches)s.layers&&!p[v]||g.push(Rn(this.sourceCaches[v],this._layers,this._serializedLayers,t,s,c));return this.placement&&g.push(function(v,E,S,k,A,D,R){const G={},$=D.queryRenderedSymbols(k),j=[];for(const ee of Object.keys($).map(Number))j.push(R[ee]);j.sort(Wn);for(const ee of j){const re=ee.featureIndex.lookupSymbolFeatures($[ee.bucketInstanceId],E,ee.bucketIndex,ee.sourceLayerIndex,A.filter,A.layers,A.availableImages,v);for(const ce in re){const W=G[ce]=G[ce]||[],pe=re[ce];pe.sort((he,_e)=>{const ve=ee.featureSortOrder;if(ve){const Te=ve.indexOf(he.featureIndex);return ve.indexOf(_e.featureIndex)-Te}return _e.featureIndex-he.featureIndex});for(const he of pe)W.push(he)}}for(const ee in G)G[ee].forEach(re=>{const ce=re.feature,W=S[v[ee].source].getFeatureState(ce.layer["source-layer"],ce.id);ce.source=ce.layer.source,ce.layer["source-layer"]&&(ce.sourceLayer=ce.layer["source-layer"]),ce.state=W});return G}(this._layers,this._serializedLayers,this.sourceCaches,t,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(g)}querySourceFeatures(t,s){s&&s.filter&&this._validate(u.validateStyle.filter,"querySourceFeatures.filter",s.filter,null,s);const c=this.sourceCaches[t];return c?function(p,g){const v=p.getRenderableIds().map(k=>p.getTileByID(k)),E=[],S={};for(let k=0;k<v.length;k++){const A=v[k],D=A.tileID.canonical.key;S[D]||(S[D]=!0,A.querySourceFeatures(E,g))}return E}(c,s):[]}addSourceType(t,s,c){return er.getSourceType(t)?c(new Error(`A source type called "${t}" already exists.`)):(er.setSourceType(t,s),s.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:s.workerSourceURL},c):c(null,null))}getLight(){return this.light.getLight()}setLight(t,s={}){this._checkLoaded();const c=this.light.getLight();let p=!1;for(const v in t)if(!oe(t[v],c[v])){p=!0;break}if(!p)return;const g={now:u.exported.now(),transition:u.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,s),this.light.updateTransitions(g)}_validate(t,s,c,p,g={}){return(!g||g.validate!==!1)&&At(this,t.call(u.validateStyle,u.extend({key:s,style:this.serialize(),value:c,styleSpec:u.spec},p)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),u.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this.sourceCaches){const s=this.sourceCaches[t];s.setEventedParent(null),s.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const s in this.sourceCaches)this.sourceCaches[s].update(t,this.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,s,c,p,g=!1){let v=!1,E=!1;const S={};for(const k of this._order){const A=this._layers[k];if(A.type!=="symbol")continue;if(!S[A.source]){const R=this.sourceCaches[A.source];S[A.source]=R.getRenderableIds(!0).map(G=>R.getTileByID(G)).sort((G,$)=>$.tileID.overscaledZ-G.tileID.overscaledZ||(G.tileID.isLessThan($.tileID)?-1:1))}const D=this.crossTileSymbolIndex.addLayer(A,S[A.source],t.center.lng);v=v||D}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((g=g||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(u.exported.now(),t.zoom))&&(this.pauseablePlacement=new me(t,this.terrain,this._order,g,s,c,p,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,S),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(u.exported.now()),E=!0),v&&this.pauseablePlacement.placement.setStale()),E||v)for(const k of this._order){const A=this._layers[k];A.type==="symbol"&&this.placement.updateLayerOpacities(A,S[A.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(u.exported.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,s,c){this.imageManager.getImages(s.icons,c),this._updateTilesForChangedImages();const p=this.sourceCaches[s.source];p&&p.setDependencies(s.tileID.key,s.type,s.icons)}getGlyphs(t,s,c){this.glyphManager.getGlyphs(s.stacks,c)}getResource(t,s,c){return u.makeRequest(s,c)}}er.getSourceType=function(h){return Ut[h]},er.setSourceType=function(h,t){Ut[h]=t},er.registerForPluginStateChange=u.registerForPluginStateChange;var Go="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const Ms={prelude:qt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:qt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:qt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:qt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:qt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:qt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:qt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:qt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:qt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:qt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:qt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:qt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:qt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:qt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:qt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:qt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:qt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:qt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:qt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:qt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:qt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:qt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:qt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:qt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:qt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:qt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:qt("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Go),terrainDepth:qt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Go),terrainCoords:qt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Go)};function qt(h,t){const s=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=t.match(/attribute ([\w]+) ([\w]+)/g),p=h.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=g?g.concat(p):p,E={};return{fragmentSource:h=h.replace(s,(S,k,A,D,R)=>(E[R]=!0,k==="define"?`
#ifndef HAS_UNIFORM_u_${R}
varying ${A} ${D} ${R};
#else
uniform ${A} ${D} u_${R};
#endif
`:`
#ifdef HAS_UNIFORM_u_${R}
    ${A} ${D} ${R} = u_${R};
#endif
`)),vertexSource:t=t.replace(s,(S,k,A,D,R)=>{const G=D==="float"?"vec2":"vec4",$=R.match(/color/)?"color":G;return E[R]?k==="define"?`
#ifndef HAS_UNIFORM_u_${R}
uniform lowp float u_${R}_t;
attribute ${A} ${G} a_${R};
varying ${A} ${D} ${R};
#else
uniform ${A} ${D} u_${R};
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_${R}
    ${R} = a_${R};
#else
    ${A} ${D} ${R} = u_${R};
#endif
`:`
#ifndef HAS_UNIFORM_u_${R}
    ${R} = unpack_mix_${$}(a_${R}, u_${R}_t);
#else
    ${A} ${D} ${R} = u_${R};
#endif
`:k==="define"?`
#ifndef HAS_UNIFORM_u_${R}
uniform lowp float u_${R}_t;
attribute ${A} ${G} a_${R};
#else
uniform ${A} ${D} u_${R};
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_${R}
    ${A} ${D} ${R} = a_${R};
#else
    ${A} ${D} ${R} = u_${R};
#endif
`:`
#ifndef HAS_UNIFORM_u_${R}
    ${A} ${D} ${R} = unpack_mix_${$}(a_${R}, u_${R}_t);
#else
    ${A} ${D} ${R} = u_${R};
#endif
`}),staticAttributes:c,staticUniforms:v}}class Il{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,s,c,p,g,v,E,S,k){this.context=t;let A=this.boundPaintVertexBuffers.length!==p.length;for(let D=0;!A&&D<p.length;D++)this.boundPaintVertexBuffers[D]!==p[D]&&(A=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===c&&!A&&this.boundIndexBuffer===g&&this.boundVertexOffset===v&&this.boundDynamicVertexBuffer===E&&this.boundDynamicVertexBuffer2===S&&this.boundDynamicVertexBuffer3===k?(t.bindVertexArrayOES.set(this.vao),E&&E.bind(),g&&g.dynamicDraw&&g.bind(),S&&S.bind(),k&&k.bind()):this.freshBind(s,c,p,g,v,E,S,k)}freshBind(t,s,c,p,g,v,E,S){let k;const A=t.numAttributes,D=this.context,R=D.gl;if(D.extVertexArrayObject)this.vao&&this.destroy(),this.vao=D.extVertexArrayObject.createVertexArrayOES(),D.bindVertexArrayOES.set(this.vao),k=0,this.boundProgram=t,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=p,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=v,this.boundDynamicVertexBuffer2=E,this.boundDynamicVertexBuffer3=S;else{k=D.currentNumAttributes||0;for(let G=A;G<k;G++)R.disableVertexAttribArray(G)}s.enableAttributes(R,t);for(const G of c)G.enableAttributes(R,t);v&&v.enableAttributes(R,t),E&&E.enableAttributes(R,t),S&&S.enableAttributes(R,t),s.bind(),s.setVertexAttribPointers(R,t,g);for(const G of c)G.bind(),G.setVertexAttribPointers(R,t,g);v&&(v.bind(),v.setVertexAttribPointers(R,t,g)),p&&p.bind(),E&&(E.bind(),E.setVertexAttribPointers(R,t,g)),S&&(S.bind(),S.setVertexAttribPointers(R,t,g)),D.currentNumAttributes=A}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function zl(h){const t=[];for(let s=0;s<h.length;s++){if(h[s]===null)continue;const c=h[s].split(" ");t.push(c.pop())}return t}class bc{constructor(t,s,c,p,g,v,E){const S=t.gl;this.program=S.createProgram();const k=zl(c.staticAttributes),A=p?p.getBinderAttributes():[],D=k.concat(A),R=Ms.prelude.staticUniforms?zl(Ms.prelude.staticUniforms):[],G=c.staticUniforms?zl(c.staticUniforms):[],$=p?p.getBinderUniforms():[],j=R.concat(G).concat($),ee=[];for(const ve of j)ee.indexOf(ve)<0&&ee.push(ve);const re=p?p.defines():[];v&&re.push("#define OVERDRAW_INSPECTOR;"),E&&re.push("#define TERRAIN3D;");const ce=re.concat(Ms.prelude.fragmentSource,c.fragmentSource).join(`
`),W=re.concat(Ms.prelude.vertexSource,c.vertexSource).join(`
`),pe=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(pe,ce),S.compileShader(pe),S.attachShader(this.program,pe);const he=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(he,W),S.compileShader(he),S.attachShader(this.program,he),this.attributes={};const _e={};this.numAttributes=D.length;for(let ve=0;ve<this.numAttributes;ve++)D[ve]&&(S.bindAttribLocation(this.program,ve,D[ve]),this.attributes[D[ve]]=ve);S.linkProgram(this.program),S.deleteShader(he),S.deleteShader(pe);for(let ve=0;ve<ee.length;ve++){const Te=ee[ve];if(Te&&!_e[Te]){const ye=S.getUniformLocation(this.program,Te);ye&&(_e[Te]=ye)}}this.fixedUniforms=g(t,_e),this.terrainUniforms=((ve,Te)=>({u_depth:new u.Uniform1i(ve,Te.u_depth),u_terrain:new u.Uniform1i(ve,Te.u_terrain),u_terrain_dim:new u.Uniform1f(ve,Te.u_terrain_dim),u_terrain_matrix:new u.UniformMatrix4f(ve,Te.u_terrain_matrix),u_terrain_unpack:new u.Uniform4f(ve,Te.u_terrain_unpack),u_terrain_offset:new u.Uniform1f(ve,Te.u_terrain_offset),u_terrain_exaggeration:new u.Uniform1f(ve,Te.u_terrain_exaggeration)}))(t,_e),this.binderUniforms=p?p.getUniforms(t,_e):[]}draw(t,s,c,p,g,v,E,S,k,A,D,R,G,$,j,ee,re,ce){const W=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(c),t.setStencilMode(p),t.setColorMode(g),t.setCullFace(v),S){t.activeTexture.set(W.TEXTURE2),W.bindTexture(W.TEXTURE_2D,S.depthTexture),t.activeTexture.set(W.TEXTURE3),W.bindTexture(W.TEXTURE_2D,S.texture);for(const he in this.terrainUniforms)this.terrainUniforms[he].set(S[he])}for(const he in this.fixedUniforms)this.fixedUniforms[he].set(E[he]);j&&j.setUniforms(t,this.binderUniforms,G,{zoom:$});let pe=0;switch(s){case W.LINES:pe=2;break;case W.TRIANGLES:pe=3;break;case W.LINE_STRIP:pe=1}for(const he of R.get()){const _e=he.vaos||(he.vaos={});(_e[k]||(_e[k]=new Il)).bind(t,this,A,j?j.getPaintVertexBuffers():[],D,he.vertexOffset,ee,re,ce),W.drawElements(s,he.primitiveLength*pe,W.UNSIGNED_SHORT,he.primitiveOffset*pe*2)}}}function Ec(h,t,s){const c=1/Sn(s,1,t.transform.tileZoom),p=Math.pow(2,s.tileID.overscaledZ),g=s.tileSize*Math.pow(2,t.transform.tileZoom)/p,v=g*(s.tileID.canonical.x+s.tileID.wrap*p),E=g*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_scale:[c,h.fromScale,h.toScale],u_fade:h.t,u_pixel_coord_upper:[v>>16,E>>16],u_pixel_coord_lower:[65535&v,65535&E]}}const Al=(h,t,s,c)=>{const p=t.style.light,g=p.properties.get("position"),v=[g.x,g.y,g.z],E=u.create$1();p.properties.get("anchor")==="viewport"&&u.fromRotation(E,-t.transform.angle),u.transformMat3(v,v,E);const S=p.properties.get("color");return{u_matrix:h,u_lightpos:v,u_lightintensity:p.properties.get("intensity"),u_lightcolor:[S.r,S.g,S.b],u_vertical_gradient:+s,u_opacity:c}},Xd=(h,t,s,c,p,g,v)=>u.extend(Al(h,t,s,c),Ec(g,t,v),{u_height_factor:-Math.pow(2,p.overscaledZ)/v.tileSize/8}),wa=h=>({u_matrix:h}),Ml=(h,t,s,c)=>u.extend(wa(h),Ec(s,t,c)),Sc=(h,t)=>({u_matrix:h,u_world:t}),Tc=(h,t,s,c,p)=>u.extend(Ml(h,t,s,c),{u_world:p}),kc=(h,t,s,c)=>{const p=h.transform;let g,v;if(c.paint.get("circle-pitch-alignment")==="map"){const E=Sn(s,1,p.zoom);g=!0,v=[E,E]}else g=!1,v=p.pixelsToGLUnits;return{u_camera_to_center_distance:p.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_matrix:h.translatePosMatrix(t.posMatrix,s,c.paint.get("circle-translate"),c.paint.get("circle-translate-anchor")),u_pitch_with_map:+g,u_device_pixel_ratio:h.pixelRatio,u_extrude_scale:v}},mo=(h,t,s)=>{const c=Sn(s,1,t.zoom),p=Math.pow(2,t.zoom-s.tileID.overscaledZ),g=s.tileID.overscaleFactor();return{u_matrix:h,u_camera_to_center_distance:t.cameraToCenterDistance,u_pixels_to_tile_units:c,u_extrude_scale:[t.pixelsToGLUnits[0]/(c*p),t.pixelsToGLUnits[1]/(c*p)],u_overscale_factor:g}},Ps=(h,t,s=1)=>({u_matrix:h,u_color:t,u_overlay:0,u_overlay_scale:s}),Zo=h=>({u_matrix:h}),ba=(h,t,s,c)=>({u_matrix:h,u_extrude_scale:Sn(t,1,s),u_intensity:c});function Ea(h,t){const s=Math.pow(2,t.canonical.z),c=t.canonical.y;return[new u.MercatorCoordinate(0,c/s).toLngLat().lat,new u.MercatorCoordinate(0,(c+1)/s).toLngLat().lat]}const qo=(h,t,s,c)=>{const p=h.transform;return{u_matrix:Ls(h,t,s,c),u_ratio:1/Sn(t,1,p.zoom),u_device_pixel_ratio:h.pixelRatio,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},Pl=(h,t,s,c,p)=>u.extend(qo(h,t,s,p),{u_image:0,u_image_height:c}),Sa=(h,t,s,c,p)=>{const g=h.transform,v=en(t,g);return{u_matrix:Ls(h,t,s,p),u_texsize:t.imageAtlasTexture.size,u_ratio:1/Sn(t,1,g.zoom),u_device_pixel_ratio:h.pixelRatio,u_image:0,u_scale:[v,c.fromScale,c.toScale],u_fade:c.t,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Ds=(h,t,s,c,p,g)=>{const v=h.lineAtlas,E=en(t,h.transform),S=s.layout.get("line-cap")==="round",k=v.getDash(c.from,S),A=v.getDash(c.to,S),D=k.width*p.fromScale,R=A.width*p.toScale;return u.extend(qo(h,t,s,g),{u_patternscale_a:[E/D,-k.height/2],u_patternscale_b:[E/R,-A.height/2],u_sdfgamma:v.width/(256*Math.min(D,R)*h.pixelRatio)/2,u_image:0,u_tex_y_a:k.y,u_tex_y_b:A.y,u_mix:p.t})};function en(h,t){return 1/Sn(h,1,t.tileZoom)}function Ls(h,t,s,c){return h.translatePosMatrix(c?c.posMatrix:t.tileID.posMatrix,t,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const Cc=(h,t,s,c,p)=>{return{u_matrix:h,u_tl_parent:t,u_scale_parent:s,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(v=p.paint.get("raster-saturation"),v>0?1-1/(1.001-v):-v),u_contrast_factor:(g=p.paint.get("raster-contrast"),g>0?1/(1-g):1+g),u_spin_weights:Ic(p.paint.get("raster-hue-rotate"))};var g,v};function Ic(h){h*=Math.PI/180;const t=Math.sin(h),s=Math.cos(h);return[(2*s+1)/3,(-Math.sqrt(3)*t-s+1)/3,(Math.sqrt(3)*t-s+1)/3]}const Dl=(h,t,s,c,p,g,v,E,S,k)=>{const A=p.transform;return{u_is_size_zoom_constant:+(h==="constant"||h==="source"),u_is_size_feature_constant:+(h==="constant"||h==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:A.cameraToCenterDistance,u_pitch:A.pitch/360*2*Math.PI,u_rotate_symbol:+s,u_aspect_ratio:A.width/A.height,u_fade_change:p.options.fadeDuration?p.symbolFadeChange:1,u_matrix:g,u_label_plane_matrix:v,u_coord_matrix:E,u_is_text:+S,u_pitch_with_map:+c,u_texsize:k,u_texture:0}},Ta=(h,t,s,c,p,g,v,E,S,k,A)=>{const D=p.transform;return u.extend(Dl(h,t,s,c,p,g,v,E,S,k),{u_gamma_scale:c?Math.cos(D._pitch)*D.cameraToCenterDistance:1,u_device_pixel_ratio:p.pixelRatio,u_is_halo:+A})},zc=(h,t,s,c,p,g,v,E,S,k)=>u.extend(Ta(h,t,s,c,p,g,v,E,!0,S,!0),{u_texsize_icon:k,u_texture_icon:1}),Hd=(h,t,s)=>({u_matrix:h,u_opacity:t,u_color:s}),Kd=(h,t,s,c,p,g)=>u.extend(function(v,E,S,k){const A=S.imageManager.getPattern(v.from.toString()),D=S.imageManager.getPattern(v.to.toString()),{width:R,height:G}=S.imageManager.getPixelSize(),$=Math.pow(2,k.tileID.overscaledZ),j=k.tileSize*Math.pow(2,S.transform.tileZoom)/$,ee=j*(k.tileID.canonical.x+k.tileID.wrap*$),re=j*k.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:A.tl,u_pattern_br_a:A.br,u_pattern_tl_b:D.tl,u_pattern_br_b:D.br,u_texsize:[R,G],u_mix:E.t,u_pattern_size_a:A.displaySize,u_pattern_size_b:D.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/Sn(k,1,S.transform.tileZoom),u_pixel_coord_upper:[ee>>16,re>>16],u_pixel_coord_lower:[65535&ee,65535&re]}}(c,g,s,p),{u_matrix:h,u_opacity:t}),Ll={fillExtrusion:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_lightpos:new u.Uniform3f(h,t.u_lightpos),u_lightintensity:new u.Uniform1f(h,t.u_lightintensity),u_lightcolor:new u.Uniform3f(h,t.u_lightcolor),u_vertical_gradient:new u.Uniform1f(h,t.u_vertical_gradient),u_opacity:new u.Uniform1f(h,t.u_opacity)}),fillExtrusionPattern:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_lightpos:new u.Uniform3f(h,t.u_lightpos),u_lightintensity:new u.Uniform1f(h,t.u_lightintensity),u_lightcolor:new u.Uniform3f(h,t.u_lightcolor),u_vertical_gradient:new u.Uniform1f(h,t.u_vertical_gradient),u_height_factor:new u.Uniform1f(h,t.u_height_factor),u_image:new u.Uniform1i(h,t.u_image),u_texsize:new u.Uniform2f(h,t.u_texsize),u_pixel_coord_upper:new u.Uniform2f(h,t.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(h,t.u_pixel_coord_lower),u_scale:new u.Uniform3f(h,t.u_scale),u_fade:new u.Uniform1f(h,t.u_fade),u_opacity:new u.Uniform1f(h,t.u_opacity)}),fill:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix)}),fillPattern:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_image:new u.Uniform1i(h,t.u_image),u_texsize:new u.Uniform2f(h,t.u_texsize),u_pixel_coord_upper:new u.Uniform2f(h,t.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(h,t.u_pixel_coord_lower),u_scale:new u.Uniform3f(h,t.u_scale),u_fade:new u.Uniform1f(h,t.u_fade)}),fillOutline:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_world:new u.Uniform2f(h,t.u_world)}),fillOutlinePattern:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_world:new u.Uniform2f(h,t.u_world),u_image:new u.Uniform1i(h,t.u_image),u_texsize:new u.Uniform2f(h,t.u_texsize),u_pixel_coord_upper:new u.Uniform2f(h,t.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(h,t.u_pixel_coord_lower),u_scale:new u.Uniform3f(h,t.u_scale),u_fade:new u.Uniform1f(h,t.u_fade)}),circle:(h,t)=>({u_camera_to_center_distance:new u.Uniform1f(h,t.u_camera_to_center_distance),u_scale_with_map:new u.Uniform1i(h,t.u_scale_with_map),u_pitch_with_map:new u.Uniform1i(h,t.u_pitch_with_map),u_extrude_scale:new u.Uniform2f(h,t.u_extrude_scale),u_device_pixel_ratio:new u.Uniform1f(h,t.u_device_pixel_ratio),u_matrix:new u.UniformMatrix4f(h,t.u_matrix)}),collisionBox:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_camera_to_center_distance:new u.Uniform1f(h,t.u_camera_to_center_distance),u_pixels_to_tile_units:new u.Uniform1f(h,t.u_pixels_to_tile_units),u_extrude_scale:new u.Uniform2f(h,t.u_extrude_scale),u_overscale_factor:new u.Uniform1f(h,t.u_overscale_factor)}),collisionCircle:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_inv_matrix:new u.UniformMatrix4f(h,t.u_inv_matrix),u_camera_to_center_distance:new u.Uniform1f(h,t.u_camera_to_center_distance),u_viewport_size:new u.Uniform2f(h,t.u_viewport_size)}),debug:(h,t)=>({u_color:new u.UniformColor(h,t.u_color),u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_overlay:new u.Uniform1i(h,t.u_overlay),u_overlay_scale:new u.Uniform1f(h,t.u_overlay_scale)}),clippingMask:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix)}),heatmap:(h,t)=>({u_extrude_scale:new u.Uniform1f(h,t.u_extrude_scale),u_intensity:new u.Uniform1f(h,t.u_intensity),u_matrix:new u.UniformMatrix4f(h,t.u_matrix)}),heatmapTexture:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_world:new u.Uniform2f(h,t.u_world),u_image:new u.Uniform1i(h,t.u_image),u_color_ramp:new u.Uniform1i(h,t.u_color_ramp),u_opacity:new u.Uniform1f(h,t.u_opacity)}),hillshade:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_image:new u.Uniform1i(h,t.u_image),u_latrange:new u.Uniform2f(h,t.u_latrange),u_light:new u.Uniform2f(h,t.u_light),u_shadow:new u.UniformColor(h,t.u_shadow),u_highlight:new u.UniformColor(h,t.u_highlight),u_accent:new u.UniformColor(h,t.u_accent)}),hillshadePrepare:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_image:new u.Uniform1i(h,t.u_image),u_dimension:new u.Uniform2f(h,t.u_dimension),u_zoom:new u.Uniform1f(h,t.u_zoom),u_unpack:new u.Uniform4f(h,t.u_unpack)}),line:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_ratio:new u.Uniform1f(h,t.u_ratio),u_device_pixel_ratio:new u.Uniform1f(h,t.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(h,t.u_units_to_pixels)}),lineGradient:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_ratio:new u.Uniform1f(h,t.u_ratio),u_device_pixel_ratio:new u.Uniform1f(h,t.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(h,t.u_units_to_pixels),u_image:new u.Uniform1i(h,t.u_image),u_image_height:new u.Uniform1f(h,t.u_image_height)}),linePattern:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_texsize:new u.Uniform2f(h,t.u_texsize),u_ratio:new u.Uniform1f(h,t.u_ratio),u_device_pixel_ratio:new u.Uniform1f(h,t.u_device_pixel_ratio),u_image:new u.Uniform1i(h,t.u_image),u_units_to_pixels:new u.Uniform2f(h,t.u_units_to_pixels),u_scale:new u.Uniform3f(h,t.u_scale),u_fade:new u.Uniform1f(h,t.u_fade)}),lineSDF:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_ratio:new u.Uniform1f(h,t.u_ratio),u_device_pixel_ratio:new u.Uniform1f(h,t.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(h,t.u_units_to_pixels),u_patternscale_a:new u.Uniform2f(h,t.u_patternscale_a),u_patternscale_b:new u.Uniform2f(h,t.u_patternscale_b),u_sdfgamma:new u.Uniform1f(h,t.u_sdfgamma),u_image:new u.Uniform1i(h,t.u_image),u_tex_y_a:new u.Uniform1f(h,t.u_tex_y_a),u_tex_y_b:new u.Uniform1f(h,t.u_tex_y_b),u_mix:new u.Uniform1f(h,t.u_mix)}),raster:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_tl_parent:new u.Uniform2f(h,t.u_tl_parent),u_scale_parent:new u.Uniform1f(h,t.u_scale_parent),u_buffer_scale:new u.Uniform1f(h,t.u_buffer_scale),u_fade_t:new u.Uniform1f(h,t.u_fade_t),u_opacity:new u.Uniform1f(h,t.u_opacity),u_image0:new u.Uniform1i(h,t.u_image0),u_image1:new u.Uniform1i(h,t.u_image1),u_brightness_low:new u.Uniform1f(h,t.u_brightness_low),u_brightness_high:new u.Uniform1f(h,t.u_brightness_high),u_saturation_factor:new u.Uniform1f(h,t.u_saturation_factor),u_contrast_factor:new u.Uniform1f(h,t.u_contrast_factor),u_spin_weights:new u.Uniform3f(h,t.u_spin_weights)}),symbolIcon:(h,t)=>({u_is_size_zoom_constant:new u.Uniform1i(h,t.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(h,t.u_is_size_feature_constant),u_size_t:new u.Uniform1f(h,t.u_size_t),u_size:new u.Uniform1f(h,t.u_size),u_camera_to_center_distance:new u.Uniform1f(h,t.u_camera_to_center_distance),u_pitch:new u.Uniform1f(h,t.u_pitch),u_rotate_symbol:new u.Uniform1i(h,t.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(h,t.u_aspect_ratio),u_fade_change:new u.Uniform1f(h,t.u_fade_change),u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(h,t.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(h,t.u_coord_matrix),u_is_text:new u.Uniform1i(h,t.u_is_text),u_pitch_with_map:new u.Uniform1i(h,t.u_pitch_with_map),u_texsize:new u.Uniform2f(h,t.u_texsize),u_texture:new u.Uniform1i(h,t.u_texture)}),symbolSDF:(h,t)=>({u_is_size_zoom_constant:new u.Uniform1i(h,t.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(h,t.u_is_size_feature_constant),u_size_t:new u.Uniform1f(h,t.u_size_t),u_size:new u.Uniform1f(h,t.u_size),u_camera_to_center_distance:new u.Uniform1f(h,t.u_camera_to_center_distance),u_pitch:new u.Uniform1f(h,t.u_pitch),u_rotate_symbol:new u.Uniform1i(h,t.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(h,t.u_aspect_ratio),u_fade_change:new u.Uniform1f(h,t.u_fade_change),u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(h,t.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(h,t.u_coord_matrix),u_is_text:new u.Uniform1i(h,t.u_is_text),u_pitch_with_map:new u.Uniform1i(h,t.u_pitch_with_map),u_texsize:new u.Uniform2f(h,t.u_texsize),u_texture:new u.Uniform1i(h,t.u_texture),u_gamma_scale:new u.Uniform1f(h,t.u_gamma_scale),u_device_pixel_ratio:new u.Uniform1f(h,t.u_device_pixel_ratio),u_is_halo:new u.Uniform1i(h,t.u_is_halo)}),symbolTextAndIcon:(h,t)=>({u_is_size_zoom_constant:new u.Uniform1i(h,t.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(h,t.u_is_size_feature_constant),u_size_t:new u.Uniform1f(h,t.u_size_t),u_size:new u.Uniform1f(h,t.u_size),u_camera_to_center_distance:new u.Uniform1f(h,t.u_camera_to_center_distance),u_pitch:new u.Uniform1f(h,t.u_pitch),u_rotate_symbol:new u.Uniform1i(h,t.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(h,t.u_aspect_ratio),u_fade_change:new u.Uniform1f(h,t.u_fade_change),u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(h,t.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(h,t.u_coord_matrix),u_is_text:new u.Uniform1i(h,t.u_is_text),u_pitch_with_map:new u.Uniform1i(h,t.u_pitch_with_map),u_texsize:new u.Uniform2f(h,t.u_texsize),u_texsize_icon:new u.Uniform2f(h,t.u_texsize_icon),u_texture:new u.Uniform1i(h,t.u_texture),u_texture_icon:new u.Uniform1i(h,t.u_texture_icon),u_gamma_scale:new u.Uniform1f(h,t.u_gamma_scale),u_device_pixel_ratio:new u.Uniform1f(h,t.u_device_pixel_ratio),u_is_halo:new u.Uniform1i(h,t.u_is_halo)}),background:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_opacity:new u.Uniform1f(h,t.u_opacity),u_color:new u.UniformColor(h,t.u_color)}),backgroundPattern:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_opacity:new u.Uniform1f(h,t.u_opacity),u_image:new u.Uniform1i(h,t.u_image),u_pattern_tl_a:new u.Uniform2f(h,t.u_pattern_tl_a),u_pattern_br_a:new u.Uniform2f(h,t.u_pattern_br_a),u_pattern_tl_b:new u.Uniform2f(h,t.u_pattern_tl_b),u_pattern_br_b:new u.Uniform2f(h,t.u_pattern_br_b),u_texsize:new u.Uniform2f(h,t.u_texsize),u_mix:new u.Uniform1f(h,t.u_mix),u_pattern_size_a:new u.Uniform2f(h,t.u_pattern_size_a),u_pattern_size_b:new u.Uniform2f(h,t.u_pattern_size_b),u_scale_a:new u.Uniform1f(h,t.u_scale_a),u_scale_b:new u.Uniform1f(h,t.u_scale_b),u_pixel_coord_upper:new u.Uniform2f(h,t.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(h,t.u_pixel_coord_lower),u_tile_units_to_pixels:new u.Uniform1f(h,t.u_tile_units_to_pixels)}),terrain:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_texture:new u.Uniform1i(h,t.u_texture)}),terrainDepth:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix)}),terrainCoords:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_texture:new u.Uniform1i(h,t.u_texture),u_terrain_coords_id:new u.Uniform1f(h,t.u_terrain_coords_id)})};class Rl{constructor(t,s,c){this.context=t;const p=t.gl;this.buffer=p.createBuffer(),this.dynamicDraw=Boolean(c),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const s=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Bl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Fl{constructor(t,s,c,p){this.length=s.length,this.attributes=c,this.itemSize=s.bytesPerElement,this.dynamicDraw=p,this.context=t;const g=t.gl;this.buffer=g.createBuffer(),t.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,s){for(let c=0;c<this.attributes.length;c++){const p=s.attributes[this.attributes[c].name];p!==void 0&&t.enableVertexAttribArray(p)}}setVertexAttribPointers(t,s,c){for(let p=0;p<this.attributes.length;p++){const g=this.attributes[p],v=s.attributes[g.name];v!==void 0&&t.vertexAttribPointer(v,g.components,t[Bl[g.type]],!1,this.itemSize,g.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Lt{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ac extends Lt{getDefault(){return u.Color.transparent}set(t){const s=this.current;(t.r!==s.r||t.g!==s.g||t.b!==s.b||t.a!==s.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Yd extends Lt{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Rs extends Lt{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Bs extends Lt{getDefault(){return[!0,!0,!0,!0]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||t[3]!==s[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Mc extends Lt{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Pr extends Lt{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Ol extends Lt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const s=this.current;(t.func!==s.func||t.ref!==s.ref||t.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class ka extends Lt{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Ca extends Lt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=t,this.dirty=!1}}class Nl extends Lt{getDefault(){return[0,1]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Ul extends Lt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=t,this.dirty=!1}}class Ia extends Lt{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Vl extends Lt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.BLEND):s.disable(s.BLEND),this.current=t,this.dirty=!1}}class $l extends Lt{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class za extends Lt{getDefault(){return u.Color.transparent}set(t){const s=this.current;(t.r!==s.r||t.g!==s.g||t.b!==s.b||t.a!==s.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Pc extends Lt{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class Dc extends Lt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=t,this.dirty=!1}}class Wo extends Lt{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Jd extends Lt{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class Qd extends Lt{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class ep extends Lt{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class tp extends Lt{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||t[3]!==s[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class np extends Lt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class rp extends Lt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class jl extends Lt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Aa extends Lt{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Gl extends Lt{getDefault(){return null}set(t){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Zl extends Lt{constructor(t){super(t),this.vao=t.extVertexArrayObject}getDefault(){return null}set(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)}}class Xo extends Lt{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Lc extends Lt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Rc extends Lt{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Ma extends Lt{constructor(t,s){super(t),this.context=t,this.parent=s}getDefault(){return null}}class go extends Ma{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Bc extends Ma{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Ho{constructor(t,s,c,p){this.context=t,this.width=s,this.height=c;const g=t.gl,v=this.framebuffer=g.createFramebuffer();if(this.colorAttachment=new go(t,v),p&&(this.depthAttachment=new Bc(t,v)),g.checkFramebufferStatus(g.FRAMEBUFFER)!==g.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,s=this.colorAttachment.get();if(s&&t.deleteTexture(s),this.depthAttachment){const c=this.depthAttachment.get();c&&t.deleteRenderbuffer(c)}t.deleteFramebuffer(this.framebuffer)}}class Yt{constructor(t,s,c){this.blendFunction=t,this.blendColor=s,this.mask=c}}Yt.Replace=[1,0],Yt.disabled=new Yt(Yt.Replace,u.Color.transparent,[!1,!1,!1,!1]),Yt.unblended=new Yt(Yt.Replace,u.Color.transparent,[!0,!0,!0,!0]),Yt.alphaBlended=new Yt([1,771],u.Color.transparent,[!0,!0,!0,!0]);class Fc{constructor(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Ac(this),this.clearDepth=new Yd(this),this.clearStencil=new Rs(this),this.colorMask=new Bs(this),this.depthMask=new Mc(this),this.stencilMask=new Pr(this),this.stencilFunc=new Ol(this),this.stencilOp=new ka(this),this.stencilTest=new Ca(this),this.depthRange=new Nl(this),this.depthTest=new Ul(this),this.depthFunc=new Ia(this),this.blend=new Vl(this),this.blendFunc=new $l(this),this.blendColor=new za(this),this.blendEquation=new Pc(this),this.cullFace=new Dc(this),this.cullFaceSide=new Wo(this),this.frontFace=new Jd(this),this.program=new Qd(this),this.activeTexture=new ep(this),this.viewport=new tp(this),this.bindFramebuffer=new np(this),this.bindRenderbuffer=new rp(this),this.bindTexture=new jl(this),this.bindVertexBuffer=new Aa(this),this.bindElementBuffer=new Gl(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Zl(this),this.pixelStoreUnpack=new Xo(this),this.pixelStoreUnpackPremultiplyAlpha=new Lc(this),this.pixelStoreUnpackFlipY=new Rc(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,s){return new Rl(this,t,s)}createVertexBuffer(t,s,c){return new Fl(this,t,s,c)}createRenderbuffer(t,s,c){const p=this.gl,g=p.createRenderbuffer();return this.bindRenderbuffer.set(g),p.renderbufferStorage(p.RENDERBUFFER,t,s,c),this.bindRenderbuffer.set(null),g}createFramebuffer(t,s,c){return new Ho(this,t,s,c)}clear({color:t,depth:s}){const c=this.gl;let p=0;t&&(p|=c.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),s!==void 0&&(p|=c.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),c.clear(p)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){oe(t.blendFunction,Yt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class St{constructor(t,s,c){this.func=t,this.mask=s,this.range=c}}St.ReadOnly=!1,St.ReadWrite=!0,St.disabled=new St(519,St.ReadOnly,[0,1]);const Rt=7680;class Ht{constructor(t,s,c,p,g,v){this.test=t,this.ref=s,this.mask=c,this.fail=p,this.depthFail=g,this.pass=v}}Ht.disabled=new Ht({func:519,mask:0},0,0,Rt,Rt,Rt);class tn{constructor(t,s,c){this.enable=t,this.mode=s,this.frontFace=c}}let Fs;function Ko(h,t,s,c,p,g,v){const E=h.context,S=E.gl,k=h.useProgram("collisionBox"),A=[];let D=0,R=0;for(let W=0;W<c.length;W++){const pe=c[W],he=t.getTile(pe),_e=he.getBucket(s);if(!_e)continue;let ve=pe.posMatrix;p[0]===0&&p[1]===0||(ve=h.translatePosMatrix(pe.posMatrix,he,p,g));const Te=v?_e.textCollisionBox:_e.iconCollisionBox,ye=_e.collisionCircleArray;if(ye.length>0){const Ge=u.create(),Be=ve;u.mul(Ge,_e.placementInvProjMatrix,h.transform.glCoordMatrix),u.mul(Ge,Ge,_e.placementViewportMatrix),A.push({circleArray:ye,circleOffset:R,transform:Be,invTransform:Ge,coord:pe}),D+=ye.length/4,R=D}Te&&k.draw(E,S.LINES,St.disabled,Ht.disabled,h.colorModeForRenderPass(),tn.disabled,mo(ve,h.transform,he),h.style.terrain&&h.style.terrain.getTerrainData(pe),s.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,null,h.transform.zoom,null,null,Te.collisionVertexBuffer)}if(!v||!A.length)return;const G=h.useProgram("collisionCircle"),$=new u.CollisionCircleLayoutArray;$.resize(4*D),$._trim();let j=0;for(const W of A)for(let pe=0;pe<W.circleArray.length/4;pe++){const he=4*pe,_e=W.circleArray[he+0],ve=W.circleArray[he+1],Te=W.circleArray[he+2],ye=W.circleArray[he+3];$.emplace(j++,_e,ve,Te,ye,0),$.emplace(j++,_e,ve,Te,ye,1),$.emplace(j++,_e,ve,Te,ye,2),$.emplace(j++,_e,ve,Te,ye,3)}(!Fs||Fs.length<2*D)&&(Fs=function(W){const pe=2*W,he=new u.QuadTriangleArray;he.resize(pe),he._trim();for(let _e=0;_e<pe;_e++){const ve=6*_e;he.uint16[ve+0]=4*_e+0,he.uint16[ve+1]=4*_e+1,he.uint16[ve+2]=4*_e+2,he.uint16[ve+3]=4*_e+2,he.uint16[ve+4]=4*_e+3,he.uint16[ve+5]=4*_e+0}return he}(D));const ee=E.createIndexBuffer(Fs,!0),re=E.createVertexBuffer($,u.collisionCircleLayout.members,!0);for(const W of A){const pe={u_matrix:W.transform,u_inv_matrix:W.invTransform,u_camera_to_center_distance:(ce=h.transform).cameraToCenterDistance,u_viewport_size:[ce.width,ce.height]};G.draw(E,S.TRIANGLES,St.disabled,Ht.disabled,h.colorModeForRenderPass(),tn.disabled,pe,h.style.terrain&&h.style.terrain.getTerrainData(W.coord),s.id,re,ee,u.SegmentVector.simpleSegment(0,2*W.circleOffset,W.circleArray.length,W.circleArray.length/2),null,h.transform.zoom,null,null,null)}var ce;re.destroy(),ee.destroy()}tn.disabled=new tn(!1,1029,2305),tn.backCCW=new tn(!0,1029,2305);const ip=u.identity(new Float32Array(16));function op(h,t,s,c,p,g){const{horizontalAlign:v,verticalAlign:E}=u.getAnchorAlignment(h),S=-(v-.5)*t,k=-(E-.5)*s,A=u.evaluateVariableOffset(h,c);return new u.pointGeometry((S/p+A[0])*g,(k/p+A[1])*g)}function Oc(h,t,s,c,p,g,v,E,S,k,A){const D=h.text.placedSymbolArray,R=h.text.dynamicLayoutVertexArray,G=h.icon.dynamicLayoutVertexArray,$={};R.clear();for(let j=0;j<D.length;j++){const ee=D.get(j),re=h.allowVerticalPlacement&&!ee.placedOrientation,ce=ee.hidden||!ee.crossTileID||re?null:c[ee.crossTileID];if(ce){const W=new u.pointGeometry(ee.anchorX,ee.anchorY),pe=It(W,s?v:g,A),he=Gr(p.cameraToCenterDistance,pe.signedDistanceFromCamera);let _e=u.evaluateSizeForFeature(h.textSizeData,S,ee)*he/u.ONE_EM;s&&(_e*=h.tilePixelRatio/E);const{width:ve,height:Te,anchor:ye,textOffset:Ge,textBoxScale:Be}=ce,qe=op(ye,ve,Te,Ge,Be,_e),gt=s?It(W.add(qe),g,A).point:pe.point.add(t?qe.rotate(-p.angle):qe),vt=h.allowVerticalPlacement&&ee.placedOrientation===u.WritingMode.vertical?Math.PI/2:0;for(let it=0;it<ee.numGlyphs;it++)u.addDynamicAttributes(R,gt,vt);k&&ee.associatedIconIndex>=0&&($[ee.associatedIconIndex]={shiftedAnchor:gt,angle:vt})}else ft(ee.numGlyphs,R)}if(k){G.clear();const j=h.icon.placedSymbolArray;for(let ee=0;ee<j.length;ee++){const re=j.get(ee);if(re.hidden)ft(re.numGlyphs,G);else{const ce=$[ee];if(ce)for(let W=0;W<re.numGlyphs;W++)u.addDynamicAttributes(G,ce.shiftedAnchor,ce.angle);else ft(re.numGlyphs,G)}}h.icon.dynamicLayoutVertexBuffer.updateData(G)}h.text.dynamicLayoutVertexBuffer.updateData(R)}function sp(h,t,s){return s.iconsInText&&t?"symbolTextAndIcon":h?"symbolSDF":"symbolIcon"}function Pa(h,t,s,c,p,g,v,E,S,k,A,D){const R=h.context,G=R.gl,$=h.transform,j=E==="map",ee=S==="map",re=E!=="viewport"&&s.layout.get("symbol-placement")!=="point",ce=j&&!ee&&!re,W=!s.layout.get("symbol-sort-key").isConstant();let pe=!1;const he=h.depthModeForSublayer(0,St.ReadOnly),_e=s.layout.get("text-variable-anchor"),ve=[];for(const Te of c){const ye=t.getTile(Te),Ge=ye.getBucket(s);if(!Ge)continue;const Be=p?Ge.text:Ge.icon;if(!Be||!Be.segments.get().length)continue;const qe=Be.programConfigurations.get(s.id),gt=p||Ge.sdfIcons,vt=p?Ge.textSizeData:Ge.iconSizeData,it=ee||$.pitch!==0,Ft=h.useProgram(sp(gt,p,Ge),qe),Ot=u.evaluateSizeForZoom(vt,$.zoom),kt=h.style.terrain&&h.style.terrain.getTerrainData(Te);let Mt,$t,Nn,xi,oi=[0,0],wi=null;if(p){if($t=ye.glyphAtlasTexture,Nn=G.LINEAR,Mt=ye.glyphAtlasTexture.size,Ge.iconsInText){oi=ye.imageAtlasTexture.size,wi=ye.imageAtlasTexture;const Wr=vt.kind==="composite"||vt.kind==="camera";xi=it||h.options.rotating||h.options.zooming||Wr?G.LINEAR:G.NEAREST}}else{const Wr=s.layout.get("icon-size").constantOr(0)!==1||Ge.iconsNeedLinear;$t=ye.imageAtlasTexture,Nn=gt||h.options.rotating||h.options.zooming||Wr||it?G.LINEAR:G.NEAREST,Mt=ye.imageAtlasTexture.size}const no=Sn(ye,1,h.transform.zoom),qr=co(Te.posMatrix,ee,j,h.transform,no),vr=ri(Te.posMatrix,ee,j,h.transform,no),Di=_e&&Ge.hasTextData(),Ua=s.layout.get("icon-text-fit")!=="none"&&Di&&Ge.hasIconData();if(re){const Wr=h.style.terrain?(su,ns)=>h.style.terrain.getElevation(Te,su,ns):null,xo=s.layout.get("text-rotation-alignment")==="map";Mr(Ge,Te.posMatrix,h,p,qr,vr,ee,k,xo,Wr)}const Mn=h.translatePosMatrix(Te.posMatrix,ye,g,v),bt=re||p&&_e||Ua?ip:qr,Bt=h.translatePosMatrix(vr,ye,g,v,!0),Un=gt&&s.paint.get(p?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Vn;Vn=gt?Ge.iconsInText?zc(vt.kind,Ot,ce,ee,h,Mn,bt,Bt,Mt,oi):Ta(vt.kind,Ot,ce,ee,h,Mn,bt,Bt,p,Mt,!0):Dl(vt.kind,Ot,ce,ee,h,Mn,bt,Bt,p,Mt);const rn={program:Ft,buffers:Be,uniformValues:Vn,atlasTexture:$t,atlasTextureIcon:wi,atlasInterpolation:Nn,atlasInterpolationIcon:xi,isSDF:gt,hasHalo:Un};if(W&&Ge.canOverlap){pe=!0;const Wr=Be.segments.get();for(const xo of Wr)ve.push({segments:new u.SegmentVector([xo]),sortKey:xo.sortKey,state:rn,terrainData:kt})}else ve.push({segments:Be.segments,sortKey:0,state:rn,terrainData:kt})}pe&&ve.sort((Te,ye)=>Te.sortKey-ye.sortKey);for(const Te of ve){const ye=Te.state;if(R.activeTexture.set(G.TEXTURE0),ye.atlasTexture.bind(ye.atlasInterpolation,G.CLAMP_TO_EDGE),ye.atlasTextureIcon&&(R.activeTexture.set(G.TEXTURE1),ye.atlasTextureIcon&&ye.atlasTextureIcon.bind(ye.atlasInterpolationIcon,G.CLAMP_TO_EDGE)),ye.isSDF){const Ge=ye.uniformValues;ye.hasHalo&&(Ge.u_is_halo=1,Os(ye.buffers,Te.segments,s,h,ye.program,he,A,D,Ge,Te.terrainData)),Ge.u_is_halo=0}Os(ye.buffers,Te.segments,s,h,ye.program,he,A,D,ye.uniformValues,Te.terrainData)}}function Os(h,t,s,c,p,g,v,E,S,k){const A=c.context;p.draw(A,A.gl.TRIANGLES,g,v,E,tn.disabled,S,k,s.id,h.layoutVertexBuffer,h.indexBuffer,t,s.paint,c.transform.zoom,h.programConfigurations.get(s.id),h.dynamicLayoutVertexBuffer,h.opacityVertexBuffer)}function Ns(h,t,s,c,p,g,v){const E=h.context.gl,S=s.paint.get("fill-pattern"),k=S&&S.constantOr(1),A=s.getCrossfadeParameters();let D,R,G,$,j;v?(R=k&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",D=E.LINES):(R=k?"fillPattern":"fill",D=E.TRIANGLES);for(const ee of c){const re=t.getTile(ee);if(k&&!re.patternsLoaded())continue;const ce=re.getBucket(s);if(!ce)continue;const W=ce.programConfigurations.get(s.id),pe=h.useProgram(R,W),he=h.style.terrain&&h.style.terrain.getTerrainData(ee);k&&(h.context.activeTexture.set(E.TEXTURE0),re.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),W.updatePaintBuffers(A));const _e=S.constantOr(null);if(_e&&re.imageAtlas){const ye=re.imageAtlas,Ge=ye.patternPositions[_e.to.toString()],Be=ye.patternPositions[_e.from.toString()];Ge&&Be&&W.setConstantPatternPositions(Ge,Be)}const ve=he?ee:null,Te=h.translatePosMatrix(ve?ve.posMatrix:ee.posMatrix,re,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor"));if(v){$=ce.indexBuffer2,j=ce.segments2;const ye=[E.drawingBufferWidth,E.drawingBufferHeight];G=R==="fillOutlinePattern"&&k?Tc(Te,h,A,re,ye):Sc(Te,ye)}else $=ce.indexBuffer,j=ce.segments,G=k?Ml(Te,h,A,re):wa(Te);pe.draw(h.context,D,p,h.stencilModeForClipping(ee),g,tn.disabled,G,he,s.id,ce.layoutVertexBuffer,$,j,s.paint,h.transform.zoom,W)}}function Us(h,t,s,c,p,g,v){const E=h.context,S=E.gl,k=s.paint.get("fill-extrusion-pattern"),A=k.constantOr(1),D=s.getCrossfadeParameters(),R=s.paint.get("fill-extrusion-opacity");for(const G of c){const $=t.getTile(G),j=$.getBucket(s);if(!j)continue;const ee=h.style.terrain&&h.style.terrain.getTerrainData(G),re=j.programConfigurations.get(s.id),ce=h.useProgram(A?"fillExtrusionPattern":"fillExtrusion",re);A&&(h.context.activeTexture.set(S.TEXTURE0),$.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),re.updatePaintBuffers(D));const W=k.constantOr(null);if(W&&$.imageAtlas){const ve=$.imageAtlas,Te=ve.patternPositions[W.to.toString()],ye=ve.patternPositions[W.from.toString()];Te&&ye&&re.setConstantPatternPositions(Te,ye)}const pe=h.translatePosMatrix(G.posMatrix,$,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),he=s.paint.get("fill-extrusion-vertical-gradient"),_e=A?Xd(pe,h,he,R,G,D,$):Al(pe,h,he,R);ce.draw(E,E.gl.TRIANGLES,p,g,v,tn.backCCW,_e,ee,s.id,j.layoutVertexBuffer,j.indexBuffer,j.segments,s.paint,h.transform.zoom,re,h.style.terrain&&j.centroidVertexBuffer)}}function ql(h,t,s,c,p,g,v){const E=h.context,S=E.gl,k=s.fbo;if(!k)return;const A=h.useProgram("hillshade"),D=h.style.terrain&&h.style.terrain.getTerrainData(t);E.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,k.colorAttachment.get()),A.draw(E,S.TRIANGLES,p,g,v,tn.disabled,((R,G,$,j)=>{const ee=$.paint.get("hillshade-shadow-color"),re=$.paint.get("hillshade-highlight-color"),ce=$.paint.get("hillshade-accent-color");let W=$.paint.get("hillshade-illumination-direction")*(Math.PI/180);$.paint.get("hillshade-illumination-anchor")==="viewport"&&(W-=R.transform.angle);const pe=!R.options.moving;return{u_matrix:j?j.posMatrix:R.transform.calculatePosMatrix(G.tileID.toUnwrapped(),pe),u_image:0,u_latrange:Ea(0,G.tileID),u_light:[$.paint.get("hillshade-exaggeration"),W],u_shadow:ee,u_highlight:re,u_accent:ce}})(h,s,c,D?t:null),D,c.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments)}function Nc(h,t,s,c,p,g){const v=h.context,E=v.gl,S=t.dem;if(S&&S.data){const k=S.dim,A=S.stride,D=S.getPixels();if(v.activeTexture.set(E.TEXTURE1),v.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||h.getTileTexture(A),t.demTexture){const G=t.demTexture;G.update(D,{premultiply:!1}),G.bind(E.NEAREST,E.CLAMP_TO_EDGE)}else t.demTexture=new ke(v,D,E.RGBA,{premultiply:!1}),t.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE);v.activeTexture.set(E.TEXTURE0);let R=t.fbo;if(!R){const G=new ke(v,{width:k,height:k,data:null},E.RGBA);G.bind(E.LINEAR,E.CLAMP_TO_EDGE),R=t.fbo=v.createFramebuffer(k,k,!0),R.colorAttachment.set(G.texture)}v.bindFramebuffer.set(R.framebuffer),v.viewport.set([0,0,k,k]),h.useProgram("hillshadePrepare").draw(v,E.TRIANGLES,c,p,g,tn.disabled,((G,$)=>{const j=$.stride,ee=u.create();return u.ortho(ee,0,u.EXTENT,-u.EXTENT,0,0,1),u.translate(ee,ee,[0,-u.EXTENT,0]),{u_matrix:ee,u_image:1,u_dimension:[j,j],u_zoom:G.overscaledZ,u_unpack:$.getUnpackVector()}})(t.tileID,S),null,s.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments),t.needsHillshadePrepare=!1}}function Da(h,t,s,c,p,g){const v=c.paint.get("raster-fade-duration");if(!g&&v>0){const E=u.exported.now(),S=(E-h.timeAdded)/v,k=t?(E-t.timeAdded)/v:-1,A=s.getSource(),D=p.coveringZoomLevel({tileSize:A.tileSize,roundZoom:A.roundZoom}),R=!t||Math.abs(t.tileID.overscaledZ-D)>Math.abs(h.tileID.overscaledZ-D),G=R&&h.refreshedUponExpiration?1:u.clamp(R?S:1-k,0,1);return h.refreshedUponExpiration&&S>=1&&(h.refreshedUponExpiration=!1),t?{opacity:1,mix:1-G}:{opacity:G,mix:0}}return{opacity:1,mix:0}}const La=new u.Color(1,0,0,1),ii=new u.Color(0,1,0,1),Uc=new u.Color(0,0,1,1),Wl=new u.Color(1,0,1,1),Vc=new u.Color(0,1,1,1);function yo(h,t,s,c){Yo(h,0,t+s/2,h.transform.width,s,c)}function Vs(h,t,s,c){Yo(h,t-s/2,0,s,h.transform.height,c)}function Yo(h,t,s,c,p,g){const v=h.context,E=v.gl;E.enable(E.SCISSOR_TEST),E.scissor(t*h.pixelRatio,s*h.pixelRatio,c*h.pixelRatio,p*h.pixelRatio),v.clear({color:g}),E.disable(E.SCISSOR_TEST)}function ap(h,t,s){const c=h.context,p=c.gl,g=s.posMatrix,v=h.useProgram("debug"),E=St.disabled,S=Ht.disabled,k=h.colorModeForRenderPass(),A="$debug",D=h.style.terrain&&h.style.terrain.getTerrainData(s);c.activeTexture.set(p.TEXTURE0),h.emptyTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE);const R=t.getTileByID(s.key).latestRawTileData,G=Math.floor((R&&R.byteLength||0)/1024),$=t.getTile(s).tileSize,j=512/Math.min($,512)*(s.overscaledZ/h.transform.zoom)*.5;let ee=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(ee+=` => ${s.overscaledZ}`),function(re,ce){re.initDebugOverlayCanvas();const W=re.debugOverlayCanvas,pe=re.context.gl,he=re.debugOverlayCanvas.getContext("2d");he.clearRect(0,0,W.width,W.height),he.shadowColor="white",he.shadowBlur=2,he.lineWidth=1.5,he.strokeStyle="white",he.textBaseline="top",he.font="bold 36px Open Sans, sans-serif",he.fillText(ce,5,5),he.strokeText(ce,5,5),re.debugOverlayTexture.update(W),re.debugOverlayTexture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE)}(h,`${ee} ${G}kB`),v.draw(c,p.TRIANGLES,E,S,Yt.alphaBlended,tn.disabled,Ps(g,u.Color.transparent,j),null,A,h.debugBuffer,h.quadTriangleIndexBuffer,h.debugSegments),v.draw(c,p.LINE_STRIP,E,S,k,tn.disabled,Ps(g,u.Color.red),D,A,h.debugBuffer,h.tileBorderIndexBuffer,h.debugSegments)}function Ra(h,t,s){const c=h.context,p=c.gl,g=h.colorModeForRenderPass(),v=new St(p.LEQUAL,St.ReadWrite,h.depthRangeFor3D),E=h.useProgram("terrain"),S=t.getTerrainMesh(),k=t.getTerrainData(s.tileID);c.bindFramebuffer.set(null),c.viewport.set([0,0,h.width,h.height]),c.activeTexture.set(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,t.getRTTFramebuffer().colorAttachment.get());const A=h.transform.calculatePosMatrix(s.tileID.toUnwrapped());E.draw(c,p.TRIANGLES,v,Ht.disabled,g,tn.backCCW,{u_matrix:A,u_texture:0},k,"terrain",S.vertexBuffer,S.indexBuffer,S.segments)}function $c(h,t,s,c){const p=h.context,g=s.tileSize*t.qualityFactor;s.textures[c]||(s.textures[c]=h.getTileTexture(g)||new ke(p,{width:g,height:g,data:null},p.gl.RGBA),s.textures[c].bind(p.gl.LINEAR,p.gl.CLAMP_TO_EDGE),c===0&&t.sourceCache.renderHistory.unshift(s.tileID.key));const v=t.getRTTFramebuffer();v.colorAttachment.set(s.textures[c].texture),p.bindFramebuffer.set(v.framebuffer),p.viewport.set([0,0,g,g])}class jc{constructor(t){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=t,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=t.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const t=this.painter.style,s=t.terrain;for(const c in t.sourceCaches){this._coordsDescendingInv[c]={};const p=t.sourceCaches[c].getVisibleCoordinates();for(const g of p){const v=s.sourceCache.getTerrainCoords(g);for(const E in v)this._coordsDescendingInv[c][E]||(this._coordsDescendingInv[c][E]=[]),this._coordsDescendingInv[c][E].push(v[E])}}for(const c of t._order){const p=t._layers[c],g=p.source;if(this._renderToTexture[p.type]&&!this._coordsDescendingInvStr[g]){this._coordsDescendingInvStr[g]={};for(const v in this._coordsDescendingInv[g])this._coordsDescendingInvStr[g][v]=this._coordsDescendingInv[g][v].map(E=>E.key).sort().join()}}return this._renderableTiles.forEach(c=>{for(const p in this._coordsDescendingInvStr){const g=this._coordsDescendingInvStr[p][c.tileID.key];g&&g!==c.textureCoords[p]&&c.clearTextures(this.painter),s.needsRerender(p,c.tileID)&&c.clearTextures(this.painter)}this._rerender[c.tileID.key]=!c.textures.length}),s.clearRerenderCache(),s.sourceCache.removeOutdated(this.painter),this}renderLayer(t){const s=t.type,c=this.painter,p=c.style._order,g=c.currentLayer,v=g+1===p.length;if(this._renderToTexture[s]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=s,this._stacks[this._stacks.length-1].push(p[g]),!v))return!0;if(this._renderToTexture[this._prevType]||s==="hillshade"||this._renderToTexture[s]&&v){this._prevType=s;const E=this._stacks.length-1,S=this._stacks[E]||[];for(const k of this._renderableTiles){if($c(c,c.style.terrain,k,E),this._rerender[k.tileID.key]){c.context.clear({color:u.Color.transparent});for(let A=0;A<S.length;A++){const D=c.style._layers[S[A]],R=D.source?this._coordsDescendingInv[D.source][k.tileID.key]:[k.tileID];c._renderTileClippingMasks(D,R),c.renderLayer(c,c.style.sourceCaches[D.source],D,R),D.source&&(k.textureCoords[D.source]=this._coordsDescendingInvStr[D.source][k.tileID.key])}}Ra(c,c.style.terrain,k)}if(s==="hillshade"){this._stacks.push([p[g]]);for(const k of this._renderableTiles){const A=this._coordsDescendingInv[t.source][k.tileID.key];$c(c,c.style.terrain,k,this._stacks.length-1),c.context.clear({color:u.Color.transparent}),c._renderTileClippingMasks(t,A),c.renderLayer(c,c.style.sourceCaches[t.source],t,A),Ra(c,c.style.terrain,k)}return!0}return this._renderToTexture[s]}return!1}}const $s={symbol:function(h,t,s,c,p){if(h.renderPass!=="translucent")return;const g=Ht.disabled,v=h.colorModeForRenderPass();s.layout.get("text-variable-anchor")&&function(E,S,k,A,D,R,G){const $=S.transform,j=D==="map",ee=R==="map";for(const re of E){const ce=A.getTile(re),W=ce.getBucket(k);if(!W||!W.text||!W.text.segments.get().length)continue;const pe=u.evaluateSizeForZoom(W.textSizeData,$.zoom),he=Sn(ce,1,S.transform.zoom),_e=co(re.posMatrix,ee,j,S.transform,he),ve=k.layout.get("icon-text-fit")!=="none"&&W.hasIconData();if(pe){const Te=Math.pow(2,$.zoom-ce.tileID.overscaledZ);Oc(W,j,ee,G,$,_e,re.posMatrix,Te,pe,ve,S.style.terrain?(ye,Ge)=>S.style.terrain.getElevation(re,ye,Ge):null)}}}(c,h,s,t,s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),p),s.paint.get("icon-opacity").constantOr(1)!==0&&Pa(h,t,s,c,!1,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),s.layout.get("icon-rotation-alignment"),s.layout.get("icon-pitch-alignment"),s.layout.get("icon-keep-upright"),g,v),s.paint.get("text-opacity").constantOr(1)!==0&&Pa(h,t,s,c,!0,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),s.layout.get("text-keep-upright"),g,v),t.map.showCollisionBoxes&&(Ko(h,t,s,c,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),!0),Ko(h,t,s,c,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),!1))},circle:function(h,t,s,c){if(h.renderPass!=="translucent")return;const p=s.paint.get("circle-opacity"),g=s.paint.get("circle-stroke-width"),v=s.paint.get("circle-stroke-opacity"),E=!s.layout.get("circle-sort-key").isConstant();if(p.constantOr(1)===0&&(g.constantOr(1)===0||v.constantOr(1)===0))return;const S=h.context,k=S.gl,A=h.depthModeForSublayer(0,St.ReadOnly),D=Ht.disabled,R=h.colorModeForRenderPass(),G=[];for(let $=0;$<c.length;$++){const j=c[$],ee=t.getTile(j),re=ee.getBucket(s);if(!re)continue;const ce=re.programConfigurations.get(s.id),W=h.useProgram("circle",ce),pe=re.layoutVertexBuffer,he=re.indexBuffer,_e=h.style.terrain&&h.style.terrain.getTerrainData(j),ve={programConfiguration:ce,program:W,layoutVertexBuffer:pe,indexBuffer:he,uniformValues:kc(h,j,ee,s),terrainData:_e};if(E){const Te=re.segments.get();for(const ye of Te)G.push({segments:new u.SegmentVector([ye]),sortKey:ye.sortKey,state:ve})}else G.push({segments:re.segments,sortKey:0,state:ve})}E&&G.sort(($,j)=>$.sortKey-j.sortKey);for(const $ of G){const{programConfiguration:j,program:ee,layoutVertexBuffer:re,indexBuffer:ce,uniformValues:W,terrainData:pe}=$.state;ee.draw(S,k.TRIANGLES,A,D,R,tn.disabled,W,pe,s.id,re,ce,$.segments,s.paint,h.transform.zoom,j)}},heatmap:function(h,t,s,c){if(s.paint.get("heatmap-opacity")!==0)if(h.renderPass==="offscreen"){const p=h.context,g=p.gl,v=Ht.disabled,E=new Yt([g.ONE,g.ONE],u.Color.transparent,[!0,!0,!0,!0]);(function(S,k,A){const D=S.gl;S.activeTexture.set(D.TEXTURE1),S.viewport.set([0,0,k.width/4,k.height/4]);let R=A.heatmapFbo;if(R)D.bindTexture(D.TEXTURE_2D,R.colorAttachment.get()),S.bindFramebuffer.set(R.framebuffer);else{const G=D.createTexture();D.bindTexture(D.TEXTURE_2D,G),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_S,D.CLAMP_TO_EDGE),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_T,D.CLAMP_TO_EDGE),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MIN_FILTER,D.LINEAR),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MAG_FILTER,D.LINEAR),R=A.heatmapFbo=S.createFramebuffer(k.width/4,k.height/4,!1),function($,j,ee,re){const ce=$.gl;ce.texImage2D(ce.TEXTURE_2D,0,ce.RGBA,j.width/4,j.height/4,0,ce.RGBA,$.extRenderToTextureHalfFloat?$.extTextureHalfFloat.HALF_FLOAT_OES:ce.UNSIGNED_BYTE,null),re.colorAttachment.set(ee)}(S,k,G,R)}})(p,h,s),p.clear({color:u.Color.transparent});for(let S=0;S<c.length;S++){const k=c[S];if(t.hasRenderableParent(k))continue;const A=t.getTile(k),D=A.getBucket(s);if(!D)continue;const R=D.programConfigurations.get(s.id),G=h.useProgram("heatmap",R),{zoom:$}=h.transform;G.draw(p,g.TRIANGLES,St.disabled,v,E,tn.disabled,ba(k.posMatrix,A,$,s.paint.get("heatmap-intensity")),null,s.id,D.layoutVertexBuffer,D.indexBuffer,D.segments,s.paint,h.transform.zoom,R)}p.viewport.set([0,0,h.width,h.height])}else h.renderPass==="translucent"&&(h.context.setColorMode(h.colorModeForRenderPass()),function(p,g){const v=p.context,E=v.gl,S=g.heatmapFbo;if(!S)return;v.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,S.colorAttachment.get()),v.activeTexture.set(E.TEXTURE1);let k=g.colorRampTexture;k||(k=g.colorRampTexture=new ke(v,g.colorRamp,E.RGBA)),k.bind(E.LINEAR,E.CLAMP_TO_EDGE),p.useProgram("heatmapTexture").draw(v,E.TRIANGLES,St.disabled,Ht.disabled,p.colorModeForRenderPass(),tn.disabled,((A,D,R,G)=>{const $=u.create();u.ortho($,0,A.width,A.height,0,0,1);const j=A.context.gl;return{u_matrix:$,u_world:[j.drawingBufferWidth,j.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:D.paint.get("heatmap-opacity")}})(p,g),null,g.id,p.viewportBuffer,p.quadTriangleIndexBuffer,p.viewportSegments,g.paint,p.transform.zoom)}(h,s))},line:function(h,t,s,c){if(h.renderPass!=="translucent")return;const p=s.paint.get("line-opacity"),g=s.paint.get("line-width");if(p.constantOr(1)===0||g.constantOr(1)===0)return;const v=h.depthModeForSublayer(0,St.ReadOnly),E=h.colorModeForRenderPass(),S=s.paint.get("line-dasharray"),k=s.paint.get("line-pattern"),A=k.constantOr(1),D=s.paint.get("line-gradient"),R=s.getCrossfadeParameters(),G=A?"linePattern":S?"lineSDF":D?"lineGradient":"line",$=h.context,j=$.gl;let ee=!0;for(const re of c){const ce=t.getTile(re);if(A&&!ce.patternsLoaded())continue;const W=ce.getBucket(s);if(!W)continue;const pe=W.programConfigurations.get(s.id),he=h.context.program.get(),_e=h.useProgram(G,pe),ve=ee||_e.program!==he,Te=h.style.terrain&&h.style.terrain.getTerrainData(re),ye=k.constantOr(null);if(ye&&ce.imageAtlas){const qe=ce.imageAtlas,gt=qe.patternPositions[ye.to.toString()],vt=qe.patternPositions[ye.from.toString()];gt&&vt&&pe.setConstantPatternPositions(gt,vt)}const Ge=Te?re:null,Be=A?Sa(h,ce,s,R,Ge):S?Ds(h,ce,s,S,R,Ge):D?Pl(h,ce,s,W.lineClipsArray.length,Ge):qo(h,ce,s,Ge);if(A)$.activeTexture.set(j.TEXTURE0),ce.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),pe.updatePaintBuffers(R);else if(S&&(ve||h.lineAtlas.dirty))$.activeTexture.set(j.TEXTURE0),h.lineAtlas.bind($);else if(D){const qe=W.gradients[s.id];let gt=qe.texture;if(s.gradientVersion!==qe.version){let vt=256;if(s.stepInterpolant){const it=t.getSource().maxzoom,Ft=re.canonical.z===it?Math.ceil(1<<h.transform.maxZoom-re.canonical.z):1;vt=u.clamp(u.nextPowerOfTwo(W.maxLineLength/u.EXTENT*1024*Ft),256,$.maxTextureSize)}qe.gradient=u.renderColorRamp({expression:s.gradientExpression(),evaluationKey:"lineProgress",resolution:vt,image:qe.gradient||void 0,clips:W.lineClipsArray}),qe.texture?qe.texture.update(qe.gradient):qe.texture=new ke($,qe.gradient,j.RGBA),qe.version=s.gradientVersion,gt=qe.texture}$.activeTexture.set(j.TEXTURE0),gt.bind(s.stepInterpolant?j.NEAREST:j.LINEAR,j.CLAMP_TO_EDGE)}_e.draw($,j.TRIANGLES,v,h.stencilModeForClipping(re),E,tn.disabled,Be,Te,s.id,W.layoutVertexBuffer,W.indexBuffer,W.segments,s.paint,h.transform.zoom,pe,W.layoutVertexBuffer2),ee=!1}},fill:function(h,t,s,c){const p=s.paint.get("fill-color"),g=s.paint.get("fill-opacity");if(g.constantOr(1)===0)return;const v=h.colorModeForRenderPass(),E=s.paint.get("fill-pattern"),S=h.opaquePassEnabledForLayer()&&!E.constantOr(1)&&p.constantOr(u.Color.transparent).a===1&&g.constantOr(0)===1?"opaque":"translucent";if(h.renderPass===S){const k=h.depthModeForSublayer(1,h.renderPass==="opaque"?St.ReadWrite:St.ReadOnly);Ns(h,t,s,c,k,v,!1)}if(h.renderPass==="translucent"&&s.paint.get("fill-antialias")){const k=h.depthModeForSublayer(s.getPaintProperty("fill-outline-color")?2:0,St.ReadOnly);Ns(h,t,s,c,k,v,!0)}},"fill-extrusion":function(h,t,s,c){const p=s.paint.get("fill-extrusion-opacity");if(p!==0&&h.renderPass==="translucent"){const g=new St(h.context.gl.LEQUAL,St.ReadWrite,h.depthRangeFor3D);if(p!==1||s.paint.get("fill-extrusion-pattern").constantOr(1))Us(h,t,s,c,g,Ht.disabled,Yt.disabled),Us(h,t,s,c,g,h.stencilModeFor3D(),h.colorModeForRenderPass());else{const v=h.colorModeForRenderPass();Us(h,t,s,c,g,Ht.disabled,v)}}},hillshade:function(h,t,s,c){if(h.renderPass!=="offscreen"&&h.renderPass!=="translucent")return;const p=h.context,g=h.depthModeForSublayer(0,St.ReadOnly),v=h.colorModeForRenderPass(),[E,S]=h.renderPass==="translucent"?h.stencilConfigForOverlap(c):[{},c];for(const k of S){const A=t.getTile(k);A.needsHillshadePrepare!==void 0&&A.needsHillshadePrepare&&h.renderPass==="offscreen"?Nc(h,A,s,g,Ht.disabled,v):h.renderPass==="translucent"&&ql(h,k,A,s,g,E[k.overscaledZ],v)}p.viewport.set([0,0,h.width,h.height])},raster:function(h,t,s,c){if(h.renderPass!=="translucent"||s.paint.get("raster-opacity")===0||!c.length)return;const p=h.context,g=p.gl,v=t.getSource(),E=h.useProgram("raster"),S=h.colorModeForRenderPass(),[k,A]=v instanceof ct?[{},c]:h.stencilConfigForOverlap(c),D=A[A.length-1].overscaledZ,R=!h.options.moving;for(const G of A){const $=h.depthModeForSublayer(G.overscaledZ-D,s.paint.get("raster-opacity")===1?St.ReadWrite:St.ReadOnly,g.LESS),j=t.getTile(G);j.registerFadeDuration(s.paint.get("raster-fade-duration"));const ee=t.findLoadedParent(G,0),re=Da(j,ee,t,s,h.transform,h.style.terrain);let ce,W;const pe=s.paint.get("raster-resampling")==="nearest"?g.NEAREST:g.LINEAR;p.activeTexture.set(g.TEXTURE0),j.texture.bind(pe,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST),p.activeTexture.set(g.TEXTURE1),ee?(ee.texture.bind(pe,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST),ce=Math.pow(2,ee.tileID.overscaledZ-j.tileID.overscaledZ),W=[j.tileID.canonical.x*ce%1,j.tileID.canonical.y*ce%1]):j.texture.bind(pe,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST);const he=h.style.terrain&&h.style.terrain.getTerrainData(G),_e=he?G:null,ve=_e?_e.posMatrix:h.transform.calculatePosMatrix(G.toUnwrapped(),R),Te=Cc(ve,W||[0,0],ce||1,re,s);v instanceof ct?E.draw(p,g.TRIANGLES,$,Ht.disabled,S,tn.disabled,Te,he,s.id,v.boundsBuffer,h.quadTriangleIndexBuffer,v.boundsSegments):E.draw(p,g.TRIANGLES,$,k[G.overscaledZ],S,tn.disabled,Te,he,s.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments)}},background:function(h,t,s,c){const p=s.paint.get("background-color"),g=s.paint.get("background-opacity");if(g===0)return;const v=h.context,E=v.gl,S=h.transform,k=S.tileSize,A=s.paint.get("background-pattern");if(h.isPatternMissing(A))return;const D=!A&&p.a===1&&g===1&&h.opaquePassEnabledForLayer()?"opaque":"translucent";if(h.renderPass!==D)return;const R=Ht.disabled,G=h.depthModeForSublayer(0,D==="opaque"?St.ReadWrite:St.ReadOnly),$=h.colorModeForRenderPass(),j=h.useProgram(A?"backgroundPattern":"background"),ee=c||S.coveringTiles({tileSize:k,terrain:h.style.terrain});A&&(v.activeTexture.set(E.TEXTURE0),h.imageManager.bind(h.context));const re=s.getCrossfadeParameters();for(const ce of ee){const W=c?ce.posMatrix:h.transform.calculatePosMatrix(ce.toUnwrapped()),pe=A?Kd(W,g,h,A,{tileID:ce,tileSize:k},re):Hd(W,g,p),he=h.style.terrain&&h.style.terrain.getTerrainData(ce);j.draw(v,E.TRIANGLES,G,R,$,tn.disabled,pe,he,s.id,h.tileExtentBuffer,h.quadTriangleIndexBuffer,h.tileExtentSegments)}},debug:function(h,t,s){for(let c=0;c<s.length;c++)ap(h,t,s[c])},custom:function(h,t,s){const c=h.context,p=s.implementation;if(h.renderPass==="offscreen"){const g=p.prerender;g&&(h.setCustomLayerDefaults(),c.setColorMode(h.colorModeForRenderPass()),g.call(p,c.gl,h.transform.customLayerMatrix()),c.setDirty(),h.setBaseState())}else if(h.renderPass==="translucent"){h.setCustomLayerDefaults(),c.setColorMode(h.colorModeForRenderPass()),c.setStencilMode(Ht.disabled);const g=p.renderingMode==="3d"?new St(h.context.gl.LEQUAL,St.ReadWrite,h.depthRangeFor3D):h.depthModeForSublayer(0,St.ReadOnly);c.setDepthMode(g),p.render(c.gl,h.transform.customLayerMatrix()),c.setDirty(),h.setBaseState(),c.bindFramebuffer.set(null)}}};class Xl{constructor(t,s){this.context=new Fc(t),this.transform=s,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:u.create(),renderTime:0},this.setup(),this.numSublayers=bn.maxUnderzooming+bn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ht,this.gpuTimers={}}resize(t,s,c){if(this.width=t*c,this.height=s*c,this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style._order)this.style._layers[p].resize()}setup(){const t=this.context,s=new u.PosArray;s.emplaceBack(0,0),s.emplaceBack(u.EXTENT,0),s.emplaceBack(0,u.EXTENT),s.emplaceBack(u.EXTENT,u.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(s,zt.members),this.tileExtentSegments=u.SegmentVector.simpleSegment(0,0,4,2);const c=new u.PosArray;c.emplaceBack(0,0),c.emplaceBack(u.EXTENT,0),c.emplaceBack(0,u.EXTENT),c.emplaceBack(u.EXTENT,u.EXTENT),this.debugBuffer=t.createVertexBuffer(c,zt.members),this.debugSegments=u.SegmentVector.simpleSegment(0,0,4,5);const p=new u.RasterBoundsArray;p.emplaceBack(0,0,0,0),p.emplaceBack(u.EXTENT,0,u.EXTENT,0),p.emplaceBack(0,u.EXTENT,0,u.EXTENT),p.emplaceBack(u.EXTENT,u.EXTENT,u.EXTENT,u.EXTENT),this.rasterBoundsBuffer=t.createVertexBuffer(p,Ze.members),this.rasterBoundsSegments=u.SegmentVector.simpleSegment(0,0,4,2);const g=new u.PosArray;g.emplaceBack(0,0),g.emplaceBack(1,0),g.emplaceBack(0,1),g.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(g,zt.members),this.viewportSegments=u.SegmentVector.simpleSegment(0,0,4,2);const v=new u.LineStripIndexArray;v.emplaceBack(0),v.emplaceBack(1),v.emplaceBack(3),v.emplaceBack(2),v.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(v);const E=new u.TriangleIndexArray;E.emplaceBack(0,1,2),E.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(E),this.emptyTexture=new ke(t,{width:1,height:1,data:new Uint8Array([0,0,0,0])},t.gl.RGBA);const S=this.context.gl;this.stencilClearMode=new Ht({func:S.ALWAYS,mask:0},0,255,S.ZERO,S.ZERO,S.ZERO)}clearStencil(){const t=this.context,s=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=u.create();u.ortho(c,0,this.width,this.height,0,0,1),u.scale(c,c,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,s.TRIANGLES,St.disabled,this.stencilClearMode,Yt.disabled,tn.disabled,Zo(c),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,s){if(this.currentStencilSource===t.source||!t.isTileClipped()||!s||!s.length)return;this.currentStencilSource=t.source;const c=this.context,p=c.gl;this.nextStencilID+s.length>256&&this.clearStencil(),c.setColorMode(Yt.disabled),c.setDepthMode(St.disabled);const g=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const v of s){const E=this._tileClippingMaskIDs[v.key]=this.nextStencilID++,S=this.style.terrain&&this.style.terrain.getTerrainData(v);g.draw(c,p.TRIANGLES,St.disabled,new Ht({func:p.ALWAYS,mask:0},E,255,p.KEEP,p.KEEP,p.REPLACE),Yt.disabled,tn.disabled,Zo(v.posMatrix),S,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,s=this.context.gl;return new Ht({func:s.NOTEQUAL,mask:255},t,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(t){const s=this.context.gl;return new Ht({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(t){const s=this.context.gl,c=t.sort((v,E)=>E.overscaledZ-v.overscaledZ),p=c[c.length-1].overscaledZ,g=c[0].overscaledZ-p+1;if(g>1){this.currentStencilSource=void 0,this.nextStencilID+g>256&&this.clearStencil();const v={};for(let E=0;E<g;E++)v[E+p]=new Ht({func:s.GEQUAL,mask:255},E+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=g,[v,c]}return[{[p]:Ht.disabled},c]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Yt([t.CONSTANT_COLOR,t.ONE],new u.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Yt.unblended:Yt.alphaBlended}depthModeForSublayer(t,s,c){if(!this.opaquePassEnabledForLayer())return St.disabled;const p=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new St(c||this.context.gl.LEQUAL,s,[p,p])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,s){this.style=t,this.options=s,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(u.exported.now()),this.imageManager.beginFrame();const c=this.style._order,p=this.style.sourceCaches,g=this.style.terrain&&new jc(this);for(const k in p){const A=p[k];A.used&&A.prepare(this.context)}const v={},E={},S={};for(const k in p){const A=p[k];v[k]=A.getVisibleCoordinates(),E[k]=v[k].slice().reverse(),S[k]=A.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let k=0;k<c.length;k++)if(this.style._layers[c[k]].is3D()){this.opaquePassCutoff=k;break}if(g){this.opaquePassCutoff=0;const k=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!u.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||k.length)&&(u.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(A,D){const R=A.context,G=R.gl,$=Yt.unblended,j=new St(G.LEQUAL,St.ReadWrite,[0,1]),ee=D.getTerrainMesh(),re=D.sourceCache.getRenderableTiles(),ce=A.useProgram("terrainDepth");R.bindFramebuffer.set(D.getFramebuffer("depth").framebuffer),R.viewport.set([0,0,A.width/devicePixelRatio,A.height/devicePixelRatio]),R.clear({color:u.Color.transparent,depth:1});for(const W of re){const pe=D.getTerrainData(W.tileID),he=A.transform.calculatePosMatrix(W.tileID.toUnwrapped());ce.draw(R,G.TRIANGLES,j,Ht.disabled,$,tn.backCCW,{u_matrix:he},pe,"terrain",ee.vertexBuffer,ee.indexBuffer,ee.segments)}R.bindFramebuffer.set(null),R.viewport.set([0,0,A.width,A.height])}(this,this.style.terrain),function(A,D){const R=A.context,G=R.gl,$=Yt.unblended,j=new St(G.LEQUAL,St.ReadWrite,[0,1]),ee=D.getTerrainMesh(),re=D.getCoordsTexture(),ce=D.sourceCache.getRenderableTiles(),W=A.useProgram("terrainCoords");R.bindFramebuffer.set(D.getFramebuffer("coords").framebuffer),R.viewport.set([0,0,A.width/devicePixelRatio,A.height/devicePixelRatio]),R.clear({color:u.Color.transparent,depth:1}),D.coordsIndex=[];for(const pe of ce){const he=D.getTerrainData(pe.tileID);R.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,re.texture);const _e=A.transform.calculatePosMatrix(pe.tileID.toUnwrapped());W.draw(R,G.TRIANGLES,j,Ht.disabled,$,tn.backCCW,{u_matrix:_e,u_terrain_coords_id:(255-D.coordsIndex.length)/255,u_texture:0},he,"terrain",ee.vertexBuffer,ee.indexBuffer,ee.segments),D.coordsIndex.push(pe.tileID.key)}R.bindFramebuffer.set(null),R.viewport.set([0,0,A.width,A.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const k of c){const A=this.style._layers[k];if(!A.hasOffscreenPass()||A.isHidden(this.transform.zoom))continue;const D=E[A.source];(A.type==="custom"||D.length)&&this.renderLayer(this,p[A.source],A,D)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?u.Color.black:u.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!g)for(this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){const k=this.style._layers[c[this.currentLayer]],A=p[k.source],D=v[k.source];this._renderTileClippingMasks(k,D),this.renderLayer(this,A,k,D)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){const k=this.style._layers[c[this.currentLayer]],A=p[k.source];if(g&&g.renderLayer(k))continue;const D=(k.type==="symbol"?S:E)[k.source];this._renderTileClippingMasks(k,v[k.source]),this.renderLayer(this,A,k,D)}if(this.options.showTileBoundaries){let k,A;Object.values(this.style._layers).forEach(D=>{D.source&&!D.isHidden(this.transform.zoom)&&(D.source!==(A&&A.id)&&(A=this.style.sourceCaches[D.source]),(!k||k.getSource().maxzoom<A.getSource().maxzoom)&&(k=A))}),k&&$s.debug(this,k,k.getVisibleCoordinates())}this.options.showPadding&&function(k){const A=k.transform.padding;yo(k,k.transform.height-(A.top||0),3,La),yo(k,A.bottom||0,3,ii),Vs(k,A.left||0,3,Uc),Vs(k,k.transform.width-(A.right||0),3,Wl);const D=k.transform.centerPoint;(function(R,G,$,j){Yo(R,G-1,$-10,2,20,j),Yo(R,G-10,$-1,20,2,j)})(k,D.x,k.transform.height-D.y,Vc)}(this),this.context.setDefault()}renderLayer(t,s,c,p){c.isHidden(this.transform.zoom)||(c.type==="background"||c.type==="custom"||(p||[]).length)&&(this.id=c.id,this.gpuTimingStart(c),$s[c.type](t,s,c,p,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const s=this.context.extTimerQuery;let c=this.gpuTimers[t.id];c||(c=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),c.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,c.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}queryGpuTimers(t){const s={};for(const c in t){const p=t[c],g=this.context.extTimerQuery,v=g.getQueryObjectEXT(p.query,g.QUERY_RESULT_EXT)/1e6;g.deleteQueryEXT(p.query),s[c]=v}return s}translatePosMatrix(t,s,c,p,g){if(!c[0]&&!c[1])return t;const v=g?p==="map"?this.transform.angle:0:p==="viewport"?-this.transform.angle:0;if(v){const k=Math.sin(v),A=Math.cos(v);c=[c[0]*A-c[1]*k,c[0]*k+c[1]*A]}const E=[g?c[0]:Sn(s,c[0],this.transform.zoom),g?c[1]:Sn(s,c[1],this.transform.zoom),0],S=new Float32Array(16);return u.translate(S,t,E),S}saveTileTexture(t){const s=this._tileTextures[t.size[0]];s?s.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const s=this._tileTextures[t];return s&&s.length>0?s.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const s=this.imageManager.getPattern(t.from.toString()),c=this.imageManager.getPattern(t.to.toString());return!s||!c}useProgram(t,s){this.cache=this.cache||{};const c=t+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[c]||(this.cache[c]=new bc(this.context,t,Ms[t],s,Ll[t],this._showOverdrawInspector,this.style.terrain)),this.cache[c]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ke(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class Ba{constructor(t,s){this.points=t,this.planes=s}static fromInvProjectionMatrix(t,s,c){const p=Math.pow(2,c),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const S=1/(E=u.transformMat4([],E,t))[3]/s*p;return u.mul$1(E,E,[S,S,1/E[3],S])}),v=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const S=u.sub([],g[E[0]],g[E[1]]),k=u.sub([],g[E[2]],g[E[1]]),A=u.normalize([],u.cross([],S,k)),D=-u.dot(A,g[E[1]]);return A.concat(D)});return new Ba(g,v)}}class js{constructor(t,s){this.min=t,this.max=s,this.center=u.scale$1([],u.add([],this.min,this.max),.5)}quadrant(t){const s=[t%2==0,t<2],c=u.clone$2(this.min),p=u.clone$2(this.max);for(let g=0;g<s.length;g++)c[g]=s[g]?this.min[g]:this.center[g],p[g]=s[g]?this.center[g]:this.max[g];return p[2]=this.max[2],new js(c,p)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(t){const s=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let c=!0;for(let p=0;p<t.planes.length;p++){const g=t.planes[p];let v=0;for(let E=0;E<s.length;E++)u.dot$1(g,s[E])>=0&&v++;if(v===0)return 0;v!==s.length&&(c=!1)}if(c)return 2;for(let p=0;p<3;p++){let g=Number.MAX_VALUE,v=-Number.MAX_VALUE;for(let E=0;E<t.points.length;E++){const S=t.points[E][p]-this.min[p];g=Math.min(g,S),v=Math.max(v,S)}if(v<0||g>this.max[p]-this.min[p])return 0}return 1}}class Jo{constructor(t=0,s=0,c=0,p=0){if(isNaN(t)||t<0||isNaN(s)||s<0||isNaN(c)||c<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=s,this.left=c,this.right=p}interpolate(t,s,c){return s.top!=null&&t.top!=null&&(this.top=u.number(t.top,s.top,c)),s.bottom!=null&&t.bottom!=null&&(this.bottom=u.number(t.bottom,s.bottom,c)),s.left!=null&&t.left!=null&&(this.left=u.number(t.left,s.left,c)),s.right!=null&&t.right!=null&&(this.right=u.number(t.right,s.right,c)),this}getCenter(t,s){const c=u.clamp((this.left+t-this.right)/2,0,t),p=u.clamp((this.top+s-this.bottom)/2,0,s);return new u.pointGeometry(c,p)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Jo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Gs{constructor(t,s,c,p,g){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=g===void 0||!!g,this._minZoom=t||0,this._maxZoom=s||22,this._minPitch=c??0,this._maxPitch=p??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new u.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Jo,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const t=new Gs(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t._elevation=this._elevation,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._calcMatrices(),t}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const s=-u.wrap(t,-180,180)*Math.PI/180;var c;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=(c=new u.ARRAY_TYPE(4),u.ARRAY_TYPE!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c),function(p,g,v){var E=g[0],S=g[1],k=g[2],A=g[3],D=Math.sin(v),R=Math.cos(v);p[0]=E*R+k*D,p[1]=S*R+A*D,p[2]=E*-D+k*R,p[3]=S*-D+A*R}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const s=u.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const s=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,s,c){this._unmodified=!1,this._edgeInsets.interpolate(t,s,c),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const s=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(t){const s=[new u.UnwrappedTileID(0,t)];if(this._renderWorldCopies){const c=this.pointCoordinate(new u.pointGeometry(0,0)),p=this.pointCoordinate(new u.pointGeometry(this.width,0)),g=this.pointCoordinate(new u.pointGeometry(this.width,this.height)),v=this.pointCoordinate(new u.pointGeometry(0,this.height)),E=Math.floor(Math.min(c.x,p.x,g.x,v.x)),S=Math.floor(Math.max(c.x,p.x,g.x,v.x)),k=1;for(let A=E-k;A<=S+k;A++)A!==0&&s.push(new u.UnwrappedTileID(A,t))}return s}coveringTiles(t){var s,c;let p=this.coveringZoomLevel(t);const g=p;if(t.minzoom!==void 0&&p<t.minzoom)return[];t.maxzoom!==void 0&&p>t.maxzoom&&(p=t.maxzoom);const v=this.pointCoordinate(this.getCameraPoint()),E=u.MercatorCoordinate.fromLngLat(this.center),S=Math.pow(2,p),k=[S*v.x,S*v.y,0],A=[S*E.x,S*E.y,0],D=Ba.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p);let R=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(R=p);const G=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,$=W=>({aabb:new js([W*S,0,0],[(W+1)*S,S,0]),zoom:0,x:0,y:0,wrap:W,fullyVisible:!1}),j=[],ee=[],re=p,ce=t.reparseOverscaled?g:p;if(this._renderWorldCopies)for(let W=1;W<=3;W++)j.push($(-W)),j.push($(W));for(j.push($(0));j.length>0;){const W=j.pop(),pe=W.x,he=W.y;let _e=W.fullyVisible;if(!_e){const qe=W.aabb.intersects(D);if(qe===0)continue;_e=qe===2}const ve=t.terrain?k:A,Te=W.aabb.distanceX(ve),ye=W.aabb.distanceY(ve),Ge=Math.max(Math.abs(Te),Math.abs(ye)),Be=G+(1<<re-W.zoom)-2;if(W.zoom===re||Ge>Be&&W.zoom>=R){const qe=re-W.zoom,gt=k[0]-.5-(pe<<qe),vt=k[1]-.5-(he<<qe);ee.push({tileID:new u.OverscaledTileID(W.zoom===re?ce:W.zoom,W.wrap,W.zoom,pe,he),distanceSq:u.sqrLen([A[0]-.5-pe,A[1]-.5-he]),tileDistanceToCamera:Math.sqrt(gt*gt+vt*vt)})}else for(let qe=0;qe<4;qe++){const gt=(pe<<1)+qe%2,vt=(he<<1)+(qe>>1),it=W.zoom+1;let Ft=W.aabb.quadrant(qe);if(t.terrain){const Ot=new u.OverscaledTileID(it,W.wrap,it,gt,vt),kt=t.terrain.getMinMaxElevation(Ot),Mt=(s=kt.minElevation)!==null&&s!==void 0?s:this.elevation,$t=(c=kt.maxElevation)!==null&&c!==void 0?c:this.elevation;Ft=new js([Ft.min[0],Ft.min[1],Mt],[Ft.max[0],Ft.max[1],$t])}j.push({aabb:Ft,zoom:it,x:gt,y:vt,wrap:W.wrap,fullyVisible:_e})}}return ee.sort((W,pe)=>W.distanceSq-pe.distanceSq).map(W=>W.tileID)}resize(t,s){this.width=t,this.height=s,this.pixelsToGLUnits=[2/t,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const s=u.clamp(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new u.pointGeometry(u.mercatorXfromLng(t.lng)*this.worldSize,u.mercatorYfromLat(s)*this.worldSize)}unproject(t){return new u.MercatorCoordinate(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(t){this.freezeElevation||(this.elevation=t?this.getElevation(this._center,t):0)}getElevation(t,s){const c=u.MercatorCoordinate.fromLngLat(t),p=(1<<this.tileZoom)*u.EXTENT,g=c.x*p,v=c.y*p,E=Math.floor(g/u.EXTENT),S=Math.floor(v/u.EXTENT),k=new u.OverscaledTileID(this.tileZoom,0,this.tileZoom,E,S);return s.getElevation(k,g%u.EXTENT,v%u.EXTENT,u.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const s=this.pointLocation(this.centerPoint,t),c=this.getElevation(s,t);if(!(this.elevation-c))return;const p=this.getCameraPosition(),g=u.MercatorCoordinate.fromLngLat(p.lngLat,p.altitude),v=u.MercatorCoordinate.fromLngLat(s,c),E=g.x-v.x,S=g.y-v.y,k=g.z-v.z,A=Math.sqrt(E*E+S*S+k*k),D=this.scaleZoom(this.cameraToCenterDistance/A/this.tileSize);this._elevation=c,this._center=s,this.zoom=D}setLocationAtPoint(t,s){const c=this.pointCoordinate(s),p=this.pointCoordinate(this.centerPoint),g=this.locationCoordinate(t),v=new u.MercatorCoordinate(g.x-(c.x-p.x),g.y-(c.y-p.y));this.center=this.coordinateLocation(v),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,s){return s?this.coordinatePoint(this.locationCoordinate(t),this.getElevation(t,s),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,s){return this.coordinateLocation(this.pointCoordinate(t,s))}locationCoordinate(t){return u.MercatorCoordinate.fromLngLat(t)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(t,s){if(s){const R=s.pointCoordinate(t);if(R!=null)return R}const c=[t.x,t.y,0,1],p=[t.x,t.y,1,1];u.transformMat4(c,c,this.pixelMatrixInverse),u.transformMat4(p,p,this.pixelMatrixInverse);const g=c[3],v=p[3],E=c[1]/g,S=p[1]/v,k=c[2]/g,A=p[2]/v,D=k===A?0:(0-k)/(A-k);return new u.MercatorCoordinate(u.number(c[0]/g,p[0]/v,D)/this.worldSize,u.number(E,S,D)/this.worldSize)}coordinatePoint(t,s=0,c=this.pixelMatrix){const p=[t.x*this.worldSize,t.y*this.worldSize,s,1];return u.transformMat4(p,p,c),new u.pointGeometry(p[0]/p[3],p[1]/p[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return new u.LngLatBounds().extend(this.pointLocation(new u.pointGeometry(0,t))).extend(this.pointLocation(new u.pointGeometry(this.width,t))).extend(this.pointLocation(new u.pointGeometry(this.width,this.height))).extend(this.pointLocation(new u.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new u.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(t,s=!1){const c=t.key,p=s?this._alignedPosMatrixCache:this._posMatrixCache;if(p[c])return p[c];const g=t.canonical,v=this.worldSize/this.zoomScale(g.z),E=g.x+Math.pow(2,g.z)*t.wrap,S=u.identity(new Float64Array(16));return u.translate(S,S,[E*v,g.y*v,0]),u.scale(S,S,[v/u.EXTENT,v/u.EXTENT,1]),u.multiply(S,s?this.alignedProjMatrix:this.projMatrix,S),p[c]=new Float32Array(S),p[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let t,s,c,p,g=-90,v=90,E=-180,S=180;const k=this.size,A=this._unmodified;if(this.latRange){const G=this.latRange;g=u.mercatorYfromLat(G[1])*this.worldSize,v=u.mercatorYfromLat(G[0])*this.worldSize,t=v-g<k.y?k.y/(v-g):0}if(this.lngRange){const G=this.lngRange;E=u.wrap(u.mercatorXfromLng(G[0])*this.worldSize,0,this.worldSize),S=u.wrap(u.mercatorXfromLng(G[1])*this.worldSize,0,this.worldSize),S<E&&(S+=this.worldSize),s=S-E<k.x?k.x/(S-E):0}const D=this.point,R=Math.max(s||0,t||0);if(R)return this.center=this.unproject(new u.pointGeometry(s?(S+E)/2:D.x,t?(v+g)/2:D.y)),this.zoom+=this.scaleZoom(R),this._unmodified=A,void(this._constraining=!1);if(this.latRange){const G=D.y,$=k.y/2;G-$<g&&(p=g+$),G+$>v&&(p=v-$)}if(this.lngRange){const G=(E+S)/2,$=u.wrap(D.x,G-this.worldSize/2,G+this.worldSize/2),j=k.x/2;$-j<E&&(c=E+j),$+j>S&&(c=S-j)}c===void 0&&p===void 0||(this.center=this.unproject(new u.pointGeometry(c!==void 0?c:D.x,p!==void 0?p:D.y)).wrap()),this._unmodified=A,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,s=this.point.x,c=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=u.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let p=u.identity(new Float64Array(16));u.scale(p,p,[this.width/2,-this.height/2,1]),u.translate(p,p,[1,-1,0]),this.labelPlaneMatrix=p,p=u.identity(new Float64Array(16)),u.scale(p,p,[1,-1,1]),u.translate(p,p,[-1,-1,0]),u.scale(p,p,[2/this.width,2/this.height,1]),this.glCoordMatrix=p,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const g=Math.PI/2+this._pitch,v=this._fov*(.5+t.y/this.height),E=Math.sin(v)*this.cameraToSeaLevelDistance/Math.sin(u.clamp(Math.PI-g-v,.01,Math.PI-.01)),S=this.getHorizon(),k=2*Math.atan(S/this.cameraToCenterDistance)*(.5+t.y/(2*S)),A=Math.sin(k)*this.cameraToSeaLevelDistance/Math.sin(u.clamp(Math.PI-g-k,.01,Math.PI-.01)),D=Math.cos(Math.PI/2-this._pitch)*E+this.cameraToSeaLevelDistance,R=Math.cos(Math.PI/2-this._pitch)*A+this.cameraToSeaLevelDistance,G=1.01*Math.min(D,R),$=this.height/50;p=new Float64Array(16),u.perspective(p,this._fov,this.width/this.height,$,G),p[8]=2*-t.x/this.width,p[9]=2*t.y/this.height,u.scale(p,p,[1,-1,1]),u.translate(p,p,[0,0,-this.cameraToCenterDistance]),u.rotateX(p,p,this._pitch),u.rotateZ(p,p,this.angle),u.translate(p,p,[-s,-c,0]),this.mercatorMatrix=u.scale([],p,[this.worldSize,this.worldSize,this.worldSize]),u.scale(p,p,[1,1,this._pixelPerMeter]),this.pixelMatrix=u.multiply(new Float64Array(16),this.labelPlaneMatrix,p),u.translate(p,p,[0,0,-this.elevation]),this.projMatrix=p,this.invProjMatrix=u.invert([],p),this.pixelMatrix3D=u.multiply(new Float64Array(16),this.labelPlaneMatrix,p);const j=this.width%2/2,ee=this.height%2/2,re=Math.cos(this.angle),ce=Math.sin(this.angle),W=s-Math.round(s)+re*j+ce*ee,pe=c-Math.round(c)+re*ee+ce*j,he=new Float64Array(p);if(u.translate(he,he,[W>.5?W-1:W,pe>.5?pe-1:pe,0]),this.alignedProjMatrix=he,p=u.invert(new Float64Array(16),this.pixelMatrix),!p)throw new Error("failed to invert matrix");this.pixelMatrixInverse=p,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new u.pointGeometry(0,0)),s=[t.x*this.worldSize,t.y*this.worldSize,0,1];return u.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.pointGeometry(0,t))}getCameraQueryGeometry(t){const s=this.getCameraPoint();if(t.length===1)return[t[0],s];{let c=s.x,p=s.y,g=s.x,v=s.y;for(const E of t)c=Math.min(c,E.x),p=Math.min(p,E.y),g=Math.max(g,E.x),v=Math.max(v,E.y);return[new u.pointGeometry(c,p),new u.pointGeometry(g,p),new u.pointGeometry(g,v),new u.pointGeometry(c,v),new u.pointGeometry(c,p)]}}}class Gc{constructor(t){this._hashName=t&&encodeURIComponent(t),u.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(s,c){let p=!1,g=null;const v=()=>{g=null,p&&(s(),g=setTimeout(v,300),p=!1)};return()=>(p=!0,g||v(),g)}(this._updateHashUnthrottled.bind(this))}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(t){const s=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,p=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,p),v=Math.round(s.lng*g)/g,E=Math.round(s.lat*g)/g,S=this._map.getBearing(),k=this._map.getPitch();let A="";if(A+=t?`/${v}/${E}/${c}`:`${c}/${E}/${v}`,(S||k)&&(A+="/"+Math.round(10*S)/10),k&&(A+=`/${Math.round(k)}`),this._hashName){const D=this._hashName;let R=!1;const G=window.location.hash.slice(1).split("&").map($=>{const j=$.split("=")[0];return j===D?(R=!0,`${j}=${A}`):$}).filter($=>$);return R||G.push(`${D}=${A}`),`#${G.join("&")}`}return`#${A}`}_getCurrentHash(){const t=window.location.hash.replace("#","");if(this._hashName){let s;return t.split("&").map(c=>c.split("=")).forEach(c=>{c[0]===this._hashName&&(s=c)}),(s&&s[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._getCurrentHash();if(t.length>=3&&!t.some(s=>isNaN(s))){const s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:s,pitch:+(t[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,t)}catch{}}}const Zs={linearity:.3,easing:u.bezier(0,0,.3,1)},Zc=u.extend({deceleration:2500,maxSpeed:1400},Zs),qc=u.extend({deceleration:20,maxSpeed:1400},Zs),Wc=u.extend({deceleration:1e3,maxSpeed:360},Zs),Qo=u.extend({deceleration:1e3,maxSpeed:90},Zs);class Xc{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:u.exported.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,s=u.exported.now();for(;t.length>0&&s-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,pan:new u.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:g}of this._inertiaBuffer)s.zoom+=g.zoomDelta||0,s.bearing+=g.bearingDelta||0,s.pitch+=g.pitchDelta||0,g.panDelta&&s.pan._add(g.panDelta),g.around&&(s.around=g.around),g.pinchAround&&(s.pinchAround=g.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,p={};if(s.pan.mag()){const g=Ws(s.pan.mag(),c,u.extend({},Zc,t||{}));p.offset=s.pan.mult(g.amount/s.pan.mag()),p.center=this._map.transform.center,qs(p,g)}if(s.zoom){const g=Ws(s.zoom,c,qc);p.zoom=this._map.transform.zoom+g.amount,qs(p,g)}if(s.bearing){const g=Ws(s.bearing,c,Wc);p.bearing=this._map.transform.bearing+u.clamp(g.amount,-179,179),qs(p,g)}if(s.pitch){const g=Ws(s.pitch,c,Qo);p.pitch=this._map.transform.pitch+g.amount,qs(p,g)}if(p.zoom||p.bearing){const g=s.pinchAround===void 0?s.around:s.pinchAround;p.around=g?this._map.unproject(g):this._map.getCenter()}return this.clear(),u.extend(p,{noMoveStart:!0})}}function qs(h,t){(!h.duration||h.duration<t.duration)&&(h.duration=t.duration,h.easing=t.easing)}function Ws(h,t,s){const{maxSpeed:c,linearity:p,deceleration:g}=s,v=u.clamp(h*p/(t/1e3),-c,c),E=Math.abs(v)/(g*p);return{easing:s.easing,duration:1e3*E,amount:v*(E/2)}}class Dr extends u.Event{constructor(t,s,c,p={}){const g=Z.mousePos(s.getCanvasContainer(),c),v=s.unproject(g);super(t,u.extend({point:g,lngLat:v,originalEvent:c},p)),this._defaultPrevented=!1,this.target=s}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Xs extends u.Event{constructor(t,s,c){const p=t==="touchend"?c.changedTouches:c.touches,g=Z.touchPos(s.getCanvasContainer(),p),v=g.map(S=>s.unproject(S)),E=g.reduce((S,k,A,D)=>S.add(k.div(D.length)),new u.pointGeometry(0,0));super(t,{points:g,point:E,lngLats:v,lngLat:s.unproject(E),originalEvent:c}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Lr extends u.Event{constructor(t,s,c){super(t,{originalEvent:c}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class lp{constructor(t,s){this._map=t,this._clickTolerance=s.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Lr(t.type,this._map,t))}mousedown(t,s){return this._mousedownPos=s,this._firePreventable(new Dr(t.type,this._map,t))}mouseup(t){this._map.fire(new Dr(t.type,this._map,t))}click(t,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new Dr(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Dr(t.type,this._map,t))}mouseover(t){this._map.fire(new Dr(t.type,this._map,t))}mouseout(t){this._map.fire(new Dr(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Xs(t.type,this._map,t))}touchmove(t){this._map.fire(new Xs(t.type,this._map,t))}touchend(t){this._map.fire(new Xs(t.type,this._map,t))}touchcancel(t){this._map.fire(new Xs(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ki{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Dr(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Dr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Dr(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Hc{constructor(t,s){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,s){this.isEnabled()&&t.shiftKey&&t.button===0&&(Z.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(t,s){if(!this._active)return;const c=s;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const p=this._startPos;this._lastPos=c,this._box||(this._box=Z.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const g=Math.min(p.x,c.x),v=Math.max(p.x,c.x),E=Math.min(p.y,c.y),S=Math.max(p.y,c.y);Z.setTransform(this._box,`translate(${g}px,${E}px)`),this._box.style.width=v-g+"px",this._box.style.height=S-E+"px"}mouseupWindow(t,s){if(!this._active||t.button!==0)return;const c=this._startPos,p=s;if(this.reset(),Z.suppressClick(),c.x!==p.x||c.y!==p.y)return this._map.fire(new u.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:g=>g.fitScreenCoordinates(c,p,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(Z.remove(this._box),this._box=null),Z.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,s){return this._map.fire(new u.Event(t,{originalEvent:s}))}}function Mi(h,t){if(h.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${h.length}, points ${t.length}`);const s={};for(let c=0;c<h.length;c++)s[h[c].identifier]=t[c];return s}class Hs{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,s,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),c.length===this.numTouches&&(this.centroid=function(p){const g=new u.pointGeometry(0,0);for(const v of p)g._add(v);return g.div(p.length)}(s),this.touches=Mi(c,s)))}touchmove(t,s,c){if(this.aborted||!this.centroid)return;const p=Mi(c,s);for(const g in this.touches){const v=this.touches[g],E=p[g];(!E||E.dist(v)>30)&&(this.aborted=!0)}}touchend(t,s,c){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const p=!this.aborted&&this.centroid;if(this.reset(),p)return p}}}class Hl{constructor(t){this.singleTap=new Hs(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,s,c){this.singleTap.touchstart(t,s,c)}touchmove(t,s,c){this.singleTap.touchmove(t,s,c)}touchend(t,s,c){const p=this.singleTap.touchend(t,s,c);if(p){const g=t.timeStamp-this.lastTime<500,v=!this.lastTap||this.lastTap.dist(p)<30;if(g&&v||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}}}class up{constructor(){this._zoomIn=new Hl({numTouches:1,numTaps:2}),this._zoomOut=new Hl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,s,c){this._zoomIn.touchstart(t,s,c),this._zoomOut.touchstart(t,s,c)}touchmove(t,s,c){this._zoomIn.touchmove(t,s,c),this._zoomOut.touchmove(t,s,c)}touchend(t,s,c){const p=this._zoomIn.touchend(t,s,c),g=this._zoomOut.touchend(t,s,c);return p?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:v=>v.easeTo({duration:300,zoom:v.getZoom()+1,around:v.unproject(p)},{originalEvent:t})}):g?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:v=>v.easeTo({duration:300,zoom:v.getZoom()-1,around:v.unproject(g)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const cp={0:1,2:2};class Fa{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(t,s){return!1}_move(t,s){return{}}mousedown(t,s){if(this._lastPoint)return;const c=Z.mouseButton(t);this._correctButton(t,c)&&(this._lastPoint=s,this._eventButton=c)}mousemoveWindow(t,s){const c=this._lastPoint;if(c){if(t.preventDefault(),function(p,g){const v=cp[g];return p.buttons===void 0||(p.buttons&v)!==v}(t,this._eventButton))this.reset();else if(this._moved||!(s.dist(c)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(c,s)}}mouseupWindow(t){this._lastPoint&&Z.mouseButton(t)===this._eventButton&&(this._moved&&Z.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ks extends Fa{mousedown(t,s){super.mousedown(t,s),this._lastPoint&&(this._active=!0)}_correctButton(t,s){return s===0&&!t.ctrlKey}_move(t,s){return{around:s,panDelta:s.sub(t)}}}class Pi extends Fa{_correctButton(t,s){return s===0&&t.ctrlKey||s===2}_move(t,s){const c=.8*(s.x-t.x);if(c)return this._active=!0,{bearingDelta:c}}contextmenu(t){t.preventDefault()}}class He extends Fa{_correctButton(t,s){return s===0&&t.ctrlKey||s===2}_move(t,s){const c=-.5*(s.y-t.y);if(c)return this._active=!0,{pitchDelta:c}}contextmenu(t){t.preventDefault()}}class Kc{constructor(t,s){this._minTouches=t.cooperativeGestures?2:1,this._clickTolerance=t.clickTolerance||1,this._map=s,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new u.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(t,s,c){return this._calculateTransform(t,s,c)}touchmove(t,s,c){if(this._map._cooperativeGestures&&(this._minTouches===2&&c.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(t,!1,c.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(c.length<this._minTouches))return t.preventDefault(),this._calculateTransform(t,s,c)}touchend(t,s,c){this._calculateTransform(t,s,c),this._active&&c.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,s,c){c.length>0&&(this._active=!0);const p=Mi(c,s),g=new u.pointGeometry(0,0),v=new u.pointGeometry(0,0);let E=0;for(const k in p){const A=p[k],D=this._touches[k];D&&(g._add(A),v._add(A.sub(D)),E++,p[k]=A)}if(this._touches=p,E<this._minTouches||!v.mag())return;const S=v.div(E);return this._sum._add(S),this._sum.mag()<this._clickTolerance?void 0:{around:g.div(E),panDelta:S}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _o{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(t){}_move(t,s,c){return{}}touchstart(t,s,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([s[0],s[1]]))}touchmove(t,s,c){if(!this._firstTwoTouches)return;t.preventDefault();const[p,g]=this._firstTwoTouches,v=Yi(c,s,p),E=Yi(c,s,g);if(!v||!E)return;const S=this._aroundCenter?null:v.add(E).div(2);return this._move([v,E],S,t)}touchend(t,s,c){if(!this._firstTwoTouches)return;const[p,g]=this._firstTwoTouches,v=Yi(c,s,p),E=Yi(c,s,g);v&&E||(this._active&&Z.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Yi(h,t,s){for(let c=0;c<h.length;c++)if(h[c].identifier===s)return t[c]}function Kl(h,t){return Math.log(h/t)/Math.LN2}class Ue extends _o{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,s){const c=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Kl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Kl(this._distance,c),pinchAround:s}}}function Oa(h,t){return 180*h.angleWith(t)/Math.PI}class hp extends _o{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,s){const c=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Oa(this._vector,c),pinchAround:s}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const s=25/(Math.PI*this._minDiameter)*360,c=Oa(t,this._startVector);return Math.abs(c)<s}}function Yl(h){return Math.abs(h.y)>Math.abs(h.x)}class Jl extends _o{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,s,c){super.touchstart(t,s,c),this._currentTouchCount=c.length}_start(t){this._lastPoints=t,Yl(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,s,c){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const p=t[0].sub(this._lastPoints[0]),g=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(p,g,c.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(p.y+g.y)/2*-.5}):void 0}gestureBeginsVertically(t,s,c){if(this._valid!==void 0)return this._valid;const p=t.mag()>=2,g=s.mag()>=2;if(!p&&!g)return;if(!p||!g)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const v=t.y>0==s.y>0;return Yl(t)&&Yl(s)&&v}}const Yc={panStep:100,bearingStep:15,pitchStep:10};class Jc{constructor(){const t=Yc;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let s=0,c=0,p=0,g=0,v=0;switch(t.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:t.shiftKey?c=-1:(t.preventDefault(),g=-1);break;case 39:t.shiftKey?c=1:(t.preventDefault(),g=1);break;case 38:t.shiftKey?p=1:(t.preventDefault(),v=-1);break;case 40:t.shiftKey?p=-1:(t.preventDefault(),v=1);break;default:return}return this._rotationDisabled&&(c=0,p=0),{cameraAnimation:E=>{const S=E.getZoom();E.easeTo({duration:300,easeId:"keyboardHandler",easing:dp,zoom:s?Math.round(S)+s*(t.shiftKey?2:1):S,bearing:E.getBearing()+c*this._bearingStep,pitch:E.getPitch()+p*this._pitchStep,offset:[-g*this._panStep,-v*this._panStep],center:E.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function dp(h){return h*(2-h)}const Qc=4.000244140625;class Ql{constructor(t,s){this._map=t,this._el=t.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,u.bindAll(["_onTimeout"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;t.preventDefault()}let s=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const c=u.exported.now(),p=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,s!==0&&s%Qc==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(p*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),t.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=t,this._delta-=s,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=Z.mousePos(this._el,t);this._around=u.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(s)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._map.transform;if(this._delta!==0){const E=this._type==="wheel"&&Math.abs(this._delta)>Qc?this._wheelZoomRate:this._defaultZoomRate;let S=2/(1+Math.exp(-Math.abs(this._delta*E)));this._delta<0&&S!==0&&(S=1/S);const k=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(k*S))),this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const s=typeof this._targetZoom=="number"?this._targetZoom:t.zoom,c=this._startZoom,p=this._easing;let g,v=!1;if(this._type==="wheel"&&c&&p){const E=Math.min((u.exported.now()-this._lastWheelEventTime)/200,1),S=p(E);g=u.number(c,s,S),E<1?this._frameId||(this._frameId=!0):v=!0}else g=s,v=!0;return this._active=!0,v&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!v,zoomDelta:g-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let s=u.ease;if(this._prevEase){const c=this._prevEase,p=(u.exported.now()-c.start)/c.duration,g=c.easing(p+.01)-c.easing(p),v=.27/Math.sqrt(g*g+1e-4)*.01,E=Math.sqrt(.0729-v*v);s=u.bezier(v,E,.25,1)}return this._prevEase={start:u.exported.now(),duration:t,easing:s},s}reset(){this._active=!1}}class eu{constructor(t,s){this._clickZoom=t,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class tu{constructor(){this.reset()}reset(){this._active=!1}dblclick(t,s){return t.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:c.getZoom()+(t.shiftKey?-1:1),around:c.unproject(s)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class nu{constructor(){this._tap=new Hl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(t,s,c){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?c.length>0&&(this._swipePoint=s[0],this._swipeTouch=c[0].identifier):this._tap.touchstart(t,s,c))}touchmove(t,s,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const p=s[0],g=p.y-this._swipePoint.y;return this._swipePoint=p,t.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(t,s,c)}touchend(t,s,c){this._tapTime?this._swipePoint&&c.length===0&&this.reset():this._tap.touchend(t,s,c)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _r{constructor(t,s,c){this._el=t,this._mousePan=s,this._touchPan=c}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ji{constructor(t,s,c){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=s,this._mousePitch=c}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class eh{constructor(t,s,c,p){this._el=t,this._touchZoom=s,this._touchRotate=c,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const es=h=>h.zoom||h.drag||h.pitch||h.rotate;class ru extends u.Event{}function Ys(h){return h.panDelta&&h.panDelta.mag()||h.zoomDelta||h.bearingDelta||h.pitchDelta}class th{constructor(t,s){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Xc(t),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),u.bindAll(["handleEvent","handleWindowEvent"],this);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[p,g,v]of this._listeners)Z.addEventListener(p,g,p===document?this.handleWindowEvent:this.handleEvent,v)}destroy(){for(const[t,s,c]of this._listeners)Z.removeEventListener(t,s,t===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(t){const s=this._map,c=s.getCanvasContainer();this._add("mapEvent",new lp(s,t));const p=s.boxZoom=new Hc(s,t);this._add("boxZoom",p);const g=new up,v=new tu;s.doubleClickZoom=new eu(v,g),this._add("tapZoom",g),this._add("clickZoom",v);const E=new nu;this._add("tapDragZoom",E);const S=s.touchPitch=new Jl(s);this._add("touchPitch",S);const k=new Pi(t),A=new He(t);s.dragRotate=new Ji(t,k,A),this._add("mouseRotate",k,["mousePitch"]),this._add("mousePitch",A,["mouseRotate"]);const D=new Ks(t),R=new Kc(t,s);s.dragPan=new _r(c,D,R),this._add("mousePan",D),this._add("touchPan",R,["touchZoom","touchRotate"]);const G=new hp,$=new Ue;s.touchZoomRotate=new eh(c,$,G,E),this._add("touchRotate",G,["touchPan","touchZoom"]),this._add("touchZoom",$,["touchPan","touchRotate"]);const j=s.scrollZoom=new Ql(s,this);this._add("scrollZoom",j,["mousePan"]);const ee=s.keyboard=new Jc;this._add("keyboard",ee),this._add("blockableMapEvent",new Ki(s));for(const re of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[re]&&s[re].enable(t[re])}_add(t,s,c){this._handlers.push({handlerName:t,handler:s,allowed:c}),this._handlersById[t]=s}stop(t){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(es(this._eventsInProgress))||this.isZooming()}_blockedByActive(t,s,c){for(const p in t)if(p!==c&&(!s||s.indexOf(p)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const s=[];for(const c of t)this._el.contains(c.target)&&s.push(c);return s}handleEvent(t,s){if(t.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const c=t.type==="renderFrame"?void 0:t,p={needsRenderFrame:!1},g={},v={},E=t.touches,S=E?this._getMapTouches(E):void 0,k=S?Z.touchPos(this._el,S):Z.mousePos(this._el,t);for(const{handlerName:R,handler:G,allowed:$}of this._handlers){if(!G.isEnabled())continue;let j;this._blockedByActive(v,$,R)?G.reset():G[s||t.type]&&(j=G[s||t.type](t,k,S),this.mergeHandlerResult(p,g,j,R,c),j&&j.needsRenderFrame&&this._triggerRenderFrame()),(j||G.isActive())&&(v[R]=G)}const A={};for(const R in this._previousActiveHandlers)v[R]||(A[R]=c);this._previousActiveHandlers=v,(Object.keys(A).length||Ys(p))&&(this._changes.push([p,g,A]),this._triggerRenderFrame()),(Object.keys(v).length||Ys(p))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:D}=p;D&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],D(this._map))}mergeHandlerResult(t,s,c,p,g){if(!c)return;u.extend(t,c);const v={handlerName:p,originalEvent:c.originalEvent||g};c.zoomDelta!==void 0&&(s.zoom=v),c.panDelta!==void 0&&(s.drag=v),c.pitchDelta!==void 0&&(s.pitch=v),c.bearingDelta!==void 0&&(s.rotate=v)}_applyChanges(){const t={},s={},c={};for(const[p,g,v]of this._changes)p.panDelta&&(t.panDelta=(t.panDelta||new u.pointGeometry(0,0))._add(p.panDelta)),p.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+p.zoomDelta),p.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+p.bearingDelta),p.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+p.pitchDelta),p.around!==void 0&&(t.around=p.around),p.pinchAround!==void 0&&(t.pinchAround=p.pinchAround),p.noInertia&&(t.noInertia=p.noInertia),u.extend(s,g),u.extend(c,v);this._updateMapTransform(t,s,c),this._changes=[]}_updateMapTransform(t,s,c){const p=this._map,g=p.transform,v=p.style&&p.style.terrain;if(!(Ys(t)||v&&this._drag))return this._fireEvents(s,c,!0);let{panDelta:E,zoomDelta:S,bearingDelta:k,pitchDelta:A,around:D,pinchAround:R}=t;R!==void 0&&(D=R),p._stop(!0),D=D||p.transform.centerPoint;const G=g.pointLocation(E?D.sub(E):D);k&&(g.bearing+=k),A&&(g.pitch+=A),S&&(g.zoom+=S),v?s.drag&&!this._drag?(this._drag={center:g.centerPoint,lngLat:g.pointLocation(D),point:D,handlerName:s.drag.handlerName},p.fire(new u.Event("freezeElevation",{freeze:!0}))):this._drag&&c[this._drag.handlerName]?(p.fire(new u.Event("freezeElevation",{freeze:!1})),this._drag=null):s.drag&&this._drag&&(g.center=g.pointLocation(g.centerPoint.sub(E))):g.setLocationAtPoint(G,D),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(s,c,!0)}_fireEvents(t,s,c){const p=es(this._eventsInProgress),g=es(t),v={};for(const A in t){const{originalEvent:D}=t[A];this._eventsInProgress[A]||(v[`${A}start`]=D),this._eventsInProgress[A]=t[A]}!p&&g&&this._fireEvent("movestart",g.originalEvent);for(const A in v)this._fireEvent(A,v[A]);g&&this._fireEvent("move",g.originalEvent);for(const A in t){const{originalEvent:D}=t[A];this._fireEvent(A,D)}const E={};let S;for(const A in this._eventsInProgress){const{handlerName:D,originalEvent:R}=this._eventsInProgress[A];this._handlersById[D].isActive()||(delete this._eventsInProgress[A],S=s[D]||R,E[`${A}end`]=S)}for(const A in E)this._fireEvent(A,E[A]);const k=es(this._eventsInProgress);if(c&&(p||g)&&!k){this._updatingCamera=!0;const A=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),D=R=>R!==0&&-this._bearingSnap<R&&R<this._bearingSnap;A?(D(A.bearing||this._map.getBearing())&&(A.bearing=0),this._map.easeTo(A,{originalEvent:S})):(this._map.fire(new u.Event("moveend",{originalEvent:S})),D(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,s){this._map.fire(new u.Event(t,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new ru("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Zr={extend:(h,...t)=>u.extend(h,...t),run(h){h()},logToElement(h,t=!1,s="log"){const c=window.document.getElementById(s);c&&(t&&(c.innerHTML=""),c.innerHTML+=`<br>${h}`)}};class nn extends u.Evented{constructor(t,s){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=s.bearingSnap,u.bindAll(["_renderFrameCallback"],this)}getCenter(){return new u.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(t,s){return this.jumpTo({center:t},s)}panBy(t,s,c){return t=u.pointGeometry.convert(t).mult(-1),this.panTo(this.transform.center,u.extend({offset:t},s),c)}panTo(t,s,c){return this.easeTo(u.extend({center:t},s),c)}getZoom(){return this.transform.zoom}setZoom(t,s){return this.jumpTo({zoom:t},s),this}zoomTo(t,s,c){return this.easeTo(u.extend({zoom:t},s),c)}zoomIn(t,s){return this.zoomTo(this.getZoom()+1,t,s),this}zoomOut(t,s){return this.zoomTo(this.getZoom()-1,t,s),this}getBearing(){return this.transform.bearing}setBearing(t,s){return this.jumpTo({bearing:t},s),this}getPadding(){return this.transform.padding}setPadding(t,s){return this.jumpTo({padding:t},s),this}rotateTo(t,s,c){return this.easeTo(u.extend({bearing:t},s),c)}resetNorth(t,s){return this.rotateTo(0,u.extend({duration:1e3},t),s),this}resetNorthPitch(t,s){return this.easeTo(u.extend({bearing:0,pitch:0,duration:1e3},t),s),this}snapToNorth(t,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,s):this}getPitch(){return this.transform.pitch}setPitch(t,s){return this.jumpTo({pitch:t},s),this}cameraForBounds(t,s){t=u.LngLatBounds.convert(t);const c=s&&s.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),c,s)}_cameraForBoxAndBearing(t,s,c,p){const g={top:0,bottom:0,right:0,left:0};if(typeof(p=u.extend({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},p)).padding=="number"){const he=p.padding;p.padding={top:he,bottom:he,right:he,left:he}}p.padding=u.extend(g,p.padding);const v=this.transform,E=v.padding,S=v.project(u.LngLat.convert(t)),k=v.project(u.LngLat.convert(s)),A=S.rotate(-c*Math.PI/180),D=k.rotate(-c*Math.PI/180),R=new u.pointGeometry(Math.max(A.x,D.x),Math.max(A.y,D.y)),G=new u.pointGeometry(Math.min(A.x,D.x),Math.min(A.y,D.y)),$=R.sub(G),j=(v.width-(E.left+E.right+p.padding.left+p.padding.right))/$.x,ee=(v.height-(E.top+E.bottom+p.padding.top+p.padding.bottom))/$.y;if(ee<0||j<0)return void u.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const re=Math.min(v.scaleZoom(v.scale*Math.min(j,ee)),p.maxZoom),ce=u.pointGeometry.convert(p.offset),W=new u.pointGeometry((p.padding.left-p.padding.right)/2,(p.padding.top-p.padding.bottom)/2).rotate(c*Math.PI/180),pe=ce.add(W).mult(v.scale/v.zoomScale(re));return{center:v.unproject(S.add(k).div(2).sub(pe)),zoom:re,bearing:c}}fitBounds(t,s,c){return this._fitInternal(this.cameraForBounds(t,s),s,c)}fitScreenCoordinates(t,s,c,p,g){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(u.pointGeometry.convert(t)),this.transform.pointLocation(u.pointGeometry.convert(s)),c,p),p,g)}_fitInternal(t,s,c){return t?(delete(s=u.extend(t,s)).padding,s.linear?this.easeTo(s,c):this.flyTo(s,c)):this}jumpTo(t,s){this.stop();const c=this.transform;let p=!1,g=!1,v=!1;return"zoom"in t&&c.zoom!==+t.zoom&&(p=!0,c.zoom=+t.zoom),t.center!==void 0&&(c.center=u.LngLat.convert(t.center)),"bearing"in t&&c.bearing!==+t.bearing&&(g=!0,c.bearing=+t.bearing),"pitch"in t&&c.pitch!==+t.pitch&&(v=!0,c.pitch=+t.pitch),t.padding==null||c.isPaddingEqual(t.padding)||(c.padding=t.padding),this.fire(new u.Event("movestart",s)).fire(new u.Event("move",s)),p&&this.fire(new u.Event("zoomstart",s)).fire(new u.Event("zoom",s)).fire(new u.Event("zoomend",s)),g&&this.fire(new u.Event("rotatestart",s)).fire(new u.Event("rotate",s)).fire(new u.Event("rotateend",s)),v&&this.fire(new u.Event("pitchstart",s)).fire(new u.Event("pitch",s)).fire(new u.Event("pitchend",s)),this.fire(new u.Event("moveend",s))}calculateCameraOptionsFromTo(t,s,c,p=0){const g=u.MercatorCoordinate.fromLngLat(t,s),v=u.MercatorCoordinate.fromLngLat(c,p),E=v.x-g.x,S=v.y-g.y,k=v.z-g.z,A=Math.hypot(E,S,k);if(A===0)throw new Error("Can't calculate camera options with same From and To");const D=Math.hypot(E,S),R=this.transform.scaleZoom(this.transform.cameraToCenterDistance/A/this.transform.tileSize),G=180*Math.atan2(E,-S)/Math.PI;let $=180*Math.acos(D/A)/Math.PI;return $=k<0?90-$:90+$,{center:v.toLngLat(),zoom:R,pitch:$,bearing:G}}easeTo(t,s){this._stop(!1,t.easeId),((t=u.extend({offset:[0,0],duration:500,easing:u.ease},t)).animate===!1||!t.essential&&u.exported.prefersReducedMotion)&&(t.duration=0);const c=this.transform,p=this.getZoom(),g=this.getBearing(),v=this.getPitch(),E=this.getPadding(),S="zoom"in t?+t.zoom:p,k="bearing"in t?this._normalizeBearing(t.bearing,g):g,A="pitch"in t?+t.pitch:v,D="padding"in t?t.padding:c.padding,R=u.pointGeometry.convert(t.offset);let G=c.centerPoint.add(R);const $=c.pointLocation(G),j=u.LngLat.convert(t.center||$);this._normalizeCenter(j);const ee=c.project($),re=c.project(j).sub(ee),ce=c.zoomScale(S-p);let W,pe;t.around&&(W=u.LngLat.convert(t.around),pe=c.locationPoint(W));const he={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||S!==p,this._rotating=this._rotating||g!==k,this._pitching=this._pitching||A!==v,this._padding=!c.isPaddingEqual(D),this._easeId=t.easeId,this._prepareEase(s,t.noMoveStart,he),this._ease(_e=>{if(this._zooming&&(c.zoom=u.number(p,S,_e)),this._rotating&&(c.bearing=u.number(g,k,_e)),this._pitching&&(c.pitch=u.number(v,A,_e)),this._padding&&(c.interpolatePadding(E,D,_e),G=c.centerPoint.add(R)),W)c.setLocationAtPoint(W,pe);else{const ve=c.zoomScale(c.zoom-p),Te=S>p?Math.min(2,ce):Math.max(.5,ce),ye=Math.pow(Te,1-_e),Ge=c.unproject(ee.add(re.mult(_e*ye)).mult(ve));c.setLocationAtPoint(c.renderWorldCopies?Ge.wrap():Ge,G)}this._fireMoveEvents(s)},_e=>{this._afterEase(s,_e)},t),this}_prepareEase(t,s,c={}){this._moving=!0,this.fire(new u.Event("freezeElevation",{freeze:!0})),s||c.moving||this.fire(new u.Event("movestart",t)),this._zooming&&!c.zooming&&this.fire(new u.Event("zoomstart",t)),this._rotating&&!c.rotating&&this.fire(new u.Event("rotatestart",t)),this._pitching&&!c.pitching&&this.fire(new u.Event("pitchstart",t))}_fireMoveEvents(t){this.fire(new u.Event("move",t)),this._zooming&&this.fire(new u.Event("zoom",t)),this._rotating&&this.fire(new u.Event("rotate",t)),this._pitching&&this.fire(new u.Event("pitch",t))}_afterEase(t,s){if(this._easeId&&s&&this._easeId===s)return;delete this._easeId,this.fire(new u.Event("freezeElevation",{freeze:!1}));const c=this._zooming,p=this._rotating,g=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,c&&this.fire(new u.Event("zoomend",t)),p&&this.fire(new u.Event("rotateend",t)),g&&this.fire(new u.Event("pitchend",t)),this.fire(new u.Event("moveend",t))}flyTo(t,s){if(!t.essential&&u.exported.prefersReducedMotion){const it=u.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(it,s)}this.stop(),t=u.extend({offset:[0,0],speed:1.2,curve:1.42,easing:u.ease},t);const c=this.transform,p=this.getZoom(),g=this.getBearing(),v=this.getPitch(),E=this.getPadding(),S="zoom"in t?u.clamp(+t.zoom,c.minZoom,c.maxZoom):p,k="bearing"in t?this._normalizeBearing(t.bearing,g):g,A="pitch"in t?+t.pitch:v,D="padding"in t?t.padding:c.padding,R=c.zoomScale(S-p),G=u.pointGeometry.convert(t.offset);let $=c.centerPoint.add(G);const j=c.pointLocation($),ee=u.LngLat.convert(t.center||j);this._normalizeCenter(ee);const re=c.project(j),ce=c.project(ee).sub(re);let W=t.curve;const pe=Math.max(c.width,c.height),he=pe/R,_e=ce.mag();if("minZoom"in t){const it=u.clamp(Math.min(t.minZoom,p,S),c.minZoom,c.maxZoom),Ft=pe/c.zoomScale(it-p);W=Math.sqrt(Ft/_e*2)}const ve=W*W;function Te(it){const Ft=(he*he-pe*pe+(it?-1:1)*ve*ve*_e*_e)/(2*(it?he:pe)*ve*_e);return Math.log(Math.sqrt(Ft*Ft+1)-Ft)}function ye(it){return(Math.exp(it)-Math.exp(-it))/2}function Ge(it){return(Math.exp(it)+Math.exp(-it))/2}const Be=Te(0);let qe=function(it){return Ge(Be)/Ge(Be+W*it)},gt=function(it){return pe*((Ge(Be)*(ye(Ft=Be+W*it)/Ge(Ft))-ye(Be))/ve)/_e;var Ft},vt=(Te(1)-Be)/W;if(Math.abs(_e)<1e-6||!isFinite(vt)){if(Math.abs(pe-he)<1e-6)return this.easeTo(t,s);const it=he<pe?-1:1;vt=Math.abs(Math.log(he/pe))/W,gt=function(){return 0},qe=function(Ft){return Math.exp(it*W*Ft)}}return t.duration="duration"in t?+t.duration:1e3*vt/("screenSpeed"in t?+t.screenSpeed/W:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=g!==k,this._pitching=A!==v,this._padding=!c.isPaddingEqual(D),this._prepareEase(s,!1),this._ease(it=>{const Ft=it*vt,Ot=1/qe(Ft);c.zoom=it===1?S:p+c.scaleZoom(Ot),this._rotating&&(c.bearing=u.number(g,k,it)),this._pitching&&(c.pitch=u.number(v,A,it)),this._padding&&(c.interpolatePadding(E,D,it),$=c.centerPoint.add(G));const kt=it===1?ee:c.unproject(re.add(ce.mult(gt(Ft))).mult(Ot));c.setLocationAtPoint(c.renderWorldCopies?kt.wrap():kt,$),this._fireMoveEvents(s)},()=>this._afterEase(s),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const c=this._onEaseEnd;delete this._onEaseEnd,c.call(this,s)}if(!t){const c=this.handlers;c&&c.stop(!1)}return this}_ease(t,s,c){c.animate===!1||c.duration===0?(t(1),s()):(this._easeStart=u.exported.now(),this._easeOptions=c,this._onEaseFrame=t,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((u.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,s){t=u.wrap(t,-180,180);const c=Math.abs(t-s);return Math.abs(t-360-s)<c&&(t-=360),Math.abs(t+360-s)<c&&(t+=360),t}_normalizeCenter(t){const s=this.transform;if(!s.renderWorldCopies||s.lngRange)return;const c=t.lng-s.center.lng;t.lng+=c>180?-360:c<-180?360:0}}class Js{constructor(t={}){this.options=t,u.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options&&this.options.compact,this._container=Z.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Z.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Z.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){Z.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,s){const c=this._map._getUIString(`AttributionControl.${s}`);t.title=c,t.setAttribute("aria-label",c)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(t){!t||t.sourceDataType!=="metadata"&&t.sourceDataType!=="visibility"&&t.dataType!=="style"&&t.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(p=>typeof p!="string"?"":p)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}const s=this._map.style.sourceCaches;for(const p in s){const g=s[p];if(g.used||g.usedForTerrain){const v=g.getSource();v.attribution&&t.indexOf(v.attribution)<0&&t.push(v.attribution)}}t=t.filter(p=>String(p).trim()),t.sort((p,g)=>p.length-g.length),t=t.filter((p,g)=>{for(let v=g+1;v<t.length;v++)if(t[v].indexOf(p)>=0)return!1;return!0});const c=t.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,t.length?(this._innerContainer.innerHTML=c,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class Na{constructor(t={}){this.options=t,u.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=Z.create("div","maplibregl-ctrl mapboxgl-ctrl");const s=Z.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://maplibre.org/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){Z.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const t=this._container.children;if(t.length){const s=t[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&s.classList.add("maplibregl-compact","mapboxgl-compact"):s.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class nh{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const s=++this._id;return this._queue.push({callback:t,id:s,cancelled:!1}),s}remove(t){const s=this._currentlyRunning,c=s?this._queue.concat(s):this._queue;for(const p of c)if(p.id===t)return void(p.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const s=this._currentlyRunning=this._queue;this._queue=[];for(const c of s)if(!c.cancelled&&(c.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const rh={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},ih={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},pp={showCompass:!0,showZoom:!0,visualizePitch:!1};class _i{constructor(t,s,c=!1){this._clickTolerance=10,this.element=s,this.mouseRotate=new Pi({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,c&&(this.mousePitch=new He({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),u.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),Z.addEventListener(s,"mousedown",this.mousedown),Z.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),Z.addEventListener(s,"touchmove",this.touchmove),Z.addEventListener(s,"touchend",this.touchend),Z.addEventListener(s,"touchcancel",this.reset)}down(t,s){this.mouseRotate.mousedown(t,s),this.mousePitch&&this.mousePitch.mousedown(t,s),Z.disableDrag()}move(t,s){const c=this.map,p=this.mouseRotate.mousemoveWindow(t,s);if(p&&p.bearingDelta&&c.setBearing(c.getBearing()+p.bearingDelta),this.mousePitch){const g=this.mousePitch.mousemoveWindow(t,s);g&&g.pitchDelta&&c.setPitch(c.getPitch()+g.pitchDelta)}}off(){const t=this.element;Z.removeEventListener(t,"mousedown",this.mousedown),Z.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),Z.removeEventListener(t,"touchmove",this.touchmove),Z.removeEventListener(t,"touchend",this.touchend),Z.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){Z.enableDrag(),Z.removeEventListener(window,"mousemove",this.mousemove),Z.removeEventListener(window,"mouseup",this.mouseup)}mousedown(t){this.down(u.extend({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),Z.mousePos(this.element,t)),Z.addEventListener(window,"mousemove",this.mousemove),Z.addEventListener(window,"mouseup",this.mouseup)}mousemove(t){this.move(t,Z.mousePos(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){t.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Z.touchPos(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){t.targetTouches.length!==1?this.reset():(this._lastPos=Z.touchPos(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){t.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Qs(h,t,s){if(h=new u.LngLat(h.lng,h.lat),t){const c=new u.LngLat(h.lng-360,h.lat),p=new u.LngLat(h.lng+360,h.lat),g=s.locationPoint(h).distSqr(t);s.locationPoint(c).distSqr(t)<g?h=c:s.locationPoint(p).distSqr(t)<g&&(h=p)}for(;Math.abs(h.lng-s.center.lng)>180;){const c=s.locationPoint(h);if(c.x>=0&&c.y>=0&&c.x<=s.width&&c.y<=s.height)break;h.lng>s.center.lng?h.lng-=360:h.lng+=360}return h}const tt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ut(h,t,s){const c=h.classList;for(const p in tt)c.remove(`maplibregl-${s}-anchor-${p}`,`mapboxgl-${s}-anchor-${p}`);c.add(`maplibregl-${s}-anchor-${t}`,`mapboxgl-${s}-anchor-${t}`)}class ts extends u.Evented{constructor(t,s){if(super(),(t instanceof HTMLElement||s)&&(t=u.extend({element:t},s)),u.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,t&&t.element)this._element=t.element,this._offset=u.pointGeometry.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=Z.create("div"),this._element.setAttribute("aria-label","Map marker");const c=Z.createNS("http://www.w3.org/2000/svg","svg"),p=41,g=27;c.setAttributeNS(null,"display","block"),c.setAttributeNS(null,"height",`${p}px`),c.setAttributeNS(null,"width",`${g}px`),c.setAttributeNS(null,"viewBox",`0 0 ${g} ${p}`);const v=Z.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"stroke","none"),v.setAttributeNS(null,"stroke-width","1"),v.setAttributeNS(null,"fill","none"),v.setAttributeNS(null,"fill-rule","evenodd");const E=Z.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const S=Z.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(3.0, 29.0)"),S.setAttributeNS(null,"fill","#000000");const k=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ce of k){const W=Z.createNS("http://www.w3.org/2000/svg","ellipse");W.setAttributeNS(null,"opacity","0.04"),W.setAttributeNS(null,"cx","10.5"),W.setAttributeNS(null,"cy","5.80029008"),W.setAttributeNS(null,"rx",ce.rx),W.setAttributeNS(null,"ry",ce.ry),S.appendChild(W)}const A=Z.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"fill",this._color);const D=Z.createNS("http://www.w3.org/2000/svg","path");D.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),A.appendChild(D);const R=Z.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"opacity","0.25"),R.setAttributeNS(null,"fill","#000000");const G=Z.createNS("http://www.w3.org/2000/svg","path");G.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),R.appendChild(G);const $=Z.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(6.0, 7.0)"),$.setAttributeNS(null,"fill","#FFFFFF");const j=Z.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ee=Z.createNS("http://www.w3.org/2000/svg","circle");ee.setAttributeNS(null,"fill","#000000"),ee.setAttributeNS(null,"opacity","0.25"),ee.setAttributeNS(null,"cx","5.5"),ee.setAttributeNS(null,"cy","5.5"),ee.setAttributeNS(null,"r","5.4999962");const re=Z.createNS("http://www.w3.org/2000/svg","circle");re.setAttributeNS(null,"fill","#FFFFFF"),re.setAttributeNS(null,"cx","5.5"),re.setAttributeNS(null,"cy","5.5"),re.setAttributeNS(null,"r","5.4999962"),j.appendChild(ee),j.appendChild(re),E.appendChild(S),E.appendChild(A),E.appendChild(R),E.appendChild($),E.appendChild(j),c.appendChild(E),c.setAttributeNS(null,"height",p*this._scale+"px"),c.setAttributeNS(null,"width",g*this._scale+"px"),this._element.appendChild(c),this._offset=u.pointGeometry.convert(t&&t.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",c=>{c.preventDefault()}),this._element.addEventListener("mousedown",c=>{c.preventDefault()}),ut(this._element,this._anchor,"marker"),this._popup=null}addTo(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),Z.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=u.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const p=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(38.1-13.5+p)],"bottom-right":[-p,-1*(38.1-13.5+p)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(t){const s=t.code,c=t.charCode||t.keyCode;s!=="Space"&&s!=="Enter"&&c!==32&&c!==13||this.togglePopup()}_onMapClick(t){const s=t.originalEvent.target,c=this._element;this._popup&&(s===c||c.contains(s))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this}_update(t){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Qs(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let s="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?s=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(s=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let c="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?c="rotateX(0deg)":this._pitchAlignment==="map"&&(c=`rotateX(${this._map.getPitch()}deg)`),t&&t.type!=="moveend"||(this._pos=this._pos.round()),Z.setTransform(this._element,`${tt[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${c} ${s}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const p=this._map.unproject(this._pos),g=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=p.distanceTo(this._lngLat)>20*g?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(t){return this._offset=u.pointGeometry.convert(t),this._update(),this}_onMove(t){if(!this._isDragging){const s=this._clickTolerance||this._map._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=s}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.Event("dragstart"))),this.fire(new u.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new u.Event("dragend")),this._state="inactive"}_addDragHandler(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const iu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Qi,Hn=0,eo=!1;const vi={maxWidth:100,unit:"metric"};function oh(h,t,s){const c=s&&s.maxWidth||100,p=h._container.clientHeight/2,g=h.unproject([0,p]),v=h.unproject([c,p]),E=g.distanceTo(v);if(s&&s.unit==="imperial"){const S=3.2808*E;S>5280?to(t,c,S/5280,h._getUIString("ScaleControl.Miles")):to(t,c,S,h._getUIString("ScaleControl.Feet"))}else s&&s.unit==="nautical"?to(t,c,E/1852,h._getUIString("ScaleControl.NauticalMiles")):E>=1e3?to(t,c,E/1e3,h._getUIString("ScaleControl.Kilometers")):to(t,c,E,h._getUIString("ScaleControl.Meters"))}function to(h,t,s,c){const p=function(g){const v=Math.pow(10,`${Math.floor(g)}`.length-1);let E=g/v;return E=E>=10?10:E>=5?5:E>=3?3:E>=2?2:E>=1?1:function(S){const k=Math.pow(10,Math.ceil(-Math.log(S)/Math.LN10));return Math.round(S*k)/k}(E),v*E}(s);h.style.width=t*(p/s)+"px",h.innerHTML=`${p}&nbsp;${c}`}const pn={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Tn=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ou(h){if(h){if(typeof h=="number"){const t=Math.round(Math.sqrt(.5*Math.pow(h,2)));return{center:new u.pointGeometry(0,0),top:new u.pointGeometry(0,h),"top-left":new u.pointGeometry(t,t),"top-right":new u.pointGeometry(-t,t),bottom:new u.pointGeometry(0,-h),"bottom-left":new u.pointGeometry(t,-t),"bottom-right":new u.pointGeometry(-t,-t),left:new u.pointGeometry(h,0),right:new u.pointGeometry(-h,0)}}if(h instanceof u.pointGeometry||Array.isArray(h)){const t=u.pointGeometry.convert(h);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:u.pointGeometry.convert(h.center||[0,0]),top:u.pointGeometry.convert(h.top||[0,0]),"top-left":u.pointGeometry.convert(h["top-left"]||[0,0]),"top-right":u.pointGeometry.convert(h["top-right"]||[0,0]),bottom:u.pointGeometry.convert(h.bottom||[0,0]),"bottom-left":u.pointGeometry.convert(h["bottom-left"]||[0,0]),"bottom-right":u.pointGeometry.convert(h["bottom-right"]||[0,0]),left:u.pointGeometry.convert(h.left||[0,0]),right:u.pointGeometry.convert(h.right||[0,0])}}return ou(new u.pointGeometry(0,0))}const vo={supported:N,setRTLTextPlugin:u.setRTLTextPlugin,getRTLTextPluginStatus:u.getRTLTextPluginStatus,Map:class extends nn{constructor(h){var t;if(u.PerformanceUtils.mark(u.PerformanceMarkers.create),(h=u.extend({},ih,h)).minZoom!=null&&h.maxZoom!=null&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(h.minPitch!=null&&h.maxPitch!=null&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(h.minPitch!=null&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(h.maxPitch!=null&&h.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Gs(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies),{bearingSnap:h.bearingSnap}),this._interactive=h.interactive,this._cooperativeGestures=h.cooperativeGestures,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._crossSourceCollisions=h.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=h.collectResourceTiming,this._renderTaskQueue=new nh,this._controls=[],this._mapId=u.uniqueId(),this._locale=u.extend({},rh,h.locale),this._clickTolerance=h.clickTolerance,this._pixelRatio=(t=h.pixelRatio)!==null&&t!==void 0?t:devicePixelRatio,this._requestManager=new ze(h.transformRequest),typeof h.container=="string"){if(this._container=document.getElementById(h.container),!this._container)throw new Error(`Container '${h.container}' not found.`)}else{if(!(h.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(h.maxBounds&&this.setMaxBounds(h.maxBounds),u.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new th(this,h),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=h.hash&&new Gc(typeof h.hash=="string"&&h.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch}),h.bounds&&(this.resize(),this.fitBounds(h.bounds,u.extend({},h.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=h.localIdeographFontFamily,h.style&&this.setStyle(h.style,{localIdeographFontFamily:h.localIdeographFontFamily}),h.attributionControl&&this.addControl(new Js({customAttribution:h.customAttribution})),h.maplibreLogo&&this.addControl(new Na,h.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new u.Event(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new u.Event(`${s.dataType}dataloading`,s))}),this.on("dataabort",s=>{this.fire(new u.Event("sourcedataabort",s))})}_getMapId(){return this._mapId}addControl(h,t){if(t===void 0&&(t=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new u.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=h.onAdd(this);this._controls.push(h);const c=this._controlPositions[t];return t.indexOf("bottom")!==-1?c.insertBefore(s,c.firstChild):c.appendChild(s),this}removeControl(h){if(!h||!h.onRemove)return this.fire(new u.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(h);return t>-1&&this._controls.splice(t,1),h.onRemove(this),this}hasControl(h){return this._controls.indexOf(h)>-1}calculateCameraOptionsFromTo(h,t,s,c){return c==null&&this.style.terrain&&(c=this.transform.getElevation(s,this.style.terrain)),super.calculateCameraOptionsFromTo(h,t,s,c)}resize(h){const t=this._containerDimensions(),s=t[0],c=t[1];this._resizeCanvas(s,c,this.getPixelRatio()),this.transform.resize(s,c),this.painter.resize(s,c,this.getPixelRatio());const p=!this._moving;return p&&(this.stop(),this.fire(new u.Event("movestart",h)).fire(new u.Event("move",h))),this.fire(new u.Event("resize",h)),p&&this.fire(new u.Event("moveend",h)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(h){const[t,s]=this._containerDimensions();this._pixelRatio=h,this._resizeCanvas(t,s,h),this.painter.resize(t,s,h)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(h){return this.transform.setMaxBounds(u.LngLatBounds.convert(h)),this._update()}setMinZoom(h){if((h=h??-2)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h&&this.setZoom(h),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(h){if((h=h??22)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h&&this.setZoom(h),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(h){if((h=h??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h&&this.setPitch(h),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(h){if((h=h??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h&&this.setPitch(h),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(h){return this.transform.renderWorldCopies=h,this._update()}project(h){return this.transform.locationPoint(u.LngLat.convert(h),this.style&&this.style.terrain)}unproject(h){return this.transform.pointLocation(u.pointGeometry.convert(h),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(h,t,s){if(h==="mouseenter"||h==="mouseover"){let c=!1;return{layer:t,listener:s,delegates:{mousemove:g=>{const v=this.getLayer(t)?this.queryRenderedFeatures(g.point,{layers:[t]}):[];v.length?c||(c=!0,s.call(this,new Dr(h,this,g.originalEvent,{features:v}))):c=!1},mouseout:()=>{c=!1}}}}if(h==="mouseleave"||h==="mouseout"){let c=!1;return{layer:t,listener:s,delegates:{mousemove:v=>{(this.getLayer(t)?this.queryRenderedFeatures(v.point,{layers:[t]}):[]).length?c=!0:c&&(c=!1,s.call(this,new Dr(h,this,v.originalEvent)))},mouseout:v=>{c&&(c=!1,s.call(this,new Dr(h,this,v.originalEvent)))}}}}{const c=p=>{const g=this.getLayer(t)?this.queryRenderedFeatures(p.point,{layers:[t]}):[];g.length&&(p.features=g,s.call(this,p),delete p.features)};return{layer:t,listener:s,delegates:{[h]:c}}}}on(h,t,s){if(s===void 0)return super.on(h,t);const c=this._createDelegatedListener(h,t,s);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(c);for(const p in c.delegates)this.on(p,c.delegates[p]);return this}once(h,t,s){if(s===void 0)return super.once(h,t);const c=this._createDelegatedListener(h,t,s);for(const p in c.delegates)this.once(p,c.delegates[p]);return this}off(h,t,s){return s===void 0?super.off(h,t):(this._delegatedListeners&&this._delegatedListeners[h]&&(c=>{const p=this._delegatedListeners[h];for(let g=0;g<p.length;g++){const v=p[g];if(v.layer===t&&v.listener===s){for(const E in v.delegates)this.off(E,v.delegates[E]);return p.splice(g,1),this}}})(),this)}queryRenderedFeatures(h,t){if(!this.style)return[];let s;if(t!==void 0||h===void 0||h instanceof u.pointGeometry||Array.isArray(h)||(t=h,h=void 0),t=t||{},(h=h||[[0,0],[this.transform.width,this.transform.height]])instanceof u.pointGeometry||typeof h[0]=="number")s=[u.pointGeometry.convert(h)];else{const c=u.pointGeometry.convert(h[0]),p=u.pointGeometry.convert(h[1]);s=[c,new u.pointGeometry(p.x,c.y),p,new u.pointGeometry(c.x,p.y),c]}return this.style.queryRenderedFeatures(s,t,this.transform)}querySourceFeatures(h,t){return this.style.querySourceFeatures(h,t)}setStyle(h,t){return(t=u.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&h?(this._diffStyle(h,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(h,t))}setTransformRequest(h){return this._requestManager.setTransformRequest(h),this}_getUIString(h){const t=this._locale[h];if(t==null)throw new Error(`Missing UI string '${h}'`);return t}_updateStyle(h,t){return this.style&&(this.style.setEventedParent(null),this.style._remove()),h?(this.style=new er(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof h=="string"?this.style.loadURL(h):this.style.loadJSON(h),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new er(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(h,t){if(typeof h=="string"){const s=this._requestManager.transformRequest(h,u.ResourceType.Style);u.getJSON(s,(c,p)=>{c?this.fire(new u.ErrorEvent(c)):p&&this._updateDiff(p,t)})}else typeof h=="object"&&this._updateDiff(h,t)}_updateDiff(h,t){try{this.style.setState(h)&&this._update(!0)}catch(s){u.warnOnce(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(h,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():u.warnOnce("There is no style added to the map.")}addSource(h,t){return this._lazyInitEmptyStyle(),this.style.addSource(h,t),this._update(!0)}isSourceLoaded(h){const t=this.style&&this.style.sourceCaches[h];if(t!==void 0)return t.loaded();this.fire(new u.ErrorEvent(new Error(`There is no source with ID '${h}'`)))}setTerrain(h){return this.style.setTerrain(h),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const h=this.style&&this.style.sourceCaches;for(const t in h){const s=h[t]._tiles;for(const c in s){const p=s[c];if(p.state!=="loaded"&&p.state!=="errored")return!1}}return!0}addSourceType(h,t,s){return this._lazyInitEmptyStyle(),this.style.addSourceType(h,t,s)}removeSource(h){return this.style.removeSource(h),this._update(!0)}getSource(h){return this.style.getSource(h)}addImage(h,t,{pixelRatio:s=1,sdf:c=!1,stretchX:p,stretchY:g,content:v}={}){if(this._lazyInitEmptyStyle(),t instanceof HTMLImageElement||u.isImageBitmap(t)){const{width:E,height:S,data:k}=u.exported.getImageData(t);this.style.addImage(h,{data:new u.RGBAImage({width:E,height:S},k),pixelRatio:s,stretchX:p,stretchY:g,content:v,sdf:c,version:0})}else{if(t.width===void 0||t.height===void 0)return this.fire(new u.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:E,height:S,data:k}=t,A=t;this.style.addImage(h,{data:new u.RGBAImage({width:E,height:S},new Uint8Array(k)),pixelRatio:s,stretchX:p,stretchY:g,content:v,sdf:c,version:0,userImage:A}),A.onAdd&&A.onAdd(this,h)}}}updateImage(h,t){const s=this.style.getImage(h);if(!s)return this.fire(new u.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=t instanceof HTMLImageElement||u.isImageBitmap(t)?u.exported.getImageData(t):t,{width:p,height:g,data:v}=c;if(p===void 0||g===void 0)return this.fire(new u.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(p!==s.data.width||g!==s.data.height)return this.fire(new u.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const E=!(t instanceof HTMLImageElement||u.isImageBitmap(t));s.data.replace(v,E),this.style.updateImage(h,s)}hasImage(h){return h?!!this.style.getImage(h):(this.fire(new u.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(h){this.style.removeImage(h)}loadImage(h,t){u.getImage(this._requestManager.transformRequest(h,u.ResourceType.Image),t)}listImages(){return this.style.listImages()}addLayer(h,t){return this._lazyInitEmptyStyle(),this.style.addLayer(h,t),this._update(!0)}moveLayer(h,t){return this.style.moveLayer(h,t),this._update(!0)}removeLayer(h){return this.style.removeLayer(h),this._update(!0)}getLayer(h){return this.style.getLayer(h)}setLayerZoomRange(h,t,s){return this.style.setLayerZoomRange(h,t,s),this._update(!0)}setFilter(h,t,s={}){return this.style.setFilter(h,t,s),this._update(!0)}getFilter(h){return this.style.getFilter(h)}setPaintProperty(h,t,s,c={}){return this.style.setPaintProperty(h,t,s,c),this._update(!0)}getPaintProperty(h,t){return this.style.getPaintProperty(h,t)}setLayoutProperty(h,t,s,c={}){return this.style.setLayoutProperty(h,t,s,c),this._update(!0)}getLayoutProperty(h,t){return this.style.getLayoutProperty(h,t)}setLight(h,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(h,t),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(h,t){return this.style.setFeatureState(h,t),this._update()}removeFeatureState(h,t){return this.style.removeFeatureState(h,t),this._update()}getFeatureState(h){return this.style.getFeatureState(h)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let h=0,t=0;return this._container&&(h=this._container.clientWidth||400,t=this._container.clientHeight||300),[h,t]}_setupContainer(){const h=this._container;h.classList.add("maplibregl-map","mapboxgl-map");const t=this._canvasContainer=Z.create("div","maplibregl-canvas-container mapboxgl-canvas-container",h);this._interactive&&t.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=Z.create("canvas","maplibregl-canvas mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const s=this._containerDimensions();this._resizeCanvas(s[0],s[1],this.getPixelRatio());const c=this._controlContainer=Z.create("div","maplibregl-control-container mapboxgl-control-container",h),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(g=>{p[g]=Z.create("div",`maplibregl-ctrl-${g} mapboxgl-ctrl-${g}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const h=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=Z.create("div","maplibregl-cooperative-gesture-screen",h);let t="Control",s=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(s=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map",t="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${s}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",c=>{c.key===t&&(this._metaPress=!0)}),document.addEventListener("keyup",c=>{c.key===t&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",c=>{this._onCooperativeGesture(c,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(h,t,s){this._canvas.width=s*h,this._canvas.height=s*t,this._canvas.style.width=`${h}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const h=u.extend({},N.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl",h)||this._canvas.getContext("experimental-webgl",h);t?(this.painter=new Xl(t,this.transform),u.exported$1.testSupport(t)):this.fire(new u.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new u.Event("webglcontextlost",{originalEvent:h}))}_contextRestored(h){this._setupPainter(),this.resize(),this._update(),this.fire(new u.Event("webglcontextrestored",{originalEvent:h}))}_onMapScroll(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(h,t,s){return!t&&s<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(h){return this._update(),this._renderTaskQueue.add(h)}_cancelRenderFrame(h){this._renderTaskQueue.remove(h)}_render(h){let t,s=0;const c=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(t=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,t),s=u.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(h),this._removed)return;let p=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const v=this.transform.zoom,E=u.exported.now();this.style.zoomHistory.update(v,E);const S=new u.EvaluationParameters(v,{now:E,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),k=S.crossFadingFactor();k===1&&k===this._crossFadingFactor||(p=!0,this._crossFadingFactor=k),this.style.update(S)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new u.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,u.PerformanceUtils.mark(u.PerformanceMarkers.load),this.fire(new u.Event("load"))),this.style&&(this.style.hasTransitions()||p)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const v=u.exported.now()-s;c.endQueryEXT(c.TIME_ELAPSED_EXT,t),setTimeout(()=>{const E=c.getQueryObjectEXT(t,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(t),this.fire(new u.Event("gpu-timing-frame",{cpuTime:v,gpuTime:E}))},50)}if(this.listens("gpu-timing-layer")){const v=this.painter.collectGpuTimers();setTimeout(()=>{const E=this.painter.queryGpuTimers(v);this.fire(new u.Event("gpu-timing-layer",{layerTimes:E}))},50)}const g=this._sourcesDirty||this._styleDirty||this._placementDirty;return g||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new u.Event("idle")),!this._loaded||this._fullyLoaded||g||(this._fullyLoaded=!0,u.PerformanceUtils.mark(u.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const h=this.painter.context.gl.getExtension("WEBGL_lose_context");h&&h.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),Z.remove(this._canvasContainer),Z.remove(this._controlContainer),this._cooperativeGestures&&Z.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),u.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new u.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=u.exported.frame(h=>{u.PerformanceUtils.frame(h),this._frame=null,this._render(h)}))}_onWindowOnline(){this._update()}_onWindowResize(h){this._trackResize&&this.resize({originalEvent:h})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._update())}get showPadding(){return!!this._showPadding}set showPadding(h){this._showPadding!==h&&(this._showPadding=h,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,h?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._update())}get repaint(){return!!this._repaint}set repaint(h){this._repaint!==h&&(this._repaint=h,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(h){this._vertices=h,this._update()}_setCacheLimits(h,t){u.setCacheLimits(h,t)}get version(){return"2.4.0"}},NavigationControl:class{constructor(h){this.options=u.extend({},pp,h),this._container=Z.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(u.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),Z.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),Z.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(u.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=Z.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const h=this._map.getZoom(),t=h===this._map.getMaxZoom(),s=h===this._map.getMinZoom();this._zoomInButton.disabled=t,this._zoomOutButton.disabled=s,this._zoomInButton.setAttribute("aria-disabled",t.toString()),this._zoomOutButton.setAttribute("aria-disabled",s.toString())}_rotateCompassArrow(){const h=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=h}onAdd(h){return this._map=h,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new _i(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){Z.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(h,t){const s=Z.create("button",h,this._container);return s.type="button",s.addEventListener("click",t),s}_setButtonTitle(h,t){const s=this._map._getUIString(`NavigationControl.${t}`);h.title=s,h.setAttribute("aria-label",s)}},GeolocateControl:class extends u.Evented{constructor(h){super(),this.options=u.extend({},iu,h),u.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(h){var t;return this._map=h,this._container=Z.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),t=this._setupUI,Qi!==void 0?t(Qi):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(s=>{Qi=s.state!=="denied",t(Qi)}):(Qi=!!window.navigator.geolocation,t(Qi)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),Z.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Hn=0,eo=!1}_isOutOfMapMaxBounds(h){const t=this._map.getMaxBounds(),s=h.coords;return t&&(s.longitude<t.getWest()||s.longitude>t.getEast()||s.latitude<t.getSouth()||s.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new u.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(h),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new u.Event("geolocate",h)),this._finish()}}_updateCamera(h){const t=new u.LngLat(h.coords.longitude,h.coords.latitude),s=h.coords.accuracy,c=this._map.getBearing(),p=u.extend({bearing:c},this.options.fitBoundsOptions);this._map.fitBounds(t.toBounds(s),p,{geolocateSource:!0})}_updateMarker(h){if(h){const t=new u.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const h=this._map._container.clientHeight/2,t=this._map.unproject([0,h]),s=this._map.unproject([1,h]),c=t.distanceTo(s),p=Math.ceil(2*this._accuracy/c);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(h){if(this._map){if(this.options.trackUserLocation)if(h.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(h.code===3&&eo)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new u.Event("error",h)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(h){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=Z.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),Z.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",h===!1){u.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Z.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new ts(this._dotElement),this._circleElement=Z.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ts({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||this._watchState!=="ACTIVE_LOCK"||t.originalEvent&&t.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new u.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return u.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Hn--,eo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new u.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let h;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Hn++,Hn>1?(h={maximumAge:6e5,timeout:0},eo=!0):(h=this.options.positionOptions,eo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,h)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Js,LogoControl:Na,ScaleControl:class{constructor(h){this.options=u.extend({},vi,h),u.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){oh(this._map,this._container,this.options)}onAdd(h){return this._map=h,this._container=Z.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",h.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){Z.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(h){this.options.unit=h,oh(this._map,this._container,this.options)}},FullscreenControl:class{constructor(h){this._fullscreen=!1,h&&h.container&&(h.container instanceof HTMLElement?this._container=h.container:u.warnOnce("Full screen control 'container' must be a DOM element.")),u.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(h){return this._map=h,this._container||(this._container=this._map.getContainer()),this._controlContainer=Z.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",u.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){Z.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const h=this._fullscreenButton=Z.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);Z.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",h).setAttribute("aria-hidden","true"),h.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const h=this._getTitle();this._fullscreenButton.setAttribute("aria-label",h),this._fullscreenButton.title=h}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(h){this.options=h,u.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(h){return this._map=h,this._container=Z.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=Z.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),Z.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){Z.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends u.Evented{constructor(h){super(),this.options=u.extend(Object.create(pn),h),u.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new u.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&Z.remove(this._content),this._container&&(Z.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new u.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(h){return this._lngLat=u.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(h){return this.setDOMContent(document.createTextNode(h))}setHTML(h){const t=document.createDocumentFragment(),s=document.createElement("body");let c;for(s.innerHTML=h;c=s.firstChild,c;)t.appendChild(c);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(h){return this.options.maxWidth=h,this._update(),this}setDOMContent(h){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=Z.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(h),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(h){this._container&&this._container.classList.add(h)}removeClassName(h){this._container&&this._container.classList.remove(h)}setOffset(h){return this.options.offset=h,this._update(),this}toggleClassName(h){if(this._container)return this._container.classList.toggle(h)}_createCloseButton(){this.options.closeButton&&(this._closeButton=Z.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(h){this._update(h.point)}_onMouseMove(h){this._update(h.point)}_onDrag(h){this._update(h.point)}_update(h){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=Z.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=Z.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(g=>this._container.classList.add(g)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Qs(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!h))return;const t=this._pos=this._trackPointer&&h?h:this._map.project(this._lngLat);let s=this.options.anchor;const c=ou(this.options.offset);if(!s){const g=this._container.offsetWidth,v=this._container.offsetHeight;let E;E=t.y+c.bottom.y<v?["top"]:t.y>this._map.transform.height-v?["bottom"]:[],t.x<g/2?E.push("left"):t.x>this._map.transform.width-g/2&&E.push("right"),s=E.length===0?"bottom":E.join("-")}const p=t.add(c[s]).round();Z.setTransform(this._container,`${tt[s]} translate(${p.x}px,${p.y}px)`),ut(this._container,s,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const h=this._container.querySelector(Tn);h&&h.focus()}_onClose(){this.remove()}},Marker:ts,Style:er,LngLat:u.LngLat,LngLatBounds:u.LngLatBounds,Point:u.pointGeometry,MercatorCoordinate:u.MercatorCoordinate,Evented:u.Evented,AJAXError:u.AJAXError,config:u.config,CanvasSource:Tt,GeoJSONSource:wn,ImageSource:ct,RasterDEMTileSource:st,RasterTileSource:ar,VectorTileSource:an,VideoSource:at,prewarm:function(){ur().acquire(jt)},clearPrewarmedResources:function(){const h=Gt;h&&(h.isPreloaded()&&h.numActive()===1?(h.release(jt),Gt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return Pt.workerCount},set workerCount(h){Pt.workerCount=h},get maxParallelImageRequests(){return u.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(h){u.config.MAX_PARALLEL_IMAGE_REQUESTS=h},clearStorage(h){u.clearTileCache(h)},workerUrl:"",addProtocol(h,t){u.config.REGISTERED_PROTOCOLS[h]=t},removeProtocol(h){delete u.config.REGISTERED_PROTOCOLS[h]}};return Zr.extend(vo,{isSafari:u.isSafari,getPerformanceMetrics:u.PerformanceUtils.getPerformanceMetrics}),vo});var I=_;return I})})(AE);const ME=km;const PE=n=>fetch(n).then(o=>{var l;return(l=o.headers.get("content-type"))!=null&&l.includes("json")?o.json():o.text()}),DE=[{latitude:35.712583,longitude:139.780056,title:"",emoji_reactions:{}},{latitude:35.7100576,longitude:139.7728115,title:" ",emoji_reactions:{}}],LE=({latitude:n,longitude:o,zIndex:l,onClick:f,children:_})=>Gn(EE,{latitude:n,longitude:o,onClick:w=>{f&&f(w)},style:l?{zIndex:l}:{},children:_});const M0=({latitude:n,longitude:o,title:l,desc:f,photo:_,icon:w})=>{const[I,u]=Qe.useState(7),{current:N}=aE();return Qe.useEffect(()=>{N&&N.on("zoomend",q=>{u(q.viewState.zoom)})},[]),Gn(LE,{latitude:n,longitude:o,children:Lu("div",{className:"IconMarkerWrap",title:f,children:[I<16?Gn("div",{className:"IconMarkerBalloon",children:Lu("div",{className:"IconMarkerBalloonTitle IconMarkerBalloonTitleMoreZoom",children:[l,"..."]})}):Lu("div",{className:"IconMarkerBalloon",children:[Gn("div",{className:"IconMarkerBalloonTitle",children:l}),Lu("div",{className:"IconMarkerBalloonContent",children:[_&&_.length>0&&Gn("div",{className:"IconMarkerBalloonPhoto",children:Gn("img",{src:_+"/raw"})}),f&&f.length>0&&Gn("div",{className:"IconMarkerBalloonDesc",children:f})]})]}),Gn("div",{className:"IconMarKerIcon",children:Gn("img",{src:w})})]})})};var Cm={},RE={get exports(){return Cm},set exports(n){Cm=n}},P0={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sl=Qe;function BE(n,o){return n===o&&(n!==0||1/n===1/o)||n!==n&&o!==o}var FE=typeof Object.is=="function"?Object.is:BE,OE=Sl.useState,NE=Sl.useEffect,UE=Sl.useLayoutEffect,VE=Sl.useDebugValue;function $E(n,o){var l=o(),f=OE({inst:{value:l,getSnapshot:o}}),_=f[0].inst,w=f[1];return UE(function(){_.value=l,_.getSnapshot=o,kf(_)&&w({inst:_})},[n,l,o]),NE(function(){return kf(_)&&w({inst:_}),n(function(){kf(_)&&w({inst:_})})},[n]),VE(l),l}function kf(n){var o=n.getSnapshot;n=n.value;try{var l=o();return!FE(n,l)}catch{return!0}}function jE(n,o){return o()}var GE=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?jE:$E;P0.useSyncExternalStore=Sl.useSyncExternalStore!==void 0?Sl.useSyncExternalStore:GE;(function(n){n.exports=P0})(RE);const Mo=new WeakMap,Cf={},qh={},gs=()=>{},$i=gs(),If=Object,sn=n=>n===$i,Po=n=>typeof n=="function",Cs=(n,o)=>({...n,...o}),zg="undefined",Wd=typeof window!=zg,Im=typeof document!=zg,ZE=()=>Wd&&typeof window.requestAnimationFrame!=zg,D0=(n,o)=>{const l=Mo.get(n);return[()=>n.get(o)||Cf,f=>{if(!sn(o)){const _=n.get(o);o in qh||(qh[o]=_),l[5](o,Cs(_,f),_||Cf)}},l[6],()=>!sn(o)&&o in qh?qh[o]:n.get(o)||Cf]},Wh=new WeakMap;let qE=0;const pc=n=>{const o=typeof n,l=n&&n.constructor,f=l==Date;let _,w;if(If(n)===n&&!f&&l!=RegExp){if(_=Wh.get(n),_)return _;if(_=++qE+"~",Wh.set(n,_),l==Array){for(_="@",w=0;w<n.length;w++)_+=pc(n[w])+",";Wh.set(n,_)}if(l==If){_="#";const I=If.keys(n).sort();for(;!sn(w=I.pop());)sn(n[w])||(_+=w+":"+pc(n[w])+",");Wh.set(n,_)}}else _=f?n.toJSON():o=="symbol"?n.toString():o=="string"?JSON.stringify(n):""+n;return _};let zm=!0;const WE=()=>zm,[Am,Mm]=Wd&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[gs,gs],XE=()=>{const n=Im&&document.visibilityState;return sn(n)||n!=="hidden"},HE=n=>(Im&&document.addEventListener("visibilitychange",n),Am("focus",n),()=>{Im&&document.removeEventListener("visibilitychange",n),Mm("focus",n)}),KE=n=>{const o=()=>{zm=!0,n()},l=()=>{zm=!1};return Am("online",o),Am("offline",l),()=>{Mm("online",o),Mm("offline",l)}},YE={isOnline:WE,isVisible:XE},JE={initFocus:HE,initReconnect:KE},mv=!Fm.useId,fc=!Wd||"Deno"in window,QE=n=>ZE()?window.requestAnimationFrame(n):setTimeout(n,1),zf=fc?Qe.useEffect:Qe.useLayoutEffect,Af=typeof navigator<"u"&&navigator.connection,gv=!fc&&Af&&(["slow-2g","2g"].includes(Af.effectiveType)||Af.saveData),Ag=n=>{if(Po(n))try{n=n()}catch{n=""}const o=n;return n=typeof n=="string"?n:(Array.isArray(n)?n.length:n)?pc(n):"",[n,o]};let eS=0;const Pm=()=>++eS,L0=0,R0=1,B0=2,tS=3;var Du={__proto__:null,FOCUS_EVENT:L0,RECONNECT_EVENT:R0,MUTATE_EVENT:B0,ERROR_REVALIDATE_EVENT:tS};async function F0(...n){const[o,l,f,_]=n,w=Cs({populateCache:!0,throwOnError:!0},typeof _=="boolean"?{revalidate:_}:_||{});let I=w.populateCache;const u=w.rollbackOnError;let N=w.optimisticData;const q=w.revalidate!==!1,ue=ze=>typeof u=="function"?u(ze):u!==!1,oe=w.throwOnError;if(Po(l)){const ze=l,Ie=[],ke=o.keys();for(let Xe=ke.next();!Xe.done;Xe=ke.next()){const se=Xe.value;!se.startsWith("$inf$")&&ze(o.get(se)._k)&&Ie.push(se)}return Promise.all(Ie.map(Z))}return Z(l);async function Z(ze){const[Ie]=Ag(ze);if(!Ie)return;const[ke,Xe]=D0(o,Ie),[se,Q,ae]=Mo.get(o),Se=se[Ie],Ae=()=>q&&(delete ae[Ie],Se&&Se[0])?Se[0](B0).then(()=>ke().data):ke().data;if(n.length<3)return Ae();let Le=f,Me;const Ke=Pm();Q[Ie]=[Ke,0];const Ct=!sn(N),dt=ke(),cn=dt.data,xn=dt._c,an=sn(xn)?cn:xn;if(Ct&&(N=Po(N)?N(an):N,Xe({data:N,_c:an})),Po(Le))try{Le=Le(an)}catch(qn){Me=qn}if(Le&&Po(Le.then))if(Le=await Le.catch(qn=>{Me=qn}),Ke!==Q[Ie][0]){if(Me)throw Me;return Le}else Me&&Ct&&ue(Me)&&(I=!0,Le=an,Xe({data:Le,_c:$i}));I&&(Me||(Po(I)&&(Le=I(Le,an)),Xe({data:Le,_c:$i}))),Q[Ie][1]=Pm();const ar=await Ae();if(Xe({_c:$i}),Me){if(oe)throw Me;return}return I?ar:Le}}const yv=(n,o)=>{for(const l in n)n[l][0]&&n[l][0](o)},nS=(n,o)=>{if(!Mo.has(n)){const l=Cs(JE,o),f={},_=F0.bind($i,n);let w=gs;const I={},u=(ue,oe)=>{const Z=I[ue]||[];return I[ue]=Z,Z.push(oe),()=>Z.splice(Z.indexOf(oe),1)},N=(ue,oe,Z)=>{n.set(ue,oe);const ze=I[ue];if(ze)for(const Ie of ze)Ie(oe,Z)},q=()=>{if(!Mo.has(n)&&(Mo.set(n,[f,{},{},{},_,N,u]),!fc)){const ue=l.initFocus(setTimeout.bind($i,yv.bind($i,f,L0))),oe=l.initReconnect(setTimeout.bind($i,yv.bind($i,f,R0)));w=()=>{ue&&ue(),oe&&oe(),Mo.delete(n)}}};return q(),[n,_,q,w]}return[n,Mo.get(n)[4]]},rS=(n,o,l,f,_)=>{const w=l.errorRetryCount,I=_.retryCount,u=~~((Math.random()+.5)*(1<<(I<8?I:8)))*l.errorRetryInterval;!sn(w)&&I>w||setTimeout(f,u,_)},iS=(n,o)=>pc(n)==pc(o),[O0,oS]=nS(new Map),sS=Cs({onLoadingSlow:gs,onSuccess:gs,onError:gs,onErrorRetry:rS,onDiscarded:gs,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:gv?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:gv?5e3:3e3,compare:iS,isPaused:()=>!1,cache:O0,mutate:oS,fallback:{}},YE),aS=(n,o)=>{const l=Cs(n,o);if(o){const{use:f,fallback:_}=n,{use:w,fallback:I}=o;f&&w&&(l.use=f.concat(w)),_&&I&&(l.fallback=Cs(_,I))}return l},lS=Qe.createContext({}),N0=Wd&&window.__SWR_DEVTOOLS_USE__,uS=N0?window.__SWR_DEVTOOLS_USE__:[],cS=()=>{N0&&(window.__SWR_DEVTOOLS_REACT__=Fm)},hS=n=>Po(n[1])?[n[0],n[1],n[2]||{}]:[n[0],null,(n[1]===null?n[2]:n[1])||{}],dS=()=>Cs(sS,Qe.useContext(lS)),pS=n=>(o,l,f)=>n(o,l&&((...w)=>{const I=Ag(o)[0],[,,,u]=Mo.get(O0),N=u[I];return N?(delete u[I],N):l(...w)}),f),fS=uS.concat(pS),mS=n=>function(...l){const f=dS(),[_,w,I]=hS(l),u=aS(f,I);let N=n;const{use:q}=u,ue=(q||[]).concat(fS);for(let oe=ue.length;oe--;)N=ue[oe](N);return N(_,w||u.fetcher||null,u)},gS=(n,o,l)=>{const f=o[n]||(o[n]=[]);return f.push(l),()=>{const _=f.indexOf(l);_>=0&&(f[_]=f[f.length-1],f.pop())}};cS();const Mf={dedupe:!0},yS=(n,o,l)=>{const{cache:f,compare:_,suspense:w,fallbackData:I,revalidateOnMount:u,revalidateIfStale:N,refreshInterval:q,refreshWhenHidden:ue,refreshWhenOffline:oe,keepPreviousData:Z}=l,[ze,Ie,ke]=Mo.get(f),[Xe,se]=Ag(n),Q=Qe.useRef(!1),ae=Qe.useRef(!1),Se=Qe.useRef(Xe),Ae=Qe.useRef(o),Le=Qe.useRef(l),Me=()=>Le.current,Ke=()=>Me().isVisible()&&Me().isOnline(),[Ct,dt,cn,xn]=D0(f,Xe),an=Qe.useRef({}).current,ar=sn(I)?l.fallback[Xe]:I,qn=(Xt,jt)=>{let Pt=!0;for(const En in an){const Gt=En;Gt==="data"?_(jt[Gt],Xt[Gt])||sn(Xt[Gt])&&_(jt[Gt],Rn)||(Pt=!1):jt[Gt]!==Xt[Gt]&&(Pt=!1)}return Pt},st=Qe.useMemo(()=>{const Xt=(()=>!Xe||!o?!1:sn(u)?Me().isPaused()||w?!1:sn(N)?!0:N:u)(),jt=Gt=>{const ur=Cs(Gt);return delete ur._k,Xt?{isValidating:!0,isLoading:!0,...ur}:ur};let Pt=jt(Ct());const En=jt(xn());return[()=>{const Gt=jt(Ct());return qn(Gt,Pt)?Pt:Pt=Gt},()=>En]},[f,Xe]),wn=Cm.useSyncExternalStore(Qe.useCallback(Xt=>cn(Xe,(jt,Pt)=>{qn(Pt,jt)||Xt()}),[f,Xe]),st[0],st[1]),Ze=!Q.current,ct=ze[Xe]&&ze[Xe].length>0,at=wn.data,Tt=sn(at)?ar:at,Ut=wn.error,yr=Qe.useRef(Tt),Rn=Z?sn(at)?yr.current:at:Tt,Wn=(()=>ct&&!sn(Ut)?!1:Ze&&!sn(u)?u:Me().isPaused()?!1:w?sn(Tt)?!1:N:sn(Tt)||N)(),zn=!!(Xe&&o&&Ze&&Wn),lr=sn(wn.isValidating)?zn:wn.isValidating,gi=sn(wn.isLoading)?zn:wn.isLoading,bn=Qe.useCallback(async Xt=>{const jt=Ae.current;if(!Xe||!jt||ae.current||Me().isPaused())return!1;let Pt,En,Gt=!0;const ur=Xt||{},Qn=!ke[Xe]||!ur.dedupe,ei=()=>mv?!ae.current&&Xe===Se.current&&Q.current:Xe===Se.current,wt={isValidating:!1,isLoading:!1},Cr=()=>{dt(wt)},ti=()=>{const Bn=ke[Xe];Bn&&Bn[1]===En&&delete ke[Xe]},ni={isValidating:!0};sn(Ct().data)&&(ni.isLoading=!0);try{if(Qn&&(dt(ni),l.loadingTimeout&&sn(Ct().data)&&setTimeout(()=>{Gt&&ei()&&Me().onLoadingSlow(Xe,l)},l.loadingTimeout),ke[Xe]=[jt(se),Pm()]),[Pt,En]=ke[Xe],Pt=await Pt,Qn&&setTimeout(ti,l.dedupingInterval),!ke[Xe]||ke[Xe][1]!==En)return Qn&&ei()&&Me().onDiscarded(Xe),!1;wt.error=$i;const Bn=Ie[Xe];if(!sn(Bn)&&(En<=Bn[0]||En<=Bn[1]||Bn[1]===0))return Cr(),Qn&&ei()&&Me().onDiscarded(Xe),!1;const An=Ct().data;wt.data=_(An,Pt)?An:Pt,Qn&&ei()&&Me().onSuccess(Pt,Xe,l)}catch(Bn){ti();const An=Me(),{shouldRetryOnError:Ir}=An;An.isPaused()||(wt.error=Bn,Qn&&ei()&&(An.onError(Bn,Xe,An),(Ir===!0||Po(Ir)&&Ir(Bn))&&Ke()&&An.onErrorRetry(Bn,Xe,An,Wi=>{const zr=ze[Xe];zr&&zr[0]&&zr[0](Du.ERROR_REVALIDATE_EVENT,Wi)},{retryCount:(ur.retryCount||0)+1,dedupe:!0})))}return Gt=!1,Cr(),!0},[Xe,f]),qi=Qe.useCallback((...Xt)=>F0(f,Se.current,...Xt),[]);if(zf(()=>{Ae.current=o,Le.current=l,sn(at)||(yr.current=at)}),zf(()=>{if(!Xe)return;const Xt=bn.bind($i,Mf);let jt=0;const En=gS(Xe,ze,(Gt,ur={})=>{if(Gt==Du.FOCUS_EVENT){const Qn=Date.now();Me().revalidateOnFocus&&Qn>jt&&Ke()&&(jt=Qn+Me().focusThrottleInterval,Xt())}else if(Gt==Du.RECONNECT_EVENT)Me().revalidateOnReconnect&&Ke()&&Xt();else{if(Gt==Du.MUTATE_EVENT)return bn();if(Gt==Du.ERROR_REVALIDATE_EVENT)return bn(ur)}});return ae.current=!1,Se.current=Xe,Q.current=!0,dt({_k:se}),Wn&&(sn(Tt)||fc?Xt():QE(Xt)),()=>{ae.current=!0,En()}},[Xe]),zf(()=>{let Xt;function jt(){const En=Po(q)?q(Tt):q;En&&Xt!==-1&&(Xt=setTimeout(Pt,En))}function Pt(){!Ct().error&&(ue||Me().isVisible())&&(oe||Me().isOnline())?bn(Mf).then(jt):jt()}return jt(),()=>{Xt&&(clearTimeout(Xt),Xt=-1)}},[q,ue,oe,Xe]),Qe.useDebugValue(Rn),w&&sn(Tt)&&Xe)throw!mv&&fc?new Error("Fallback data is required when using suspense in SSR."):(Ae.current=o,Le.current=l,ae.current=!1,sn(Ut)?bn(Mf):Ut);return{mutate:qi,get data(){return an.data=!0,Rn},get error(){return an.error=!0,Ut},get isValidating(){return an.isValidating=!0,lr},get isLoading(){return an.isLoading=!0,gi}}};var _S=mS(yS);const Xh=({projectName:n,pageName:o,iconName:l})=>{const f=n?"https://gyamap.com/project_entries/"+n:"https://gyamap.com/page_entries/"+o,{data:_}=_S(f,PE);return _?Gn(Qw,{children:_.map(w=>Gn(M0,{icon:l,...w},w.title))}):null};function vS(){return Gn("div",{className:"App",children:Lu(Ig,{style:{display:"block",width:"100vw",height:"100vh"},mapLib:ME,mapStyle:"https://tile.openstreetmap.jp/styles/osm-bright/style.json",attributionControl:!0,initialViewState:{latitude:35.71527,longitude:139.77269,zoom:15},hash:!1,maxZoom:22,maxPitch:85,children:[DE.map(n=>Gn(M0,{icon:"./yuiseki_icon.png",...n},n.title)),Gn(Xh,{projectName:"yuiseki",iconName:"yuiseki_icon.png"}),Gn(Xh,{projectName:"inoue2002",iconName:"inoue2002_icon.png"}),Gn(Xh,{projectName:"masuimap",iconName:"masui_icon.png"}),Gn(Xh,{pageName:"",iconName:"masui_icon.png"}),Gn(IE,{position:"bottom-right",visualizePitch:!0,showZoom:!0,showCompass:!0})]})})}Pf.createRoot(document.getElementById("root")).render(Gn(Fm.StrictMode,{children:Gn(vS,{})}));
